import{r as ref,c as computed,b as onMounted,o as onUnmounted,a4 as useRoute,d as defineComponent,I as createElementBlock,a0 as createBaseVNode,f as createVNode,K as createCommentVNode,F as Fragment,M as renderList,A as createBlock,L as withCtx,u as unref,R as normalizeClass,E as resolveComponent,z as openBlock,a1 as toDisplayString}from"./vue-vendor-31320f47.js";import{Z as StorageUtil,n as useAuthStore,j as useTexts,aL as BrandLogo,aM as ThemeToggle,_ as _export_sfc,m as useSettingsStore}from"./index-38202212.js";import{u as useWebSocketStore}from"./websocket-61b7fea7.js";import{a as getAdminMenuItems}from"./navigationOptions-d958d3cc.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const RESPONSIVE_BREAKPOINTS={mobile:768,tablet:1024,desktop:1280,large:1536,xlarge:1920};function useResponsiveSidebar(){const STORAGE_KEY="admin_sidebar_collapsed",MOBILE_COLLAPSED_KEY="admin_sidebar_mobile_collapsed",screenWidth=ref(typeof window<"u"?window.innerWidth:1024),savedState=typeof window<"u"?StorageUtil.get(STORAGE_KEY):null,isCollapsed=ref(savedState!==null?savedState:!1),isMobileOverlayOpen=ref(!1),isTransitioning=ref(!1),isMobile=computed(()=>screenWidth.value<RESPONSIVE_BREAKPOINTS.mobile),isTablet=computed(()=>screenWidth.value>=RESPONSIVE_BREAKPOINTS.mobile&&screenWidth.value<RESPONSIVE_BREAKPOINTS.desktop),isDesktop=computed(()=>screenWidth.value>=RESPONSIVE_BREAKPOINTS.desktop),currentSidebarWidth=computed(()=>isCollapsed.value?60:220),collapsedWidth=computed(()=>60),shouldAutoCollapse=computed(()=>!1),sidebarConfig=computed(()=>({isCollapsed:isCollapsed.value,isMobile:isMobile.value,isTablet:isTablet.value,screenWidth:screenWidth.value,sidebarWidth:currentSidebarWidth.value,collapsedWidth:collapsedWidth.value,shouldAutoCollapse:shouldAutoCollapse.value})),updateScreenWidth=()=>{screenWidth.value=window.innerWidth},initializeSidebar=()=>{if(isMobile.value){isCollapsed.value=!0;const mobileState=StorageUtil.get(MOBILE_COLLAPSED_KEY);mobileState!==null&&(isMobileOverlayOpen.value=!mobileState)}},toggleSidebar=()=>{isTransitioning.value=!0,isMobile.value?(isMobileOverlayOpen.value=!isMobileOverlayOpen.value,StorageUtil.set(MOBILE_COLLAPSED_KEY,!isMobileOverlayOpen.value)):(isCollapsed.value=!isCollapsed.value,StorageUtil.set(STORAGE_KEY,isCollapsed.value)),setTimeout(()=>{isTransitioning.value=!1,window.dispatchEvent(new Event("resize"))},300)},closeMobileSidebar=()=>{isMobile.value&&isMobileOverlayOpen.value&&(isMobileOverlayOpen.value=!1,StorageUtil.set(MOBILE_COLLAPSED_KEY,!0))},expandSidebar=()=>{isCollapsed.value&&!isMobile.value&&(isCollapsed.value=!1,StorageUtil.set(STORAGE_KEY,!1))},collapseSidebar=()=>{!isCollapsed.value&&!isMobile.value&&(isCollapsed.value=!0,StorageUtil.set(STORAGE_KEY,!0))},handleResize=()=>{const oldIsMobile=isMobile.value;screenWidth.value,updateScreenWidth(),oldIsMobile!==isMobile.value&&initializeSidebar()},handleKeydown=event=>{(event.ctrlKey||event.metaKey)&&event.key==="b"&&(event.preventDefault(),toggleSidebar()),event.key==="Escape"&&isMobile.value&&isMobileOverlayOpen.value&&(event.preventDefault(),closeMobileSidebar())},handleRouteChange=()=>{isMobile.value&&isMobileOverlayOpen.value&&closeMobileSidebar()};return onMounted(()=>{updateScreenWidth(),initializeSidebar(),window.addEventListener("resize",handleResize),window.addEventListener("keydown",handleKeydown),document.body.style.overflowX="hidden"}),onUnmounted(()=>{window.removeEventListener("resize",handleResize),window.removeEventListener("keydown",handleKeydown),document.body.style.overflowX=""}),{isCollapsed,isMobileOverlayOpen,isTransitioning,screenWidth,isMobile,isTablet,isDesktop,currentSidebarWidth,collapsedWidth,shouldAutoCollapse,sidebarConfig,toggleSidebar,closeMobileSidebar,expandSidebar,collapseSidebar,handleRouteChange,updateScreenWidth,initializeSidebar}}function useGlobalWebSocket(){const route=useRoute(),webSocketStore=useWebSocketStore(),authStore=useAuthStore(),shouldConnectWebSocket=()=>!(!authStore.isAdmin||!route.path.startsWith("/admin")),initWebSocketIfNeeded=()=>{shouldConnectWebSocket()&&webSocketStore.initWebSocket()};return onMounted(()=>{initWebSocketIfNeeded()}),onUnmounted(()=>{}),{webSocketStore,shouldConnectWebSocket,initWebSocketIfNeeded}}const _hoisted_1$1={class:"sidebar-header"},_hoisted_2$1={class:"sidebar-menu"},_hoisted_3$1={key:0,class:"menu-wrapper"},_hoisted_4={key:1,class:"menu-wrapper"},_hoisted_5={class:"menu-label"},_hoisted_6={key:0,class:"sidebar-footer"},_hoisted_7={class:"footer-actions"},_hoisted_8={key:2,class:"theme-toggle-wrapper"},_sfc_main$1=defineComponent({__name:"AdminSidebar",props:{menuItems:{},isCollapsed:{type:Boolean},isMobile:{type:Boolean},isMobileOpen:{type:Boolean},siteName:{}},emits:["toggle-sidebar","close-mobile","route-change"],setup(__props,{emit:__emit}){const{$t}=useTexts(),emit=__emit,route=useRoute();return(_ctx,_cache)=>{const _component_router_link=resolveComponent("router-link"),_component_CyberTooltip=resolveComponent("CyberTooltip");return openBlock(),createElementBlock("aside",{class:normalizeClass(["admin-sidebar",{collapsed:__props.isCollapsed,"mobile-open":__props.isMobile&&__props.isMobileOpen}])},[createBaseVNode("div",_hoisted_1$1,[createVNode(BrandLogo,{size:"sm",collapsed:__props.isCollapsed&&!__props.isMobile},null,8,["collapsed"]),__props.isMobile?(openBlock(),createElementBlock("button",{key:0,class:"mobile-close-btn",onClick:_cache[0]||(_cache[0]=$event=>emit("close-mobile"))},[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("nav",_hoisted_2$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.menuItems,(item,index)=>(openBlock(),createElementBlock(Fragment,{key:index},[__props.isCollapsed&&!__props.isMobile?(openBlock(),createElementBlock("div",_hoisted_3$1,[createVNode(_component_CyberTooltip,{content:item.label,placement:"right",offset:20},{default:withCtx(()=>[createVNode(_component_router_link,{to:item.path,class:normalizeClass(["menu-item",{active:unref(route).path.includes(item.path)}]),onClick:_cache[1]||(_cache[1]=$event=>emit("route-change"))},{default:withCtx(()=>[createBaseVNode("i",{class:normalizeClass(["menu-icon fas",item.icon])},null,2)]),_:2},1032,["to","class"])]),_:2},1032,["content"])])):(openBlock(),createElementBlock("div",_hoisted_4,[createVNode(_component_router_link,{to:item.path,class:normalizeClass(["menu-item",{active:unref(route).path.includes(item.path)}]),onClick:_cache[2]||(_cache[2]=$event=>emit("route-change"))},{default:withCtx(()=>[createBaseVNode("i",{class:normalizeClass(["menu-icon fas",item.icon])},null,2),createBaseVNode("span",_hoisted_5,toDisplayString(item.label),1)]),_:2},1032,["to","class"])]))],64))),128))]),__props.isMobile?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_6,[createBaseVNode("div",_hoisted_7,[__props.isCollapsed?(openBlock(),createBlock(_component_CyberTooltip,{key:0,content:unref($t)("layouts.sidebar.expandMenu"),placement:"right",offset:20},{default:withCtx(()=>[createBaseVNode("button",{class:"footer-icon-btn",onClick:_cache[3]||(_cache[3]=$event=>emit("toggle-sidebar"))},[..._cache[9]||(_cache[9]=[createBaseVNode("i",{class:"fas fa-angles-right"},null,-1)])])]),_:1},8,["content"])):createCommentVNode("",!0),__props.isCollapsed?createCommentVNode("",!0):(openBlock(),createBlock(_component_CyberTooltip,{key:1,content:unref($t)("layouts.sidebar.collapseMenu"),placement:"top",offset:8},{default:withCtx(()=>[createBaseVNode("button",{class:"footer-icon-btn",onClick:_cache[4]||(_cache[4]=$event=>emit("toggle-sidebar"))},[..._cache[10]||(_cache[10]=[createBaseVNode("i",{class:"fas fa-angles-left"},null,-1)])])]),_:1},8,["content"])),__props.isCollapsed?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_8,[createVNode(ThemeToggle,{size:"small",placement:"top",align:"left"})])),__props.isCollapsed?createCommentVNode("",!0):(openBlock(),createBlock(_component_CyberTooltip,{key:3,content:unref($t)("layouts.sidebar.aiConfig"),placement:"top",offset:8},{default:withCtx(()=>[createBaseVNode("button",{class:"footer-icon-btn",onClick:_cache[5]||(_cache[5]=$event=>_ctx.$router.push("/admin/ai"))},[..._cache[11]||(_cache[11]=[createBaseVNode("i",{class:"fas fa-robot"},null,-1)])])]),_:1},8,["content"])),__props.isCollapsed?createCommentVNode("",!0):(openBlock(),createBlock(_component_CyberTooltip,{key:4,content:unref($t)("layouts.sidebar.websiteConfig"),placement:"top",offset:8},{default:withCtx(()=>[createBaseVNode("button",{class:"footer-icon-btn",onClick:_cache[6]||(_cache[6]=$event=>_ctx.$router.push("/admin/construction?tab=website"))},[..._cache[12]||(_cache[12]=[createBaseVNode("i",{class:"fas fa-globe"},null,-1)])])]),_:1},8,["content"])),__props.isCollapsed?createCommentVNode("",!0):(openBlock(),createBlock(_component_CyberTooltip,{key:5,content:unref($t)("layouts.sidebar.globalSettings"),placement:"top",offset:8},{default:withCtx(()=>[createBaseVNode("button",{class:"footer-icon-btn",onClick:_cache[7]||(_cache[7]=$event=>_ctx.$router.push("/admin/settings"))},[..._cache[13]||(_cache[13]=[createBaseVNode("i",{class:"fas fa-cog"},null,-1)])])]),_:1},8,["content"]))])]))],2)}}});const AdminSidebar=_export_sfc(_sfc_main$1,[["__scopeId","data-v-c4edcaef"]]),_hoisted_1={class:"admin-container"},_hoisted_2={key:0,class:"mobile-header"},_hoisted_3={class:"mobile-title"},_sfc_main=defineComponent({__name:"AdminLayout",setup(__props){const{$t}=useTexts(),ADMIN_MENU_ITEMS=computed(()=>getAdminMenuItems($t)),route=useRoute(),authStore=useAuthStore(),settingsStore=useSettingsStore();computed(()=>authStore.userInfo);const{isCollapsed,isMobileOverlayOpen,isTransitioning,isMobile,isTablet,isDesktop,_currentSidebarWidth,toggleSidebar,closeMobileSidebar,handleRouteChange}=useResponsiveSidebar(),{initWebSocketIfNeeded}=useGlobalWebSocket();onMounted(async()=>{settingsStore.isLoaded||await settingsStore.loadGlobalSettings(),initWebSocketIfNeeded()});const pageTitle=computed(()=>{const{path}=route;return path.includes("/admin/dashboard")?$t("admin.dashboard.title"):path.includes("/admin/users")?$t("admin.users.title"):path.includes("/admin/channels")?$t("admin.channels.title"):path.includes("/admin/categories")?$t("admin.categories.title"):path.includes("/admin/announcements")?$t("admin.announcements.title"):path.includes("/admin/settings")?$t("admin.settings.title"):$t("admin.common.adminCenter")}),menuItems=computed(()=>{let items=[...ADMIN_MENU_ITEMS.value];return settingsStore.isAIEnabled||(items=items.filter(item=>item.path!=="/admin/tagging")),settingsStore.isVectorEnabled||(items=items.filter(item=>item.path!=="/admin/vectors")),items});return(_ctx,_cache)=>{const _component_router_view=resolveComponent("router-view");return openBlock(),createElementBlock("div",{class:normalizeClass(["admin-layout",{"is-transitioning":unref(isTransitioning),mobile:unref(isMobile),tablet:unref(isTablet),desktop:unref(isDesktop)}])},[unref(isMobile)&&unref(isMobileOverlayOpen)?(openBlock(),createElementBlock("div",{key:0,class:"mobile-overlay",onClick:_cache[0]||(_cache[0]=(...args)=>unref(closeMobileSidebar)&&unref(closeMobileSidebar)(...args))})):createCommentVNode("",!0),createBaseVNode("div",_hoisted_1,[createVNode(AdminSidebar,{"menu-items":menuItems.value,"is-collapsed":unref(isCollapsed),"is-mobile":unref(isMobile),"is-mobile-open":unref(isMobileOverlayOpen),"site-name":unref(settingsStore).siteName,onToggleSidebar:unref(toggleSidebar),onCloseMobile:unref(closeMobileSidebar),onRouteChange:unref(handleRouteChange)},null,8,["menu-items","is-collapsed","is-mobile","is-mobile-open","site-name","onToggleSidebar","onCloseMobile","onRouteChange"]),createBaseVNode("div",{class:normalizeClass(["admin-content",{"sidebar-collapsed":unref(isCollapsed),"mobile-mode":unref(isMobile),"tablet-mode":unref(isTablet)}])},[unref(isMobile)?(openBlock(),createElementBlock("div",_hoisted_2,[createBaseVNode("button",{class:"mobile-menu-btn",onClick:_cache[1]||(_cache[1]=(...args)=>unref(toggleSidebar)&&unref(toggleSidebar)(...args))},[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-bars"},null,-1)])]),createBaseVNode("h1",_hoisted_3,toDisplayString(pageTitle.value),1)])):createCommentVNode("",!0),(openBlock(),createElementBlock("div",{key:unref(route).path,class:"content-body"},[createVNode(_component_router_view)]))],2)])],2)}}});const AdminLayout=_export_sfc(_sfc_main,[["__scopeId","data-v-d57b7ed3"]]);export{AdminLayout as default};
