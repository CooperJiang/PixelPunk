import{d as defineComponent,r as ref,c as computed,w as watch,b as onMounted,I as createElementBlock,a0 as createBaseVNode,a1 as toDisplayString,u as unref,ab as createTextVNode,K as createCommentVNode,F as Fragment,M as renderList,a4 as useRoute,a3 as useRouter,z as openBlock,R as normalizeClass}from"./vue-vendor-31320f47.js";import{b as getAuthorFolder}from"./index-8471eeda.js";import{j as useTexts,_ as _export_sfc}from"./index-4d0dab4c.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const _hoisted_1={class:"author-folder-page-standalone"},_hoisted_2={class:"standalone-header"},_hoisted_3={class:"header-left"},_hoisted_4={class:"page-title"},_hoisted_5={class:"header-right"},_hoisted_6={class:"author-folder-page"},_hoisted_7={key:0,class:"breadcrumb"},_hoisted_8={class:"current-folder"},_hoisted_9={key:1,class:"folder-header"},_hoisted_10={class:"folder-info"},_hoisted_11={class:"folder-title"},_hoisted_12={class:"folder-stats"},_hoisted_13={class:"stat-item"},_hoisted_14={key:0,class:"stat-item"},_hoisted_15={key:2,class:"subfolders-section"},_hoisted_16={class:"section-title"},_hoisted_17={class:"folders-grid"},_hoisted_18=["onClick"],_hoisted_19={class:"folder-cover"},_hoisted_20=["src","alt"],_hoisted_21={key:1,class:"empty-cover"},_hoisted_22={class:"folder-info"},_hoisted_23={class:"folder-name"},_hoisted_24={key:3,class:"images-section"},_hoisted_25={class:"section-title"},_hoisted_26={class:"images-grid"},_hoisted_27=["onClick"],_hoisted_28={class:"image-wrapper"},_hoisted_29=["src","alt"],_hoisted_30={class:"image-overlay"},_hoisted_31={class:"image-info"},_hoisted_32={class:"image-name"},_hoisted_33={class:"image-size"},_hoisted_34={class:"image-dimensions"},_hoisted_35={key:4,class:"pagination-section"},_hoisted_36={class:"pagination"},_hoisted_37=["disabled"],_hoisted_38=["disabled"],_hoisted_39={class:"page-numbers"},_hoisted_40=["onClick"],_hoisted_41=["disabled"],_hoisted_42=["disabled"],_hoisted_43={class:"pagination-info"},_hoisted_44={key:5,class:"empty-state"},_hoisted_45={class:"empty-content"},_hoisted_46={key:6,class:"loading-container"},_hoisted_47={class:"loading-spinner"},_hoisted_48={key:7,class:"error-container"},_hoisted_49={class:"error-content"},_sfc_main=defineComponent({__name:"folder",setup(__props){const route=useRoute(),router=useRouter(),{$t}=useTexts(),folderData=ref(null),loading=ref(!1),error=ref(""),currentPage=ref(1),pageSize=ref(20),authorId=route.params.authorId,folderId=route.params.folderId,visiblePages=computed(()=>{if(!folderData.value)return[];const totalPages=folderData.value.pagination.lastPage,current=currentPage.value,delta=2;let start=Math.max(1,current-delta),end=Math.min(totalPages,current+delta);current-start<delta&&(end=Math.min(totalPages,end+(delta-(current-start)))),end-current<delta&&(start=Math.max(1,start-(delta-(end-current))));const pages=[];for(let i=start;i<=end;i++)pages.push(i);return pages}),loadFolderData=async()=>{if(!authorId||!folderId){error.value="Invalid parameters";return}loading.value=!0,error.value="";try{const data=await getAuthorFolder(authorId,folderId,{page:currentPage.value,size:pageSize.value});folderData.value=data}catch(err){error.value=err.message||"Failed to load folder content"}finally{loading.value=!1}},goToPage=page=>{page<1||folderData.value&&page>folderData.value.pagination.lastPage||(currentPage.value=page)},openSubfolder=subfolder=>{router.push(`/author/${authorId}/folder/${subfolder.id}`)},openImage=image=>{window.open(image.fullPath,"_blank")},formatFileSize=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(1))} ${sizes[i]}`},goBack=()=>{window.history.length>1?window.history.back():closeWindow()},closeWindow=()=>{try{window.close(),setTimeout(()=>{window.closed||(window.history.length>1?window.history.back():window.location.href="/")},100)}catch{window.history.length>1?window.history.back():window.location.href="/"}},goToAuthorPage=()=>{window.open(`/author/${authorId}`,"_blank")};return watch(currentPage,()=>{loadFolderData()}),onMounted(()=>{loadFolderData()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("button",{class:"back-btn",onClick:goBack},[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-arrow-left"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("author.folder.back")),1)]),createBaseVNode("div",_hoisted_4,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-folder"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("author.folder.title")),1)])]),createBaseVNode("div",_hoisted_5,[createBaseVNode("button",{class:"close-btn",onClick:closeWindow},[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-times"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("author.folder.close")),1)])])]),createBaseVNode("div",_hoisted_6,[folderData.value?(openBlock(),createElementBlock("div",_hoisted_7,[createBaseVNode("a",{class:"breadcrumb-link",onClick:goToAuthorPage},[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-user"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("author.folder.authorHome")),1)]),_cache[8]||(_cache[8]=createBaseVNode("span",{class:"breadcrumb-separator"},"/",-1)),createBaseVNode("span",_hoisted_8,toDisplayString(folderData.value.folder.name),1)])):createCommentVNode("",!0),folderData.value?(openBlock(),createElementBlock("div",_hoisted_9,[createBaseVNode("div",_hoisted_10,[createBaseVNode("h1",_hoisted_11,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-folder"},null,-1)),createTextVNode(" "+toDisplayString(folderData.value.folder.name),1)]),createBaseVNode("div",_hoisted_12,[createBaseVNode("span",_hoisted_13,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-images"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("author.folder.resourceCount",{count:folderData.value.folder.imageCount})),1)]),folderData.value.subFolders.length>0?(openBlock(),createElementBlock("span",_hoisted_14,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-folder"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("author.folder.subFolderCount",{count:folderData.value.subFolders.length})),1)])):createCommentVNode("",!0)])])])):createCommentVNode("",!0),folderData.value&&folderData.value.subFolders.length>0?(openBlock(),createElementBlock("div",_hoisted_15,[createBaseVNode("h2",_hoisted_16,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-folder"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("author.folder.subFolders")),1)]),createBaseVNode("div",_hoisted_17,[(openBlock(!0),createElementBlock(Fragment,null,renderList(folderData.value.subFolders,subfolder=>(openBlock(),createElementBlock("div",{key:subfolder.id,class:"folder-card",onClick:$event=>openSubfolder(subfolder)},[createBaseVNode("div",_hoisted_19,[subfolder.coverImageFullPath?(openBlock(),createElementBlock("img",{key:0,src:subfolder.coverImageFullPath,alt:subfolder.name,class:"cover-img"},null,8,_hoisted_20)):(openBlock(),createElementBlock("div",_hoisted_21,[..._cache[13]||(_cache[13]=[createBaseVNode("i",{class:"fas fa-folder"},null,-1)])]))]),createBaseVNode("div",_hoisted_22,[createBaseVNode("h3",_hoisted_23,toDisplayString(subfolder.name),1)])],8,_hoisted_18))),128))])])):createCommentVNode("",!0),folderData.value&&folderData.value.images.length>0?(openBlock(),createElementBlock("div",_hoisted_24,[createBaseVNode("h2",_hoisted_25,[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-images"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("author.folder.files")),1)]),createBaseVNode("div",_hoisted_26,[(openBlock(!0),createElementBlock(Fragment,null,renderList(folderData.value.images,image=>(openBlock(),createElementBlock("div",{key:image.id,class:"image-card",onClick:$event=>openImage(image)},[createBaseVNode("div",_hoisted_28,[createBaseVNode("img",{src:image.fullPath,alt:image.originalName,class:"image-thumbnail",loading:"lazy"},null,8,_hoisted_29),createBaseVNode("div",_hoisted_30,[createBaseVNode("div",_hoisted_31,[createBaseVNode("span",_hoisted_32,toDisplayString(image.originalName),1),createBaseVNode("span",_hoisted_33,toDisplayString(formatFileSize(image.size)),1),createBaseVNode("span",_hoisted_34,toDisplayString(image.width)+" Ã— "+toDisplayString(image.height),1)])])])],8,_hoisted_27))),128))])])):createCommentVNode("",!0),folderData.value&&folderData.value.pagination.total>folderData.value.pagination.perPage?(openBlock(),createElementBlock("div",_hoisted_35,[createBaseVNode("div",_hoisted_36,[createBaseVNode("button",{disabled:currentPage.value===1,class:"page-btn",onClick:_cache[0]||(_cache[0]=$event=>goToPage(1))},toDisplayString(unref($t)("author.folder.pagination.first")),9,_hoisted_37),createBaseVNode("button",{disabled:currentPage.value===1,class:"page-btn",onClick:_cache[1]||(_cache[1]=$event=>goToPage(currentPage.value-1))},toDisplayString(unref($t)("author.folder.pagination.prev")),9,_hoisted_38),createBaseVNode("div",_hoisted_39,[(openBlock(!0),createElementBlock(Fragment,null,renderList(visiblePages.value,page=>(openBlock(),createElementBlock("button",{key:page,class:normalizeClass(["page-btn",[{active:page===currentPage.value}]]),onClick:$event=>goToPage(page)},toDisplayString(page),11,_hoisted_40))),128))]),createBaseVNode("button",{disabled:currentPage.value===folderData.value.pagination.lastPage,class:"page-btn",onClick:_cache[2]||(_cache[2]=$event=>goToPage(currentPage.value+1))},toDisplayString(unref($t)("author.folder.pagination.next")),9,_hoisted_41),createBaseVNode("button",{disabled:currentPage.value===folderData.value.pagination.lastPage,class:"page-btn",onClick:_cache[3]||(_cache[3]=$event=>goToPage(folderData.value.pagination.lastPage))},toDisplayString(unref($t)("author.folder.pagination.last")),9,_hoisted_42)]),createBaseVNode("div",_hoisted_43,toDisplayString(unref($t)("author.folder.pagination.info",{total:folderData.value.pagination.total,current:currentPage.value,last:folderData.value.pagination.lastPage})),1)])):createCommentVNode("",!0),folderData.value&&folderData.value.images.length===0&&folderData.value.subFolders.length===0?(openBlock(),createElementBlock("div",_hoisted_44,[createBaseVNode("div",_hoisted_45,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-folder-open"},null,-1)),createBaseVNode("h3",null,toDisplayString(unref($t)("author.folder.empty.title")),1),createBaseVNode("p",null,toDisplayString(unref($t)("author.folder.empty.description")),1)])])):createCommentVNode("",!0),loading.value?(openBlock(),createElementBlock("div",_hoisted_46,[createBaseVNode("div",_hoisted_47,[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-spinner fa-spin"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("author.folder.loading")),1)])])):createCommentVNode("",!0),error.value&&!loading.value?(openBlock(),createElementBlock("div",_hoisted_48,[createBaseVNode("div",_hoisted_49,[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-exclamation-triangle"},null,-1)),createBaseVNode("h3",null,toDisplayString(unref($t)("author.folder.error.title")),1),createBaseVNode("p",null,toDisplayString(error.value),1),createBaseVNode("button",{class:"retry-btn",onClick:loadFolderData},toDisplayString(unref($t)("author.folder.error.retry")),1)])])):createCommentVNode("",!0)])]))}});const folder=_export_sfc(_sfc_main,[["__scopeId","data-v-e0150cd5"]]);export{folder as default};
