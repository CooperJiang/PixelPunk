import{j as useTexts,_ as _export_sfc,J as getCurrentLocale,r as downloadFileQuick,q as useToast,az as getRandomRecommendedFile}from"./index-4d0dab4c.js";import{d as defineComponent,c as computed,I as createElementBlock,a0 as createBaseVNode,R as normalizeClass,a1 as toDisplayString,ab as createTextVNode,z as openBlock,r as ref,Q as normalizeStyle,a5 as withModifiers,u as unref,K as createCommentVNode,w as watch,b as onMounted,o as onUnmounted,A as createBlock,f as createVNode,L as withCtx,a6 as Transition,T as Teleport,n as nextTick,E as resolveComponent,F as Fragment,M as renderList,G as resolveDirective,H as withDirectives}from"./vue-vendor-31320f47.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const _hoisted_1$b={class:"fullscreen-center"},_hoisted_2$9={class:"empty-state-container"},_hoisted_3$8={class:"empty-content"},_hoisted_4$6={class:"empty-icon"},_hoisted_5$6={class:"empty-title"},_hoisted_6$5={class:"empty-description"},_hoisted_7$5={class:"empty-actions"},_hoisted_8$4={class:"empty-decorations"},_sfc_main$c=defineComponent({__name:"ErrorState",props:{error:{}},emits:["retry"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t}=useTexts(),isNoContentError=computed(()=>props.error.includes($t("random.errorState.keywords.noFiles1"))||props.error.includes($t("random.errorState.keywords.noFiles2"))||props.error.includes($t("random.errorState.keywords.explore"))||props.error.includes($t("random.errorState.keywords.noRecommend1"))||props.error.includes($t("random.errorState.keywords.noRecommend2"))),iconClass=computed(()=>isNoContentError.value?"fas fa-images":"fas fa-exclamation-triangle"),displayTitle=computed(()=>isNoContentError.value?$t("random.errorState.noContentTitle"):$t("random.errorState.fetchFailedTitle")),displayMessage=computed(()=>isNoContentError.value?$t("random.errorState.noContentMessage"):$t("random.errorState.fetchFailedMessage")),buttonText=computed(()=>isNoContentError.value?$t("random.errorState.refreshButton"):$t("random.errorState.retryButton")),buttonIconClass=computed(()=>isNoContentError.value?"fas fa-sync-alt":"fas fa-redo"),handleRetry=()=>{emit("retry")};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$b,[createBaseVNode("div",_hoisted_2$9,[createBaseVNode("div",_hoisted_3$8,[createBaseVNode("div",_hoisted_4$6,[createBaseVNode("i",{class:normalizeClass(iconClass.value)},null,2)]),createBaseVNode("h3",_hoisted_5$6,toDisplayString(displayTitle.value),1),createBaseVNode("p",_hoisted_6$5,toDisplayString(displayMessage.value),1),createBaseVNode("div",_hoisted_7$5,[createBaseVNode("button",{class:"retry-btn",onClick:handleRetry},[createBaseVNode("i",{class:normalizeClass(buttonIconClass.value+" mr-2")},null,2),createTextVNode(" "+toDisplayString(buttonText.value),1)])]),createBaseVNode("div",_hoisted_8$4,[createBaseVNode("div",{class:normalizeClass(["decoration-circle circle-1",{"error-theme":!isNoContentError.value}])},null,2),createBaseVNode("div",{class:normalizeClass(["decoration-circle circle-2",{"error-theme":!isNoContentError.value}])},null,2),createBaseVNode("div",{class:normalizeClass(["decoration-circle circle-3",{"error-theme":!isNoContentError.value}])},null,2)])])])]))}});const ErrorState=_export_sfc(_sfc_main$c,[["__scopeId","data-v-2fdf52a0"]]),createEventHandlers=options=>{const{scale,translateX,translateY,isDragging,dragStartX,dragStartY,dragStartTranslateX,dragStartTranslateY,lastTouchDistance,initialTouchScale,showZoomIndicatorTemporary,resetTransform}=options;return{handleWheel:e=>{e.preventDefault();const delta=e.deltaY>0?-.1:.1,newScale=Math.max(.1,Math.min(5,scale.value+delta));newScale!==scale.value&&(scale.value=newScale,showZoomIndicatorTemporary())},handleMouseDown:e=>{e.button===0&&(isDragging.value=!0,dragStartX.value=e.clientX,dragStartY.value=e.clientY,dragStartTranslateX.value=translateX.value,dragStartTranslateY.value=translateY.value,document.body.style.cursor="grabbing",e.preventDefault())},handleMouseMove:e=>{if(!isDragging.value)return;const deltaX=e.clientX-dragStartX.value,deltaY=e.clientY-dragStartY.value;translateX.value=dragStartTranslateX.value+deltaX,translateY.value=dragStartTranslateY.value+deltaY},handleMouseUp:()=>{isDragging.value&&(isDragging.value=!1,document.body.style.cursor="")},handleTouchStart:e=>{if(e.touches.length===1){const touch=e.touches[0];dragStartX.value=touch.clientX,dragStartY.value=touch.clientY,dragStartTranslateX.value=translateX.value,dragStartTranslateY.value=translateY.value,isDragging.value=!0}else if(e.touches.length===2){const touch1=e.touches[0],touch2=e.touches[1],distance=Math.sqrt(Math.pow(touch2.clientX-touch1.clientX,2)+Math.pow(touch2.clientY-touch1.clientY,2));lastTouchDistance.value=distance,initialTouchScale.value=scale.value,isDragging.value=!1}},handleTouchMove:e=>{if(e.preventDefault(),e.touches.length===1&&isDragging.value){const touch=e.touches[0],deltaX=touch.clientX-dragStartX.value,deltaY=touch.clientY-dragStartY.value;translateX.value=dragStartTranslateX.value+deltaX,translateY.value=dragStartTranslateY.value+deltaY}else if(e.touches.length===2){const touch1=e.touches[0],touch2=e.touches[1],distance=Math.sqrt(Math.pow(touch2.clientX-touch1.clientX,2)+Math.pow(touch2.clientY-touch1.clientY,2));if(lastTouchDistance.value>0){const scaleChange=distance/lastTouchDistance.value,newScale=Math.max(.1,Math.min(5,initialTouchScale.value*scaleChange));newScale!==scale.value&&(scale.value=newScale,showZoomIndicatorTemporary())}}},handleTouchEnd:()=>{isDragging.value=!1,lastTouchDistance.value=0},handleImageClick:()=>{resetTransform()}}},_hoisted_1$a=["src","alt"],_sfc_main$b=defineComponent({name:"FileContainer",__name:"FileContainer",props:{fileUrl:{},fileName:{},fileType:{},shouldUseFillMode:{type:Boolean},fileStyle:{}},emits:["wheel","mousedown","mousemove","mouseup","mouseleave","touchstart","touchmove","touchend","fileClick","fileLoad","fileError"],setup(__props,{expose:__expose}){const imageRef=ref();return __expose({imageRef}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"enhanced-image-container",onWheel:_cache[3]||(_cache[3]=withModifiers($event=>_ctx.$emit("wheel",$event),["prevent"])),onMousedown:_cache[4]||(_cache[4]=$event=>_ctx.$emit("mousedown",$event)),onMousemove:_cache[5]||(_cache[5]=$event=>_ctx.$emit("mousemove",$event)),onMouseup:_cache[6]||(_cache[6]=$event=>_ctx.$emit("mouseup",$event)),onMouseleave:_cache[7]||(_cache[7]=$event=>_ctx.$emit("mouseleave",$event)),onTouchstart:_cache[8]||(_cache[8]=$event=>_ctx.$emit("touchstart",$event)),onTouchmove:_cache[9]||(_cache[9]=$event=>_ctx.$emit("touchmove",$event)),onTouchend:_cache[10]||(_cache[10]=$event=>_ctx.$emit("touchend",$event))},[createBaseVNode("img",{ref_key:"imageRef",ref:imageRef,src:__props.fileUrl,alt:__props.fileName,class:normalizeClass(["enhanced-fullscreen-image",{"fill-mode":__props.shouldUseFillMode}]),style:normalizeStyle(__props.fileStyle),draggable:"false",onClick:_cache[0]||(_cache[0]=withModifiers($event=>_ctx.$emit("fileClick",$event),["stop"])),onLoad:_cache[1]||(_cache[1]=$event=>_ctx.$emit("fileLoad",$event)),onError:_cache[2]||(_cache[2]=$event=>_ctx.$emit("fileError",$event))},null,46,_hoisted_1$a)],32))}});const FileContainer=_export_sfc(_sfc_main$b,[["__scopeId","data-v-7207c21d"]]),_hoisted_1$9={class:"control-buttons"},_hoisted_2$8=["title"],_hoisted_3$7=["title"],_sfc_main$a=defineComponent({name:"ControlButtons",__name:"ControlButtons",props:{isBrowserFullscreen:{type:Boolean}},emits:["close","exitFullscreen"],setup(__props){const{$t}=useTexts();return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$9,[createBaseVNode("button",{class:"enhanced-close-button",title:unref($t)("components.enhancedFilePreview.exitPreviewEsc"),onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("close"))},[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])],8,_hoisted_2$8),__props.isBrowserFullscreen?(openBlock(),createElementBlock("button",{key:0,class:"enhanced-fullscreen-exit-button",title:unref($t)("components.enhancedFilePreview.exitFullscreenEsc"),onClick:_cache[1]||(_cache[1]=$event=>_ctx.$emit("exitFullscreen"))},[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fas fa-compress"},null,-1)])],8,_hoisted_3$7)):createCommentVNode("",!0)]))}});const ControlButtons=_export_sfc(_sfc_main$a,[["__scopeId","data-v-2866e8f0"]]),_hoisted_1$8={class:"hint-item"},_hoisted_2$7={key:0,class:"hint-item"},_hoisted_3$6={class:"hint-item"},_hoisted_4$5={class:"hint-item"},_hoisted_5$5={class:"hint-item"},_sfc_main$9=defineComponent({name:"ControlsHint",__name:"ControlsHint",props:{showControlsHint:{type:Boolean},isBrowserFullscreen:{type:Boolean},shouldUseFillMode:{type:Boolean}},setup(__props){const{$t}=useTexts();return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["enhanced-controls-hint",{"auto-hide":!__props.showControlsHint}])},[createBaseVNode("div",_hoisted_1$8,[_cache[0]||(_cache[0]=createBaseVNode("kbd",null,"ESC",-1)),createTextVNode(" "+toDisplayString(unref($t)(`components.enhancedFilePreview.${__props.isBrowserFullscreen?"exitFullscreen":"exitPreview"}`)),1)]),__props.isBrowserFullscreen?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_2$7,[_cache[1]||(_cache[1]=createBaseVNode("kbd",null,"F",-1)),createTextVNode(" "+toDisplayString(unref($t)("components.enhancedFilePreview.enterFullscreen")),1)])),createBaseVNode("div",_hoisted_3$6,[createBaseVNode("kbd",null,toDisplayString(unref($t)("components.enhancedFilePreview.spaceKey")),1),createTextVNode(" "+toDisplayString(__props.shouldUseFillMode?unref($t)("components.enhancedFilePreview.switchToFit"):unref($t)("components.enhancedFilePreview.switchToFill"))+toDisplayString(unref($t)("components.enhancedFilePreview.mode")),1)]),createBaseVNode("div",_hoisted_4$5,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-mouse"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("components.enhancedFilePreview.wheelZoom")),1)]),createBaseVNode("div",_hoisted_5$5,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-hand-rock"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("components.enhancedFilePreview.dragMove")),1)])],2))}});const ControlsHint=_export_sfc(_sfc_main$9,[["__scopeId","data-v-59f3e0d7"]]),_hoisted_1$7={class:"indicators"},_hoisted_2$6={key:0,class:"enhanced-zoom-indicator"},_hoisted_3$5={key:1,class:"enhanced-mode-indicator"},_sfc_main$8=defineComponent({name:"Indicators",__name:"Indicators",props:{showZoomIndicator:{type:Boolean},showModeIndicator:{type:Boolean},scale:{},shouldUseFillMode:{type:Boolean}},setup(__props){const{$t}=useTexts();return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$7,[__props.showZoomIndicator?(openBlock(),createElementBlock("div",_hoisted_2$6,toDisplayString(Math.round(__props.scale*100))+"%",1)):createCommentVNode("",!0),__props.showModeIndicator?(openBlock(),createElementBlock("div",_hoisted_3$5,toDisplayString(__props.shouldUseFillMode?unref($t)("components.enhancedFilePreview.fillMode"):unref($t)("components.enhancedFilePreview.fitMode")),1)):createCommentVNode("",!0)]))}});const Indicators=_export_sfc(_sfc_main$8,[["__scopeId","data-v-41d640ba"]]),_sfc_main$7=defineComponent({name:"CyberEnhancedFilePreview",__name:"index",props:{visible:{type:Boolean},fileUrl:{},fileName:{},fileType:{},fileWidth:{default:0},fileHeight:{default:0}},emits:["update:visible","close"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t}=useTexts(),overlayRef=ref(),containerRef=ref(),imageRef=computed(()=>containerRef.value?.imageRef),scale=ref(1),translateX=ref(0),translateY=ref(0),showZoomIndicator=ref(!1),showModeIndicator=ref(!1),showControlsHint=ref(!0),isImageLoaded=ref(!1),isFillMode=ref(!0),isBrowserFullscreen=ref(!1),isHorizontalImage=ref(!0),isDragging=ref(!1),dragStartX=ref(0),dragStartY=ref(0),dragStartTranslateX=ref(0),dragStartTranslateY=ref(0),lastTouchDistance=ref(0),initialTouchScale=ref(1);let zoomIndicatorTimer=null,modeIndicatorTimer=null,controlsHintTimer=null;const shouldUseFillMode=computed(()=>isFillMode.value),imageStyle=computed(()=>{const baseTransform=`translate(${translateX.value}px, ${translateY.value}px) scale(${scale.value})`;return shouldUseFillMode.value&&scale.value===1?{transform:baseTransform,transformOrigin:"center center",transition:isDragging.value?"none":"transform 0.2s ease-out",width:"100vw",height:"100vh",objectFit:"cover"}:!shouldUseFillMode.value&&!isHorizontalImage.value&&scale.value===1?{transform:baseTransform,transformOrigin:"center center",transition:isDragging.value?"none":"transform 0.2s ease-out",width:"auto",height:"100vh",objectFit:"contain",maxWidth:"100vw",maxHeight:"100vh"}:{transform:baseTransform,transformOrigin:"center center",transition:isDragging.value?"none":"transform 0.2s ease-out",width:"auto",height:"auto",objectFit:"contain",maxWidth:"none",maxHeight:"none"}}),showZoomIndicatorTemporary=()=>{showZoomIndicator.value=!0,zoomIndicatorTimer&&clearTimeout(zoomIndicatorTimer),zoomIndicatorTimer=window.setTimeout(()=>{showZoomIndicator.value=!1},1e3)},showModeIndicatorTemporary=()=>{showModeIndicator.value=!0,modeIndicatorTimer&&clearTimeout(modeIndicatorTimer),modeIndicatorTimer=window.setTimeout(()=>{showModeIndicator.value=!1},1500)},startControlsHintTimer=()=>{showControlsHint.value=!0,controlsHintTimer&&clearTimeout(controlsHintTimer),controlsHintTimer=window.setTimeout(()=>{showControlsHint.value=!1},5e3)},resetTransform=()=>{const img=imageRef.value,container=containerRef.value?.$el||containerRef.value;if(!img||!container)return;const containerWidth=container.clientWidth,containerHeight=container.clientHeight,imgWidth=img.naturalWidth,imgHeight=img.naturalHeight;if(!(imgWidth===0||imgHeight===0)){if(shouldUseFillMode.value||!isHorizontalImage.value)scale.value=1;else{const scaleX=containerWidth/imgWidth,scaleY=containerHeight/imgHeight;scale.value=Math.min(scaleX,scaleY)}translateX.value=0,translateY.value=0}},toggleDisplayMode=()=>{isFillMode.value=!isFillMode.value,showModeIndicatorTemporary(),resetTransform()},enterBrowserFullscreen=async()=>{try{overlayRef.value&&!isBrowserFullscreen.value&&document.fullscreenElement===null&&(await overlayRef.value.requestFullscreen(),isBrowserFullscreen.value=!0)}catch{}},exitBrowserFullscreen=async()=>{try{isBrowserFullscreen.value&&document.fullscreenElement&&(await document.exitFullscreen(),isBrowserFullscreen.value=!1)}catch{}},onImageLoad=()=>{isImageLoaded.value=!0;const img=imageRef.value;img&&(isHorizontalImage.value=img.naturalWidth>=img.naturalHeight),resetTransform(),startControlsHintTimer()},onImageError=()=>{},{handleWheel,handleMouseDown,handleMouseMove,handleMouseUp,handleTouchStart,handleTouchMove,handleTouchEnd,handleImageClick}=createEventHandlers({scale,translateX,translateY,isDragging,dragStartX,dragStartY,dragStartTranslateX,dragStartTranslateY,lastTouchDistance,initialTouchScale,showZoomIndicatorTemporary,resetTransform}),handleKeydown=e=>{switch(e.key){case"Escape":isBrowserFullscreen.value?exitBrowserFullscreen():handleClose();break;case"f":case"F":isBrowserFullscreen.value||enterBrowserFullscreen();break;case" ":e.preventDefault(),toggleDisplayMode();break}},handleOverlayClick=e=>{e.target===overlayRef.value&&handleClose()},handleClose=()=>{emit("update:visible",!1),emit("close")},handleFullscreenChange=()=>{isBrowserFullscreen.value=!!document.fullscreenElement};return watch(()=>props.visible,newVal=>{newVal?(document.body.style.overflow="hidden",nextTick(()=>{overlayRef.value?.focus()})):(document.body.style.overflow="",isBrowserFullscreen.value&&exitBrowserFullscreen(),isDragging.value=!1,document.body.style.cursor="",zoomIndicatorTimer&&(clearTimeout(zoomIndicatorTimer),zoomIndicatorTimer=null),modeIndicatorTimer&&(clearTimeout(modeIndicatorTimer),modeIndicatorTimer=null),controlsHintTimer&&(clearTimeout(controlsHintTimer),controlsHintTimer=null))}),watch(()=>props.fileUrl,()=>{isImageLoaded.value=!1,resetTransform()}),watch(isFillMode,()=>{isImageLoaded.value&&resetTransform()}),onMounted(()=>{document.addEventListener("fullscreenchange",handleFullscreenChange)}),onUnmounted(()=>{document.removeEventListener("fullscreenchange",handleFullscreenChange),document.body.style.overflow="",document.body.style.cursor="",zoomIndicatorTimer&&clearTimeout(zoomIndicatorTimer),modeIndicatorTimer&&clearTimeout(modeIndicatorTimer),controlsHintTimer&&clearTimeout(controlsHintTimer)}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"enhanced-fullscreen"},{default:withCtx(()=>[__props.visible?(openBlock(),createElementBlock("div",{key:0,ref_key:"overlayRef",ref:overlayRef,class:"enhanced-fullscreen-overlay",tabindex:"0",onClick:handleOverlayClick,onKeydown:handleKeydown},[createVNode(FileContainer,{ref_key:"containerRef",ref:containerRef,"file-url":props.fileUrl,"file-name":props.fileName||unref($t)("components.enhancedFilePreview.defaultImageName"),"should-use-fill-mode":shouldUseFillMode.value,"file-style":imageStyle.value,onWheel:unref(handleWheel),onMousedown:unref(handleMouseDown),onMousemove:unref(handleMouseMove),onMouseup:unref(handleMouseUp),onMouseleave:unref(handleMouseUp),onTouchstart:unref(handleTouchStart),onTouchmove:unref(handleTouchMove),onTouchend:unref(handleTouchEnd),onFileClick:unref(handleImageClick),onFileLoad:onImageLoad,onFileError:onImageError},null,8,["file-url","file-name","should-use-fill-mode","file-style","onWheel","onMousedown","onMousemove","onMouseup","onMouseleave","onTouchstart","onTouchmove","onTouchend","onFileClick"]),createVNode(ControlButtons,{"is-browser-fullscreen":isBrowserFullscreen.value,onClose:handleClose,onExitFullscreen:exitBrowserFullscreen},null,8,["is-browser-fullscreen"]),createVNode(ControlsHint,{"show-controls-hint":showControlsHint.value,"is-browser-fullscreen":isBrowserFullscreen.value,"should-use-fill-mode":shouldUseFillMode.value},null,8,["show-controls-hint","is-browser-fullscreen","should-use-fill-mode"]),createVNode(Indicators,{"show-zoom-indicator":showZoomIndicator.value,"show-mode-indicator":showModeIndicator.value,scale:scale.value,"should-use-fill-mode":shouldUseFillMode.value},null,8,["show-zoom-indicator","show-mode-indicator","scale","should-use-fill-mode"])],544)):createCommentVNode("",!0)]),_:1})]))}});const EnhancedFilePreview=_export_sfc(_sfc_main$7,[["__scopeId","data-v-5b5ece71"]]),_hoisted_1$6={key:0,class:"progressive-indicator"},_hoisted_2$5={class:"overlay-content"},_hoisted_3$4={class:"image-title"},_hoisted_4$4={class:"image-quick-info"},_hoisted_5$4={class:"info-badge"},_hoisted_6$4={class:"info-badge"},_hoisted_7$4={class:"info-badge"},_hoisted_8$3={class:"image-hint"},_hoisted_9$3={class:"hint-text"},_sfc_main$6=defineComponent({__name:"FileDisplay",props:{imageData:{}},emits:["image-load","image-error"],setup(__props,{emit:__emit}){const{$t}=useTexts(),props=__props,emit=__emit,currentImageUrl=ref(""),isProgressiveLoading=ref(!0),imageFitMode=computed(()=>{if(!props.imageData)return"contain";const width=props.imageData.width||0,height=props.imageData.height||0;return width/height<1?"contain":"cover"}),isPortrait=computed(()=>props.imageData?(props.imageData.width||0)<(props.imageData.height||0):!1),loadProgressiveImage=()=>{currentImageUrl.value=props.imageData.full_thumb_url||props.imageData.full_url,isProgressiveLoading.value=!0;const img=new Image;img.onload=()=>{currentImageUrl.value=props.imageData.full_url,isProgressiveLoading.value=!1,emit("image-load")},img.onerror=()=>{isProgressiveLoading.value=!1,emit("image-error")},img.src=props.imageData.full_url};watch(()=>props.imageData,()=>{props.imageData&&loadProgressiveImage()},{immediate:!0});const isOverlayVisible=ref(!1),isFullscreen=ref(!1),formatFileSize=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},handleMouseEnter=()=>{isOverlayVisible.value=!0},handleMouseLeave=()=>{isOverlayVisible.value=!1},handleOverlayEnter=()=>{isOverlayVisible.value=!0},openFullscreen=()=>{isFullscreen.value=!0},closeFullscreen=()=>{isFullscreen.value=!1},handleKeydown=event=>{event.key==="Escape"&&isFullscreen.value&&closeFullscreen()};return onMounted(()=>{document.addEventListener("keydown",handleKeydown)}),onUnmounted(()=>{document.removeEventListener("keydown",handleKeydown)}),(_ctx,_cache)=>{const _component_CyberFile=resolveComponent("CyberFile");return openBlock(),createElementBlock("div",{class:normalizeClass(["fullscreen-image-container",{"progressive-loading":isProgressiveLoading.value,"portrait-mode":isPortrait.value}]),onMouseenter:handleMouseEnter,onMouseleave:handleMouseLeave},[createVNode(_component_CyberFile,{src:currentImageUrl.value,alt:__props.imageData.display_name,class:"hero-image",width:"100%",height:"100%","fit-mode":imageFitMode.value,"retry-count":3,"is-nsfw":__props.imageData.is_nsfw,"background-pattern":"none",onClick:openFullscreen},null,8,["src","alt","fit-mode","is-nsfw"]),isProgressiveLoading.value?(openBlock(),createElementBlock("div",_hoisted_1$6,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-circle-notch fa-spin"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("random.fileDisplay.loadingHD")),1)])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["image-info-overlay",{show:isOverlayVisible.value}]),onMouseenter:handleOverlayEnter},[createBaseVNode("div",_hoisted_2$5,[createBaseVNode("h1",_hoisted_3$4,toDisplayString(__props.imageData.display_name),1),createBaseVNode("div",_hoisted_4$4,[createBaseVNode("span",_hoisted_5$4,toDisplayString(__props.imageData.width)+" × "+toDisplayString(__props.imageData.height),1),createBaseVNode("span",_hoisted_6$4,toDisplayString(formatFileSize(__props.imageData.size)),1),createBaseVNode("span",_hoisted_7$4,toDisplayString(__props.imageData.format?.toUpperCase()),1)]),createBaseVNode("div",_hoisted_8$3,[createBaseVNode("span",_hoisted_9$3,toDisplayString(unref($t)("random.fileDisplay.clickHint")),1)])])],34),createVNode(unref(EnhancedFilePreview),{visible:isFullscreen.value,"file-url":__props.imageData.full_url,"file-name":__props.imageData.display_name,"file-width":__props.imageData.width,"file-height":__props.imageData.height,"onUpdate:visible":closeFullscreen,onClose:closeFullscreen},null,8,["visible","file-url","file-name","file-width","file-height"])],34)}}});const FileDisplay=_export_sfc(_sfc_main$6,[["__scopeId","data-v-09e312f4"]]),_hoisted_1$5={class:"creator-card"},_hoisted_2$4={class:"section-title"},_hoisted_3$3={class:"creator-info"},_hoisted_4$3={class:"creator-avatar"},_hoisted_5$3=["src","alt"],_hoisted_6$3={key:1,class:"avatar-placeholder"},_hoisted_7$3={class:"creator-details"},_hoisted_8$2={class:"creator-name-row"},_hoisted_9$2={class:"creator-name"},_hoisted_10$2={class:"creator-stats"},_hoisted_11$2={class:"stat-item"},_hoisted_12$1={key:0,class:"stat-item"},_hoisted_13$1={key:1,class:"stat-item"},_hoisted_14$1={key:0,class:"creator-preferences"},_hoisted_15$1={class:"preferences-title"},_hoisted_16$1={class:"preference-tags"},_hoisted_17$1={key:1,class:"other-works"},_hoisted_18$1={class:"works-title"},_hoisted_19$1={class:"works-grid"},_hoisted_20=["onClick"],_hoisted_21={class:"work-overlay"},_hoisted_22={class:"work-size"},_sfc_main$5=defineComponent({__name:"CreatorCard",props:{imageData:{}},emits:["go-to-author","view-work"],setup(__props,{emit:__emit}){const emit=__emit,{$t}=useTexts(),workLoadingStates=ref({}),formatNumber=num=>num==null||isNaN(num)?"0":num>=1e4?`${(num/1e4).toFixed(1)}w`:num>=1e3?`${(num/1e3).toFixed(1)}k`:num.toString(),getInitials=username=>username?username.charAt(0).toUpperCase():"?",goToAuthorPage=()=>{emit("go-to-author")},viewWork=work=>{emit("view-work",work)};return(_ctx,_cache)=>{const _component_CyberTag=resolveComponent("CyberTag"),_component_CyberFile=resolveComponent("CyberFile"),_directive_loading=resolveDirective("loading");return openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("h3",_hoisted_2$4,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-user mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t)("random.creator.title")),1)]),createBaseVNode("div",_hoisted_3$3,[createBaseVNode("div",_hoisted_4$3,[__props.imageData.user_info?.avatar?(openBlock(),createElementBlock("img",{key:0,src:__props.imageData.user_info.avatar,alt:__props.imageData.user_info.username,class:"avatar-img"},null,8,_hoisted_5$3)):(openBlock(),createElementBlock("div",_hoisted_6$3,toDisplayString(getInitials(__props.imageData.user_name)),1))]),createBaseVNode("div",_hoisted_7$3,[createBaseVNode("div",_hoisted_8$2,[createBaseVNode("h4",_hoisted_9$2,toDisplayString(__props.imageData.user_name),1),createBaseVNode("button",{class:"creator-link-btn",onClick:goToAuthorPage},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-external-link-alt"},null,-1)])])]),createBaseVNode("div",_hoisted_10$2,[createBaseVNode("span",_hoisted_11$2,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-images"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("random.creator.worksCount",{count:__props.imageData.user_info?.total_images||0})),1)]),__props.imageData.user_info?.total_views?(openBlock(),createElementBlock("span",_hoisted_12$1,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-eye"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("random.creator.viewsCount",{count:formatNumber(__props.imageData.user_info.total_views)})),1)])):createCommentVNode("",!0),__props.imageData.user_info?.days_joined?(openBlock(),createElementBlock("span",_hoisted_13$1,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-calendar"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("random.creator.daysJoined",{days:__props.imageData.user_info.days_joined})),1)])):createCommentVNode("",!0)])])]),__props.imageData.user_info?.top_tags&&__props.imageData.user_info.top_tags.length?(openBlock(),createElementBlock("div",_hoisted_14$1,[createBaseVNode("h5",_hoisted_15$1,toDisplayString(unref($t)("random.creator.preferences")),1),createBaseVNode("div",_hoisted_16$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.imageData.user_info.top_tags,tag=>(openBlock(),createBlock(_component_CyberTag,{key:tag,variant:"primary",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(tag),1)]),_:2},1024))),128))])])):createCommentVNode("",!0),__props.imageData.user_info?.other_images&&__props.imageData.user_info.other_images.length?(openBlock(),createElementBlock("div",_hoisted_17$1,[createBaseVNode("h5",_hoisted_18$1,toDisplayString(unref($t)("random.creator.otherWorks")),1),createBaseVNode("div",_hoisted_19$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.imageData.user_info.other_images,work=>withDirectives((openBlock(),createElementBlock("div",{key:work.id,class:"work-item",onClick:$event=>viewWork(work)},[createVNode(_component_CyberFile,{src:work.full_thumb_url,alt:work.display_name,class:"work-image","fit-mode":"cover","retry-count":2,"is-nsfw":work.is_nsfw,"background-pattern":"none",onLoading:$event=>workLoadingStates.value[work.id]=$event},null,8,["src","alt","is-nsfw","onLoading"]),createBaseVNode("div",_hoisted_21,[createBaseVNode("span",_hoisted_22,toDisplayString(work.width)+"×"+toDisplayString(work.height),1)])],8,_hoisted_20)),[[_directive_loading,workLoadingStates.value[work.id]]])),128))])])):createCommentVNode("",!0)])}}});const CreatorCard=_export_sfc(_sfc_main$5,[["__scopeId","data-v-6a9d4c4d"]]),_hoisted_1$4={key:0,class:"ai-analysis-card"},_hoisted_2$3={class:"section-title"},_hoisted_3$2={class:"ai-content"},_hoisted_4$2={key:0,class:"ai-description"},_hoisted_5$2={key:1,class:"ai-tags"},_hoisted_6$2={class:"tags-subtitle"},_hoisted_7$2={class:"tags-container"},_sfc_main$4=defineComponent({__name:"AIAnalysisCard",props:{imageData:{}},setup(__props){const{$t}=useTexts();return(_ctx,_cache)=>{const _component_CyberTag=resolveComponent("CyberTag");return __props.imageData.ai_info?(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("h3",_hoisted_2$3,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-robot mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t)("random.aiAnalysis.title")),1)]),createBaseVNode("div",_hoisted_3$2,[__props.imageData.ai_info.description?(openBlock(),createElementBlock("div",_hoisted_4$2,[createBaseVNode("p",null,toDisplayString(__props.imageData.ai_info.description),1)])):createCommentVNode("",!0),__props.imageData.ai_info.tags&&__props.imageData.ai_info.tags.length?(openBlock(),createElementBlock("div",_hoisted_5$2,[createBaseVNode("h4",_hoisted_6$2,toDisplayString(unref($t)("random.aiAnalysis.smartTags")),1),createBaseVNode("div",_hoisted_7$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.imageData.ai_info.tags.slice(0,8),tag=>(openBlock(),createBlock(_component_CyberTag,{key:tag,variant:"primary",size:"small",title:tag},{default:withCtx(()=>[createTextVNode(toDisplayString(tag),1)]),_:2},1032,["title"]))),128))])])):createCommentVNode("",!0)])])):createCommentVNode("",!0)}}});const AIAnalysisCard=_export_sfc(_sfc_main$4,[["__scopeId","data-v-58de062b"]]),_hoisted_1$3={class:"image-details-card"},_hoisted_2$2={class:"section-title"},_hoisted_3$1={class:"details-content"},_hoisted_4$1={class:"detail-row"},_hoisted_5$1={class:"detail-label"},_hoisted_6$1={class:"detail-value"},_hoisted_7$1={class:"detail-row"},_hoisted_8$1={class:"detail-label"},_hoisted_9$1={class:"detail-value"},_hoisted_10$1={class:"detail-row"},_hoisted_11$1={class:"detail-label"},_hoisted_12={class:"detail-value"},_hoisted_13={class:"detail-row"},_hoisted_14={class:"detail-label"},_hoisted_15={class:"detail-value"},_hoisted_16={key:0,class:"detail-row"},_hoisted_17={class:"detail-label"},_hoisted_18={class:"color-display"},_hoisted_19={class:"color-code"},_sfc_main$3=defineComponent({__name:"FileDetailsCard",props:{imageData:{}},setup(__props){const{$t}=useTexts(),formatFileSize=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},formatDate=dateString=>new Date(dateString).toLocaleDateString(getCurrentLocale(),{year:"numeric",month:"long",day:"numeric"});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("h3",_hoisted_2$2,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-info-circle mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t)("random.fileDetails.title")),1)]),createBaseVNode("div",_hoisted_3$1,[createBaseVNode("div",_hoisted_4$1,[createBaseVNode("span",_hoisted_5$1,toDisplayString(unref($t)("random.fileDetails.dimensions")),1),createBaseVNode("span",_hoisted_6$1,toDisplayString(__props.imageData.width)+" × "+toDisplayString(__props.imageData.height),1)]),createBaseVNode("div",_hoisted_7$1,[createBaseVNode("span",_hoisted_8$1,toDisplayString(unref($t)("random.fileDetails.fileSize")),1),createBaseVNode("span",_hoisted_9$1,toDisplayString(formatFileSize(__props.imageData.size)),1)]),createBaseVNode("div",_hoisted_10$1,[createBaseVNode("span",_hoisted_11$1,toDisplayString(unref($t)("random.fileDetails.format")),1),createBaseVNode("span",_hoisted_12,toDisplayString(__props.imageData.format?.toUpperCase()),1)]),createBaseVNode("div",_hoisted_13,[createBaseVNode("span",_hoisted_14,toDisplayString(unref($t)("random.fileDetails.uploadTime")),1),createBaseVNode("span",_hoisted_15,toDisplayString(formatDate(__props.imageData.created_at)),1)]),__props.imageData.ai_info?.dominant_color?(openBlock(),createElementBlock("div",_hoisted_16,[createBaseVNode("span",_hoisted_17,toDisplayString(unref($t)("random.fileDetails.dominantColor")),1),createBaseVNode("div",_hoisted_18,[createBaseVNode("div",{class:"color-preview",style:normalizeStyle({backgroundColor:__props.imageData.ai_info.dominant_color})},null,4),createBaseVNode("span",_hoisted_19,toDisplayString(__props.imageData.ai_info.dominant_color),1)])])):createCommentVNode("",!0)])]))}});const FileDetailsCard=_export_sfc(_sfc_main$3,[["__scopeId","data-v-782e6538"]]),_hoisted_1$2={class:"action-section"},_sfc_main$2=defineComponent({__name:"ActionButtons",props:{imageData:{}},emits:["refresh"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,toast=useToast(),{$t}=useTexts(),handleRefresh=()=>{emit("refresh")},handleDownload=async()=>{try{const fileName=props.imageData.display_name||props.imageData.original_name||`image_${props.imageData.id}`;await downloadFileQuick(props.imageData.id,fileName),toast.success($t("random.actionButtons.downloadSuccess",{fileName}))}catch(error){console.error($t("random.actionButtons.downloadFailedLog"),error),toast.error($t("random.actionButtons.downloadFailed"))}},handleOpenInNewWindow=()=>{window.open(props.imageData.full_url,"_blank")};return(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton");return openBlock(),createElementBlock("div",_hoisted_1$2,[createVNode(_component_CyberButton,{type:"primary",icon:"download",onClick:handleDownload,size:"large"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("random.actionButtons.downloadOriginal")),1)]),_:1}),createVNode(_component_CyberButton,{type:"secondary",icon:"external-link-alt",onClick:handleOpenInNewWindow,size:"large"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("random.actionButtons.openInNewWindow")),1)]),_:1}),createVNode(_component_CyberButton,{type:"outlined",icon:"dice",onClick:handleRefresh,size:"large"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("random.actionButtons.nextOne")),1)]),_:1})])}}});const ActionButtons=_export_sfc(_sfc_main$2,[["__scopeId","data-v-aeda365b"]]),_hoisted_1$1={class:"fixed bottom-6 right-6 z-30"},_hoisted_2$1=["disabled","title"],_sfc_main$1=defineComponent({__name:"RefreshButton",props:{loading:{type:Boolean}},emits:["refresh"],setup(__props,{emit:__emit}){const emit=__emit,{$t}=useTexts(),handleRefresh=()=>{emit("refresh")};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("button",{disabled:__props.loading,class:"refresh-btn",title:unref($t)("random.refreshButton.title"),onClick:handleRefresh},[createBaseVNode("i",{class:normalizeClass(["fas fa-sync-alt",{"fa-spin":__props.loading}])},null,2)],8,_hoisted_2$1)]))}});const RefreshButton=_export_sfc(_sfc_main$1,[["__scopeId","data-v-09544a68"]]),_hoisted_1={class:"random-page-container"},_hoisted_2={class:"image-hero-section"},_hoisted_3={key:0,class:"details-section"},_hoisted_4={class:"scroll-indicator"},_hoisted_5={class:"w-full px-6 py-8"},_hoisted_6={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},_hoisted_7={class:"keyboard-hint"},_hoisted_8={class:"hint-content"},_hoisted_9={class:"hint-text"},_hoisted_10={class:"key-hints"},_hoisted_11={class:"key-hint"},_sfc_main=defineComponent({__name:"index",setup(__props){const loading=ref(!1),error=ref(""),imageData=ref(null),toast=useToast(),{$t}=useTexts(),goToAuthorPage=()=>{imageData.value?.user_info?.id&&window.open(`/author/${imageData.value.user_info.id}`,"_blank")},viewWork=work=>{window.open(work.full_url,"_blank")},fetchRandomImage=async()=>{loading.value=!0,error.value="",imageData.value=null;try{const result=await getRandomRecommendedFile();if(result.success){const newImageData=result.data;if(!newImageData){error.value=result.message||$t("random.error.noFiles"),loading.value=!1;return}imageData.value=newImageData}else error.value=result.message||$t("random.error.fetchFailed"),loading.value=!1}catch(err){err?.response?.status===404?error.value=$t("random.error.noFiles"):error.value=$t("random.error.fetchFailed"),loading.value=!1}},refreshImage=()=>{fetchRandomImage()},handleKeydown=e=>{const activeElement=document.querySelector(":focus");if(!(activeElement&&(activeElement.tagName==="INPUT"||activeElement.tagName==="TEXTAREA"||activeElement.contentEditable==="true")||document.querySelector(".enhanced-fullscreen-overlay")))switch(e.key){case" ":case"Enter":e.preventDefault(),fetchRandomImage();break;case"f":case"F":e.preventDefault();break}},onImageLoad=()=>{loading.value=!1},onImageError=()=>{toast.error($t("random.error.fileLoadFailed")),loading.value=!1};return onMounted(()=>{fetchRandomImage(),document.addEventListener("keydown",handleKeydown)}),onUnmounted(()=>{document.removeEventListener("keydown",handleKeydown)}),(_ctx,_cache)=>{const _directive_loading=resolveDirective("loading");return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(RefreshButton,{loading:loading.value,onRefresh:refreshImage},null,8,["loading"]),withDirectives((openBlock(),createElementBlock("div",_hoisted_2,[error.value?(openBlock(),createBlock(ErrorState,{key:0,error:error.value,onRetry:refreshImage},null,8,["error"])):imageData.value?(openBlock(),createBlock(FileDisplay,{key:1,"image-data":imageData.value,onImageLoad,onImageError},null,8,["image-data"])):createCommentVNode("",!0)])),[[_directive_loading,loading.value]]),imageData.value?(openBlock(),createElementBlock("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-chevron-up"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("random.scrollIndicator")),1)]),createBaseVNode("div",_hoisted_5,[createBaseVNode("div",_hoisted_6,[createVNode(CreatorCard,{"image-data":imageData.value,onGoToAuthor:goToAuthorPage,onViewWork:viewWork},null,8,["image-data"]),createVNode(AIAnalysisCard,{"image-data":imageData.value},null,8,["image-data"]),createVNode(FileDetailsCard,{"image-data":imageData.value},null,8,["image-data"])]),createVNode(ActionButtons,{"image-data":imageData.value,onRefresh:refreshImage},null,8,["image-data"])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_7,[createBaseVNode("div",_hoisted_8,[createBaseVNode("span",_hoisted_9,toDisplayString(unref($t)("random.keyboardHint.title")),1),createBaseVNode("div",_hoisted_10,[createBaseVNode("span",_hoisted_11,[_cache[1]||(_cache[1]=createBaseVNode("kbd",null,"Space",-1)),createTextVNode(" "+toDisplayString(unref($t)("random.keyboardHint.refresh")),1)])])])])])}}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-44490a3c"]]);export{index as default};
