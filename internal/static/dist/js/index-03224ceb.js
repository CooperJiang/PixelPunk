import{q as useToast,j as useTexts,a3 as getValidationRules,a6 as Validator,_ as _export_sfc,aN as __unplugin_components_3}from"./index-38202212.js";import{g as getChannelList,a as getChannelConfigs,b as getConfigTemplates,u as updateChannel,c as createChannel,d as disableChannel,e as enableChannel,t as testChannel,f as setDefaultChannel,h as deleteChannel,i as exportChannel,j as exportAllChannels,k as importChannel,l as getSupportedTypes}from"./index-e6a47ea7.js";import{r as ref,c as computed,a as reactive,w as watch,b as onMounted,o as onUnmounted,d as defineComponent,E as resolveComponent,z as openBlock,I as createElementBlock,K as createCommentVNode,a0 as createBaseVNode,R as normalizeClass,Q as normalizeStyle,a1 as toDisplayString,ab as createTextVNode,u as unref,f as createVNode,L as withCtx,A as createBlock,H as withDirectives,$ as vShow,F as Fragment,M as renderList,n as nextTick,i as isRef}from"./vue-vendor-31320f47.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";function useChannels(){const toast=useToast(),channels=ref([]),loading=ref(!1),sortedChannels=computed(()=>[...channels.value||[]].sort((a,b)=>a.type==="local"?-1:b.type==="local"?1:new Date(b.created_at).getTime()-new Date(a.created_at).getTime()));return{channels,loading,sortedChannels,fetchChannels:async()=>{try{loading.value=!0;const result=await getChannelList();result.success&&(channels.value=result.data||[])}catch(error){toast.error(error.message),channels.value=[]}finally{loading.value=!1}}}}function useChannelForm(){const toast=useToast(),{$t}=useTexts(),R=getValidationRules($t),currentChannel=ref(null),showAddChannelDialog=ref(!1),channelForm=reactive({name:"",type:"",status:1,is_default:!1,remark:""}),resetForm=()=>{const baseKeys=new Set(["name","type","status","is_default","remark"]),formData=channelForm;Object.keys(formData).forEach(k=>{baseKeys.has(k)||delete formData[k]}),channelForm.name="",channelForm.type="",channelForm.status=1,channelForm.is_default=!1,channelForm.remark=""},editChannel=async channel=>{currentChannel.value=channel,resetForm(),channelForm.name=channel.name,channelForm.type=channel.type,channelForm.status=channel.status,channelForm.is_default=channel.is_default,channelForm.remark=channel.remark||"";try{const result=await getChannelConfigs(channel.id);result.success&&((result.data||[]).forEach(config=>{if(config.key_name==="access_key"||config.key_name==="secret_key"||config.key_name==="secret_id")channelForm[config.key_name]=config.is_secret?"********":config.value;else try{const formData=channelForm;if(config.type==="int"){let intValue=0;if(config.value!==null&&config.value!==void 0&&config.value!==""){const parsed=parseInt(String(config.value),10);intValue=isNaN(parsed)?0:parsed}formData[config.key_name]=intValue}else if(config.type==="bool"){let boolValue=!1;const strValue=String(config.value||"").toLowerCase();(strValue==="true"||strValue==="1")&&(boolValue=!0),formData[config.key_name]=boolValue}else formData[config.key_name]=config.value||""}catch{const formData=channelForm;formData[config.key_name]=config.value}}),showAddChannelDialog.value=!0)}catch(error){toast.error(error.message)}},saveChannel=async onSuccess=>{if(!Validator.validate(channelForm.name||"",[R.required],$t).valid)return toast.error($t("admin.channels.form.nameRequired"));if(!Validator.validate(String(channelForm.type||""),[R.required],$t).valid)return toast.error($t("admin.channels.form.typeRequired"));try{const tmplData=await getConfigTemplates(channelForm.type);if(tmplData.success){const templates=tmplData.data||[],formData2=channelForm;for(const t of templates){const key=t.key_name,rawVal=formData2[key];if(t.required&&(rawVal==null||String(rawVal).trim()==="")){toast.error($t("admin.channels.form.fieldRequired",{field:t.name}));return}if(rawVal!=null&&String(rawVal)!==""){if(t.type==="int"){const n=Number(rawVal);if(!Number.isFinite(n)||!Number.isInteger(n)){toast.error($t("admin.channels.form.mustBeInt",{field:t.name}));return}}else if(t.type==="bool"){if(!(typeof rawVal=="boolean")){toast.error($t("admin.channels.form.mustBeBool",{field:t.name}));return}}else if((t.type==="string"||t.type==="password")&&typeof rawVal!="string"){toast.error($t("admin.channels.form.mustBeString",{field:t.name}));return}}}}}catch{toast.error($t("admin.channels.form.loadTemplateFailed"));return}if(currentChannel.value&&channelForm.is_default===!1)try{const listRes=await getChannelList();if(listRes.success){const currentId=currentChannel.value.id;if((listRes.data||[]).filter(c=>c.id!==currentId&&c.is_default).length===0){toast.error($t("admin.channels.form.needDefaultChannel"));return}}}catch{}const channelData={name:channelForm.name,type:channelForm.type,status:channelForm.status,is_default:channelForm.is_default,remark:channelForm.remark||""},configs={},baseKeys=new Set(["name","type","status","is_default","remark"]),formData=channelForm;Object.keys(formData).forEach(key=>{if(!baseKeys.has(key)){const value=formData[key];(value!=="********"||typeof value=="boolean"||typeof value=="number")&&(configs[key]=value)}}),Object.keys(configs).length>0&&(channelData.configs=configs);try{currentChannel.value?(await updateChannel(currentChannel.value.id,channelData)).success&&(toast.success($t("admin.channels.form.channelUpdated")),showAddChannelDialog.value=!1,onSuccess?.()):(await createChannel(channelData)).success&&(toast.success($t("admin.channels.form.channelAdded")),showAddChannelDialog.value=!1,onSuccess?.())}catch(error){toast.error(error.message)}};return watch(showAddChannelDialog,newVal=>{newVal||(currentChannel.value=null,resetForm())}),{currentChannel,showAddChannelDialog,channelForm,resetForm,editChannel,saveChannel}}function useChannelOperations(){const toast=useToast(),{$t}=useTexts();return{toggleChannelStatus:async(channel,onSuccess)=>{try{channel.status===1?(await disableChannel(channel.id)).success&&toast.success($t("admin.channels.operations.disabled")):(await enableChannel(channel.id)).success&&toast.success($t("admin.channels.operations.enabled")),onSuccess?.()}catch{}},testChannelConnection:async channel=>{if(!channel){toast.warning($t("admin.channels.operations.testWarning"));return}try{toast.info($t("admin.channels.operations.testing")),(await testChannel(channel.id)).success&&toast.success($t("admin.channels.operations.testSuccess"))}catch(error){const errorMessage=error?.message||error?.response?.data?.message||$t("admin.channels.operations.testConnectionFailed");toast.error($t("admin.channels.operations.testFailed",{message:errorMessage}))}},handleSetDefault:async(channel,onSuccess)=>{if(channel.is_default){toast.info($t("admin.channels.operations.alreadyDefault"));return}try{(await setDefaultChannel(channel.id)).success&&(toast.success($t("admin.channels.operations.setDefaultSuccess")),onSuccess?.())}catch{}},handleDeleteChannel:async(channel,onSuccess)=>{try{(await deleteChannel(channel.id)).success&&(toast.success($t("admin.channels.operations.deleteSuccess")),onSuccess?.())}catch{}}}}function useFileOperations(){const toast=useToast(),{$t}=useTexts(),fileInputRef=ref(null),importChannelConfig=()=>{fileInputRef.value?.click()},handleExportChannel=async channel=>{if(channel.type==="local"){toast.warning($t("admin.channels.file.localNotSupport"));return}try{toast.info($t("admin.channels.file.preparingExport"));const result=await exportChannel(channel.id);if(result.success){const{data}=result,json=JSON.stringify(data,null,2),blob=new Blob([json],{type:"application/json"}),url=URL.createObjectURL(blob),a=document.createElement("a");a.href=url;const safeName=channel.name.replace(/[^a-zA-Z0-9\u4e00-\u9fa5_-]/g,"_");a.download=`${safeName}-export.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(url),toast.success($t("admin.channels.file.exportSuccess"))}}catch(error){toast.error(error.message)}},handleExportAllChannels=async()=>{try{toast.info($t("admin.channels.file.preparingExportAll"));const result=await exportAllChannels();if(result.success){const{data}=result,json=JSON.stringify(data,null,2),blob=new Blob([json],{type:"application/json"}),url=URL.createObjectURL(blob),a=document.createElement("a");a.href=url,a.download="all-channels-config-export.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(url),toast.success($t("admin.channels.file.exportAllSuccess",{count:data.total_count}))}}catch(error){const errorMessage=error?.response?.data?.message||error?.message||$t("admin.channels.file.exportFailedDefault");toast.error(errorMessage)}},handleFileImportInternal=async(file,onSuccess)=>{try{toast.info($t("admin.channels.file.importing")),(await importChannel(file)).success&&(toast.success($t("admin.channels.file.importSuccess")),onSuccess?.())}catch(error){const errorMessage=error?.response?.data?.message||error?.message||$t("admin.channels.file.importFailedDefault");toast.error(errorMessage)}};return{fileInputRef,importChannelConfig,handleExportChannel,handleExportAllChannels,handleFileImportInternal,handleFileImport:async(event,onSuccess)=>{const target=event.target,{files}=target;if(!files||files.length===0)return;const file=files[0];await handleFileImportInternal(file,onSuccess),fileInputRef.value&&(fileInputRef.value.value="")}}}function useDragAndDrop(containerSelector,onFileDrop,options){const toast=useToast(),{$t}=useTexts(),dragOverCounter=ref(0),isDragOver=ref(!1),handleDragEnter=event=>{event.preventDefault(),dragOverCounter.value++,isDragOver.value=!0},handleDragOver=event=>{event.preventDefault()},handleDragLeave=event=>{event.preventDefault(),dragOverCounter.value--,dragOverCounter.value===0&&(isDragOver.value=!1)},handleDrop=async event=>{event.preventDefault(),dragOverCounter.value=0,isDragOver.value=!1;const files=event.dataTransfer?.files;if(!files||files.length===0)return;const file=files[0];if(!file.name.toLowerCase().endsWith(".json")&&file.type!=="application/json"){toast.error($t("admin.channels.messages.dragJsonOnly"));return}onFileDrop(file)},isDialogOpen=()=>!!options?.isDisabled&&options.isDisabled(),isEditingField=target=>{const el=target;if(!el)return!1;const tag=(el.tagName||"").toLowerCase();if(tag==="input"||tag==="textarea")return!0;let cur=el;for(;cur;){if(cur.getAttribute&&cur.getAttribute("contenteditable")==="true")return!0;cur=cur.parentElement}return!1},handlePaste=async event=>{if(isDialogOpen()||isEditingField(event.target))return;const items=event.clipboardData?.items;if(items)for(let i=0;i<items.length;i++){const item=items[i];if(item.kind==="file"&&item.type==="application/json"){event.preventDefault();const file=item.getAsFile();file&&onFileDrop(file);return}if(item.kind==="string"&&item.type==="text/plain"){event.preventDefault(),item.getAsString(async text=>{try{JSON.parse(text);const blob=new Blob([text],{type:"application/json"}),file=new File([blob],"pasted-config.json",{type:"application/json"});onFileDrop(file)}catch{toast.error($t("admin.channels.messages.invalidJsonPaste"))}});return}}},initEventListeners=()=>{document.addEventListener("paste",handlePaste);const container=document.querySelector(containerSelector);container&&(container.addEventListener("dragenter",handleDragEnter),container.addEventListener("dragover",handleDragOver),container.addEventListener("dragleave",handleDragLeave),container.addEventListener("drop",handleDrop))},cleanupEventListeners=()=>{document.removeEventListener("paste",handlePaste);const container=document.querySelector(containerSelector);container&&(container.removeEventListener("dragenter",handleDragEnter),container.removeEventListener("dragover",handleDragOver),container.removeEventListener("dragleave",handleDragLeave),container.removeEventListener("drop",handleDrop))};return onMounted(()=>{initEventListeners()}),onUnmounted(()=>{cleanupEventListeners()}),{isDragOver,initEventListeners,cleanupEventListeners}}function useChannelManagement(){const channelData=useChannels(),channelForm=useChannelForm(),channelOperations=useChannelOperations(),fileOperations=useFileOperations(),dragAndDrop=useDragAndDrop(".channels-content",file=>{fileOperations.handleFileImportInternal(file,channelData.fetchChannels)},{isDisabled:()=>channelForm.showAddChannelDialog.value===!0}),handleChannelOperationWithRefresh={toggleStatus:channel=>channelOperations.toggleChannelStatus(channel,channelData.fetchChannels),setDefault:channel=>channelOperations.handleSetDefault(channel,channelData.fetchChannels),deleteChannel:channel=>channelOperations.handleDeleteChannel(channel,channelData.fetchChannels),testConnection:channelOperations.testChannelConnection},handleFormOperationWithRefresh={saveChannel:()=>channelForm.saveChannel(channelData.fetchChannels),editChannel:channelForm.editChannel,resetForm:channelForm.resetForm},handleFileOperationWithRefresh={importConfig:fileOperations.importChannelConfig,exportChannel:fileOperations.handleExportChannel,exportAll:fileOperations.handleExportAllChannels,handleFileImport:event=>fileOperations.handleFileImport(event,channelData.fetchChannels)};return{...channelData,...channelForm,fileInputRef:fileOperations.fileInputRef,isDragOver:dragAndDrop.isDragOver,channelOperations:handleChannelOperationWithRefresh,formOperations:handleFormOperationWithRefresh,fileOperations:handleFileOperationWithRefresh}}const _hoisted_1$2={key:0,class:"default-glow"},_hoisted_2$2={class:"card-section header-section"},_hoisted_3$2={class:"channel-header"},_hoisted_4$2={class:"channel-icon-wrapper"},_hoisted_5$2={class:"channel-icon"},_hoisted_6$2={key:0,class:"default-crown"},_hoisted_7$2={class:"channel-info"},_hoisted_8$2={class:"channel-name"},_hoisted_9$2={class:"channel-meta"},_hoisted_10$2={key:0,class:"default-badge"},_hoisted_11$2={class:"channel-actions"},_hoisted_12$2=["title"],_hoisted_13$2=["disabled","title"],_hoisted_14$2=["title"],_hoisted_15$2={class:"card-section details-section"},_hoisted_16$2={class:"channel-details"},_hoisted_17$2={class:"stats-grid"},_hoisted_18$2={class:"stat-item"},_hoisted_19$2={class:"stat-content"},_hoisted_20$1={class:"stat-label"},_hoisted_21$1={class:"stat-value"},_hoisted_22$1={class:"stat-item"},_hoisted_23$1={class:"stat-content"},_hoisted_24$1={class:"stat-label"},_hoisted_25$1={class:"stat-value"},_hoisted_26$1={class:"stat-item"},_hoisted_27={class:"stat-content"},_hoisted_28={class:"stat-label"},_hoisted_29={class:"stat-value truncate"},_hoisted_30={class:"stat-content"},_hoisted_31={class:"stat-label"},_hoisted_32={class:"stat-value truncate"},_hoisted_33={class:"card-section footer-section"},_hoisted_34={class:"channel-footer"},_hoisted_35={class:"footer-left"},_hoisted_36={key:1,class:"default-tip"},_hoisted_37={class:"footer-right"},_hoisted_38=["disabled","title"],_hoisted_39=["disabled"],_sfc_main$2=defineComponent({__name:"ChannelCard",props:{channel:{}},emits:["edit","export","toggle-status","set-default","delete","test"],setup(__props){const{$t}=useTexts(),toast=useToast(),getChannelIcon=type=>{switch(type){case"oss":return"fas fa-cloud";case"cos":return"fas fa-cloud";case"rainyun":return"fas fa-cloud-rain";case"local":return"fas fa-hdd";default:return"fas fa-server"}},getChannelIconColor=type=>{switch(type){case"oss":return"var(--color-brand-500)";case"cos":return"var(--color-success-400)";case"rainyun":return"var(--color-info-500)";case"local":return"var(--color-warning-500)";default:return"var(--color-content-muted)"}},getChannelTypeText=type=>({oss:$t("constants.storageOptions.channelTypes.oss"),cos:$t("constants.storageOptions.channelTypes.cos"),rainyun:$t("constants.storageOptions.channelTypes.rainyun"),local:$t("constants.storageOptions.channelTypes.local")})[type]||$t("constants.storageOptions.channelTypes.unknown"),copyToClipboard=text=>{navigator.clipboard.writeText(text).then(()=>{toast.success($t("admin.channels.messages.copySuccess"))},()=>{toast.error($t("admin.channels.messages.copyFailed"))})};return(_ctx,_cache)=>{const _component_CyberPopconfirm=resolveComponent("CyberPopconfirm");return openBlock(),createElementBlock("div",{class:normalizeClass(["channel-card",{"default-channel":__props.channel.is_default,"local-channel":__props.channel.type==="local"}])},[__props.channel.is_default?(openBlock(),createElementBlock("div",_hoisted_1$2)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[createBaseVNode("div",_hoisted_4$2,[createBaseVNode("div",_hoisted_5$2,[createBaseVNode("i",{class:normalizeClass(getChannelIcon(__props.channel.type)),style:normalizeStyle({color:getChannelIconColor(__props.channel.type)})},null,6)]),__props.channel.is_default?(openBlock(),createElementBlock("div",_hoisted_6$2,[..._cache[7]||(_cache[7]=[createBaseVNode("i",{class:"fas fa-crown"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_7$2,[createBaseVNode("h3",_hoisted_8$2,toDisplayString(__props.channel.name),1),createBaseVNode("div",_hoisted_9$2,[__props.channel.is_default?(openBlock(),createElementBlock("span",_hoisted_10$2,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-star"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.status.default")),1)])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["channel-status",{active:__props.channel.status===1}])},[_cache[9]||(_cache[9]=createBaseVNode("span",{class:"status-dot"},null,-1)),createTextVNode(" "+toDisplayString(__props.channel.status===1?unref($t)("admin.channels.status.enabled"):unref($t)("admin.channels.status.disabled")),1)],2)])]),createBaseVNode("div",_hoisted_11$2,[createBaseVNode("button",{class:"action-btn edit",title:unref($t)("admin.channels.actions.edit"),onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("edit",__props.channel))},[..._cache[10]||(_cache[10]=[createBaseVNode("i",{class:"fas fa-edit"},null,-1)])],8,_hoisted_12$2),createBaseVNode("button",{class:"action-btn export",disabled:__props.channel.type==="local",title:__props.channel.type==="local"?unref($t)("admin.channels.actions.exportNotSupported"):unref($t)("admin.channels.actions.exportConfig"),onClick:_cache[1]||(_cache[1]=$event=>_ctx.$emit("export",__props.channel))},[..._cache[11]||(_cache[11]=[createBaseVNode("i",{class:"fas fa-file-export"},null,-1)])],8,_hoisted_13$2),createVNode(_component_CyberPopconfirm,{title:__props.channel.status===1?unref($t)("admin.channels.confirm.disable"):unref($t)("admin.channels.confirm.enable"),onConfirm:_cache[2]||(_cache[2]=$event=>_ctx.$emit("toggle-status",__props.channel))},{reference:withCtx(()=>[createBaseVNode("button",{class:normalizeClass(["action-btn",__props.channel.status===1?"deactivate":"activate"]),title:__props.channel.status===1?unref($t)("admin.channels.actions.disable"):unref($t)("admin.channels.actions.enable")},[createBaseVNode("i",{class:normalizeClass(__props.channel.status===1?"fas fa-ban":"fas fa-check")},null,2)],10,_hoisted_14$2)]),_:1},8,["title"])])])]),createBaseVNode("div",_hoisted_15$2,[createBaseVNode("div",_hoisted_16$2,[createBaseVNode("div",_hoisted_17$2,[createBaseVNode("div",_hoisted_18$2,[_cache[12]||(_cache[12]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-hdd"})],-1)),createBaseVNode("div",_hoisted_19$2,[createBaseVNode("span",_hoisted_20$1,toDisplayString(unref($t)("admin.channels.info.type")),1),createBaseVNode("span",_hoisted_21$1,toDisplayString(getChannelTypeText(__props.channel.type)),1)])]),createBaseVNode("div",_hoisted_22$1,[_cache[13]||(_cache[13]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-images"})],-1)),createBaseVNode("div",_hoisted_23$1,[createBaseVNode("span",_hoisted_24$1,toDisplayString(unref($t)("admin.channels.info.file")),1),createBaseVNode("span",_hoisted_25$1,toDisplayString(__props.channel.file_count||0),1)])]),createBaseVNode("div",_hoisted_26$1,[_cache[14]||(_cache[14]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-database"})],-1)),createBaseVNode("div",_hoisted_27,[createBaseVNode("span",_hoisted_28,toDisplayString(unref($t)("admin.channels.info.bucket")),1),createBaseVNode("span",_hoisted_29,toDisplayString(__props.channel.bucket||"-"),1)])]),createBaseVNode("div",{class:normalizeClass(["stat-item",{clickable:__props.channel.custom_domain||__props.channel.domain||__props.channel.endpoint}]),onClick:_cache[3]||(_cache[3]=$event=>__props.channel.custom_domain||__props.channel.domain||__props.channel.endpoint?copyToClipboard(__props.channel.custom_domain||__props.channel.domain||__props.channel.endpoint):null)},[_cache[15]||(_cache[15]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-globe"})],-1)),createBaseVNode("div",_hoisted_30,[createBaseVNode("span",_hoisted_31,toDisplayString(unref($t)("admin.channels.info.domain")),1),createBaseVNode("span",_hoisted_32,toDisplayString(__props.channel.custom_domain||__props.channel.domain||__props.channel.endpoint||"-"),1)])],2)])])]),createBaseVNode("div",_hoisted_33,[createBaseVNode("div",_hoisted_34,[createBaseVNode("div",_hoisted_35,[__props.channel.is_default?createCommentVNode("",!0):(openBlock(),createElementBlock("button",{key:0,class:"footer-btn primary",onClick:_cache[4]||(_cache[4]=$event=>_ctx.$emit("set-default",__props.channel))},[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-star mr-1"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.actions.setDefault")),1)])),__props.channel.is_default?(openBlock(),createElementBlock("span",_hoisted_36,[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-crown mr-1"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.status.defaultChannel")),1)])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_37,[createBaseVNode("button",{class:"footer-btn test",disabled:__props.channel.status!==1,title:__props.channel.status!==1?unref($t)("admin.channels.actions.testDisabledTip"):unref($t)("admin.channels.actions.test"),onClick:_cache[5]||(_cache[5]=$event=>_ctx.$emit("test",__props.channel))},[_cache[18]||(_cache[18]=createBaseVNode("i",{class:"fas fa-plug mr-1"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.actions.test")),1)],8,_hoisted_38),__props.channel.is_local?createCommentVNode("",!0):(openBlock(),createBlock(_component_CyberPopconfirm,{key:0,title:unref($t)("admin.channels.confirm.delete"),onConfirm:_cache[6]||(_cache[6]=$event=>_ctx.$emit("delete",__props.channel))},{reference:withCtx(()=>[createBaseVNode("button",{class:"footer-btn danger",disabled:__props.channel.is_default},[_cache[19]||(_cache[19]=createBaseVNode("i",{class:"fas fa-trash mr-1"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.actions.delete")),1)],8,_hoisted_39)]),_:1},8,["title"]))])])])],2)}}});const ChannelCard=_export_sfc(_sfc_main$2,[["__scopeId","data-v-3cc00d90"]]),_hoisted_1$1={class:"channel-form"},_hoisted_2$1={class:"form-group"},_hoisted_3$1={class:"form-group"},_hoisted_4$1={class:"label-with-tip"},_hoisted_5$1={class:"label-text"},_hoisted_6$1={class:"count"},_hoisted_7$1={class:"label-with-tip"},_hoisted_8$1={class:"label-text"},_hoisted_9$1={key:0,class:"required-star"},_hoisted_10$1={key:3,class:"radio-group"},_hoisted_11$1={class:"count"},_hoisted_12$1={class:"label-with-tip"},_hoisted_13$1={class:"label-text"},_hoisted_14$1={key:0,class:"required-star"},_hoisted_15$1={key:3,class:"radio-group"},_hoisted_16$1={class:"count"},_hoisted_17$1={class:"label-with-tip"},_hoisted_18$1={class:"label-text"},_hoisted_19$1={key:0,class:"required-star"},_hoisted_20={key:3,class:"radio-group"},_hoisted_21={class:"form-group"},_hoisted_22={class:"radio-group"},_hoisted_23={class:"form-group"},_hoisted_24={class:"radio-group"},_hoisted_25={key:0,class:"status-local-tip"},_hoisted_26={class:"form-group"},_sfc_main$1=defineComponent({__name:"ChannelForm",props:{form:{},isEdit:{type:Boolean}},emits:["update:form"],setup(__props,{emit:__emit}){const{$t}=useTexts(),props=__props,emit=__emit,localForm=reactive({...props.form});watch(()=>props.form,newForm=>{Object.assign(localForm,newForm)},{deep:!0}),watch(localForm,newForm=>{emit("update:form",{...newForm})},{deep:!0});const channelTypeOptions=ref([]),mapTypeLabel=t=>({local:$t("admin.channels.types.local"),oss:$t("admin.channels.types.oss"),cos:$t("admin.channels.types.cos"),qiniu:$t("admin.channels.types.qiniu"),upyun:$t("admin.channels.types.upyun"),s3:$t("admin.channels.types.s3"),rainyun:$t("admin.channels.types.rainyun"),webdav:"WebDAV",r2:"Cloudflare R2",azureblob:"Azure Blob",sftp:"SFTP",ftp:"FTP/FTPS"})[t]||t,ranking=["oss","cos","qiniu","upyun","s3","rainyun","webdav","r2","azureblob","local","sftp","ftp"],applyRanking=opts=>{const order=new Map;return ranking.forEach((v,i)=>order.set(v,i)),opts.slice().sort((a,b)=>{const ia=order.has(a.value)?order.get(a.value):Number.MAX_SAFE_INTEGER,ib=order.has(b.value)?order.get(b.value):Number.MAX_SAFE_INTEGER;return ia!==ib?ia-ib:a.label.localeCompare(b.label,"zh-Hans-CN")})};onMounted(async()=>{try{const res=await getSupportedTypes(),resData=res,isSuccess=resData.success===!0||resData.code===200,dataArray=resData.data;if(isSuccess&&Array.isArray(dataArray)){const arr=dataArray;if(arr.length>0&&typeof arr[0]=="object"&&arr[0]&&"value"in arr[0]){const opts=arr.map(it=>{const item=it;return{label:item.label||mapTypeLabel(item.value),value:item.value}});channelTypeOptions.value=applyRanking(opts)}else{const opts=arr.map(t=>({label:mapTypeLabel(t),value:t}));channelTypeOptions.value=applyRanking(opts)}}else if(Array.isArray(res)){const opts=res.map(t=>({label:mapTypeLabel(t),value:t}));channelTypeOptions.value=applyRanking(opts)}}catch{channelTypeOptions.value=[]}});const isEdit=computed(()=>props.isEdit),dynamicFields=ref([]),fieldTips={use_path_style:$t("admin.channels.tips.usePathStyle")},getFieldTip=key=>fieldTips[key]||"";watch(()=>localForm.type,async newType=>{if(!newType||String(newType).trim()===""){dynamicFields.value=[];return}try{const resData=await getConfigTemplates(newType);if(resData.success===!0||resData.code===200){const data=resData.data||[];dynamicFields.value.splice(0,dynamicFields.value.length,...data);for(const field of data){const key=field.key_name;if(localForm[key]===void 0)if(field.default!==void 0&&field.default!==null)localForm[key]=field.default;else switch(field.type){case"bool":localForm[key]=!1;break;case"int":localForm[key]=0;break;case"string":case"password":localForm[key]="";break;default:localForm[key]=""}}if(await nextTick(),!props.isEdit){const has=k=>data.some(f=>f.key_name===k),setIfUndef=(k,v)=>{const cur=localForm[k];(cur==null||cur==="")&&(localForm[k]=v)};has("use_https")&&setIfUndef("use_https",!0),has("hide_remote_url")&&setIfUndef("hide_remote_url",!1),newType==="s3"&&has("use_path_style")&&setIfUndef("use_path_style",!1)}showBaseGroup.value=!0,showLinkGroup.value=!1,showAdvancedGroup.value=!1}else dynamicFields.value=[]}catch{dynamicFields.value=[]}},{immediate:!0});const s3ProvidersTip=$t("admin.channels.tips.s3Providers"),showBaseGroup=ref(!0),showLinkGroup=ref(!1),showAdvancedGroup=ref(!1),linkKeys=new Set(["custom_domain","use_https","hide_remote_url","use_path_style","access_control","domain"]),grouped=computed(()=>{const base=[],link=[],adv=[];for(const f of dynamicFields.value){if(f.required){base.push(f);continue}if(linkKeys.has(f.key_name)){link.push(f);continue}adv.push(f)}return{base,link,adv}});return(_ctx,_cache)=>{const _component_CyberInput=resolveComponent("CyberInput"),_component_CyberTooltip=resolveComponent("CyberTooltip"),_component_CyberDropdown=resolveComponent("CyberDropdown"),_component_CyberRadio=resolveComponent("CyberRadio");return openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("label",null,[_cache[10]||(_cache[10]=createBaseVNode("span",{class:"required-star"},"*",-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.form.name")),1)]),createVNode(_component_CyberInput,{modelValue:localForm.name,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localForm.name=$event),placeholder:unref($t)("admin.channels.form.namePlaceholder")},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_3$1,[createBaseVNode("label",_hoisted_4$1,[createBaseVNode("span",_hoisted_5$1,[_cache[11]||(_cache[11]=createBaseVNode("span",{class:"required-star"},"*",-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.form.type")),1)]),localForm.type==="s3"?(openBlock(),createBlock(_component_CyberTooltip,{key:0,content:unref(s3ProvidersTip),placement:"top"},{default:withCtx(()=>[..._cache[12]||(_cache[12]=[createBaseVNode("i",{class:"fas fa-info-circle tip-icon text-content"},null,-1)])]),_:1},8,["content"])):createCommentVNode("",!0)]),createVNode(_component_CyberDropdown,{modelValue:localForm.type,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>localForm.type=$event),disabled:!!isEdit.value,options:channelTypeOptions.value,placeholder:unref($t)("admin.channels.form.typePlaceholder")},null,8,["modelValue","disabled","options","placeholder"])]),createBaseVNode("div",{class:"group-header",onClick:_cache[2]||(_cache[2]=$event=>showBaseGroup.value=!showBaseGroup.value)},[createBaseVNode("i",{class:normalizeClass(["fas",showBaseGroup.value?"fa-chevron-down":"fa-chevron-right"])},null,2),createBaseVNode("span",null,toDisplayString(unref($t)("admin.channels.form.basicRequired")),1),createBaseVNode("span",_hoisted_6$1,toDisplayString(grouped.value.base.length),1)]),withDirectives(createBaseVNode("div",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(grouped.value.base,f=>(openBlock(),createElementBlock("div",{key:f.key_name,class:"form-group"},[createBaseVNode("label",_hoisted_7$1,[createBaseVNode("span",_hoisted_8$1,[f.required?(openBlock(),createElementBlock("span",_hoisted_9$1,"*")):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(f.name),1)]),getFieldTip(f.key_name)?(openBlock(),createBlock(_component_CyberTooltip,{key:0,content:getFieldTip(f.key_name),placement:"top"},{default:withCtx(()=>[..._cache[13]||(_cache[13]=[createBaseVNode("i",{class:"fas fa-info-circle tip-icon text-content"},null,-1)])]),_:1},8,["content"])):createCommentVNode("",!0)]),Array.isArray(f.options)&&f.options.length>0?(openBlock(),createBlock(_component_CyberDropdown,{key:0,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,options:f.options.map(o=>({label:o,value:o})),placeholder:f.description||unref($t)("admin.channels.form.pleaseSelect")},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])):f.type==="string"||f.type==="password"?(openBlock(),createBlock(_component_CyberInput,{key:1,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,type:f.type==="password"?"password":"text",placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","type","placeholder"])):f.type==="int"?(openBlock(),createBlock(_component_CyberInput,{key:2,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,modelModifiers:{number:!0},type:"number",placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):f.type==="bool"?(openBlock(),createElementBlock("div",_hoisted_10$1,[createVNode(_component_CyberRadio,{modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,value:!0},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.yes")),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),createVNode(_component_CyberRadio,{modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,value:!1},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.no")),1)]),_:1},8,["modelValue","onUpdate:modelValue"])])):(openBlock(),createBlock(_component_CyberInput,{key:4,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]))),128))],512),[[vShow,showBaseGroup.value]]),createBaseVNode("div",{class:"group-header",onClick:_cache[3]||(_cache[3]=$event=>showLinkGroup.value=!showLinkGroup.value)},[createBaseVNode("i",{class:normalizeClass(["fas",showLinkGroup.value?"fa-chevron-down":"fa-chevron-right"])},null,2),createBaseVNode("span",null,toDisplayString(unref($t)("admin.channels.form.linkPermission")),1),createBaseVNode("span",_hoisted_11$1,toDisplayString(grouped.value.link.length),1)]),withDirectives(createBaseVNode("div",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(grouped.value.link,f=>(openBlock(),createElementBlock("div",{key:f.key_name,class:"form-group"},[createBaseVNode("label",_hoisted_12$1,[createBaseVNode("span",_hoisted_13$1,[f.required?(openBlock(),createElementBlock("span",_hoisted_14$1,"*")):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(f.name),1)]),getFieldTip(f.key_name)?(openBlock(),createBlock(_component_CyberTooltip,{key:0,content:getFieldTip(f.key_name),placement:"top"},{default:withCtx(()=>[..._cache[14]||(_cache[14]=[createBaseVNode("i",{class:"fas fa-info-circle tip-icon text-content"},null,-1)])]),_:1},8,["content"])):createCommentVNode("",!0)]),Array.isArray(f.options)&&f.options.length>0?(openBlock(),createBlock(_component_CyberDropdown,{key:0,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,options:f.options.map(o=>({label:o,value:o})),placeholder:f.description||unref($t)("admin.channels.form.pleaseSelect")},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])):f.type==="string"||f.type==="password"?(openBlock(),createBlock(_component_CyberInput,{key:1,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,type:f.type==="password"?"password":"text",placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","type","placeholder"])):f.type==="int"?(openBlock(),createBlock(_component_CyberInput,{key:2,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,modelModifiers:{number:!0},type:"number",placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):f.type==="bool"?(openBlock(),createElementBlock("div",_hoisted_15$1,[createVNode(_component_CyberRadio,{modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,value:!0},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.yes")),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),createVNode(_component_CyberRadio,{modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,value:!1},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.no")),1)]),_:1},8,["modelValue","onUpdate:modelValue"])])):(openBlock(),createBlock(_component_CyberInput,{key:4,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]))),128))],512),[[vShow,showLinkGroup.value]]),createBaseVNode("div",{class:"group-header",onClick:_cache[4]||(_cache[4]=$event=>showAdvancedGroup.value=!showAdvancedGroup.value)},[createBaseVNode("i",{class:normalizeClass(["fas",showAdvancedGroup.value?"fa-chevron-down":"fa-chevron-right"])},null,2),createBaseVNode("span",null,toDisplayString(unref($t)("admin.channels.form.advanced")),1),createBaseVNode("span",_hoisted_16$1,toDisplayString(grouped.value.adv.length),1)]),withDirectives(createBaseVNode("div",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(grouped.value.adv,f=>(openBlock(),createElementBlock("div",{key:f.key_name,class:"form-group"},[createBaseVNode("label",_hoisted_17$1,[createBaseVNode("span",_hoisted_18$1,[f.required?(openBlock(),createElementBlock("span",_hoisted_19$1,"*")):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(f.name),1)]),getFieldTip(f.key_name)?(openBlock(),createBlock(_component_CyberTooltip,{key:0,content:getFieldTip(f.key_name),placement:"top"},{default:withCtx(()=>[..._cache[15]||(_cache[15]=[createBaseVNode("i",{class:"fas fa-info-circle tip-icon text-content"},null,-1)])]),_:1},8,["content"])):createCommentVNode("",!0)]),Array.isArray(f.options)&&f.options.length>0?(openBlock(),createBlock(_component_CyberDropdown,{key:0,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,options:f.options.map(o=>({label:o,value:o})),placeholder:f.description||unref($t)("admin.channels.form.pleaseSelect")},null,8,["modelValue","onUpdate:modelValue","options","placeholder"])):f.type==="string"||f.type==="password"?(openBlock(),createBlock(_component_CyberInput,{key:1,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,type:f.type==="password"?"password":"text",placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","type","placeholder"])):f.type==="int"?(openBlock(),createBlock(_component_CyberInput,{key:2,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,modelModifiers:{number:!0},type:"number",placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):f.type==="bool"?(openBlock(),createElementBlock("div",_hoisted_20,[createVNode(_component_CyberRadio,{modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,value:!0},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.yes")),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),createVNode(_component_CyberRadio,{modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,value:!1},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.no")),1)]),_:1},8,["modelValue","onUpdate:modelValue"])])):(openBlock(),createBlock(_component_CyberInput,{key:4,modelValue:localForm[f.key_name],"onUpdate:modelValue":$event=>localForm[f.key_name]=$event,placeholder:f.description||""},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]))),128))],512),[[vShow,showAdvancedGroup.value]]),createBaseVNode("div",_hoisted_21,[createBaseVNode("label",null,toDisplayString(unref($t)("admin.channels.form.isDefault")),1),createBaseVNode("div",_hoisted_22,[createVNode(_component_CyberRadio,{modelValue:localForm.is_default,"onUpdate:modelValue":_cache[5]||(_cache[5]=$event=>localForm.is_default=$event),value:!0},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.yes")),1)]),_:1},8,["modelValue"]),createVNode(_component_CyberRadio,{modelValue:localForm.is_default,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>localForm.is_default=$event),value:!1},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.no")),1)]),_:1},8,["modelValue"])])]),createBaseVNode("div",_hoisted_23,[createBaseVNode("label",null,toDisplayString(unref($t)("admin.channels.form.status")),1),createBaseVNode("div",_hoisted_24,[createVNode(_component_CyberRadio,{modelValue:localForm.status,"onUpdate:modelValue":_cache[7]||(_cache[7]=$event=>localForm.status=$event),value:1,disabled:isEdit.value&&localForm.type==="local"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.enabled")),1)]),_:1},8,["modelValue","disabled"]),createVNode(_component_CyberRadio,{modelValue:localForm.status,"onUpdate:modelValue":_cache[8]||(_cache[8]=$event=>localForm.status=$event),value:0,disabled:isEdit.value&&localForm.type==="local"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.form.disabled")),1)]),_:1},8,["modelValue","disabled"]),isEdit.value&&localForm.type==="local"?(openBlock(),createElementBlock("div",_hoisted_25,[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-info-circle"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.channels.form.localStatusTip")),1)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_26,[createBaseVNode("label",null,toDisplayString(unref($t)("admin.channels.form.remark")),1),createVNode(_component_CyberInput,{modelValue:localForm.remark,"onUpdate:modelValue":_cache[9]||(_cache[9]=$event=>localForm.remark=$event),placeholder:unref($t)("admin.channels.form.remarkPlaceholder")},null,8,["modelValue","placeholder"])])])}}});const ChannelForm=_export_sfc(_sfc_main$1,[["__scopeId","data-v-ea36cce6"]]),_hoisted_1={class:"admin-channels-page admin-page-container"},_hoisted_2={class:"action-buttons"},_hoisted_3={class:"ml-2 hidden sm:inline"},_hoisted_4={class:"shortcut-tips"},_hoisted_5={class:"tip-item"},_hoisted_6={class:"tip-item"},_hoisted_7={class:"tip-item"},_hoisted_8={key:0,class:"drag-overlay"},_hoisted_9={class:"drag-content"},_hoisted_10={class:"drag-title"},_hoisted_11={class:"drag-desc"},_hoisted_12={class:"channels-grid"},_hoisted_13={key:0,class:"loading-state"},_hoisted_14={key:0,class:"empty-content"},_hoisted_15={class:"empty-title"},_hoisted_16={class:"empty-desc"},_hoisted_17={class:"empty-actions"},_hoisted_18={class:"empty-tip"},_hoisted_19={class:"dialog-footer flex justify-end space-x-2 p-4"},_sfc_main=defineComponent({name:"ChannelsManagePage",__name:"index",setup(__props){const{$t}=useTexts(),{channels,loading,sortedChannels,fetchChannels,currentChannel,channelForm,showAddChannelDialog,isDragOver,fileInputRef,channelOperations,formOperations,fileOperations}=useChannelManagement();return onMounted(()=>{fetchChannels()}),(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton"),_component_CyberLoading=resolveComponent("CyberLoading"),_component_CyberAdminWrapper=resolveComponent("CyberAdminWrapper");return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(_component_CyberAdminWrapper,{title:unref($t)("admin.channels.title"),subtitle:unref($t)("admin.channels.subtitle"),icon:"fas fa-cloud-upload-alt"},{actions:withCtx(()=>[createBaseVNode("div",_hoisted_2,[createVNode(_component_CyberButton,{type:"primary",icon:"plus",onClick:_cache[0]||(_cache[0]=()=>{unref(formOperations).resetForm(),showAddChannelDialog.value=!0})},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.actions.addChannel")),1)]),_:1}),_cache[6]||(_cache[6]=createBaseVNode("div",{class:"button-divider"},null,-1)),createVNode(_component_CyberButton,{type:"ghost",icon:"file-import",onClick:unref(fileOperations).importConfig},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.actions.importConfig")),1)]),_:1},8,["onClick"]),createVNode(_component_CyberButton,{type:"ghost",icon:"file-export",onClick:unref(fileOperations).exportAll},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.actions.exportAll")),1)]),_:1},8,["onClick"]),_cache[7]||(_cache[7]=createBaseVNode("div",{class:"button-divider"},null,-1)),createVNode(_component_CyberButton,{type:"ghost",disabled:unref(loading),loading:unref(loading),"loading-mode":"inline",icon:"sync-alt",class:"refresh-btn",title:unref(loading)?unref($t)("admin.channels.actions.refreshing"):unref($t)("admin.channels.actions.refresh"),onClick:unref(fetchChannels)},{default:withCtx(()=>[createBaseVNode("span",_hoisted_3,toDisplayString(unref(loading)?unref($t)("admin.channels.actions.refreshing"):unref($t)("admin.channels.actions.refresh")),1)]),_:1},8,["disabled","loading","title","onClick"])])]),toolbar:withCtx(()=>[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-keyboard text-content"},null,-1)),createBaseVNode("span",null,[createTextVNode(toDisplayString(unref($t)("admin.channels.shortcuts.title"))+" ",1),_cache[8]||(_cache[8]=createBaseVNode("kbd",null,"Ctrl/Cmd + V",-1)),createTextVNode(" "+toDisplayString(unref($t)("admin.channels.shortcuts.paste")),1)])]),_cache[12]||(_cache[12]=createBaseVNode("div",{class:"tip-divider"},null,-1)),createBaseVNode("div",_hoisted_6,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-upload text-error-500"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("admin.channels.shortcuts.dragHint")),1)]),_cache[13]||(_cache[13]=createBaseVNode("div",{class:"tip-divider"},null,-1)),createBaseVNode("div",_hoisted_7,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-info-circle text-secondary"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("admin.channels.tips.multipleServices")),1)])])]),default:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["channels-content",{"drag-over":unref(isDragOver)}])},[unref(isDragOver)?(openBlock(),createElementBlock("div",_hoisted_8,[createBaseVNode("div",_hoisted_9,[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-cloud-upload-alt drag-icon"},null,-1)),createBaseVNode("h3",_hoisted_10,toDisplayString(unref($t)("admin.channels.drag.title")),1),createBaseVNode("p",_hoisted_11,toDisplayString(unref($t)("admin.channels.drag.desc")),1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_12,[unref(loading)?(openBlock(),createElementBlock("div",_hoisted_13,[createVNode(_component_CyberLoading,{visible:!0,text:unref($t)("admin.channels.loading")},null,8,["text"])])):(openBlock(),createElementBlock(Fragment,{key:1},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(sortedChannels),channel=>(openBlock(),createBlock(ChannelCard,{key:channel.id,channel,onEdit:unref(formOperations).editChannel,onExport:unref(fileOperations).exportChannel,onToggleStatus:unref(channelOperations).toggleStatus,onSetDefault:unref(channelOperations).setDefault,onDelete:unref(channelOperations).deleteChannel,onTest:unref(channelOperations).testConnection},null,8,["channel","onEdit","onExport","onToggleStatus","onSetDefault","onDelete","onTest"]))),128)),unref(channels).length===0?(openBlock(),createElementBlock("div",_hoisted_14,[_cache[16]||(_cache[16]=createBaseVNode("div",{class:"empty-icon-wrapper"},[createBaseVNode("i",{class:"fas fa-cloud-upload-alt"}),createBaseVNode("div",{class:"icon-glow"})],-1)),createBaseVNode("h3",_hoisted_15,toDisplayString(unref($t)("admin.channels.empty.title")),1),createBaseVNode("p",_hoisted_16,toDisplayString(unref($t)("admin.channels.empty.desc")),1),createBaseVNode("div",_hoisted_17,[createVNode(_component_CyberButton,{type:"primary",size:"medium",icon:"plus",class:"add-channel-btn",onClick:_cache[1]||(_cache[1]=()=>{unref(formOperations).resetForm(),showAddChannelDialog.value=!0})},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.empty.action")),1)]),_:1}),createBaseVNode("p",_hoisted_18,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-lightbulb mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("admin.channels.empty.tip")),1)])])])):createCommentVNode("",!0)],64))]),createVNode(unref(__unplugin_components_3),{modelValue:unref(showAddChannelDialog),"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>isRef(showAddChannelDialog)?showAddChannelDialog.value=$event:null),title:unref(currentChannel)?unref($t)("admin.channels.dialog.edit"):unref($t)("admin.channels.dialog.add"),width:"500px"},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_19,[createVNode(_component_CyberButton,{type:"secondary",class:"text-xs",onClick:_cache[3]||(_cache[3]=$event=>showAddChannelDialog.value=!1)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.actions.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",class:"text-xs",onClick:unref(formOperations).saveChannel},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.channels.actions.save")),1)]),_:1},8,["onClick"])])]),default:withCtx(()=>[createVNode(ChannelForm,{form:unref(channelForm),"is-edit":!!unref(currentChannel),"onUpdate:form":_cache[2]||(_cache[2]=newForm=>Object.assign(unref(channelForm),newForm))},null,8,["form","is-edit"])]),_:1},8,["modelValue","title"]),createBaseVNode("input",{ref_key:"fileInputRef",ref:fileInputRef,type:"file",accept:".json",style:{display:"none"},onChange:_cache[5]||(_cache[5]=(...args)=>unref(fileOperations).handleFileImport&&unref(fileOperations).handleFileImport(...args))},null,544)],2)]),_:1},8,["title","subtitle"])])}}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-b2d28234"]]);export{index as default};
