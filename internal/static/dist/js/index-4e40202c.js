import{d as defineComponent,r as ref,a as reactive,E as resolveComponent,z as openBlock,I as createElementBlock,A as createBlock,a0 as createBaseVNode,f as createVNode,L as withCtx,ab as createTextVNode,a1 as toDisplayString,u as unref,a5 as withModifiers,a3 as useRouter,w as watch,b as onMounted,j as onBeforeUnmount,c as computed,F as Fragment,M as renderList,R as normalizeClass,K as createCommentVNode,Q as normalizeStyle,J as renderSlot,H as withDirectives,$ as vShow,a4 as useRoute}from"./vue-vendor-31320f47.js";import{ah as post,x as get,ai as put,aj as del,ak as userApi,al as fileApi,am as folderApi,n as useAuthStore,j as useTexts,an as getUserProfile,ao as uploadAvatar,ap as updateUserProfile,q as useToast,_ as _export_sfc,Z as StorageUtil,aq as updatePassword,ar as sendChangeEmailCode,as as changeEmail,J as getCurrentLocale,a3 as getValidationRules,a6 as Validator,at as getAccessControlConfig,au as createOrUpdateAccessControl,av as resetAccessControlConfig,M as useTheme,i as useLayoutStore,aw as useAppearanceSettings}from"./index-4d0dab4c.js";import{t as tagApi}from"./index-dd94d71d.js";import{s as storageApi}from"./index-13ad1e31.js";import{s as shareApi}from"./index-8277663f.js";import{a as authorApi}from"./index-8471eeda.js";import{g as getStorageSizeOptions,a as getFileSizeOptions}from"./storageOptions-66a07ca4.js";import{s as showConfirm}from"./dialog-476153c4.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const getAccessControlModeOptions=$t=>[{label:$t("constants.accessControl.modes.ipWhitelist"),value:"whitelist"},{label:$t("constants.accessControl.modes.ipBlacklist"),value:"blacklist"}],getDomainControlModeOptions=$t=>[{label:$t("constants.accessControl.modes.domainWhitelist"),value:"whitelist"},{label:$t("constants.accessControl.modes.domainBlacklist"),value:"blacklist"}],getRestrictionModeOptions=$t=>[{label:$t("constants.accessControl.restrictionModes.strict"),value:"strict"},{label:$t("constants.accessControl.restrictionModes.moderate"),value:"moderate"},{label:$t("constants.accessControl.restrictionModes.loose"),value:"loose"}],getBlockActionOptions=$t=>[{label:$t("constants.accessControl.blockActions.block"),value:"block"},{label:$t("constants.accessControl.blockActions.redirect"),value:"redirect"},{label:$t("constants.accessControl.blockActions.thumbnail"),value:"thumbnail"}],SIZE_UNIT_OPTIONS=[{label:"B",value:"B"},{label:"KB",value:"KB"},{label:"MB",value:"MB"},{label:"GB",value:"GB"},{label:"TB",value:"TB"}],QUICK_SIZE_PRESETS=[{label:"1 MB",value:1,unit:"MB"},{label:"5 MB",value:5,unit:"MB"},{label:"10 MB",value:10,unit:"MB"},{label:"50 MB",value:50,unit:"MB"},{label:"100 MB",value:100,unit:"MB"},{label:"500 MB",value:500,unit:"MB"},{label:"1 GB",value:1,unit:"GB"},{label:"10 GB",value:10,unit:"GB"}],ALL_SIZE_UNITS=[{key:"B",label:"Bytes (B)",divisor:1,precision:0},{key:"KB",label:"Kilobytes (KB)",divisor:1024,precision:2},{key:"MB",label:"Megabytes (MB)",divisor:1024*1024,precision:2},{key:"GB",label:"Gigabytes (GB)",divisor:1024*1024*1024,precision:4},{key:"TB",label:"Terabytes (TB)",divisor:1024*1024*1024*1024,precision:6}];function createApiKey(data){return post("/apikey/create",data)}function getApiKeyList(params){return get("/apikey/list",params)}function getApiKeyDetail(keyId){return get(`/apikey/${keyId}`)}function updateApiKey(keyId,data){return put(`/apikey/${keyId}`,data)}function deleteApiKey(keyId){return del(`/apikey/${keyId}`)}function toggleApiKey(keyId){return post(`/apikey/${keyId}/toggle`)}function getApiKeyStats(keyId){return get(`/apikey/${keyId}/stats`)}function regenerateApiKey(keyId){return post(`/apikey/${keyId}/regenerate`)}const index$2={createApiKey,getApiKeyList,getApiKeyDetail,updateApiKey,deleteApiKey,toggleApiKey,getApiKeyStats,regenerateApiKey},apikeyApi=Object.freeze(Object.defineProperty({__proto__:null,createApiKey,default:index$2,deleteApiKey,getApiKeyDetail,getApiKeyList,getApiKeyStats,regenerateApiKey,toggleApiKey,updateApiKey},Symbol.toStringTag,{value:"Module"}));function getUserStats(){return get("/stats")}const index$1={getUserStats},statsApi=Object.freeze(Object.defineProperty({__proto__:null,default:index$1,getUserStats},Symbol.toStringTag,{value:"Module"})),api={user:userApi,file:fileApi,folder:folderApi,stats:statsApi,apikey:apikeyApi,storage:storageApi,tag:tagApi,share:shareApi,author:authorApi},_hoisted_1$b={key:1,class:"mt-5 grid gap-6 md:grid-cols-[200px_1fr]"},_hoisted_2$a={class:"profile-avatar-card flex flex-col items-center border p-5 text-center"},_hoisted_3$a={class:"mt-3 text-xs text-content-muted"},_hoisted_4$a={class:"profile-form-card border p-5"},_hoisted_5$a={class:"space-y-2"},_hoisted_6$a={class:"block text-sm font-medium text-content"},_hoisted_7$9={class:"space-y-2"},_hoisted_8$8={class:"block text-sm font-medium text-content"},_hoisted_9$8={class:"space-y-2"},_hoisted_10$8={class:"block text-sm font-medium text-content"},_hoisted_11$8={class:"space-y-2"},_hoisted_12$8={class:"block text-sm font-medium text-content"},_hoisted_13$8={class:"flex justify-end"},_sfc_main$b=defineComponent({__name:"ProfileSection",setup(__props,{expose:__expose}){const authStore=useAuthStore(),toast=useToast(),{$t}=useTexts(),avatarInput=ref(null),avatarUrl=ref(authStore.userInfo?.avatarFullPath||authStore.userInfo?.avatar||""),avatarPath=ref(authStore.userInfo?.avatar||""),isUploading=ref(!1),isLoading=ref(!1),isSaving=ref(!1),profile=reactive({username:authStore.user?.username||"",email:"",nickname:"",website:"",bio:"",avatar:avatarPath.value||""}),fetchUserProfile=async()=>{try{isLoading.value=!0;const result=await getUserProfile();if(result.success){const userData=result.data;profile.username=userData.username||"",profile.email=userData.email||"",profile.bio=userData.bio||"",profile.website=userData.website||"",userData.avatar&&(avatarPath.value=userData.avatar,profile.avatar=userData.avatar),userData.avatarFullPath?avatarUrl.value=userData.avatarFullPath:avatarUrl.value=userData.avatar||"",authStore.setUserInfo(userData)}}catch{}finally{isLoading.value=!1}},triggerAvatarUpload=()=>{avatarInput.value?.click()},handleAvatarUpload=async event=>{const target=event.target,{files}=target;if(!files||files.length===0)return;const file=files[0];if(file.size>2*1024*1024){toast.error($t("settings.profile.avatar.sizeLimit"));return}if(!["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(file.type)){toast.error($t("settings.profile.avatar.invalidType"));return}isUploading.value=!0;try{const result=await uploadAvatar(file);if(result.success){const{data}=result;avatarUrl.value=data.full_url||data.url,avatarPath.value=data.avatar_url||data.url,profile.avatar=data.avatar_url||data.url,authStore.updateUserAvatar(data.avatar_url||data.url,data.full_url||data.url),toast.success($t("settings.profile.avatar.uploadSuccess"))}}catch{}finally{isUploading.value=!1,avatarInput.value&&(avatarInput.value.value="")}},saveProfile=async()=>{try{isSaving.value=!0;const updateData={username:profile.username,bio:profile.bio,website:profile.website,avatar:avatarPath.value},result=await updateUserProfile(updateData);result.success&&(result.data&&authStore.setUserInfo(result.data),toast.success($t("settings.profile.messages.saveSuccess")))}catch{}finally{isSaving.value=!1}};return __expose({fetchUserProfile}),(_ctx,_cache)=>{const _component_CyberLoading=resolveComponent("CyberLoading"),_component_CyberUserAvatar=resolveComponent("CyberUserAvatar"),_component_CyberButton=resolveComponent("CyberButton"),_component_CyberInput=resolveComponent("CyberInput");return openBlock(),createElementBlock("div",null,[isLoading.value?(openBlock(),createBlock(_component_CyberLoading,{key:0,visible:isLoading.value},null,8,["visible"])):(openBlock(),createElementBlock("div",_hoisted_1$b,[createBaseVNode("div",_hoisted_2$a,[createVNode(_component_CyberUserAvatar,{"avatar-url":avatarUrl.value,username:profile.username,size:"md","custom-styles":{width:"80px",height:"80px",fontSize:"1.75rem"}},null,8,["avatar-url","username"]),createBaseVNode("input",{ref_key:"avatarInput",ref:avatarInput,type:"file",class:"hidden",accept:".jpg,.jpeg,.png,.webp,.gif",onChange:handleAvatarUpload},null,544),createVNode(_component_CyberButton,{type:"secondary",icon:"upload",loading:isUploading.value,class:"mt-4 w-full",onClick:triggerAvatarUpload},{default:withCtx(()=>[createTextVNode(toDisplayString(isUploading.value?unref($t)("status.uploading"):unref($t)("settings.profile.avatar.change")),1)]),_:1},8,["loading"]),createBaseVNode("p",_hoisted_3$a,toDisplayString(unref($t)("settings.profile.avatar.hint")),1)]),createBaseVNode("div",_hoisted_4$a,[createBaseVNode("form",{class:"space-y-4",onSubmit:withModifiers(saveProfile,["prevent"])},[createBaseVNode("div",_hoisted_5$a,[createBaseVNode("label",_hoisted_6$a,toDisplayString(unref($t)("settings.profile.labels.email")),1),createVNode(_component_CyberInput,{modelValue:profile.email,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>profile.email=$event),type:"email",disabled:"",placeholder:unref($t)("settings.profile.placeholders.email"),"prefix-icon":"envelope"},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_7$9,[createBaseVNode("label",_hoisted_8$8,toDisplayString(unref($t)("settings.profile.labels.username")),1),createVNode(_component_CyberInput,{modelValue:profile.username,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>profile.username=$event),type:"text",placeholder:unref($t)("settings.profile.placeholders.username"),"prefix-icon":"user"},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_9$8,[createBaseVNode("label",_hoisted_10$8,toDisplayString(unref($t)("settings.profile.labels.website")),1),createVNode(_component_CyberInput,{modelValue:profile.website,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>profile.website=$event),type:"url",placeholder:unref($t)("settings.profile.placeholders.website"),"prefix-icon":"globe"},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_11$8,[createBaseVNode("label",_hoisted_12$8,toDisplayString(unref($t)("settings.profile.labels.bio")),1),createVNode(_component_CyberInput,{modelValue:profile.bio,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>profile.bio=$event),type:"textarea",placeholder:unref($t)("settings.profile.placeholders.bio"),rows:3},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_13$8,[createVNode(_component_CyberButton,{type:"primary",icon:"save",loading:isSaving.value},{default:withCtx(()=>[createTextVNode(toDisplayString(isSaving.value?unref($t)("settings.profile.actions.saving"):unref($t)("settings.profile.actions.save")),1)]),_:1},8,["loading"])])],32)])]))])}}});const ProfileSection=_export_sfc(_sfc_main$b,[["__scopeId","data-v-542a0c84"]]),_hoisted_1$a={class:"grid gap-6 md:grid-cols-2"},_hoisted_2$9={class:"security-card border p-5"},_hoisted_3$9={class:"text-lg font-semibold text-content-heading"},_hoisted_4$9={class:"space-y-2"},_hoisted_5$9={class:"block text-sm font-medium text-content"},_hoisted_6$9={class:"space-y-2"},_hoisted_7$8={class:"block text-sm font-medium text-content"},_hoisted_8$7={class:"text-xs text-content-muted"},_hoisted_9$7={class:"space-y-2"},_hoisted_10$7={class:"block text-sm font-medium text-content"},_hoisted_11$7={class:"flex justify-end"},_hoisted_12$7={class:"security-card border p-5"},_hoisted_13$7={class:"text-lg font-semibold text-content-heading"},_hoisted_14$6={class:"space-y-2"},_hoisted_15$5={class:"block text-sm font-medium text-content"},_hoisted_16$4={class:"text-xs text-content-muted"},_hoisted_17$4={class:"space-y-2"},_hoisted_18$4={class:"block text-sm font-medium text-content"},_hoisted_19$4={class:"space-y-2"},_hoisted_20$4={class:"block text-sm font-medium text-content"},_hoisted_21$4={class:"flex gap-2"},_hoisted_22$4={class:"text-xs text-content-muted"},_hoisted_23$4={class:"flex justify-end"},EMAIL_CODE_EXPIRE_KEY="email_code_expire_time",EMAIL_SENDING_KEY="email_sending_target",_sfc_main$a=defineComponent({__name:"SecuritySection",setup(__props){const router=useRouter(),authStore=useAuthStore(),toast=useToast(),{$t}=useTexts(),currentEmail=ref(""),security=reactive({currentPassword:"",newPassword:"",confirmPassword:""}),isChangingPassword=ref(!1),emailChange=reactive({newEmail:"",code:""}),isChangingEmail=ref(!1),isSendingCode=ref(!1),countDown=ref(0);let timer=null;watch(()=>authStore.user,newUserInfo=>{newUserInfo?.email&&(currentEmail.value=newUserInfo.email)},{immediate:!0}),onMounted(()=>{authStore.user?.email&&(currentEmail.value=authStore.user.email),checkExistingCodeTimer()}),onBeforeUnmount(()=>{clearCountdownTimer()});const checkExistingCodeTimer=()=>{const expireTime=StorageUtil.get(EMAIL_CODE_EXPIRE_KEY),targetEmail=StorageUtil.get(EMAIL_SENDING_KEY);if(!expireTime||!targetEmail)return;const now=Date.now();if(expireTime>now){const remainingSeconds=Math.ceil((expireTime-now)/1e3);remainingSeconds>0&&(countDown.value=remainingSeconds,startCountdown())}else StorageUtil.remove(EMAIL_CODE_EXPIRE_KEY),StorageUtil.remove(EMAIL_SENDING_KEY)},startCountdown=()=>{clearCountdownTimer(),timer=window.setInterval(()=>{countDown.value-=1,countDown.value<=0&&(clearCountdownTimer(),StorageUtil.remove(EMAIL_CODE_EXPIRE_KEY),StorageUtil.remove(EMAIL_SENDING_KEY))},1e3)},clearCountdownTimer=()=>{timer&&(clearInterval(timer),timer=null)},changePassword=async()=>{if(!security.currentPassword){toast.error($t("settings.security.password.messages.currentRequired"));return}if(!security.newPassword){toast.error($t("settings.security.password.messages.nextRequired"));return}if(security.newPassword!==security.confirmPassword){toast.error($t("settings.security.password.messages.confirmMismatch"));return}if(security.newPassword.length<6){toast.error($t("settings.security.password.messages.minLength"));return}try{isChangingPassword.value=!0,(await updatePassword({oldPassword:security.currentPassword,newPassword:security.newPassword})).success&&(toast.success($t("settings.security.password.messages.success")),security.currentPassword="",security.newPassword="",security.confirmPassword="",authStore.logout(),router.push("/auth"))}catch{}finally{isChangingPassword.value=!1}},sendVerificationCode=async()=>{if(!emailChange.newEmail){toast.error($t("settings.security.email.messages.nextRequired"));return}if(emailChange.newEmail===currentEmail.value){toast.error($t("settings.security.email.messages.sameAsCurrent"));return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailChange.newEmail)){toast.error($t("settings.security.email.messages.invalidEmail"));return}try{if(isSendingCode.value=!0,(await sendChangeEmailCode({new_email:emailChange.newEmail})).success){toast.success($t("settings.security.email.messages.codeSent")),countDown.value=60;const expireTime=Date.now()+60*1e3;StorageUtil.set(EMAIL_CODE_EXPIRE_KEY,expireTime),StorageUtil.set(EMAIL_SENDING_KEY,emailChange.newEmail),startCountdown()}}catch{}finally{isSendingCode.value=!1}},handleChangeEmail=async()=>{if(!emailChange.newEmail){toast.error($t("settings.security.email.messages.nextRequired"));return}if(!emailChange.code){toast.error($t("settings.security.email.messages.codeRequired"));return}if(emailChange.newEmail===currentEmail.value){toast.error($t("settings.security.email.messages.sameAsCurrent"));return}try{isChangingEmail.value=!0,(await changeEmail({new_email:emailChange.newEmail,code:emailChange.code})).success&&(authStore.user&&(authStore.updateUserInfo({email:emailChange.newEmail}),currentEmail.value=emailChange.newEmail),toast.success($t("settings.security.email.messages.success")),emailChange.newEmail="",emailChange.code="",clearCountdownTimer(),StorageUtil.remove(EMAIL_CODE_EXPIRE_KEY),StorageUtil.remove(EMAIL_SENDING_KEY))}catch{}finally{isChangingEmail.value=!1}};return(_ctx,_cache)=>{const _component_CyberInput=resolveComponent("CyberInput"),_component_CyberButton=resolveComponent("CyberButton");return openBlock(),createElementBlock("div",_hoisted_1$a,[createBaseVNode("div",_hoisted_2$9,[createBaseVNode("h3",_hoisted_3$9,toDisplayString(unref($t)("settings.security.password.title")),1),createBaseVNode("form",{class:"mt-4 space-y-4",onSubmit:withModifiers(changePassword,["prevent"])},[createBaseVNode("div",_hoisted_4$9,[createBaseVNode("label",_hoisted_5$9,toDisplayString(unref($t)("settings.security.password.labels.current")),1),createVNode(_component_CyberInput,{modelValue:security.currentPassword,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>security.currentPassword=$event),type:"password",placeholder:unref($t)("settings.security.password.placeholders.current"),"prefix-icon":"key",required:""},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_6$9,[createBaseVNode("label",_hoisted_7$8,toDisplayString(unref($t)("settings.security.password.labels.next")),1),createVNode(_component_CyberInput,{modelValue:security.newPassword,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>security.newPassword=$event),type:"password",placeholder:unref($t)("settings.security.password.placeholders.next"),"prefix-icon":"lock",required:"",minlength:"6"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_8$7,toDisplayString(unref($t)("settings.security.password.hint")),1)]),createBaseVNode("div",_hoisted_9$7,[createBaseVNode("label",_hoisted_10$7,toDisplayString(unref($t)("settings.security.password.labels.confirm")),1),createVNode(_component_CyberInput,{modelValue:security.confirmPassword,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>security.confirmPassword=$event),type:"password",placeholder:unref($t)("settings.security.password.placeholders.confirm"),"prefix-icon":"check-circle",required:""},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_11$7,[createVNode(_component_CyberButton,{type:"secondary",icon:"key",loading:isChangingPassword.value},{default:withCtx(()=>[createTextVNode(toDisplayString(isChangingPassword.value?unref($t)("settings.security.password.actions.submitting"):unref($t)("settings.security.password.actions.submit")),1)]),_:1},8,["loading"])])],32)]),createBaseVNode("div",_hoisted_12$7,[createBaseVNode("h3",_hoisted_13$7,toDisplayString(unref($t)("settings.security.email.title")),1),createBaseVNode("form",{class:"mt-4 space-y-4",onSubmit:withModifiers(handleChangeEmail,["prevent"])},[createBaseVNode("div",_hoisted_14$6,[createBaseVNode("label",_hoisted_15$5,toDisplayString(unref($t)("settings.security.email.labels.current")),1),createVNode(_component_CyberInput,{modelValue:currentEmail.value,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>currentEmail.value=$event),disabled:"",type:"email",placeholder:unref($t)("settings.security.email.placeholders.current"),"prefix-icon":"envelope"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_16$4,toDisplayString(unref($t)("settings.security.email.currentHint")),1)]),createBaseVNode("div",_hoisted_17$4,[createBaseVNode("label",_hoisted_18$4,toDisplayString(unref($t)("settings.security.email.labels.next")),1),createVNode(_component_CyberInput,{modelValue:emailChange.newEmail,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>emailChange.newEmail=$event),type:"email",placeholder:unref($t)("settings.security.email.placeholders.next"),"prefix-icon":"envelope",required:""},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_19$4,[createBaseVNode("label",_hoisted_20$4,toDisplayString(unref($t)("settings.security.email.labels.code")),1),createBaseVNode("div",_hoisted_21$4,[createVNode(_component_CyberInput,{modelValue:emailChange.code,"onUpdate:modelValue":_cache[5]||(_cache[5]=$event=>emailChange.code=$event),type:"text",placeholder:unref($t)("settings.security.email.placeholders.code"),"prefix-icon":"shield-alt",required:""},null,8,["modelValue","placeholder"]),createVNode(_component_CyberButton,{type:"outlined",disabled:isSendingCode.value||countDown.value>0,loading:isSendingCode.value,onClick:withModifiers(sendVerificationCode,["prevent"])},{default:withCtx(()=>[createTextVNode(toDisplayString(countDown.value>0?unref($t)("settings.security.email.actions.sendCodeCountdown",{seconds:countDown.value}):unref($t)("settings.security.email.actions.sendCode")),1)]),_:1},8,["disabled","loading"])]),createBaseVNode("p",_hoisted_22$4,toDisplayString(unref($t)("settings.security.email.codeHint")),1)]),createBaseVNode("div",_hoisted_23$4,[createVNode(_component_CyberButton,{type:"secondary",icon:"exchange-alt",loading:isChangingEmail.value},{default:withCtx(()=>[createTextVNode(toDisplayString(isChangingEmail.value?unref($t)("settings.security.email.actions.submitting"):unref($t)("settings.security.email.actions.submit")),1)]),_:1},8,["loading"])])],32)])])}}});const SecuritySection=_export_sfc(_sfc_main$a,[["__scopeId","data-v-50e82529"]]),_hoisted_1$9={class:"size-converter-panel"},_hoisted_2$8={class:"panel-header"},_hoisted_3$8={class:"header-content"},_hoisted_4$8={class:"title-wrapper"},_hoisted_5$8={class:"title-text"},_hoisted_6$8={class:"title"},_hoisted_7$7={class:"subtitle"},_hoisted_8$6={class:"panel-content"},_hoisted_9$6={class:"presets-section"},_hoisted_10$6={class:"section-label"},_hoisted_11$6={class:"presets-grid"},_hoisted_12$6=["onClick"],_hoisted_13$6={class:"conversion-section"},_hoisted_14$5={class:"flex items-center gap-4"},_hoisted_15$4={class:"input-group"},_hoisted_16$3={class:"input-label"},_hoisted_17$3={class:"input-group"},_hoisted_18$3={class:"input-label"},_hoisted_19$3={class:"result-group"},_hoisted_20$3={class:"input-label"},_hoisted_21$3={class:"result-display"},_hoisted_22$3={class:"result-number"},_hoisted_23$3={class:"result-unit"},_hoisted_24$3=["title"],_hoisted_25$3={class:"table-section"},_hoisted_26$3={class:"table-header"},_hoisted_27$3={class:"table-title"},_hoisted_28$3=["title"],_hoisted_29$3={class:"table-grid"},_hoisted_30$3={class:"unit-label"},_hoisted_31$3={class:"unit-value"},_hoisted_32$3=["title","onClick"],_hoisted_33$3={class:"info-section"},_hoisted_34$3={class:"info-grid"},_hoisted_35$3={class:"info-item"},_hoisted_36$3={class:"info-item"},_sfc_main$9=defineComponent({__name:"SizeConverter",setup(__props){const toast=useToast(),{$t}=useTexts(),quickPresets=QUICK_SIZE_PRESETS,sizeUnitOptions=SIZE_UNIT_OPTIONS,allUnits=ALL_SIZE_UNITS,converter=reactive({value:100,unit:"MB"}),bytesValue=computed(()=>!converter.value||converter.value<=0?0:unitToBytes(converter.value,converter.unit)),unitToBytes=(value,unit)=>Math.round(value*({B:1,KB:1024,MB:1048576,GB:1073741824,TB:1099511627776}[unit]||1)),formatNumber=num=>num.toLocaleString(getCurrentLocale()),formatUnitValue=(bytes,divisor,precision)=>bytes===0?"0":divisor===1?formatNumber(bytes):(bytes/divisor).toFixed(precision),setPreset=preset=>{converter.value=preset.value,converter.unit=preset.unit},isPresetActive=preset=>converter.value===preset.value&&converter.unit===preset.unit,bytesCopied=ref(!1),copyBytesValue=()=>{copyToClipboard(bytesValue.value.toString(),$t("settings.sizeConverter.bytesLabel"))},copyUnitValue=unit=>{const value=formatUnitValue(bytesValue.value,unit.divisor,unit.precision);copyToClipboard(value,unit.label)},copyAllValues=()=>{const allValues=allUnits.map(unit=>{const value=formatUnitValue(bytesValue.value,unit.divisor,unit.precision);return`${unit.label}: ${value}`}).join(`
`);copyToClipboard(allValues,$t("settings.sizeConverter.copyAllLabel"))},copyToClipboard=async(text,label)=>{await navigator.clipboard.writeText(text)&&toast.success($t("settings.sizeConverter.copySuccess",{label}))},onValueChange=()=>{},onUnitChange=()=>{};return(_ctx,_cache)=>{const _component_CyberInput=resolveComponent("CyberInput"),_component_CyberDropdown=resolveComponent("CyberDropdown");return openBlock(),createElementBlock("div",_hoisted_1$9,[createBaseVNode("div",_hoisted_2$8,[createBaseVNode("div",_hoisted_3$8,[createBaseVNode("div",_hoisted_4$8,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"title-icon"},[createBaseVNode("i",{class:"fas fa-exchange-alt"})],-1)),createBaseVNode("div",_hoisted_5$8,[createBaseVNode("h3",_hoisted_6$8,toDisplayString(unref($t)("settings.sizeConverter.title")),1),createBaseVNode("p",_hoisted_7$7,toDisplayString(unref($t)("settings.sizeConverter.subtitle")),1)])])])]),createBaseVNode("div",_hoisted_8$6,[createBaseVNode("div",_hoisted_9$6,[createBaseVNode("label",_hoisted_10$6,toDisplayString(unref($t)("settings.sizeConverter.presets")),1),createBaseVNode("div",_hoisted_11$6,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(quickPresets),preset=>(openBlock(),createElementBlock("button",{key:preset.label,class:normalizeClass(["preset-btn",{"preset-active":isPresetActive(preset)}]),onClick:$event=>setPreset(preset)},toDisplayString(preset.label),11,_hoisted_12$6))),128))])]),createBaseVNode("div",_hoisted_13$6,[createBaseVNode("div",_hoisted_14$5,[createBaseVNode("div",_hoisted_15$4,[createBaseVNode("label",_hoisted_16$3,toDisplayString(unref($t)("settings.sizeConverter.valueLabel")),1),createVNode(_component_CyberInput,{modelValue:converter.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>converter.value=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("settings.sizeConverter.valueLabel"),min:"0",step:"0.01",class:"w-32",onInput:onValueChange},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_17$3,[createBaseVNode("label",_hoisted_18$3,toDisplayString(unref($t)("settings.sizeConverter.unitLabel")),1),createVNode(_component_CyberDropdown,{modelValue:converter.unit,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>converter.unit=$event),options:unref(sizeUnitOptions),class:"w-20",onChange:onUnitChange},null,8,["modelValue","options"])]),_cache[3]||(_cache[3]=createBaseVNode("div",{class:"equals-sign"},[createBaseVNode("i",{class:"fas fa-equals text-content"})],-1)),createBaseVNode("div",_hoisted_19$3,[createBaseVNode("label",_hoisted_20$3,toDisplayString(unref($t)("settings.sizeConverter.bytesLabel")),1),createBaseVNode("div",_hoisted_21$3,[createBaseVNode("span",_hoisted_22$3,toDisplayString(formatNumber(bytesValue.value)),1),createBaseVNode("span",_hoisted_23$3,toDisplayString(unref($t)("settings.sizeConverter.bytes")),1),createBaseVNode("button",{class:"copy-btn",title:unref($t)("settings.sizeConverter.copyBytes"),onClick:copyBytesValue},[createBaseVNode("i",{class:normalizeClass(["fas",bytesCopied.value?"fa-check":"fa-copy"])},null,2)],8,_hoisted_24$3)])])])]),createBaseVNode("div",_hoisted_25$3,[createBaseVNode("div",_hoisted_26$3,[createBaseVNode("span",_hoisted_27$3,toDisplayString(unref($t)("settings.sizeConverter.detailTitle")),1),createBaseVNode("button",{class:"copy-all-btn",title:unref($t)("settings.sizeConverter.copyAll"),onClick:copyAllValues},[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-clipboard mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.sizeConverter.copyAll")),1)],8,_hoisted_28$3)]),createBaseVNode("div",_hoisted_29$3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(allUnits),unit=>(openBlock(),createElementBlock("div",{key:unit.key,class:"table-item"},[createBaseVNode("div",_hoisted_30$3,toDisplayString(unit.label),1),createBaseVNode("div",_hoisted_31$3,[createTextVNode(toDisplayString(formatUnitValue(bytesValue.value,unit.divisor,unit.precision))+" ",1),createBaseVNode("button",{class:"unit-copy-btn",title:unref($t)("settings.sizeConverter.copyUnit",{label:unit.label}),onClick:$event=>copyUnitValue(unit)},[..._cache[5]||(_cache[5]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])],8,_hoisted_32$3)])]))),128))])]),createBaseVNode("div",_hoisted_33$3,[createBaseVNode("div",_hoisted_34$3,[createBaseVNode("div",_hoisted_35$3,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-info-circle info-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.sizeConverter.info.usage")),1)]),createBaseVNode("div",_hoisted_36$3,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-lightbulb info-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.sizeConverter.info.calculation")),1)])])])])])}}});const SizeConverter=_export_sfc(_sfc_main$9,[["__scopeId","data-v-15e94a62"]]),_hoisted_1$8={class:"mb-6 flex items-center justify-between"},_hoisted_2$7={class:"text-lg font-semibold"},_hoisted_3$7={class:"text-sm text-brand-700"},_hoisted_4$7={key:0,class:"flex items-center justify-center py-12"},_hoisted_5$7={key:1,class:"mb-4 radius-sm flex flex-col items-center justify-center border border-subtle bg-background-800 p-8 text-center"},_hoisted_6$7={class:"mb-2 text-lg font-semibold"},_hoisted_7$6={class:"mb-4 max-w-sm text-center text-sm text-brand-700"},_hoisted_8$5={key:2},_hoisted_9$5={class:"mb-2 flex items-start justify-between"},_hoisted_10$5={class:"flex-1"},_hoisted_11$5={class:"mb-1 flex items-center gap-3"},_hoisted_12$5={class:"text-sm font-semibold text-content"},_hoisted_13$5={class:"flex items-center gap-2"},_hoisted_14$4={key:0,class:"status-badge status-expired text-xs"},_hoisted_15$3={class:"flex items-center gap-4 text-xs text-brand-600"},_hoisted_16$2={key:0},_hoisted_17$2={class:"flex items-center gap-2"},_hoisted_18$2=["title","onClick"],_hoisted_19$2={class:"ml-1 text-xs font-medium"},_hoisted_20$2={class:"flex items-center gap-1"},_hoisted_21$2={key:0,class:"api-key-display-section mb-3 mt-3 p-3"},_hoisted_22$2={class:"mb-2 flex items-center justify-between"},_hoisted_23$2={class:"flex items-center gap-2"},_hoisted_24$2={class:"text-xs font-medium text-brand-800"},_hoisted_25$2={class:"flex items-center gap-2"},_hoisted_26$2=["title","onClick"],_hoisted_27$2=["title","onClick"],_hoisted_28$2={class:"api-key-value"},_hoisted_29$2={class:"api-key-text"},_hoisted_30$2={class:"grid grid-cols-1 gap-2 md:grid-cols-3"},_hoisted_31$2={class:"usage-stat"},_hoisted_32$2={class:"stat-header"},_hoisted_33$2={class:"stat-label"},_hoisted_34$2={class:"stat-value"},_hoisted_35$2={class:"progress-container"},_hoisted_36$2={class:"progress-bar"},_hoisted_37$2={class:"progress-text"},_hoisted_38$2={class:"usage-stat"},_hoisted_39$2={class:"stat-header"},_hoisted_40$2={class:"stat-label"},_hoisted_41$2={class:"stat-value"},_hoisted_42$2={class:"progress-container"},_hoisted_43$2={class:"progress-bar"},_hoisted_44$2={class:"progress-text"},_hoisted_45$2={class:"usage-stat"},_hoisted_46$2={class:"stat-header"},_hoisted_47$2={class:"stat-label"},_hoisted_48$2={class:"stat-value"},_hoisted_49$2={class:"file-types-preview"},_hoisted_50$2={class:"text-xs text-brand-600"},_hoisted_51$2={key:0,class:"mt-6 flex justify-center"},_sfc_main$8=defineComponent({__name:"ApiKeyList",props:{apiKeys:{},isLoading:{type:Boolean},pagination:{}},emits:["create","edit","detail","delete","toggle","change-page"],setup(__props,{emit:__emit}){const emit=__emit,formatDate=dateString=>dateString?new Date(dateString).toLocaleString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",{$t}=useTexts(),formatSize=bytes=>{if(bytes===0)return $t("settings.apiKeys.text.unlimited");const k=1024,sizes=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},getStatusClass=key=>key.is_active?"status-active":"status-inactive",getStorageText=key=>{const used=key.storage_used===0?"0 B":formatSize(key.storage_used||0),limit=key.storage_limit===0?$t("settings.apiKeys.text.unlimited"):formatSize(key.storage_limit);return`${used} / ${limit}`},getStorageProgress=key=>key.storage_limit===0?0:Math.min((key.storage_used||0)/key.storage_limit*100,100),getStorageProgressText=key=>key.storage_limit===0?$t("settings.apiKeys.text.unlimited"):`${Math.round((key.storage_used||0)/key.storage_limit*100)}%`,getUploadText=key=>{const used=key.upload_count_used||0,limit=key.upload_count_limit===0?$t("settings.apiKeys.text.unlimited"):key.upload_count_limit.toString();return`${used} / ${limit}`},getUploadProgress=key=>key.upload_count_limit===0?0:Math.min((key.upload_count_used||0)/key.upload_count_limit*100,100),getUploadProgressText=key=>key.upload_count_limit===0?$t("settings.apiKeys.text.unlimited"):`${Math.round((key.upload_count_used||0)/key.upload_count_limit*100)}%`,getSingleFileLimitText=key=>key.single_file_limit===0?$t("settings.apiKeys.text.unlimited"):formatSize(key.single_file_limit),getFileTypesText=key=>!key.allowed_types||key.allowed_types.length===0?$t("settings.apiKeys.text.unlimitedFiles"):key.allowed_types.length>2?`${key.allowed_types.slice(0,2).join(", ")}${$t("settings.apiKeys.text.fileTypeMore",{count:key.allowed_types.length})}`:key.allowed_types.join(", "),onCreateClick=()=>{emit("create")},onEditClick=key=>{emit("edit",key)},onDetailClick=key=>{emit("detail",key)},onDeleteClick=key=>{emit("delete",key)},onToggleClick=key=>{emit("toggle",key)},changePage=page=>{emit("change-page",page)},toast=useToast(),visibleKeys=ref(new Set),toggleKeyVisibility=keyId=>{visibleKeys.value.has(keyId)?visibleKeys.value.delete(keyId):visibleKeys.value.add(keyId)},isKeyVisible=keyId=>visibleKeys.value.has(keyId),maskApiKey=key=>{if(!key)return"";const visibleLength=8;return key.length<=visibleLength?"*".repeat(key.length):key.substring(0,visibleLength)+"*".repeat(Math.max(12,key.length-visibleLength))},copyApiKey=async(key,keyName)=>{if(!key){toast.error($t("settings.apiKeys.toasts.emptyKey"));return}try{await navigator.clipboard.writeText(key),toast.success($t("settings.apiKeys.toasts.copySuccess",{name:keyName}))}catch{try{const textArea=document.createElement("textarea");textArea.value=key,textArea.style.position="fixed",textArea.style.opacity="0",document.body.appendChild(textArea),textArea.select(),document.execCommand("copy"),document.body.removeChild(textArea),toast.success($t("settings.apiKeys.toasts.copySuccess",{name:keyName}))}catch{toast.error($t("settings.apiKeys.toasts.copyFallbackError"))}}};return(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton"),_component_CyberPagination=resolveComponent("CyberPagination");return openBlock(),createElementBlock("div",null,[createBaseVNode("div",_hoisted_1$8,[createBaseVNode("div",null,[createBaseVNode("h3",_hoisted_2$7,toDisplayString(unref($t)("settings.apiKeys.header.title")),1),createBaseVNode("p",_hoisted_3$7,toDisplayString(unref($t)("settings.apiKeys.header.subtitle")),1)]),createVNode(_component_CyberButton,{type:"secondary",icon:"plus",onClick:onCreateClick},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.apiKeys.header.create")),1)]),_:1})]),__props.isLoading?(openBlock(),createElementBlock("div",_hoisted_4$7,[..._cache[0]||(_cache[0]=[createBaseVNode("div",{class:"loading-spinner"},[createBaseVNode("i",{class:"fas fa-spinner fa-spin text-3xl text-content"})],-1)])])):__props.apiKeys.length?(openBlock(),createElementBlock("div",_hoisted_8$5,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.apiKeys,key=>(openBlock(),createElementBlock("div",{key:key.id,class:"api-key-card mb-2 p-3 transition-all duration-200"},[createBaseVNode("div",_hoisted_9$5,[createBaseVNode("div",_hoisted_10$5,[createBaseVNode("div",_hoisted_11$5,[createBaseVNode("h4",_hoisted_12$5,toDisplayString(key.name),1),createBaseVNode("div",_hoisted_13$5,[createBaseVNode("span",{class:normalizeClass(["status-badge text-xs",getStatusClass(key)])},[createBaseVNode("i",{class:normalizeClass(["fas",key.is_active?"fa-check-circle":"fa-times-circle"])},null,2),createTextVNode(" "+toDisplayString(key.status_text||(key.is_active?unref($t)("settings.apiKeys.status.active"):unref($t)("settings.apiKeys.status.inactive"))),1)],2),key.is_expired?(openBlock(),createElementBlock("span",_hoisted_14$4,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.apiKeys.status.expired")),1)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_15$3,[createBaseVNode("span",null,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-calendar-alt mr-1"},null,-1)),createTextVNode(" "+toDisplayString(formatDate(key.created_at)),1)]),key.folder_path?(openBlock(),createElementBlock("span",_hoisted_16$2,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-folder-tree mr-1 text-brand-400"},null,-1)),createTextVNode(" "+toDisplayString(key.folder_path),1)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_17$2,[createBaseVNode("button",{class:normalizeClass(["status-toggle-btn",key.is_active?"status-active":"status-inactive"]),title:key.is_active?unref($t)("settings.apiKeys.tooltips.disable"):unref($t)("settings.apiKeys.tooltips.enable"),onClick:$event=>onToggleClick(key)},[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-power-off text-xs"},null,-1)),createBaseVNode("span",_hoisted_19$2,toDisplayString(key.is_active?unref($t)("settings.apiKeys.actions.enable"):unref($t)("settings.apiKeys.actions.disable")),1)],10,_hoisted_18$2),createBaseVNode("div",_hoisted_20$2,[createVNode(_component_CyberButton,{type:"ghost",title:unref($t)("settings.apiKeys.actions.view"),"no-border":"",class:"action-btn",onClick:$event=>onDetailClick(key)},{default:withCtx(()=>[..._cache[6]||(_cache[6]=[createBaseVNode("i",{class:"fas fa-eye"},null,-1)])]),_:1},8,["title","onClick"]),createVNode(_component_CyberButton,{type:"ghost",title:unref($t)("settings.apiKeys.actions.edit"),"no-border":"",class:"action-btn",onClick:$event=>onEditClick(key)},{default:withCtx(()=>[..._cache[7]||(_cache[7]=[createBaseVNode("i",{class:"fas fa-edit"},null,-1)])]),_:1},8,["title","onClick"]),createVNode(_component_CyberButton,{type:"ghost",title:unref($t)("settings.apiKeys.actions.delete"),"no-border":"",class:"action-btn action-btn-danger",onClick:$event=>onDeleteClick(key)},{default:withCtx(()=>[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fas fa-trash"},null,-1)])]),_:1},8,["title","onClick"])])])]),key.key?(openBlock(),createElementBlock("div",_hoisted_21$2,[createBaseVNode("div",_hoisted_22$2,[createBaseVNode("div",_hoisted_23$2,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-key text-sm text-content"},null,-1)),createBaseVNode("span",_hoisted_24$2,toDisplayString(unref($t)("settings.apiKeys.fields.apiKey")),1)]),createBaseVNode("div",_hoisted_25$2,[createBaseVNode("button",{class:"visibility-btn",title:isKeyVisible(key.id)?unref($t)("settings.apiKeys.tooltips.hideKey"):unref($t)("settings.apiKeys.tooltips.showKey"),onClick:$event=>toggleKeyVisibility(key.id)},[createBaseVNode("i",{class:normalizeClass(["fas text-xs",isKeyVisible(key.id)?"fa-eye-slash":"fa-eye"])},null,2)],8,_hoisted_26$2),createBaseVNode("button",{class:"copy-btn",title:unref($t)("settings.apiKeys.tooltips.copy"),onClick:$event=>copyApiKey(key.key,key.name)},[..._cache[10]||(_cache[10]=[createBaseVNode("i",{class:"fas fa-copy text-xs"},null,-1)])],8,_hoisted_27$2)])]),createBaseVNode("div",_hoisted_28$2,[createBaseVNode("code",_hoisted_29$2,toDisplayString(isKeyVisible(key.id)?key.key:maskApiKey(key.key)),1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_30$2,[createBaseVNode("div",_hoisted_31$2,[createBaseVNode("div",_hoisted_32$2,[_cache[11]||(_cache[11]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-hdd text-content"})],-1)),createBaseVNode("div",null,[createBaseVNode("div",_hoisted_33$2,toDisplayString(unref($t)("settings.apiKeys.fields.storage")),1),createBaseVNode("div",_hoisted_34$2,toDisplayString(getStorageText(key)),1)])]),createBaseVNode("div",_hoisted_35$2,[createBaseVNode("div",_hoisted_36$2,[createBaseVNode("div",{class:"progress-fill storage-progress",style:normalizeStyle({width:`${getStorageProgress(key)}%`})},null,4)]),createBaseVNode("div",_hoisted_37$2,toDisplayString(getStorageProgressText(key)),1)])]),createBaseVNode("div",_hoisted_38$2,[createBaseVNode("div",_hoisted_39$2,[_cache[12]||(_cache[12]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-upload text-error-400"})],-1)),createBaseVNode("div",null,[createBaseVNode("div",_hoisted_40$2,toDisplayString(unref($t)("settings.apiKeys.fields.uploadCount")),1),createBaseVNode("div",_hoisted_41$2,toDisplayString(getUploadText(key)),1)])]),createBaseVNode("div",_hoisted_42$2,[createBaseVNode("div",_hoisted_43$2,[createBaseVNode("div",{class:"progress-fill upload-progress",style:normalizeStyle({width:`${getUploadProgress(key)}%`})},null,4)]),createBaseVNode("div",_hoisted_44$2,toDisplayString(getUploadProgressText(key)),1)])]),createBaseVNode("div",_hoisted_45$2,[createBaseVNode("div",_hoisted_46$2,[_cache[13]||(_cache[13]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-file text-success-400"})],-1)),createBaseVNode("div",null,[createBaseVNode("div",_hoisted_47$2,toDisplayString(unref($t)("settings.apiKeys.fields.singleFileLimit")),1),createBaseVNode("div",_hoisted_48$2,toDisplayString(getSingleFileLimitText(key)),1)])]),createBaseVNode("div",_hoisted_49$2,[createBaseVNode("div",_hoisted_50$2,toDisplayString(unref($t)("settings.apiKeys.fields.fileTypes"))+": "+toDisplayString(getFileTypesText(key)),1)])])])]))),128)),__props.pagination.total_pages>1?(openBlock(),createElementBlock("div",_hoisted_51$2,[createVNode(_component_CyberPagination,{total:__props.pagination.total,size:__props.pagination.size,"current-page":__props.pagination.page,"onUpdate:currentPage":changePage},null,8,["total","size","current-page"])])):createCommentVNode("",!0)])):(openBlock(),createElementBlock("div",_hoisted_5$7,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"empty-icon-container mb-4"},[createBaseVNode("i",{class:"fas fa-key"})],-1)),createBaseVNode("h4",_hoisted_6$7,toDisplayString(unref($t)("settings.apiKeys.empty.title")),1),createBaseVNode("p",_hoisted_7$6,toDisplayString(unref($t)("settings.apiKeys.empty.description")),1),createVNode(_component_CyberButton,{type:"secondary",icon:"plus",onClick:onCreateClick},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.apiKeys.empty.action")),1)]),_:1})]))])}}});const ApiKeyList=_export_sfc(_sfc_main$8,[["__scopeId","data-v-f34b8f3b"]]),_hoisted_1$7={class:"mb-6 grid grid-cols-1 gap-6"},_hoisted_2$6={class:"mb-2 block text-content"},_hoisted_3$6={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},_hoisted_4$6={class:"mb-2 block text-content"},_hoisted_5$6={class:"mt-1 text-xs text-brand-600"},_hoisted_6$6={class:"mb-2 block text-content"},_hoisted_7$5={class:"mt-1 text-xs text-brand-600"},_hoisted_8$4={class:"mb-2 block text-content"},_hoisted_9$4={class:"mt-1 text-xs text-brand-600"},_hoisted_10$4={class:"mb-2 block text-content"},_hoisted_11$4={class:"mt-1 text-xs text-brand-600"},_hoisted_12$4={class:"mb-2 block text-content"},_hoisted_13$4={class:"mt-1 text-xs text-brand-600"},_hoisted_14$3={class:"mb-2 block text-content"},_hoisted_15$2={class:"mt-1 text-xs text-brand-600"},_sfc_main$7=defineComponent({__name:"ApiKeyForm",props:{initialData:{},isEditing:{type:Boolean}},emits:["submit","form-changed"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,emit=__emit,{$t}=useTexts(),fileTypeOptions=ref([{label:$t("settings.apiKeys.text.allFileTypes"),value:"*"}]),storageSizeOptions=getStorageSizeOptions($t),fileSizeOptions=getFileSizeOptions($t),form=reactive({name:"",storage_limit:0,single_file_limit:10*1024*1024,upload_count_limit:0,allowed_types:[],folder_id:"",expires_in_days:void 0}),selectedFolderPath=ref(""),formatSize=bytes=>{if(bytes===0)return $t("settings.apiKeys.text.unlimited");const k=1024,sizes=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},loadFileTypes=async()=>{try{const resp=await get("/config/upload/capabilities"),exts=resp?.data?.supported_extensions||[],mimeMap=resp?.data?.mime_map||{};if(Array.isArray(exts)&&exts.length>0){const options=[{label:$t("settings.apiKeys.text.allFileTypes"),value:"*"}];exts.forEach(ext=>{const mime=mimeMap[ext]||`image/${ext}`,label=`${ext.toUpperCase()}${$t("settings.apiKeys.text.file")}`;options.push({label,value:mime})}),fileTypeOptions.value=options}}catch(error){console.warn("Failed to load file types, using default options:",error)}},initForm=()=>{form.storage_limit=0,form.single_file_limit=10*1024*1024,form.upload_count_limit=0,props.initialData&&(Object.keys(props.initialData).forEach(key=>{props.initialData[key]!==void 0&&(form[key]=props.initialData[key])}),props.initialData.folder_id&&(selectedFolderPath.value=props.initialData.folder_id))};onMounted(async()=>{await loadFileTypes(),initForm()});const handleFolderSelected=folder=>{folder?selectedFolderPath.value=folder.path||folder.fullPath||folder.name:selectedFolderPath.value=""};watch(form,newForm=>{emit("form-changed",{...newForm})},{deep:!0});const onSubmit=()=>{const formData={...form};formData.allowed_types.includes("*")&&(formData.allowed_types=["*"]),formData.allowed_types.length===0&&(formData.allowed_types=["*"]),emit("submit",formData)};return __expose({getFormData:()=>({...form}),form}),(_ctx,_cache)=>{const _component_CyberInput=resolveComponent("CyberInput"),_component_CyberDropdown=resolveComponent("CyberDropdown"),_component_CyberFolderTree=resolveComponent("CyberFolderTree");return openBlock(),createElementBlock("form",{onSubmit:withModifiers(onSubmit,["prevent"])},[createBaseVNode("div",_hoisted_1$7,[createBaseVNode("div",null,[createBaseVNode("label",_hoisted_2$6,toDisplayString(unref($t)("settings.apiKeys.form.nameLabel")),1),createVNode(_component_CyberInput,{modelValue:form.name,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>form.name=$event),type:"text",placeholder:unref($t)("settings.apiKeys.form.namePlaceholder"),required:""},null,8,["modelValue","placeholder"])]),createBaseVNode("div",_hoisted_3$6,[createBaseVNode("div",null,[createBaseVNode("label",_hoisted_4$6,toDisplayString(unref($t)("settings.apiKeys.form.storageLimitLabel")),1),createVNode(_component_CyberDropdown,{modelValue:form.storage_limit,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>form.storage_limit=$event),options:unref(storageSizeOptions),searchable:"",placeholder:unref($t)("settings.apiKeys.form.storageLimitPlaceholder"),"allow-create":"","create-label":unref($t)("settings.apiKeys.form.storageLimitCreateLabel")},null,8,["modelValue","options","placeholder","create-label"]),createBaseVNode("p",_hoisted_5$6,toDisplayString(unref($t)("settings.apiKeys.form.storageLimitHint",{value:formatSize(form.storage_limit)})),1)]),createBaseVNode("div",null,[createBaseVNode("label",_hoisted_6$6,toDisplayString(unref($t)("settings.apiKeys.form.singleFileLimitLabel")),1),createVNode(_component_CyberDropdown,{modelValue:form.single_file_limit,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>form.single_file_limit=$event),options:unref(fileSizeOptions),searchable:"",placeholder:unref($t)("settings.apiKeys.form.singleFileLimitPlaceholder"),"allow-create":"","create-label":unref($t)("settings.apiKeys.form.storageLimitCreateLabel")},null,8,["modelValue","options","placeholder","create-label"]),createBaseVNode("p",_hoisted_7$5,toDisplayString(unref($t)("settings.apiKeys.form.singleFileLimitHint",{value:formatSize(form.single_file_limit)})),1)]),createBaseVNode("div",null,[createBaseVNode("label",_hoisted_8$4,toDisplayString(unref($t)("settings.apiKeys.form.uploadLimitLabel")),1),createVNode(_component_CyberInput,{modelValue:form.upload_count_limit,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>form.upload_count_limit=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("settings.apiKeys.form.uploadLimitPlaceholder"),min:"0"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_9$4,toDisplayString(unref($t)("settings.apiKeys.form.uploadLimitHint",{suffix:form.upload_count_limit===0?` ${unref($t)("settings.apiKeys.form.uploadLimitUnlimitedSuffix")}`:""})),1)])]),createBaseVNode("div",null,[createBaseVNode("label",_hoisted_10$4,toDisplayString(unref($t)("settings.apiKeys.form.allowedTypesLabel")),1),createVNode(_component_CyberDropdown,{modelValue:form.allowed_types,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>form.allowed_types=$event),options:fileTypeOptions.value,multiple:"",searchable:"",placeholder:unref($t)("settings.apiKeys.form.allowedTypesPlaceholder"),class:"w-full"},null,8,["modelValue","options","placeholder"]),createBaseVNode("p",_hoisted_11$4,toDisplayString(unref($t)("settings.apiKeys.form.allowedTypesHint")),1)]),createBaseVNode("div",null,[createBaseVNode("label",_hoisted_12$4,toDisplayString(unref($t)("settings.apiKeys.form.expiresLabel")),1),createVNode(_component_CyberInput,{modelValue:form.expires_in_days,"onUpdate:modelValue":_cache[5]||(_cache[5]=$event=>form.expires_in_days=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("settings.apiKeys.form.expiresPlaceholder"),min:"1"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_13$4,toDisplayString(unref($t)("settings.apiKeys.form.expiresHint")),1)]),createBaseVNode("div",null,[createBaseVNode("label",_hoisted_14$3,toDisplayString(unref($t)("settings.apiKeys.form.folderLabel")),1),createVNode(_component_CyberFolderTree,{modelValue:form.folder_id,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>form.folder_id=$event),class:"compact-dropdown text-sm","dropdown-z-index":6e3,onFolderSelected:handleFolderSelected},null,8,["modelValue"]),createBaseVNode("p",_hoisted_15$2,toDisplayString(unref($t)("settings.apiKeys.form.folderHint")),1)])])],32)}}});const ApiKeyForm=_export_sfc(_sfc_main$7,[["__scopeId","data-v-de3315ab"]]),_hoisted_1$6={key:0,class:"apikey-details"},_hoisted_2$5={key:0,class:"mb-6 radius-sm border border-subtle bg-background-700 p-4"},_hoisted_3$5={class:"mb-2 flex items-center justify-between"},_hoisted_4$5={class:"flex items-center text-content"},_hoisted_5$5=["title"],_hoisted_6$5={class:"ml-1"},_hoisted_7$4={class:"overflow-x-auto radius-sm border border-subtle bg-background-800 p-3 font-mono text-sm text-content"},_hoisted_8$3={class:"mt-2 flex items-center text-xs text-warning-400"},_hoisted_9$3={class:"apikey-details-content"},_hoisted_10$3={class:"mb-5 radius-sm border border-subtle bg-background-800 p-4"},_hoisted_11$3={class:"mb-3 flex items-center text-base font-medium text-content"},_hoisted_12$3={class:"grid grid-cols-2 gap-x-6 gap-y-4"},_hoisted_13$3={class:"info-item"},_hoisted_14$2={class:"info-label"},_hoisted_15$1={class:"info-value"},_hoisted_16$1={class:"info-item"},_hoisted_17$1={class:"info-label"},_hoisted_18$1={class:"info-value"},_hoisted_19$1={key:0,class:"status-badge status-expired ml-2"},_hoisted_20$1={class:"info-item"},_hoisted_21$1={class:"info-label"},_hoisted_22$1={class:"info-value"},_hoisted_23$1={class:"info-item"},_hoisted_24$1={class:"info-label"},_hoisted_25$1={class:"info-value"},_hoisted_26$1={class:"info-item"},_hoisted_27$1={class:"info-label"},_hoisted_28$1={class:"info-value"},_hoisted_29$1={class:"info-item"},_hoisted_30$1={class:"info-label"},_hoisted_31$1={class:"info-value"},_hoisted_32$1={class:"folder-path"},_hoisted_33$1={class:"mb-5 radius-sm border border-subtle bg-background-800 p-4"},_hoisted_34$1={class:"mb-3 flex items-center text-base font-medium text-content"},_hoisted_35$1={class:"grid grid-cols-1 gap-5 md:grid-cols-3"},_hoisted_36$1={class:"usage-card"},_hoisted_37$1={class:"usage-header"},_hoisted_38$1={class:"usage-title"},_hoisted_39$1={class:"usage-percentage text-content"},_hoisted_40$1={class:"progress-bar"},_hoisted_41$1={class:"usage-details"},_hoisted_42$1={class:"usage-value"},_hoisted_43$1={class:"usage-max"},_hoisted_44$1={class:"usage-card"},_hoisted_45$1={class:"usage-header"},_hoisted_46$1={class:"usage-title"},_hoisted_47$1={class:"usage-percentage text-error-400"},_hoisted_48$1={class:"progress-bar"},_hoisted_49$1={class:"usage-details"},_hoisted_50$1={class:"usage-value"},_hoisted_51$1={class:"usage-max"},_hoisted_52$1={class:"usage-card"},_hoisted_53$1={class:"usage-header"},_hoisted_54$1={class:"usage-title"},_hoisted_55$1={class:"file-size-limit"},_hoisted_56$1={class:"font-mono text-3xl text-success-400"},_hoisted_57$1={class:"mt-1 text-xs text-brand-600"},_hoisted_58$1={class:"mb-5 radius-sm border border-subtle bg-background-800 p-4"},_hoisted_59$1={class:"mb-3 flex items-center text-base font-medium text-content"},_hoisted_60$1={key:0,class:"flex flex-wrap gap-2"},_hoisted_61$1={key:1,class:"italic text-brand-600"},_sfc_main$6=defineComponent({__name:"ApiKeyDetail",props:{apiKey:{},apiKeyValue:{}},emits:["copy"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,toast=useToast(),{$t}=useTexts(),copied=ref(!1),formatDate=dateString=>dateString?new Date(dateString).toLocaleString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",formatSize=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},getStoragePercentageText=()=>props.apiKey?props.apiKey.storage_limit===0?$t("settings.apiKeys.text.unlimited"):`${Math.round((props.apiKey.storage_used||0)/props.apiKey.storage_limit*100)}%`:"0%",getStorageProgressWidth=()=>!props.apiKey||props.apiKey.storage_limit===0?0:Math.min((props.apiKey.storage_used||0)/props.apiKey.storage_limit*100,100),getStorageLimitText=()=>props.apiKey?props.apiKey.storage_limit===0?$t("settings.apiKeys.text.unlimited"):formatSize(props.apiKey.storage_limit):"0 B",getUploadPercentageText=()=>props.apiKey?props.apiKey.upload_count_limit===0?$t("settings.apiKeys.text.unlimited"):`${Math.round((props.apiKey.upload_count_used||0)/props.apiKey.upload_count_limit*100)}%`:"0%",getUploadProgressWidth=()=>!props.apiKey||props.apiKey.upload_count_limit===0?0:Math.min((props.apiKey.upload_count_used||0)/props.apiKey.upload_count_limit*100,100),getUploadLimitText=()=>props.apiKey?props.apiKey.upload_count_limit===0?$t("settings.apiKeys.text.unlimited"):props.apiKey.upload_count_limit.toString():"0",copyApiKey=async()=>{if(!props.apiKeyValue)return;await navigator.clipboard.writeText(props.apiKeyValue)!==void 0&&(copied.value=!0,setTimeout(()=>{copied.value=!1},3e3),toast.success($t("settings.apiKeys.toasts.detailCopySuccess")),emit("copy"))};return(_ctx,_cache)=>__props.apiKey?(openBlock(),createElementBlock("div",_hoisted_1$6,[__props.apiKeyValue?(openBlock(),createElementBlock("div",_hoisted_2$5,[createBaseVNode("div",_hoisted_3$5,[createBaseVNode("h3",_hoisted_4$5,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-key mr-2"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.apiKeys.fields.apiKey")),1)]),createBaseVNode("button",{class:"flex items-center rounded border border-subtle bg-background-600 p-1 px-2 text-xs text-content transition-colors hover:border-default hover:bg-background-500 hover:text-brand-400",title:unref($t)("settings.apiKeys.detail.copyCta"),onClick:copyApiKey},[createBaseVNode("i",{class:normalizeClass(["fas",copied.value?"fa-check":"fa-copy"])},null,2),createBaseVNode("span",_hoisted_6$5,toDisplayString(copied.value?unref($t)("settings.apiKeys.detail.copied"):unref($t)("settings.apiKeys.detail.copy")),1)],8,_hoisted_5$5)]),createBaseVNode("div",_hoisted_7$4,toDisplayString(__props.apiKeyValue),1),createBaseVNode("p",_hoisted_8$3,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.apiKeys.detail.copyNotice")),1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_9$3,[createBaseVNode("div",_hoisted_10$3,[createBaseVNode("h4",_hoisted_11$3,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-info-circle mr-2"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.apiKeys.detail.baseInfoTitle")),1)]),createBaseVNode("div",_hoisted_12$3,[createBaseVNode("div",_hoisted_13$3,[createBaseVNode("div",_hoisted_14$2,toDisplayString(unref($t)("settings.apiKeys.form.nameLabel")),1),createBaseVNode("div",_hoisted_15$1,toDisplayString(__props.apiKey.name),1)]),createBaseVNode("div",_hoisted_16$1,[createBaseVNode("div",_hoisted_17$1,toDisplayString(unref($t)("settings.apiKeys.fields.status")),1),createBaseVNode("div",_hoisted_18$1,[createBaseVNode("span",{class:normalizeClass(["status-badge",__props.apiKey.is_active?"status-active":"status-inactive"])},toDisplayString(__props.apiKey.status===1?unref($t)("settings.apiKeys.status.active"):unref($t)("settings.apiKeys.status.banned")),3),__props.apiKey.is_expired?(openBlock(),createElementBlock("span",_hoisted_19$1,toDisplayString(unref($t)("settings.apiKeys.status.expired")),1)):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_20$1,[createBaseVNode("div",_hoisted_21$1,toDisplayString(unref($t)("settings.apiKeys.fields.createdAt")),1),createBaseVNode("div",_hoisted_22$1,toDisplayString(formatDate(__props.apiKey.created_at)),1)]),createBaseVNode("div",_hoisted_23$1,[createBaseVNode("div",_hoisted_24$1,toDisplayString(unref($t)("settings.apiKeys.fields.expiresAt")),1),createBaseVNode("div",_hoisted_25$1,toDisplayString(__props.apiKey.expires_at?`${__props.apiKey.expires_at}`:unref($t)("settings.apiKeys.text.neverExpires")),1)]),createBaseVNode("div",_hoisted_26$1,[createBaseVNode("div",_hoisted_27$1,toDisplayString(unref($t)("settings.apiKeys.fields.lastUsedAt")),1),createBaseVNode("div",_hoisted_28$1,toDisplayString(__props.apiKey.last_used_at?formatDate(__props.apiKey.last_used_at):unref($t)("settings.apiKeys.text.neverUsed")),1)]),createBaseVNode("div",_hoisted_29$1,[createBaseVNode("div",_hoisted_30$1,toDisplayString(unref($t)("settings.apiKeys.fields.folder")),1),createBaseVNode("div",_hoisted_31$1,[createBaseVNode("span",_hoisted_32$1,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-folder-tree mr-1 text-brand-400"},null,-1)),createTextVNode(" "+toDisplayString(__props.apiKey.folder_path||unref($t)("settings.apiKeys.text.rootFolder")),1)])])])])]),createBaseVNode("div",_hoisted_33$1,[createBaseVNode("h4",_hoisted_34$1,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-chart-pie mr-2"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.apiKeys.detail.usageTitle")),1)]),createBaseVNode("div",_hoisted_35$1,[createBaseVNode("div",_hoisted_36$1,[createBaseVNode("div",_hoisted_37$1,[createBaseVNode("div",_hoisted_38$1,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-hdd mr-2 text-content"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.apiKeys.fields.storage")),1)]),createBaseVNode("div",_hoisted_39$1,toDisplayString(getStoragePercentageText()),1)]),createBaseVNode("div",_hoisted_40$1,[createBaseVNode("div",{class:"progress-fill progress-storage",style:normalizeStyle({width:`${getStorageProgressWidth()}%`})},null,4)]),createBaseVNode("div",_hoisted_41$1,[createBaseVNode("div",_hoisted_42$1,toDisplayString(formatSize(__props.apiKey.storage_used||0)),1),createBaseVNode("div",_hoisted_43$1,toDisplayString(getStorageLimitText()),1)])]),createBaseVNode("div",_hoisted_44$1,[createBaseVNode("div",_hoisted_45$1,[createBaseVNode("div",_hoisted_46$1,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-upload mr-2 text-error-400"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.apiKeys.fields.uploadCount")),1)]),createBaseVNode("div",_hoisted_47$1,toDisplayString(getUploadPercentageText()),1)]),createBaseVNode("div",_hoisted_48$1,[createBaseVNode("div",{class:"progress-fill progress-upload",style:normalizeStyle({width:`${getUploadProgressWidth()}%`})},null,4)]),createBaseVNode("div",_hoisted_49$1,[createBaseVNode("div",_hoisted_50$1,toDisplayString(__props.apiKey.upload_count_used||0),1),createBaseVNode("div",_hoisted_51$1,toDisplayString(getUploadLimitText()),1)])]),createBaseVNode("div",_hoisted_52$1,[createBaseVNode("div",_hoisted_53$1,[createBaseVNode("div",_hoisted_54$1,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-file mr-2 text-success-400"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.apiKeys.fields.singleFileLimit")),1)])]),createBaseVNode("div",_hoisted_55$1,[createBaseVNode("div",_hoisted_56$1,toDisplayString(formatSize(__props.apiKey.single_file_limit)),1),createBaseVNode("div",_hoisted_57$1,toDisplayString(unref($t)("settings.apiKeys.detail.perFileHint")),1)])])])]),createBaseVNode("div",_hoisted_58$1,[createBaseVNode("h4",_hoisted_59$1,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-file-alt mr-2"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.apiKeys.detail.allowedTypesTitle")),1)]),__props.apiKey.allowed_types&&__props.apiKey.allowed_types.length>0?(openBlock(),createElementBlock("div",_hoisted_60$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.apiKey.allowed_types,type=>(openBlock(),createElementBlock("div",{key:type,class:"flex items-center rounded bg-brand-100 px-3 py-1 text-content"},[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-file mr-2"},null,-1)),createTextVNode(" "+toDisplayString(type),1)]))),128))])):(openBlock(),createElementBlock("div",_hoisted_61$1,toDisplayString(unref($t)("settings.apiKeys.text.allFileTypes")),1))])])])):createCommentVNode("",!0)}});const ApiKeyDetail=_export_sfc(_sfc_main$6,[["__scopeId","data-v-c7c585a6"]]),_hoisted_1$5={class:"apikey-manager p-6"},_hoisted_2$4={class:"mb-6"},_hoisted_3$4={class:"flex justify-end gap-3 p-4"},_hoisted_4$4={class:"flex justify-end gap-3 p-4"},_hoisted_5$4={class:"mb-6"},_hoisted_6$4={class:"flex justify-end gap-3 p-4"},_sfc_main$5=defineComponent({__name:"ApiKeyManager",props:{lazyLoad:{type:Boolean,default:!1}},setup(__props,{expose:__expose}){const props=__props,toast=useToast(),{$t}=useTexts(),R=getValidationRules($t),apiKeys=ref([]),isLoading=ref(!1),pagination=reactive({page:1,size:10,total:0,total_pages:0}),changePage=page=>{page<1||page>pagination.total_pages||(pagination.page=page,fetchApiKeys())},showDialog=ref(!1),isEditing=ref(!1),isSubmitting=ref(!1),apiKeyForm=reactive({name:"",storage_limit:0,single_file_limit:10485760,upload_count_limit:0,allowed_types:[],folder_id:"",expires_in_days:void 0}),editingKeyId=ref(""),apiKeyFormRef=ref(null),currentFormData=ref({}),handleFormChanged=formData=>{currentFormData.value=formData},showKeyDialog=ref(!1),selectedKey=ref(null),apiKeyValue=ref(""),copied=ref(!1),showDeleteDialog=ref(!1),isDeleting=ref(!1),fetchApiKeys=async()=>{try{isLoading.value=!0;const result=await api.apikey.getApiKeyList({page:pagination.page,size:pagination.size});if(result.success){const{data}=result;apiKeys.value=data.items,pagination.total=data.pagination.total,pagination.page=data.pagination.page,pagination.size=data.pagination.size,pagination.total_pages=data.pagination.total_pages}}catch{}finally{isLoading.value=!1}};onMounted(()=>{props.lazyLoad||fetchApiKeys()});const openCreateDialog=()=>{isEditing.value=!1,resetForm(),showDialog.value=!0},editApiKey=key=>{showKeyDialog.value=!1,isEditing.value=!0,editingKeyId.value=key.id,apiKeyForm.name=key.name,apiKeyForm.storage_limit=key.storage_limit,apiKeyForm.single_file_limit=key.single_file_limit,apiKeyForm.upload_count_limit=key.upload_count_limit,apiKeyForm.allowed_types=[...key.allowed_types||[]],apiKeyForm.folder_id=key.folder_id||"",apiKeyForm.expires_in_days=key.expires_in_days||void 0,showDialog.value=!0},closeDialog=()=>{showDialog.value=!1,resetForm()},resetForm=()=>{apiKeyForm.name="",apiKeyForm.storage_limit=0,apiKeyForm.single_file_limit=10485760,apiKeyForm.upload_count_limit=0,apiKeyForm.allowed_types=[],apiKeyForm.folder_id="",apiKeyForm.expires_in_days=void 0,editingKeyId.value=""},submitApiKey=async formData=>{const nameCheck=Validator.validate(String(formData?.name||""),[R.required],$t);if(!nameCheck.valid)return toast.error(nameCheck.message||$t("settings.apiKeys.toast.nameRequired"));try{isSubmitting.value=!0;let result;if(isEditing.value?result=await api.apikey.updateApiKey(editingKeyId.value,formData):result=await api.apikey.createApiKey(formData),result.success){const{data}=result;toast.success(isEditing.value?$t("settings.apiKeys.toasts.updated"):$t("settings.apiKeys.toasts.created")),!isEditing.value&&data.key?(selectedKey.value=data,apiKeyValue.value=data.key,showDialog.value=!1,showKeyDialog.value=!0):closeDialog(),fetchApiKeys()}}catch{}finally{isSubmitting.value=!1}},submitFormFromButton=()=>{currentFormData.value&&Object.keys(currentFormData.value).length>0?submitApiKey(currentFormData.value):apiKeyFormRef.value&&apiKeyFormRef.value.getFormData?submitApiKey(apiKeyFormRef.value.getFormData()):submitApiKey(apiKeyForm)},showApiKey=async key=>{selectedKey.value=key,apiKeyValue.value="",showKeyDialog.value=!0,key.key&&(apiKeyValue.value=key.key)},closeKeyDialog=()=>{showKeyDialog.value=!1,apiKeyValue.value="",copied.value=!1},toggleApiKeyStatus=async key=>{try{(await api.apikey.toggleApiKey(key.id,{is_active:!key.is_active})).success&&(toast.success(key.is_active?$t("settings.apiKeys.toasts.disabled"):$t("settings.apiKeys.toasts.enabled")),fetchApiKeys())}catch{}},confirmDeleteApiKey=key=>{selectedKey.value=key,showDeleteDialog.value=!0},closeDeleteDialog=()=>{showDeleteDialog.value=!1,selectedKey.value=null},deleteApiKey2=async()=>{if(selectedKey.value)try{isDeleting.value=!0,(await api.apikey.deleteApiKey(selectedKey.value.id)).success&&(toast.success($t("settings.apiKeys.toasts.deleted")),closeDeleteDialog(),fetchApiKeys())}catch{}finally{isDeleting.value=!1}};return __expose({fetchApiKeys}),(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton"),_component_CyberDialog=resolveComponent("CyberDialog");return openBlock(),createElementBlock("div",_hoisted_1$5,[createVNode(SizeConverter),createBaseVNode("div",_hoisted_2$4,[createVNode(ApiKeyList,{"api-keys":apiKeys.value,"is-loading":isLoading.value,pagination,onCreate:openCreateDialog,onEdit:editApiKey,onDetail:showApiKey,onDelete:confirmDeleteApiKey,onToggle:toggleApiKeyStatus,onChangePage:changePage},null,8,["api-keys","is-loading","pagination"])]),createVNode(_component_CyberDialog,{id:"create-edit-dialog",modelValue:showDialog.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>showDialog.value=$event),title:isEditing.value?unref($t)("settings.apiKeys.dialog.editTitle"):unref($t)("settings.apiKeys.dialog.createTitle"),width:"700px",loading:isSubmitting.value,"show-default-footer":!1,onCancel:closeDialog},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_3$4,[createVNode(_component_CyberButton,{type:"outlined",onClick:closeDialog},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.apiKeys.dialog.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",loading:isSubmitting.value,"loading-mode":"inline",icon:"save",onClick:submitFormFromButton},{default:withCtx(()=>[createTextVNode(toDisplayString(isSubmitting.value?unref($t)("settings.apiKeys.dialog.submitting"):isEditing.value?unref($t)("settings.apiKeys.dialog.saveAction"):unref($t)("settings.apiKeys.dialog.createAction")),1)]),_:1},8,["loading"])])]),default:withCtx(()=>[createVNode(ApiKeyForm,{ref_key:"apiKeyFormRef",ref:apiKeyFormRef,"initial-data":apiKeyForm,"is-editing":isEditing.value,onSubmit:submitApiKey,onFormChanged:handleFormChanged},null,8,["initial-data","is-editing"])]),_:1},8,["modelValue","title","loading"]),createVNode(_component_CyberDialog,{id:"detail-dialog",modelValue:showKeyDialog.value,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>showKeyDialog.value=$event),title:unref($t)("settings.apiKeys.dialog.detailTitle"),width:"750px","show-default-footer":!1,onCancel:closeKeyDialog},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_4$4,[createVNode(_component_CyberButton,{type:"primary",onClick:closeKeyDialog},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.apiKeys.dialog.close")),1)]),_:1})])]),default:withCtx(()=>[createVNode(ApiKeyDetail,{"api-key":selectedKey.value,"api-key-value":apiKeyValue.value,onCopy:_cache[1]||(_cache[1]=$event=>copied.value=!0)},null,8,["api-key","api-key-value"])]),_:1},8,["modelValue","title"]),createVNode(_component_CyberDialog,{id:"delete-dialog",modelValue:showDeleteDialog.value,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>showDeleteDialog.value=$event),title:unref($t)("settings.apiKeys.dialog.deleteTitle"),width:"450px","show-default-footer":!1,onCancel:closeDeleteDialog},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_6$4,[createVNode(_component_CyberButton,{type:"ghost",onClick:closeDeleteDialog},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.apiKeys.dialog.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:"danger",icon:"trash",loading:isDeleting.value,onClick:deleteApiKey2},{default:withCtx(()=>[createTextVNode(toDisplayString(isDeleting.value?unref($t)("status.deleting"):unref($t)("settings.apiKeys.dialog.confirmDelete")),1)]),_:1},8,["loading"])])]),default:withCtx(()=>[createBaseVNode("p",_hoisted_5$4,toDisplayString(unref($t)("settings.apiKeys.dialog.deleteMessage",{name:selectedKey.value?.name||""})),1)]),_:1},8,["modelValue","title"])])}}});const ApiKeyManager=_export_sfc(_sfc_main$5,[["__scopeId","data-v-6488d76e"]]),_hoisted_1$4={class:"apikey-section-card border"},_sfc_main$4=defineComponent({__name:"ApiKeySection",setup(__props,{expose:__expose}){const apiKeyManagerRef=ref(null);return __expose({apiKeyManagerRef}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createVNode(ApiKeyManager,{ref_key:"apiKeyManagerRef",ref:apiKeyManagerRef,"lazy-load":!0},null,512)]))}});const ApiKeySection=_export_sfc(_sfc_main$4,[["__scopeId","data-v-9bf835c0"]]),_hoisted_1$3={class:"access-control-section"},_hoisted_2$3={class:"section-header"},_hoisted_3$3={class:"header-content"},_hoisted_4$3={class:"title-wrapper"},_hoisted_5$3={class:"title-text"},_hoisted_6$3={class:"title"},_hoisted_7$3={class:"subtitle"},_hoisted_8$2={class:"header-controls"},_hoisted_9$2={class:"control-grid"},_hoisted_10$2={class:"control-card"},_hoisted_11$2={class:"card-header"},_hoisted_12$2={class:"card-title"},_hoisted_13$2={class:"card-content"},_hoisted_14$1={class:"form-group"},_hoisted_15={class:"form-label"},_hoisted_16={class:"form-help"},_hoisted_17={class:"form-group"},_hoisted_18={class:"form-label"},_hoisted_19={class:"form-hint"},_hoisted_20={key:0,class:"form-error"},_hoisted_21={class:"form-help"},_hoisted_22={class:"control-card"},_hoisted_23={class:"card-header"},_hoisted_24={class:"card-title"},_hoisted_25={class:"card-content"},_hoisted_26={class:"form-group"},_hoisted_27={class:"form-label"},_hoisted_28={class:"form-help"},_hoisted_29={class:"form-group"},_hoisted_30={class:"form-label"},_hoisted_31={class:"form-hint"},_hoisted_32={key:0,class:"form-error"},_hoisted_33={class:"form-help"},_hoisted_34={class:"advanced-card"},_hoisted_35={class:"card-header"},_hoisted_36={class:"card-title"},_hoisted_37={class:"card-content"},_hoisted_38={class:"advanced-grid"},_hoisted_39={class:"form-group"},_hoisted_40={class:"form-label"},_hoisted_41={class:"form-help"},_hoisted_42={class:"form-group"},_hoisted_43={class:"form-label"},_hoisted_44={class:"form-warning"},_hoisted_45={key:0,class:"form-group"},_hoisted_46={class:"form-label"},_hoisted_47={key:0,class:"form-error"},_hoisted_48={class:"form-help"},_hoisted_49={key:1,class:"form-group"},_hoisted_50={class:"form-label"},_hoisted_51={class:"form-help"},_hoisted_52={class:"test-card"},_hoisted_53={class:"card-header"},_hoisted_54={class:"card-title"},_hoisted_55={class:"card-content"},_hoisted_56={class:"test-grid"},_hoisted_57={class:"test-group"},_hoisted_58={class:"form-label"},_hoisted_59={class:"test-input-group"},_hoisted_60={class:"test-group"},_hoisted_61={class:"form-label"},_hoisted_62={class:"test-input-group"},_hoisted_63={class:"action-buttons"},_sfc_main$3=defineComponent({__name:"AccessControlSection",setup(__props,{expose:__expose}){const toast=useToast(),loading=ref(!1),{$t}=useTexts(),defaultConfig={enabled:!1,ip_mode:"whitelist",domain_mode:"whitelist",restriction_mode:"strict",block_action:"block",redirect_url:"",custom_error_message:"",ip_list:"",domain_list:""},config=reactive({...defaultConfig}),testIP=ref(""),testDomain=ref(""),testResults=reactive({ip:"",ipAllowed:!1,domain:"",domainAllowed:!1}),errors=reactive({ip_list:"",domain_list:"",redirect_url:""}),ipModeOptions=computed(()=>getAccessControlModeOptions($t)),domainModeOptions=computed(()=>getDomainControlModeOptions($t)),restrictionModeOptions=computed(()=>getRestrictionModeOptions($t)),blockActionOptions=computed(()=>getBlockActionOptions($t)),ipModeDescription=computed(()=>$t(`settings.accessControl.descriptions.ip.${config.ip_mode}`)),domainModeDescription=computed(()=>$t(`settings.accessControl.descriptions.domain.${config.domain_mode}`)),restrictionDescription=computed(()=>$t(`settings.accessControl.descriptions.restriction.${config.restriction_mode}`)),blockActionWarning=computed(()=>$t(`settings.accessControl.warnings.${config.block_action}`)),fetchAccessControlConfig=async()=>{try{loading.value=!0;const result=await getAccessControlConfig();result.success&&Object.assign(config,result.data)}catch{}finally{loading.value=!1}},saveConfig=async()=>{if(validateConfig())try{loading.value=!0;const result=await createOrUpdateAccessControl(config);result.success&&(Object.assign(config,result.data),toast.success($t("settings.accessControl.messages.updateSuccess")))}catch{}finally{loading.value=!1}},resetConfig=async()=>{if(showConfirm($t("settings.accessControl.confirm.reset")))try{loading.value=!0,(await resetAccessControlConfig()).success&&(Object.assign(config,defaultConfig),toast.success($t("settings.accessControl.messages.resetSuccess")))}catch{}finally{loading.value=!1}},validateConfig=()=>{let isValid=!0;if(errors.ip_list="",errors.domain_list="",errors.redirect_url="",config.ip_list.trim()!==""){const ips=config.ip_list.split(",");for(const ip of ips)if(!isValidIP(ip.trim())){errors.ip_list=$t("settings.accessControl.errors.invalidIp",{value:ip.trim()}),isValid=!1;break}}if(config.domain_list.trim()!==""){const domains=config.domain_list.split(",");for(const domain of domains)if(!isValidDomain(domain.trim())){errors.domain_list=$t("settings.accessControl.errors.invalidDomain",{value:domain.trim()}),isValid=!1;break}}return config.block_action==="redirect"&&(!config.redirect_url||!isValidUrl(config.redirect_url))&&(errors.redirect_url=$t("settings.accessControl.errors.invalidRedirect"),isValid=!1),isValid},validateAndSave=()=>{validateConfig()&&saveConfig()},testAccess=type=>{if(type==="ip"){if(!testIP.value){testResults.ip=$t("settings.accessControl.test.ipRequired");return}if(!isValidIP(testIP.value)){testResults.ip=$t("settings.accessControl.test.ipInvalid");return}const ipExists=config.ip_list.split(",").map(ip=>ip.trim()).filter(ip=>ip).includes(testIP.value);config.ip_mode==="whitelist"?(testResults.ipAllowed=ipExists,testResults.ip=$t(ipExists?"settings.accessControl.test.ipAllowed":"settings.accessControl.test.ipBlocked")):(testResults.ipAllowed=!ipExists,testResults.ip=$t(ipExists?"settings.accessControl.test.ipBlocked":"settings.accessControl.test.ipAllowed"))}else{if(!testDomain.value){testResults.domain=$t("settings.accessControl.test.domainRequired");return}if(!isValidDomain(testDomain.value)){testResults.domain=$t("settings.accessControl.test.domainInvalid");return}const domainExists=config.domain_list.split(",").map(domain=>domain.trim()).filter(domain=>domain).some(domain=>{if(domain.startsWith("*.")){const suffix=domain.substring(1);return testDomain.value.endsWith(suffix)}return domain===testDomain.value});config.domain_mode==="whitelist"?(testResults.domainAllowed=domainExists,testResults.domain=$t(domainExists?"settings.accessControl.test.domainAllowed":"settings.accessControl.test.domainBlocked")):(testResults.domainAllowed=!domainExists,testResults.domain=$t(domainExists?"settings.accessControl.test.domainBlocked":"settings.accessControl.test.domainAllowed"))}},isValidIP=ip=>{if(ip==="localhost")return!0;const ipv4Regex=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,cidrRegex=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\/(\d{1,2})$/,ipv6Regex=/^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^([0-9a-fA-F]{1,4}:){1,7}:|^([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}$|^([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}$|^([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}$|^([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}$|^([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}$|^[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})$|^:((:[0-9a-fA-F]{1,4}){1,7}|:)$/;if(ipv4Regex.test(ip)){const parts=ip.match(ipv4Regex)?.slice(1);return parts?parts.every(part=>{const num=parseInt(part,10);return num>=0&&num<=255}):!1}if(cidrRegex.test(ip)){const parts=ip.match(cidrRegex)?.slice(1);if(!parts)return!1;const prefix=parseInt(parts[4],10);return prefix<0||prefix>32?!1:parts.slice(0,4).every(part=>{const num=parseInt(part,10);return num>=0&&num<=255})}return ipv6Regex.test(ip)},isValidDomain=domain=>domain==="localhost"?!0:(domain.startsWith("*.")&&(domain=domain.substring(2)),/^(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]$/i.test(domain)),isValidUrl=url=>{try{return new URL(url),!0}catch{return!1}};return onMounted(()=>{fetchAccessControlConfig()}),__expose({fetchAccessControlConfig}),(_ctx,_cache)=>{const _component_CyberSwitch=resolveComponent("CyberSwitch"),_component_CyberDropdown=resolveComponent("CyberDropdown"),_component_CyberInput=resolveComponent("CyberInput"),_component_CyberButton=resolveComponent("CyberButton");return openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("div",_hoisted_2$3,[createBaseVNode("div",_hoisted_3$3,[createBaseVNode("div",_hoisted_4$3,[_cache[13]||(_cache[13]=createBaseVNode("div",{class:"title-icon"},[createBaseVNode("i",{class:"fas fa-shield-alt"})],-1)),createBaseVNode("div",_hoisted_5$3,[createBaseVNode("h2",_hoisted_6$3,toDisplayString(unref($t)("settings.accessControl.title")),1),createBaseVNode("p",_hoisted_7$3,toDisplayString(unref($t)("settings.accessControl.description")),1)])]),createBaseVNode("div",_hoisted_8$2,[createVNode(_component_CyberSwitch,{modelValue:config.enabled,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>config.enabled=$event),onChange:saveConfig},null,8,["modelValue"])])])]),createBaseVNode("div",{class:normalizeClass(["config-content",{"config-disabled":!config.enabled}])},[createBaseVNode("div",_hoisted_9$2,[createBaseVNode("div",_hoisted_10$2,[createBaseVNode("div",_hoisted_11$2,[createBaseVNode("div",_hoisted_12$2,[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-network-wired card-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.accessControl.sections.ip.title")),1)])]),createBaseVNode("div",_hoisted_13$2,[createBaseVNode("div",_hoisted_14$1,[createBaseVNode("label",_hoisted_15,toDisplayString(unref($t)("settings.accessControl.sections.ip.modeLabel")),1),createVNode(_component_CyberDropdown,{modelValue:config.ip_mode,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>config.ip_mode=$event),clearable:!1,options:ipModeOptions.value,onChange:saveConfig},null,8,["modelValue","options"]),createBaseVNode("div",_hoisted_16,toDisplayString(ipModeDescription.value),1)]),createBaseVNode("div",_hoisted_17,[createBaseVNode("label",_hoisted_18,[createTextVNode(toDisplayString(unref($t)("settings.accessControl.sections.ip.listLabel"))+" ",1),createBaseVNode("span",_hoisted_19," ("+toDisplayString(unref($t)("settings.accessControl.sections.ip.listHint"))+") ",1)]),createVNode(_component_CyberInput,{modelValue:config.ip_list,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>config.ip_list=$event),type:"textarea",rows:3,placeholder:unref($t)("settings.accessControl.sections.ip.placeholder"),onChange:validateAndSave},null,8,["modelValue","placeholder"]),errors.ip_list?(openBlock(),createElementBlock("div",_hoisted_20,toDisplayString(errors.ip_list),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_21,toDisplayString(unref($t)("settings.accessControl.sections.ip.helper")),1)])])]),createBaseVNode("div",_hoisted_22,[createBaseVNode("div",_hoisted_23,[createBaseVNode("div",_hoisted_24,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-globe card-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.accessControl.sections.domain.title")),1)])]),createBaseVNode("div",_hoisted_25,[createBaseVNode("div",_hoisted_26,[createBaseVNode("label",_hoisted_27,toDisplayString(unref($t)("settings.accessControl.sections.domain.modeLabel")),1),createVNode(_component_CyberDropdown,{modelValue:config.domain_mode,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>config.domain_mode=$event),clearable:!1,options:domainModeOptions.value,onChange:saveConfig},null,8,["modelValue","options"]),createBaseVNode("div",_hoisted_28,toDisplayString(domainModeDescription.value),1)]),createBaseVNode("div",_hoisted_29,[createBaseVNode("label",_hoisted_30,[createTextVNode(toDisplayString(unref($t)("settings.accessControl.sections.domain.listLabel"))+" ",1),createBaseVNode("span",_hoisted_31," ("+toDisplayString(unref($t)("settings.accessControl.sections.domain.listHint"))+") ",1)]),createVNode(_component_CyberInput,{modelValue:config.domain_list,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>config.domain_list=$event),type:"textarea",rows:3,placeholder:unref($t)("settings.accessControl.sections.domain.placeholder"),onChange:validateAndSave},null,8,["modelValue","placeholder"]),errors.domain_list?(openBlock(),createElementBlock("div",_hoisted_32,toDisplayString(errors.domain_list),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_33,toDisplayString(unref($t)("settings.accessControl.sections.domain.helper")),1)])])])]),createBaseVNode("div",_hoisted_34,[createBaseVNode("div",_hoisted_35,[createBaseVNode("div",_hoisted_36,[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-cogs card-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.accessControl.advanced.title")),1)])]),createBaseVNode("div",_hoisted_37,[createBaseVNode("div",_hoisted_38,[createBaseVNode("div",_hoisted_39,[createBaseVNode("label",_hoisted_40,toDisplayString(unref($t)("settings.accessControl.advanced.restrictionLabel")),1),createVNode(_component_CyberDropdown,{modelValue:config.restriction_mode,"onUpdate:modelValue":_cache[5]||(_cache[5]=$event=>config.restriction_mode=$event),clearable:!1,options:restrictionModeOptions.value,onChange:saveConfig},null,8,["modelValue","options"]),createBaseVNode("div",_hoisted_41,toDisplayString(restrictionDescription.value),1)]),createBaseVNode("div",_hoisted_42,[createBaseVNode("label",_hoisted_43,toDisplayString(unref($t)("settings.accessControl.advanced.blockActionLabel")),1),createVNode(_component_CyberDropdown,{modelValue:config.block_action,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>config.block_action=$event),clearable:!1,options:blockActionOptions.value,onChange:saveConfig},null,8,["modelValue","options"]),createBaseVNode("div",_hoisted_44,toDisplayString(blockActionWarning.value),1)])]),config.block_action==="redirect"?(openBlock(),createElementBlock("div",_hoisted_45,[createBaseVNode("label",_hoisted_46,toDisplayString(unref($t)("settings.accessControl.advanced.redirectLabel")),1),createVNode(_component_CyberInput,{modelValue:config.redirect_url,"onUpdate:modelValue":_cache[7]||(_cache[7]=$event=>config.redirect_url=$event),placeholder:unref($t)("settings.accessControl.advanced.redirectPlaceholder"),onChange:validateAndSave},null,8,["modelValue","placeholder"]),errors.redirect_url?(openBlock(),createElementBlock("div",_hoisted_47,toDisplayString(errors.redirect_url),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_48,toDisplayString(unref($t)("settings.accessControl.advanced.redirectHelper")),1)])):createCommentVNode("",!0),config.block_action==="block"?(openBlock(),createElementBlock("div",_hoisted_49,[createBaseVNode("label",_hoisted_50,toDisplayString(unref($t)("settings.accessControl.advanced.customErrorLabel")),1),createVNode(_component_CyberInput,{modelValue:config.custom_error_message,"onUpdate:modelValue":_cache[8]||(_cache[8]=$event=>config.custom_error_message=$event),placeholder:unref($t)("settings.accessControl.advanced.customErrorPlaceholder"),onChange:validateAndSave},null,8,["modelValue","placeholder"]),createBaseVNode("div",_hoisted_51,toDisplayString(unref($t)("settings.accessControl.advanced.customErrorHelper")),1)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_52,[createBaseVNode("div",_hoisted_53,[createBaseVNode("div",_hoisted_54,[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-flask card-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("settings.accessControl.test.title")),1)])]),createBaseVNode("div",_hoisted_55,[createBaseVNode("div",_hoisted_56,[createBaseVNode("div",_hoisted_57,[createBaseVNode("label",_hoisted_58,toDisplayString(unref($t)("settings.accessControl.test.ipLabel")),1),createBaseVNode("div",_hoisted_59,[createVNode(_component_CyberInput,{modelValue:testIP.value,"onUpdate:modelValue":_cache[9]||(_cache[9]=$event=>testIP.value=$event),class:"flex-1",placeholder:unref($t)("settings.accessControl.test.ipPlaceholder")},null,8,["modelValue","placeholder"]),createVNode(_component_CyberButton,{type:"secondary",onClick:_cache[10]||(_cache[10]=$event=>testAccess("ip"))},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.accessControl.test.button")),1)]),_:1})]),testResults.ip?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["test-result",testResults.ipAllowed?"test-success":"test-error"])},[createBaseVNode("i",{class:normalizeClass(testResults.ipAllowed?"fas fa-check-circle":"fas fa-times-circle")},null,2),createTextVNode(" "+toDisplayString(testResults.ip),1)],2)):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_60,[createBaseVNode("label",_hoisted_61,toDisplayString(unref($t)("settings.accessControl.test.domainLabel")),1),createBaseVNode("div",_hoisted_62,[createVNode(_component_CyberInput,{modelValue:testDomain.value,"onUpdate:modelValue":_cache[11]||(_cache[11]=$event=>testDomain.value=$event),class:"flex-1",placeholder:unref($t)("settings.accessControl.test.domainPlaceholder")},null,8,["modelValue","placeholder"]),createVNode(_component_CyberButton,{type:"secondary",onClick:_cache[12]||(_cache[12]=$event=>testAccess("domain"))},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("settings.accessControl.test.button")),1)]),_:1})]),testResults.domain?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["test-result",testResults.domainAllowed?"test-success":"test-error"])},[createBaseVNode("i",{class:normalizeClass(testResults.domainAllowed?"fas fa-check-circle":"fas fa-times-circle")},null,2),createTextVNode(" "+toDisplayString(testResults.domain),1)],2)):createCommentVNode("",!0)])])])]),createBaseVNode("div",_hoisted_63,[createVNode(_component_CyberButton,{type:"danger",onClick:resetConfig},{default:withCtx(()=>[_cache[18]||(_cache[18]=createBaseVNode("i",{class:"fas fa-undo"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.accessControl.actions.reset")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",loading:loading.value,onClick:saveConfig},{default:withCtx(()=>[_cache[19]||(_cache[19]=createBaseVNode("i",{class:"fas fa-save"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("settings.accessControl.actions.save")),1)]),_:1},8,["loading"])])],2)])}}});const AccessControlSection=_export_sfc(_sfc_main$3,[["__scopeId","data-v-d5ffd60d"]]),_hoisted_1$2={key:0,class:"setting-card"},_hoisted_2$2={class:"card-header"},_hoisted_3$2={class:"card-title"},_hoisted_4$2={class:"card-content"},_hoisted_5$2={key:0,class:"form-group"},_hoisted_6$2={class:"form-help"},_hoisted_7$2={class:"setting-body"},_sfc_main$2=defineComponent({name:"SettingCard",__name:"index",props:{icon:{},title:{},hint:{},show:{type:Boolean,default:!0}},setup(__props){return(_ctx,_cache)=>__props.show?(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[createBaseVNode("i",{class:normalizeClass(["card-icon",__props.icon])},null,2),createBaseVNode("span",null,toDisplayString(__props.title),1)])]),createBaseVNode("div",_hoisted_4$2,[__props.hint?(openBlock(),createElementBlock("div",_hoisted_5$2,[createBaseVNode("div",_hoisted_6$2,toDisplayString(__props.hint),1)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_7$2,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])])])):createCommentVNode("",!0)}});const SettingCard=_export_sfc(_sfc_main$2,[["__scopeId","data-v-bcb901b0"]]),_hoisted_1$1={class:"preferences-section"},_hoisted_2$1={class:"section-header"},_hoisted_3$1={class:"header-content"},_hoisted_4$1={class:"title-wrapper"},_hoisted_5$1={class:"title-text"},_hoisted_6$1={class:"title"},_hoisted_7$1={class:"subtitle"},_hoisted_8$1={class:"theme-grid"},_hoisted_9$1=["onClick"],_hoisted_10$1={class:"theme-icon"},_hoisted_11$1={class:"theme-info"},_hoisted_12$1={class:"theme-label"},_hoisted_13$1={class:"theme-description"},_hoisted_14={key:0,class:"theme-check"},_sfc_main$1=defineComponent({__name:"PreferencesSection",setup(__props,{expose:__expose}){const{currentTheme,currentLocale,setTheme:setTextTheme,setLocale,$t}=useTexts(),{selectedTheme,setTheme:setVisualTheme,themeOptions,allThemes}=useTheme(),layoutStore=useLayoutStore(),{layoutSettings}=useAppearanceSettings(),toast=useToast(),visualThemeOptions=themeOptions,textStyleOptionsWithHints=computed(()=>[{label:$t("settings.preferences.options.normalHint"),value:"normal"},{label:$t("settings.preferences.options.cyberHint"),value:"cyber"}]),localeOptions=computed(()=>[{label:$t("settings.preferences.languages.zhCN"),value:"zh-CN"},{label:$t("settings.preferences.languages.enUS"),value:"en-US"},{label:$t("settings.preferences.languages.jaJP"),value:"ja-JP"}]),layoutModeOptions=computed(()=>[{label:$t("settings.preferences.layoutModes.top"),value:"top"},{label:$t("settings.preferences.layoutModes.left"),value:"left"}]),selectedVisualTheme=ref("dark"),selectedTextStyle=ref("normal"),selectedLocale=ref("zh-CN"),selectedLayoutMode=ref("top"),loadPreferences=()=>{const savedVisualTheme=StorageUtil.get("visual-theme");savedVisualTheme&&allThemes.includes(savedVisualTheme)?selectedVisualTheme.value=savedVisualTheme:selectedVisualTheme.value=selectedTheme.value;const savedTextTheme=StorageUtil.get("text-theme");savedTextTheme&&["normal","cyber"].includes(savedTextTheme)?(selectedTextStyle.value=savedTextTheme,setTextTheme(savedTextTheme)):selectedTextStyle.value=currentTheme.value,selectedLocale.value=currentLocale.value,selectedLayoutMode.value=layoutStore.mode};watch(currentLocale,newLocale=>{selectedLocale.value=newLocale});const saveVisualTheme=theme=>{try{selectedVisualTheme.value=theme,setVisualTheme(theme),toast.success($t("settings.preferences.notifications.themeSuccess"))}catch{toast.error($t("settings.preferences.notifications.themeFailure"))}},saveTextStyle=style=>{try{selectedTextStyle.value=style,setTextTheme(style),StorageUtil.set("text-theme",style),toast.success($t("settings.preferences.notifications.success"))}catch{toast.error($t("settings.preferences.notifications.failure"))}},saveLocale=locale=>{try{selectedLocale.value=locale,setLocale(locale),toast.success($t("settings.preferences.notifications.localeSuccess"))}catch{toast.error($t("settings.preferences.notifications.localeFailure"))}},saveLayoutMode=mode=>{try{selectedLayoutMode.value=mode,layoutStore.setLayoutMode(mode),toast.success($t("settings.preferences.notifications.layoutSuccess"))}catch{toast.error($t("settings.preferences.notifications.layoutFailure"))}};return onMounted(()=>{loadPreferences()}),__expose({loadPreferences}),(_ctx,_cache)=>{const _component_CyberRadioGroup=resolveComponent("CyberRadioGroup");return openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",_hoisted_3$1,[createBaseVNode("div",_hoisted_4$1,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"title-icon"},[createBaseVNode("i",{class:"fas fa-cog"})],-1)),createBaseVNode("div",_hoisted_5$1,[createBaseVNode("h2",_hoisted_6$1,toDisplayString(unref($t)("settings.preferences.title")),1),createBaseVNode("p",_hoisted_7$1,toDisplayString(unref($t)("settings.preferences.description")),1)])])])]),createVNode(SettingCard,{icon:"fas fa-language",title:unref($t)("settings.preferences.section.languageTitle"),hint:unref($t)("settings.preferences.section.languageHint")},{default:withCtx(()=>[createVNode(_component_CyberRadioGroup,{modelValue:selectedLocale.value,"onUpdate:modelValue":[_cache[0]||(_cache[0]=$event=>selectedLocale.value=$event),saveLocale],options:localeOptions.value,layout:"horizontal"},null,8,["modelValue","options"])]),_:1},8,["title","hint"]),createVNode(SettingCard,{icon:"fas fa-palette",title:unref($t)("settings.preferences.section.visualThemeTitle"),hint:unref($t)("settings.preferences.section.visualThemeHint")},{default:withCtx(()=>[createBaseVNode("div",_hoisted_8$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(visualThemeOptions),option=>(openBlock(),createElementBlock("button",{key:option.value,class:normalizeClass(["theme-option",{active:selectedVisualTheme.value===option.value}]),onClick:$event=>saveVisualTheme(option.value)},[createBaseVNode("div",_hoisted_10$1,[createBaseVNode("i",{class:normalizeClass(["fas",`fa-${option.icon}`])},null,2)]),createBaseVNode("div",_hoisted_11$1,[createBaseVNode("div",_hoisted_12$1,toDisplayString(option.label),1),createBaseVNode("div",_hoisted_13$1,toDisplayString(option.description),1)]),selectedVisualTheme.value===option.value?(openBlock(),createElementBlock("div",_hoisted_14,[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-check-circle"},null,-1)])])):createCommentVNode("",!0)],10,_hoisted_9$1))),128))])]),_:1},8,["title","hint"]),createVNode(SettingCard,{icon:"fas fa-grip-horizontal",title:unref($t)("settings.preferences.section.layoutTitle"),hint:unref($t)("settings.preferences.section.layoutHint"),show:unref(layoutSettings).multiLayoutEnabled},{default:withCtx(()=>[createVNode(_component_CyberRadioGroup,{modelValue:selectedLayoutMode.value,"onUpdate:modelValue":[_cache[1]||(_cache[1]=$event=>selectedLayoutMode.value=$event),saveLayoutMode],options:layoutModeOptions.value,layout:"horizontal"},null,8,["modelValue","options"])]),_:1},8,["title","hint","show"]),createVNode(SettingCard,{icon:"fas fa-font",title:unref($t)("settings.preferences.section.interfaceTitle"),hint:unref($t)("settings.preferences.section.interfaceHint")},{default:withCtx(()=>[createVNode(_component_CyberRadioGroup,{modelValue:selectedTextStyle.value,"onUpdate:modelValue":[_cache[2]||(_cache[2]=$event=>selectedTextStyle.value=$event),saveTextStyle],options:textStyleOptionsWithHints.value,layout:"horizontal"},null,8,["modelValue","options"])]),_:1},8,["title","hint"])])}}});const PreferencesSection=_export_sfc(_sfc_main$1,[["__scopeId","data-v-98650dd7"]]),_hoisted_1={class:"settings-page"},_hoisted_2={class:"settings-header"},_hoisted_3={class:"header-main"},_hoisted_4={class:"header-left"},_hoisted_5={class:"title-section"},_hoisted_6={class:"page-title"},_hoisted_7={class:"title-text"},_hoisted_8={class:"subtitle"},_hoisted_9={class:"header-topbar"},_hoisted_10={class:"nav-tabs"},_hoisted_11=["onClick"],_hoisted_12={class:"settings-content"},_hoisted_13={class:"content-container"},_sfc_main=defineComponent({__name:"index",setup(__props){const route=useRoute(),{$t}=useTexts(),navItems=computed(()=>[{id:"profile",label:$t("settings.nav.profile"),icon:"user",iconClass:"text-content"},{id:"security",label:$t("settings.nav.security"),icon:"lock",iconClass:"text-warning-400"},{id:"api",label:$t("settings.nav.apiKeys"),icon:"key",iconClass:"text-error-400"},{id:"access-control",label:$t("settings.nav.accessControl"),icon:"shield-alt",iconClass:"text-success-400"},{id:"preferences",label:$t("settings.nav.preferences"),icon:"cog",iconClass:"text-purple-400"}]),profileSectionRef=ref(null),apiKeySectionRef=ref(null),accessControlSectionRef=ref(null),preferencesSectionRef=ref(null),activeSection=ref("profile"),updateUrlHash=hash=>{window.history.replaceState(null,"",`#${hash}`)},loadComponentData=tabId=>{switch(tabId){case"profile":profileSectionRef.value&&profileSectionRef.value.fetchUserProfile?.();break;case"api":if(apiKeySectionRef.value){const{apiKeyManagerRef}=apiKeySectionRef.value;apiKeyManagerRef&&apiKeyManagerRef.fetchApiKeys()}break;case"access-control":accessControlSectionRef.value&&accessControlSectionRef.value.fetchAccessControlConfig?.();break}},switchTab=tabId=>{activeSection.value=tabId,updateUrlHash(tabId),loadComponentData(tabId)};return watch(()=>route.hash,newHash=>{const hash=newHash.replace("#","");navItems.value.some(item=>item.id===hash)&&(activeSection.value=hash,loadComponentData(hash))},{immediate:!0}),onMounted(()=>{const initialHash=window.location.hash.substring(1);initialHash&&navItems.value.some(item=>item.id===initialHash)?activeSection.value=initialHash:(activeSection.value="profile",updateUrlHash("profile"))}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("header",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[createBaseVNode("h1",_hoisted_6,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-cog title-icon"},null,-1)),createBaseVNode("span",_hoisted_7,toDisplayString(unref($t)("settings.page.title")),1)]),createBaseVNode("div",_hoisted_8,toDisplayString(unref($t)("settings.page.subtitle")),1)])])]),createBaseVNode("div",_hoisted_9,[createBaseVNode("div",_hoisted_10,[(openBlock(!0),createElementBlock(Fragment,null,renderList(navItems.value,item=>(openBlock(),createElementBlock("button",{key:item.id,class:normalizeClass(["nav-tab",{active:activeSection.value===item.id}]),onClick:$event=>switchTab(item.id)},[createBaseVNode("i",{class:normalizeClass(["fas",`fa-${item.icon}`,item.iconClass])},null,2),createBaseVNode("span",null,toDisplayString(item.label),1)],10,_hoisted_11))),128))])])]),createBaseVNode("main",_hoisted_12,[createBaseVNode("div",_hoisted_13,[withDirectives(createVNode(ProfileSection,{ref_key:"profileSectionRef",ref:profileSectionRef},null,512),[[vShow,activeSection.value==="profile"]]),withDirectives(createVNode(SecuritySection,null,null,512),[[vShow,activeSection.value==="security"]]),withDirectives(createVNode(ApiKeySection,{ref_key:"apiKeySectionRef",ref:apiKeySectionRef},null,512),[[vShow,activeSection.value==="api"]]),withDirectives(createVNode(AccessControlSection,{ref_key:"accessControlSectionRef",ref:accessControlSectionRef},null,512),[[vShow,activeSection.value==="access-control"]]),withDirectives(createVNode(PreferencesSection,{ref_key:"preferencesSectionRef",ref:preferencesSectionRef},null,512),[[vShow,activeSection.value==="preferences"]])])])]))}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-d6d2a2c0"]]);export{index as default};
