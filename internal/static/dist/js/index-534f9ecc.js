import{j as useTexts,_ as _export_sfc,m as useSettingsStore,q as useToast,g as getSettings,b as batchUpsertSettings,aQ as __unplugin_components_0}from"./index-38202212.js";import{d as defineComponent,a as reactive,w as watch,c as computed,b as onMounted,E as resolveComponent,z as openBlock,I as createElementBlock,a0 as createBaseVNode,ab as createTextVNode,a1 as toDisplayString,u as unref,f as createVNode,L as withCtx,r as ref,F as Fragment,M as renderList,K as createCommentVNode,R as normalizeClass,A as createBlock,a4 as useRoute,a3 as useRouter,H as withDirectives,$ as vShow}from"./vue-vendor-31320f47.js";import{d as defaultSettings,e as testQdrantConnection,c as checkAIConfiguration,b as testAIConfig,a as testVectorConfig,r as regenerateVectors}from"./defaults-22ab3e46.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const _hoisted_1$3={class:"ai-settings-container"},_hoisted_2$3={class:"settings-list"},_hoisted_3$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_4$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_5$3={class:"flex-1"},_hoisted_6$3={class:"flex items-center"},_hoisted_7$3={class:"ml-3 text-sm text-content-muted"},_hoisted_8$3={class:"setting-description"},_hoisted_9$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_10$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_11$3={class:"flex-1"},_hoisted_12$3={class:"setting-description"},_hoisted_13$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_14$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_15$3={class:"flex-1"},_hoisted_16$3={class:"setting-description"},_hoisted_17$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_18$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_19$3={class:"flex-1"},_hoisted_20$3={class:"setting-description"},_hoisted_21$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_22$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_23$3={class:"flex-1"},_hoisted_24$3={class:"slider-container flex items-center"},_hoisted_25$3={class:"ml-3 flex h-full items-center text-sm text-content-muted"},_hoisted_26$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_27$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_28$3={class:"flex-1"},_hoisted_29$3={class:"setting-description"},_hoisted_30$3={class:"flex flex-col md:flex-row md:items-center"},_hoisted_31$3={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_32$3={class:"flex-1"},_hoisted_33$2={class:"setting-description"},_hoisted_34$2={class:"feature-list"},_sfc_main$3=defineComponent({__name:"AISettings",props:{settings:{}},emits:["update"],setup(__props,{emit:__emit}){const{$t}=useTexts(),props=__props,emit=__emit,aiDefaults=defaultSettings.ai.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{}),localSettings=reactive({ai_enabled:aiDefaults.ai_enabled??!1,ai_proxy:aiDefaults.ai_proxy||"",ai_model:aiDefaults.ai_model||"gpt-4o-mini",ai_api_key:aiDefaults.ai_api_key||"",ai_temperature:aiDefaults.ai_temperature??.1,ai_max_tokens:aiDefaults.ai_max_tokens||8096,ai_concurrency:aiDefaults.ai_concurrency||5}),sanitizeInput=value=>value?value.trim().replace(/[\s\n\r\t]/g,"").replace(/["'`]/g,""):"";watch(()=>localSettings.ai_proxy,newValue=>{const sanitized=sanitizeInput(newValue);sanitized!==newValue&&(localSettings.ai_proxy=sanitized)}),watch(()=>localSettings.ai_api_key,newValue=>{const sanitized=sanitizeInput(newValue);sanitized!==newValue&&(localSettings.ai_api_key=sanitized)});const modelOptions=computed(()=>{const presetModels=["gpt-5-mini","gpt-5-nano","gpt-4.1-nano","gpt-4o-mini","gpt-4.1-mini","o3-mini","o4-mini","o4-mini-high","gpt-4o","gpt-4-turbo-with-vision","gpt-4.1-mini-2025-04-14","gpt-4.1-nano-2025-04-14"],currentModel=localSettings.ai_model;return currentModel&&!presetModels.includes(currentModel)?[currentModel,...presetModels].map(model=>({label:model,value:model})):presetModels.map(model=>({label:model,value:model}))}),getSettingsArray=()=>Object.entries(localSettings).map(([key,value])=>({key,value,type:typeof value=="number"?"number":typeof value=="boolean"?"boolean":"string",group:"ai",description:"",is_system:!0})),initializeSettings=()=>{props.settings.forEach(setting=>{setting.key in localSettings&&(localSettings[setting.key]=setting.value)})};return watch(localSettings,()=>{emit("update",getSettingsArray())},{deep:!0}),watch(()=>props.settings,newSettings=>{newSettings&&newSettings.length>0&&initializeSettings()},{immediate:!0}),onMounted(()=>{initializeSettings()}),(_ctx,_cache)=>{const _component_CyberSwitch=resolveComponent("CyberSwitch"),_component_CyberInput=resolveComponent("CyberInput"),_component_CyberDropdown=resolveComponent("CyberDropdown"),_component_CyberSlider=resolveComponent("CyberSlider");return openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("div",_hoisted_2$3,[createBaseVNode("div",_hoisted_3$3,[createBaseVNode("label",_hoisted_4$3,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-power-off mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.enableAI")),1)]),createBaseVNode("div",_hoisted_5$3,[createBaseVNode("div",_hoisted_6$3,[createVNode(_component_CyberSwitch,{modelValue:localSettings.ai_enabled,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localSettings.ai_enabled=$event)},null,8,["modelValue"]),createBaseVNode("span",_hoisted_7$3,toDisplayString(localSettings.ai_enabled?unref($t)("admin.ai.aiSettings.aiEnabled"):unref($t)("admin.ai.aiSettings.aiDisabled")),1)]),createBaseVNode("p",_hoisted_8$3,toDisplayString(unref($t)("admin.ai.aiSettings.enableDesc")),1)])]),createBaseVNode("div",_hoisted_9$3,[createBaseVNode("label",_hoisted_10$3,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-network-wired mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.proxyUrl")),1)]),createBaseVNode("div",_hoisted_11$3,[createVNode(_component_CyberInput,{modelValue:localSettings.ai_proxy,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>localSettings.ai_proxy=$event),placeholder:unref($t)("admin.ai.aiSettings.proxyPlaceholder"),width:"500px"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_12$3,toDisplayString(unref($t)("admin.ai.aiSettings.proxyDesc")),1)])]),createBaseVNode("div",_hoisted_13$3,[createBaseVNode("label",_hoisted_14$3,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-key mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.apiKey")),1)]),createBaseVNode("div",_hoisted_15$3,[createVNode(_component_CyberInput,{modelValue:localSettings.ai_api_key,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>localSettings.ai_api_key=$event),type:"password",placeholder:unref($t)("admin.ai.aiSettings.apiKeyPlaceholder"),width:"500px"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_16$3,toDisplayString(unref($t)("admin.ai.aiSettings.apiKeyDesc")),1)])]),createBaseVNode("div",_hoisted_17$3,[createBaseVNode("label",_hoisted_18$3,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-robot mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.modelSelect")),1)]),createBaseVNode("div",_hoisted_19$3,[createVNode(_component_CyberDropdown,{modelValue:localSettings.ai_model,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>localSettings.ai_model=$event),options:modelOptions.value,placeholder:unref($t)("admin.ai.aiSettings.modelPlaceholder"),width:"500px",searchable:"","allow-create":"","create-label":unref($t)("admin.ai.aiSettings.createModel")},null,8,["modelValue","options","placeholder","create-label"]),createBaseVNode("p",_hoisted_20$3,toDisplayString(unref($t)("admin.ai.aiSettings.modelDesc")),1)])]),createBaseVNode("div",_hoisted_21$3,[createBaseVNode("label",_hoisted_22$3,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-thermometer-half mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.temperature")),1)]),createBaseVNode("div",_hoisted_23$3,[createBaseVNode("div",_hoisted_24$3,[createVNode(_component_CyberSlider,{modelValue:localSettings.ai_temperature,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>localSettings.ai_temperature=$event),min:0,max:1,step:.01,description:unref($t)("admin.ai.aiSettings.temperatureDesc"),width:"460px"},null,8,["modelValue","description"]),createBaseVNode("span",_hoisted_25$3,toDisplayString(localSettings.ai_temperature.toFixed(2)),1)])])]),createBaseVNode("div",_hoisted_26$3,[createBaseVNode("label",_hoisted_27$3,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-text-width mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.maxTokens")),1)]),createBaseVNode("div",_hoisted_28$3,[createVNode(_component_CyberInput,{modelValue:localSettings.ai_max_tokens,"onUpdate:modelValue":_cache[5]||(_cache[5]=$event=>localSettings.ai_max_tokens=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("admin.ai.aiSettings.maxTokensPlaceholder"),width:"500px"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_29$3,toDisplayString(unref($t)("admin.ai.aiSettings.maxTokensDesc")),1)])]),createBaseVNode("div",_hoisted_30$3,[createBaseVNode("label",_hoisted_31$3,[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-tasks mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.concurrency")),1)]),createBaseVNode("div",_hoisted_32$3,[createVNode(_component_CyberInput,{modelValue:localSettings.ai_concurrency,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>localSettings.ai_concurrency=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("admin.ai.aiSettings.concurrencyPlaceholder"),width:"500px",min:1,max:20},{unit:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.aiSettings.unitCount")),1)]),_:1},8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_33$2,toDisplayString(unref($t)("admin.ai.aiSettings.concurrencyDesc")),1)])]),createBaseVNode("ul",_hoisted_34$2,[createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.aiSettings.features.autoTag")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.aiSettings.features.smartCategory")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.aiSettings.features.batchProcess")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.aiSettings.features.detailedDesc")),1)])])])}}});const AISettings=_export_sfc(_sfc_main$3,[["__scopeId","data-v-2dbbb9c1"]]),_hoisted_1$2={class:"vector-settings-container"},_hoisted_2$2={class:"settings-list"},_hoisted_3$2={class:"settings-group"},_hoisted_4$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_5$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_6$2={class:"flex-1"},_hoisted_7$2={class:"setting-description"},_hoisted_8$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_9$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_10$2={class:"flex-1"},_hoisted_11$2={class:"slider-container flex items-center"},_hoisted_12$2={class:"text-content-content-muted ml-3 flex h-full items-center text-sm"},_hoisted_13$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_14$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_15$2={class:"flex-1"},_hoisted_16$2={class:"setting-description"},_hoisted_17$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_18$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_19$2={class:"flex-1"},_hoisted_20$2={class:"setting-description"},_hoisted_21$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_22$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_23$2={class:"flex-1"},_hoisted_24$2={class:"setting-description"},_hoisted_25$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_26$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_27$2={class:"flex-1"},_hoisted_28$2={class:"setting-description"},_hoisted_29$2={class:"flex flex-col md:flex-row md:items-center"},_hoisted_30$2={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_31$2={class:"flex-1"},_hoisted_32$2={class:"setting-description"},_hoisted_33$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_34$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_35$1={class:"flex-1"},_hoisted_36$1={class:"slider-container flex items-center"},_hoisted_37$1={class:"text-content-content-muted ml-3 flex h-full items-center text-sm"},_hoisted_38$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_39$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_40$1={class:"flex-1"},_hoisted_41$1={class:"setting-description"},_hoisted_42$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_43$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_44$1={class:"flex-1"},_hoisted_45$1={class:"setting-description"},_hoisted_46$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_47$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_48$1={class:"flex-1"},_hoisted_49$1={class:"flex items-center gap-2"},_hoisted_50$1={key:0,class:"mt-1 text-xs text-yellow-600"},_hoisted_51$1={key:1,class:"setting-description"},_hoisted_52$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_53$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_54$1={class:"flex-1"},_hoisted_55$1={class:"setting-description"},_hoisted_56$1={class:"feature-list"},_sfc_main$2=defineComponent({__name:"VectorSettings",props:{settings:{}},emits:["update"],setup(__props,{emit:__emit}){const{$t}=useTexts(),settingsStore=useSettingsStore(),props=__props,emit=__emit,toast=useToast(),isTestingQdrant=ref(!1),isDockerMode=computed(()=>{const deployMode=settingsStore.rawSettings?.deploy_mode;return deployMode==="docker"||deployMode==="compose"}),localSettings=reactive({vector_enabled:!1,vector_provider:"openai",vector_model:"text-embedding-3-small",vector_api_key:"",vector_base_url:"https://api.openai.com/v1",vector_timeout:30,vector_similarity_threshold:.7,vector_search_threshold:.3,vector_max_results:50,vector_concurrency:3,qdrant_url:"http://localhost:6333",qdrant_timeout:30}),providerOptions=[{label:"OpenAI",value:"openai"}],modelOptions=computed(()=>{const presetModels=[{label:$t("admin.ai.vectorSettings.models.small"),value:"text-embedding-3-small"},{label:$t("admin.ai.vectorSettings.models.large"),value:"text-embedding-3-large"},{label:$t("admin.ai.vectorSettings.models.ada"),value:"text-embedding-ada-002"}],currentModel=localSettings.vector_model,presetValues=presetModels.map(m=>m.value);return currentModel&&!presetValues.includes(currentModel)?[{label:currentModel,value:currentModel},...presetModels]:presetModels}),isInitializing=ref(!0);watch(()=>props.settings,newSettings=>{newSettings&&newSettings.length>0&&(newSettings.forEach(setting=>{setting.key in localSettings&&(localSettings[setting.key]=setting.value)}),isInitializing.value&&setTimeout(()=>{isInitializing.value=!1},100))},{immediate:!0}),watch(()=>localSettings.vector_model,(newModel,oldModel)=>{isInitializing.value||!oldModel||newModel===oldModel||toast.success($t("admin.ai.messages.vectorModelChanged").replace("{model}",newModel))}),watch(localSettings,()=>{const updatedSettings=Object.keys(localSettings).map(key=>{const originalSetting=props.settings.find(s=>s.key===key),settingsRecord=localSettings;return{...originalSetting,key,value:settingsRecord[key],type:getSettingType(settingsRecord[key]),group:"vector",description:getSettingDescription(key),is_system:!0}});emit("update",updatedSettings)},{deep:!0});function getSettingType(value){return typeof value=="boolean"?"boolean":typeof value=="number"?"number":"string"}function getSettingDescription(key){return{vector_enabled:$t("admin.ai.vectorSettings.vectorDesc"),vector_provider:$t("admin.ai.vectorSettings.providerDesc"),vector_model:$t("admin.ai.vectorSettings.modelDesc"),vector_api_key:$t("admin.ai.vectorSettings.apiKeyDesc"),vector_base_url:$t("admin.ai.vectorSettings.apiBaseUrlDesc"),vector_timeout:$t("admin.ai.vectorSettings.apiTimeoutDesc"),vector_similarity_threshold:$t("admin.ai.vectorSettings.similarityThresholdDesc"),vector_search_threshold:$t("admin.ai.vectorSettings.searchThresholdDesc"),vector_max_results:$t("admin.ai.vectorSettings.maxResultsDesc"),vector_concurrency:$t("admin.ai.vectorSettings.concurrencyDesc"),qdrant_url:$t("admin.ai.vectorSettings.qdrantUrlDesc"),qdrant_timeout:$t("admin.ai.vectorSettings.qdrantTimeoutDesc")}[key]||""}async function handleTestQdrant(){if(!localSettings.qdrant_url){toast.warning($t("admin.ai.messages.needQdrantUrl"));return}isTestingQdrant.value=!0;try{const result=await testQdrantConnection({qdrant_url:localSettings.qdrant_url,qdrant_timeout:localSettings.qdrant_timeout||30});if(result.data?.success){const details=result.data.details;let message=$t("admin.ai.messages.qdrantConnectSuccess");details&&(details.version&&(message+=`
${$t("admin.ai.testResults.version")}: ${details.version}`),details.total_vectors!==void 0&&(message+=`
${$t("admin.ai.testResults.totalVectors")}: ${details.total_vectors}`),details.response_time!==void 0&&(message+=`
${$t("admin.ai.testResults.responseTime")}: ${details.response_time}ms`)),toast.success(message)}else toast.error(result.data?.message||$t("admin.ai.messages.qdrantConnectFailed"))}catch(error){const err=error;toast.error($t("admin.ai.messages.qdrantTestFailed").replace("{error}",err.message||$t("admin.ai.messages.unknownError")))}finally{isTestingQdrant.value=!1}}return(_ctx,_cache)=>{const _component_CyberSwitch=resolveComponent("CyberSwitch"),_component_CyberSlider=resolveComponent("CyberSlider"),_component_CyberDropdown=resolveComponent("CyberDropdown"),_component_CyberInput=resolveComponent("CyberInput"),_component_CyberButton=resolveComponent("CyberButton");return openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[createBaseVNode("div",_hoisted_4$2,[createBaseVNode("label",_hoisted_5$2,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-toggle-on mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.enableVector")),1)]),createBaseVNode("div",_hoisted_6$2,[createVNode(_component_CyberSwitch,{modelValue:localSettings.vector_enabled,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localSettings.vector_enabled=$event)},null,8,["modelValue"]),createBaseVNode("p",_hoisted_7$2,toDisplayString(unref($t)("admin.ai.vectorSettings.vectorDesc")),1)])]),createBaseVNode("div",_hoisted_8$2,[createBaseVNode("label",_hoisted_9$2,[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-search mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.searchThreshold")),1)]),createBaseVNode("div",_hoisted_10$2,[createBaseVNode("div",_hoisted_11$2,[createVNode(_component_CyberSlider,{modelValue:localSettings.vector_search_threshold,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>localSettings.vector_search_threshold=$event),min:0,max:1,step:.01,description:unref($t)("admin.ai.vectorSettings.searchThresholdDesc"),width:"460px"},null,8,["modelValue","description"]),createBaseVNode("span",_hoisted_12$2,toDisplayString(localSettings.vector_search_threshold.toFixed(2)),1)])])]),createBaseVNode("div",_hoisted_13$2,[createBaseVNode("label",_hoisted_14$2,[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-cloud mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.provider")),1)]),createBaseVNode("div",_hoisted_15$2,[createVNode(_component_CyberDropdown,{modelValue:localSettings.vector_provider,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>localSettings.vector_provider=$event),options:providerOptions,placeholder:unref($t)("admin.ai.vectorSettings.providerPlaceholder"),width:"500px"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_16$2,toDisplayString(unref($t)("admin.ai.vectorSettings.providerDesc")),1)])]),createBaseVNode("div",_hoisted_17$2,[createBaseVNode("label",_hoisted_18$2,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-network-wired mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.apiBaseUrl")),1)]),createBaseVNode("div",_hoisted_19$2,[createVNode(_component_CyberInput,{modelValue:localSettings.vector_base_url,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>localSettings.vector_base_url=$event),placeholder:unref($t)("admin.ai.vectorSettings.apiBaseUrlPlaceholder"),width:"500px"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_20$2,toDisplayString(unref($t)("admin.ai.vectorSettings.apiBaseUrlDesc")),1)])]),createBaseVNode("div",_hoisted_21$2,[createBaseVNode("label",_hoisted_22$2,[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-key mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.apiKey")),1)]),createBaseVNode("div",_hoisted_23$2,[createVNode(_component_CyberInput,{modelValue:localSettings.vector_api_key,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>localSettings.vector_api_key=$event),type:"password",placeholder:unref($t)("admin.ai.vectorSettings.apiKeyPlaceholder"),width:"500px"},null,8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_24$2,toDisplayString(unref($t)("admin.ai.vectorSettings.apiKeyDesc")),1)])]),createBaseVNode("div",_hoisted_25$2,[createBaseVNode("label",_hoisted_26$2,[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-robot mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.model")),1)]),createBaseVNode("div",_hoisted_27$2,[createVNode(_component_CyberDropdown,{modelValue:localSettings.vector_model,"onUpdate:modelValue":_cache[5]||(_cache[5]=$event=>localSettings.vector_model=$event),options:modelOptions.value,placeholder:unref($t)("admin.ai.vectorSettings.modelPlaceholder"),width:"500px",searchable:"","allow-create":"","create-label":unref($t)("admin.ai.vectorSettings.createModel")},null,8,["modelValue","options","placeholder","create-label"]),createBaseVNode("p",_hoisted_28$2,toDisplayString(unref($t)("admin.ai.vectorSettings.modelDesc")),1)])]),createBaseVNode("div",_hoisted_29$2,[createBaseVNode("label",_hoisted_30$2,[_cache[18]||(_cache[18]=createBaseVNode("i",{class:"fas fa-clock mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.apiTimeout")),1)]),createBaseVNode("div",_hoisted_31$2,[createVNode(_component_CyberInput,{modelValue:localSettings.vector_timeout,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>localSettings.vector_timeout=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("admin.ai.vectorSettings.apiTimeoutPlaceholder"),width:"500px"},{unit:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.unitSeconds")),1)]),_:1},8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_32$2,toDisplayString(unref($t)("admin.ai.vectorSettings.apiTimeoutDesc")),1)])]),createBaseVNode("div",_hoisted_33$1,[createBaseVNode("label",_hoisted_34$1,[_cache[19]||(_cache[19]=createBaseVNode("i",{class:"fas fa-percentage mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.similarityThreshold")),1)]),createBaseVNode("div",_hoisted_35$1,[createBaseVNode("div",_hoisted_36$1,[createVNode(_component_CyberSlider,{modelValue:localSettings.vector_similarity_threshold,"onUpdate:modelValue":_cache[7]||(_cache[7]=$event=>localSettings.vector_similarity_threshold=$event),min:0,max:1,step:.01,description:unref($t)("admin.ai.vectorSettings.similarityThresholdDesc"),width:"460px"},null,8,["modelValue","description"]),createBaseVNode("span",_hoisted_37$1,toDisplayString(localSettings.vector_similarity_threshold.toFixed(2)),1)])])]),createBaseVNode("div",_hoisted_38$1,[createBaseVNode("label",_hoisted_39$1,[_cache[20]||(_cache[20]=createBaseVNode("i",{class:"fas fa-list-ol mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.maxResults")),1)]),createBaseVNode("div",_hoisted_40$1,[createVNode(_component_CyberInput,{modelValue:localSettings.vector_max_results,"onUpdate:modelValue":_cache[8]||(_cache[8]=$event=>localSettings.vector_max_results=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("admin.ai.vectorSettings.maxResultsPlaceholder"),width:"500px"},{unit:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.unitResults")),1)]),_:1},8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_41$1,toDisplayString(unref($t)("admin.ai.vectorSettings.maxResultsDesc")),1)])]),createBaseVNode("div",_hoisted_42$1,[createBaseVNode("label",_hoisted_43$1,[_cache[21]||(_cache[21]=createBaseVNode("i",{class:"fas fa-tasks mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.concurrency")),1)]),createBaseVNode("div",_hoisted_44$1,[createVNode(_component_CyberInput,{modelValue:localSettings.vector_concurrency,"onUpdate:modelValue":_cache[9]||(_cache[9]=$event=>localSettings.vector_concurrency=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("admin.ai.vectorSettings.concurrencyPlaceholder"),width:"500px",min:1,max:10},{unit:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.unitCount")),1)]),_:1},8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_45$1,toDisplayString(unref($t)("admin.ai.vectorSettings.concurrencyDesc")),1)])]),createBaseVNode("div",_hoisted_46$1,[createBaseVNode("label",_hoisted_47$1,[_cache[22]||(_cache[22]=createBaseVNode("i",{class:"fas fa-database mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.qdrantUrl")),1)]),createBaseVNode("div",_hoisted_48$1,[createBaseVNode("div",_hoisted_49$1,[createVNode(_component_CyberInput,{modelValue:localSettings.qdrant_url,"onUpdate:modelValue":_cache[10]||(_cache[10]=$event=>localSettings.qdrant_url=$event),placeholder:unref($t)("admin.ai.vectorSettings.qdrantUrlPlaceholder"),disabled:isDockerMode.value,width:"400px"},null,8,["modelValue","placeholder","disabled"]),createVNode(_component_CyberButton,{loading:isTestingQdrant.value,disabled:!localSettings.qdrant_url||isDockerMode.value,size:"small",type:"primary",onClick:handleTestQdrant},{default:withCtx(()=>[_cache[23]||(_cache[23]=createBaseVNode("i",{class:"fas fa-vial mr-1"},null,-1)),createTextVNode(" "+toDisplayString(isTestingQdrant.value?unref($t)("admin.ai.actions.testing"):unref($t)("admin.ai.actions.testConnection")),1)]),_:1},8,["loading","disabled"])]),isDockerMode.value?(openBlock(),createElementBlock("p",_hoisted_50$1,[_cache[24]||(_cache[24]=createBaseVNode("i",{class:"fas fa-info-circle mr-1"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.qdrantUrlDockerWarning")),1)])):(openBlock(),createElementBlock("p",_hoisted_51$1,toDisplayString(unref($t)("admin.ai.vectorSettings.qdrantUrlDesc")),1))])]),createBaseVNode("div",_hoisted_52$1,[createBaseVNode("label",_hoisted_53$1,[_cache[25]||(_cache[25]=createBaseVNode("i",{class:"fas fa-stopwatch mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.qdrantTimeout")),1)]),createBaseVNode("div",_hoisted_54$1,[createVNode(_component_CyberInput,{modelValue:localSettings.qdrant_timeout,"onUpdate:modelValue":_cache[11]||(_cache[11]=$event=>localSettings.qdrant_timeout=$event),modelModifiers:{number:!0},type:"number",placeholder:unref($t)("admin.ai.vectorSettings.qdrantTimeoutPlaceholder"),width:"500px"},{unit:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.vectorSettings.unitSeconds")),1)]),_:1},8,["modelValue","placeholder"]),createBaseVNode("p",_hoisted_55$1,toDisplayString(unref($t)("admin.ai.vectorSettings.qdrantTimeoutDesc")),1)])]),createBaseVNode("ul",_hoisted_56$1,[createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.vectorSettings.features.naturalLanguage")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.vectorSettings.features.imageSimilarity")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.vectorSettings.features.smartRecommend")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.vectorSettings.features.semanticSearch")),1)])])])])}}});const VectorSettings=_export_sfc(_sfc_main$2,[["__scopeId","data-v-0f380b20"]]),_hoisted_1$1={class:"content-detection-container"},_hoisted_2$1={class:"settings-list"},_hoisted_3$1={class:"settings-group"},_hoisted_4$1={key:0,class:"warning-panel"},_hoisted_5$1={class:"flex items-start"},_hoisted_6$1={class:"warning-title"},_hoisted_7$1={class:"warning-text"},_hoisted_8$1={class:"missing-fields"},_hoisted_9$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_10$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_11$1={class:"flex-1"},_hoisted_12$1={class:"flex items-center"},_hoisted_13$1={class:"ml-3 text-sm text-content-muted"},_hoisted_14$1={class:"setting-description"},_hoisted_15$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_16$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_17$1={class:"flex-1"},_hoisted_18$1={class:"setting-description"},_hoisted_19$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_20$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_21$1={class:"flex-1"},_hoisted_22$1={class:"flex items-center"},_hoisted_23$1={class:"ml-3 text-sm text-content-muted"},_hoisted_24$1={class:"setting-description"},_hoisted_25$1={class:"flex flex-col md:flex-row md:items-center"},_hoisted_26$1={class:"flex w-full items-center text-sm text-content md:w-48 md:py-2"},_hoisted_27$1={class:"flex-1"},_hoisted_28$1={class:"slider-container flex items-center"},_hoisted_29$1={class:"ml-3 flex h-full items-center text-sm text-content-muted"},_hoisted_30$1={class:"ml-3 flex items-center text-xs text-content-muted"},_hoisted_31$1={class:"mr-2"},_hoisted_32$1={class:"feature-list"},_sfc_main$1=defineComponent({__name:"ContentDetectionSettings",props:{settings:{},aiSettings:{}},emits:["update"],setup(__props,{emit:__emit}){const{$t}=useTexts(),props=__props,emit=__emit,settingsStore=useSettingsStore(),getFieldName=key=>$t(`admin.ai.contentDetection.fieldNames.${key}`)||key,uploadDefaults=defaultSettings.upload.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{}),aiDefaults=defaultSettings.ai.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{}),localSettings=reactive({content_detection_enabled:uploadDefaults.content_detection_enabled??!0,sensitive_content_handling:uploadDefaults.sensitive_content_handling||"mark_only",ai_analysis_enabled:uploadDefaults.ai_analysis_enabled??!0,nsfw_threshold:aiDefaults.nsfw_threshold??.6}),sensitiveContentOptions=computed(()=>[{label:$t("admin.ai.contentDetection.sensitiveOptions.markOnly"),value:"mark_only",description:$t("admin.ai.contentDetection.sensitiveOptions.markOnlyDesc")},{label:$t("admin.ai.contentDetection.sensitiveOptions.autoDelete"),value:"auto_delete",description:$t("admin.ai.contentDetection.sensitiveOptions.autoDeleteDesc")},{label:$t("admin.ai.contentDetection.sensitiveOptions.pendingReview"),value:"pending_review",description:$t("admin.ai.contentDetection.sensitiveOptions.pendingReviewDesc")}]),getThresholdLabel=threshold=>threshold<=.3?{text:$t("admin.ai.contentDetection.thresholds.lenient"),color:"text-green-400"}:threshold<=.5?{text:$t("admin.ai.contentDetection.thresholds.moderate"),color:"text-yellow-400"}:threshold<=.7?{text:$t("admin.ai.contentDetection.thresholds.strict"),color:"text-orange-400"}:{text:$t("admin.ai.contentDetection.thresholds.veryStrict"),color:"text-red-400"},aiConfigStatus=computed(()=>{const{isAIEnabled}=settingsStore;if(!isAIEnabled)return{isConfigured:!1,missingFields:["ai_enabled"],hasApiKey:!1,hasModel:!1};if(!props.aiSettings||props.aiSettings.length===0)return{isConfigured:!0,missingFields:[],hasApiKey:!0,hasModel:!0};const settingsMap=props.aiSettings.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{}),missingFields=[],hasApiKey=!!(settingsMap.ai_api_key&&settingsMap.ai_api_key.toString().trim());hasApiKey||missingFields.push("ai_api_key");const hasModel=!!(settingsMap.ai_model&&settingsMap.ai_model.toString().trim());return hasModel||missingFields.push("ai_model"),{isConfigured:missingFields.length===0,missingFields,hasApiKey,hasModel}}),getSettingsArray=()=>Object.entries(localSettings).map(([key,value])=>({key,value,type:typeof value=="number"?"number":typeof value=="boolean"?"boolean":"string",group:key==="nsfw_threshold"?"ai":"upload",description:getSettingDescription(key),is_system:!0})),getSettingDescription=key=>({content_detection_enabled:$t("admin.ai.contentDetection.desc.enabled"),sensitive_content_handling:$t("admin.ai.contentDetection.desc.handling"),ai_analysis_enabled:$t("admin.ai.contentDetection.desc.aiAnalysis"),nsfw_threshold:$t("admin.ai.contentDetection.desc.nsfwThreshold")})[key]||"",initializeSettings=()=>{props.settings.forEach(setting=>{setting.key in localSettings&&(localSettings[setting.key]=setting.value)}),props.aiSettings&&props.aiSettings.forEach(setting=>{setting.key in localSettings&&(localSettings[setting.key]=setting.value)})};return watch(localSettings,()=>{emit("update",getSettingsArray())},{deep:!0}),watch(()=>props.settings,newSettings=>{newSettings&&newSettings.length>0&&initializeSettings()},{immediate:!0}),watch(()=>props.aiSettings,newAISettings=>{newAISettings&&newAISettings.length>0&&initializeSettings()},{immediate:!0}),onMounted(()=>{initializeSettings()}),(_ctx,_cache)=>{const _component_router_link=resolveComponent("router-link"),_component_CyberSwitch=resolveComponent("CyberSwitch"),_component_CyberDropdown=resolveComponent("CyberDropdown"),_component_CyberSlider=resolveComponent("CyberSlider");return openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",_hoisted_3$1,[aiConfigStatus.value.isConfigured?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_4$1,[createBaseVNode("div",_hoisted_5$1,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"warning-icon fas fa-exclamation-triangle"},null,-1)),createBaseVNode("div",null,[createBaseVNode("h4",_hoisted_6$1,toDisplayString(unref($t)("admin.ai.contentDetection.aiNotConfigured")),1),createBaseVNode("p",_hoisted_7$1,toDisplayString(unref($t)("admin.ai.contentDetection.aiNotConfiguredDesc")),1),createBaseVNode("div",_hoisted_8$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(aiConfigStatus.value.missingFields,field=>(openBlock(),createElementBlock("span",{key:field,class:"missing-field-badge"},toDisplayString(getFieldName(field)),1))),128))]),createVNode(_component_router_link,{to:"/admin/ai?tab=ai",class:"config-link"},{default:withCtx(()=>[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-arrow-right mr-2"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("admin.ai.contentDetection.goToAIConfig")),1)]),_:1})])])])),createBaseVNode("div",_hoisted_9$1,[createBaseVNode("label",_hoisted_10$1,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-toggle-on mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.contentDetection.enableDetection")),1)]),createBaseVNode("div",_hoisted_11$1,[createBaseVNode("div",_hoisted_12$1,[createVNode(_component_CyberSwitch,{modelValue:localSettings.content_detection_enabled,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localSettings.content_detection_enabled=$event),disabled:!aiConfigStatus.value.isConfigured},null,8,["modelValue","disabled"]),createBaseVNode("span",_hoisted_13$1,toDisplayString(localSettings.content_detection_enabled?unref($t)("admin.ai.contentDetection.detectionEnabled"):unref($t)("admin.ai.contentDetection.detectionDisabled")),1)]),createBaseVNode("p",_hoisted_14$1,toDisplayString(unref($t)("admin.ai.contentDetection.detectionDesc")),1)])]),createBaseVNode("div",_hoisted_15$1,[createBaseVNode("label",_hoisted_16$1,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-exclamation-triangle mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.contentDetection.sensitiveHandling")),1)]),createBaseVNode("div",_hoisted_17$1,[createVNode(_component_CyberDropdown,{modelValue:localSettings.sensitive_content_handling,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>localSettings.sensitive_content_handling=$event),options:sensitiveContentOptions.value,placeholder:unref($t)("admin.ai.contentDetection.sensitiveHandlingPlaceholder"),width:"500px",disabled:!aiConfigStatus.value.isConfigured||!localSettings.content_detection_enabled},null,8,["modelValue","options","placeholder","disabled"]),createBaseVNode("p",_hoisted_18$1,toDisplayString(unref($t)("admin.ai.contentDetection.sensitiveHandlingDesc")),1)])]),createBaseVNode("div",_hoisted_19$1,[createBaseVNode("label",_hoisted_20$1,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-brain mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.contentDetection.enableAIAnalysis")),1)]),createBaseVNode("div",_hoisted_21$1,[createBaseVNode("div",_hoisted_22$1,[createVNode(_component_CyberSwitch,{modelValue:localSettings.ai_analysis_enabled,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>localSettings.ai_analysis_enabled=$event),disabled:!aiConfigStatus.value.isConfigured},null,8,["modelValue","disabled"]),createBaseVNode("span",_hoisted_23$1,toDisplayString(localSettings.ai_analysis_enabled?unref($t)("admin.ai.contentDetection.aiAnalysisEnabled"):unref($t)("admin.ai.contentDetection.aiAnalysisDisabled")),1)]),createBaseVNode("p",_hoisted_24$1,toDisplayString(unref($t)("admin.ai.contentDetection.aiAnalysisDesc")),1)])]),createBaseVNode("div",_hoisted_25$1,[createBaseVNode("label",_hoisted_26$1,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-eye-slash mr-2 text-brand-700"},null,-1)),createTextVNode(toDisplayString(unref($t)("admin.ai.contentDetection.nsfwThreshold")),1)]),createBaseVNode("div",_hoisted_27$1,[createBaseVNode("div",_hoisted_28$1,[createVNode(_component_CyberSlider,{modelValue:localSettings.nsfw_threshold,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>localSettings.nsfw_threshold=$event),min:0,max:.95,step:.01,disabled:!aiConfigStatus.value.isConfigured||!localSettings.content_detection_enabled,description:unref($t)("admin.ai.contentDetection.nsfwThresholdDesc"),width:"365px"},null,8,["modelValue","disabled","description"]),createBaseVNode("span",_hoisted_29$1,toDisplayString(localSettings.nsfw_threshold.toFixed(2)),1),createBaseVNode("div",_hoisted_30$1,[createBaseVNode("span",_hoisted_31$1,toDisplayString(unref($t)("admin.ai.contentDetection.strictnessLevel"))+":",1),createBaseVNode("span",{class:normalizeClass(getThresholdLabel(localSettings.nsfw_threshold).color)},toDisplayString(getThresholdLabel(localSettings.nsfw_threshold).text),3)])])])]),createBaseVNode("ul",_hoisted_32$1,[createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.contentDetection.features.autoDetect")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.contentDetection.features.multiStrategy")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.contentDetection.features.adjustableThreshold")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.contentDetection.features.safeguard")),1)])])])])}}});const ContentDetectionSettings=_export_sfc(_sfc_main$1,[["__scopeId","data-v-85289e6a"]]),_hoisted_1={class:"admin-ai-page admin-page-container"},_hoisted_2={class:"content-panel"},_hoisted_3={class:"content-panel"},_hoisted_4={class:"content-panel"},_hoisted_5={key:0,class:"space-y-4"},_hoisted_6={key:0,class:"status-warning rounded-lg border p-4"},_hoisted_7={class:"flex items-start space-x-3"},_hoisted_8={class:"text-warning-heading mb-2 font-medium"},_hoisted_9={class:"text-muted text-sm"},_hoisted_10={class:"flex items-center space-x-3"},_hoisted_11={key:0,class:"flex items-center space-x-2"},_hoisted_12={class:"text-success-heading font-medium"},_hoisted_13={key:1,class:"flex items-center space-x-2"},_hoisted_14={class:"text-error-heading font-medium"},_hoisted_15={key:1,class:"status-success rounded-lg border p-4"},_hoisted_16={class:"text-success-heading mb-3 font-medium"},_hoisted_17={class:"grid grid-cols-1 gap-3 text-sm"},_hoisted_18={class:"flex items-center"},_hoisted_19={class:"text-muted min-w-20"},_hoisted_20=["title"],_hoisted_21={class:"flex items-center"},_hoisted_22={class:"text-muted min-w-20"},_hoisted_23={class:"ml-2 font-medium text-success"},_hoisted_24={class:"flex items-center"},_hoisted_25={class:"text-muted min-w-20"},_hoisted_26={class:"ml-2 font-medium text-success"},_hoisted_27={key:0,class:"flex items-center"},_hoisted_28={class:"text-muted min-w-20"},_hoisted_29={class:"ml-2 font-medium text-success"},_hoisted_30={key:2,class:"status-error rounded-lg border p-4"},_hoisted_31={class:"text-error-heading mb-3 font-medium"},_hoisted_32={class:"space-y-3 text-sm"},_hoisted_33={class:"flex items-start"},_hoisted_34={class:"text-muted"},_hoisted_35={class:"ml-0 mt-1 font-medium text-error"},_hoisted_36={key:0,class:"flex items-start"},_hoisted_37={class:"text-muted"},_hoisted_38={class:"text-error-heading ml-0 mt-1"},_hoisted_39={key:1,class:"flex items-start"},_hoisted_40={class:"text-muted"},_hoisted_41={class:"text-error-heading ml-0 mt-1 font-mono text-xs"},_hoisted_42={class:"status-info rounded-lg border p-4"},_hoisted_43={class:"text-info-heading mb-3 font-medium"},_hoisted_44={class:"grid grid-cols-1 gap-3 text-sm"},_hoisted_45={class:"text-muted min-w-20"},_hoisted_46={class:"text-info-heading ml-2 font-mono text-xs"},_hoisted_47={key:0,class:"space-y-4"},_hoisted_48={key:0,class:"status-warning rounded-lg border p-4"},_hoisted_49={class:"flex items-start space-x-3"},_hoisted_50={class:"text-warning-heading mb-2 font-medium"},_hoisted_51={class:"text-muted text-sm"},_hoisted_52={class:"flex items-center space-x-3"},_hoisted_53={key:0,class:"flex items-center space-x-2"},_hoisted_54={class:"text-success-heading font-medium"},_hoisted_55={key:1,class:"flex items-center space-x-2"},_hoisted_56={class:"text-error-heading font-medium"},_hoisted_57={key:1,class:"status-success rounded-lg border p-4"},_hoisted_58={class:"text-success-heading mb-3 font-medium"},_hoisted_59={class:"grid grid-cols-1 gap-3 text-sm"},_hoisted_60={class:"flex items-center"},_hoisted_61={class:"text-muted min-w-20"},_hoisted_62={class:"ml-2 font-medium text-success"},_hoisted_63={class:"flex items-center"},_hoisted_64={class:"text-muted min-w-20"},_hoisted_65={class:"ml-2 font-medium text-success"},_hoisted_66={class:"flex items-center"},_hoisted_67={class:"text-muted min-w-20"},_hoisted_68={class:"ml-2 font-medium text-success"},_hoisted_69={class:"flex items-center"},_hoisted_70={class:"text-muted min-w-20"},_hoisted_71=["title"],_hoisted_72={key:0,class:"flex items-center"},_hoisted_73={class:"text-muted min-w-20"},_hoisted_74={class:"ml-2 font-medium text-success"},_hoisted_75={key:2,class:"status-error rounded-lg border p-4"},_hoisted_76={class:"text-error-heading mb-3 font-medium"},_hoisted_77={class:"space-y-3 text-sm"},_hoisted_78={class:"flex items-start"},_hoisted_79={class:"text-muted"},_hoisted_80={class:"ml-0 mt-1 font-medium text-error"},_hoisted_81={key:0,class:"flex items-start"},_hoisted_82={class:"text-muted"},_hoisted_83={class:"text-error-heading ml-0 mt-1"},_hoisted_84={class:"space-y-4"},_hoisted_85={class:"status-warning rounded-lg border p-4"},_hoisted_86={class:"flex items-start space-x-3"},_hoisted_87={class:"text-warning-heading font-medium"},_hoisted_88={class:"text-muted mt-2 text-sm"},_hoisted_89={class:"text-error"},_hoisted_90={class:"text-muted mt-2 space-y-1 text-sm"},_hoisted_91={class:"flex justify-end space-x-3"},_hoisted_92={class:"space-y-4"},_hoisted_93={class:"status-success rounded-lg border p-4"},_hoisted_94={class:"flex items-start space-x-3"},_hoisted_95={class:"text-success-heading mb-2 font-medium"},_hoisted_96={class:"text-muted text-sm"},_hoisted_97={class:"space-y-3"},_hoisted_98={key:0,class:"bg-background-600-bg flex items-center space-x-3 rounded-lg border border-default p-3"},_hoisted_99={class:"flex-1"},_hoisted_100={class:"font-medium text-content-heading"},_hoisted_101={class:"text-muted text-sm"},_hoisted_102={class:"text-sm text-error"},_hoisted_103={key:1,class:"bg-background-600-bg flex items-center space-x-3 rounded-lg border border-default p-3"},_hoisted_104={class:"flex-1"},_hoisted_105={class:"font-medium text-content-heading"},_hoisted_106={class:"text-muted text-sm"},_hoisted_107={class:"text-sm text-error"},_hoisted_108={class:"status-info rounded-lg border p-4"},_hoisted_109={class:"flex items-start space-x-3"},_hoisted_110={class:"text-info-heading mb-2 font-medium"},_hoisted_111={class:"text-muted text-sm"},_hoisted_112={class:"flex justify-end space-x-3"},_sfc_main=defineComponent({name:"AIManagementPage",__name:"index",setup(__props){const{$t}=useTexts(),toast=useToast(),route=useRoute(),router=useRouter(),settingsStore=useSettingsStore(),isLoading=ref(!1),isSaving=ref(!1),testing=ref(!1),testResult=ref(null),showTestDialog=ref(!1),vectorTesting=ref(!1),vectorTestResult=ref(null),showVectorTestDialog=ref(!1),regeneratingVectors=ref(!1),showRegenerateDialog=ref(!1),showAIFeaturePromptDialog=ref(!1),aiFeaturePromptData=ref(null),tabs=computed(()=>[{key:"ai",name:$t("admin.ai.tabs.ai"),icon:"fas fa-robot"},{key:"vector",name:$t("admin.ai.tabs.vector"),icon:"fas fa-search"},{key:"content-detection",name:$t("admin.ai.tabs.contentDetection"),icon:"fas fa-shield-alt"}]),activeTab=ref(route.query.tab?.toString()||"ai"),updateActiveTab=tabId=>{activeTab.value=tabId,router.push({name:route.name,query:{...route.query,tab:tabId}})},aiSettings=ref([]),vectorSettings=ref([]),contentDetectionSettings=ref([]),modifiedAISettings=ref([]),modifiedVectorSettings=ref([]),modifiedContentDetectionSettings=ref([]),handleAISettingsUpdate=updatedSettings=>{modifiedAISettings.value=updatedSettings},handleVectorSettingsUpdate=updatedSettings=>{modifiedVectorSettings.value=updatedSettings},handleContentDetectionSettingsUpdate=updatedSettings=>{modifiedContentDetectionSettings.value=updatedSettings},resetSettings=async()=>{isLoading.value=!0,await loadSettingsForTab(activeTab.value),activeTab.value==="ai"?modifiedAISettings.value=[]:activeTab.value==="vector"?modifiedVectorSettings.value=[]:activeTab.value==="content-detection"&&(modifiedContentDetectionSettings.value=[]),toast.success($t("admin.ai.messages.settingsReset")),isLoading.value=!1},saveSettings=async()=>{let settingsToUpdate=[];if(activeTab.value==="ai"&&modifiedAISettings.value.length>0?settingsToUpdate=modifiedAISettings.value:activeTab.value==="vector"&&modifiedVectorSettings.value.length>0?settingsToUpdate=modifiedVectorSettings.value:activeTab.value==="content-detection"&&modifiedContentDetectionSettings.value.length>0&&(settingsToUpdate=modifiedContentDetectionSettings.value),settingsToUpdate.length===0){toast.info($t("admin.ai.messages.noChanges"));return}try{isSaving.value=!0,(await batchUpsertSettings(settingsToUpdate)).success&&(activeTab.value==="ai"?(modifiedAISettings.value=[],await settingsStore.loadGlobalSettings()):activeTab.value==="vector"?(modifiedVectorSettings.value=[],await settingsStore.loadGlobalSettings()):activeTab.value==="content-detection"&&(modifiedContentDetectionSettings.value=[]),toast.success($t("admin.ai.messages.settingsSaved")),await loadSettingsForTab(activeTab.value),await testConfigurationAfterSave())}catch(error){toast.error(error.message)}finally{isSaving.value=!1}},checkAIFeatureStatus=async()=>{try{const[uploadResult,aiResult]=await Promise.all([getSettings({group:"upload"}),getSettings({group:"ai"})]),uploadSettings=uploadResult.success?uploadResult.data?.settings||[]:[],aiSettings2=aiResult.success?aiResult.data?.settings||[]:[],settingsMap=[...uploadSettings,...aiSettings2].reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{}),contentDetectionEnabled=settingsMap.content_detection_enabled,aiAnalysisEnabled=settingsMap.ai_analysis_enabled;(!contentDetectionEnabled||!aiAnalysisEnabled)&&(aiFeaturePromptData.value={needContentDetection:!contentDetectionEnabled,needAIAnalysis:!aiAnalysisEnabled},showAIFeaturePromptDialog.value=!0)}catch{}},goToContentDetectionSettings=()=>{showAIFeaturePromptDialog.value=!1,router.push("/admin/ai?tab=content-detection")},testConfigurationAfterSave=async()=>{try{if(activeTab.value==="ai"){const currentAISettings=aiSettings.value,aiSettingsMap=currentAISettings.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{});if(!aiSettingsMap.ai_enabled)return;const config=checkAIConfiguration(currentAISettings);if(!config.hasApiKey||!config.hasModel)return;const testConfig={ai_api_key:aiSettingsMap.ai_api_key,ai_proxy:aiSettingsMap.ai_proxy||"https://api.openai.com",ai_model:aiSettingsMap.ai_model,ai_temperature:aiSettingsMap.ai_temperature,ai_max_tokens:aiSettingsMap.ai_max_tokens},response=await testAIConfig(testConfig),result=response.data?.data||response.data;!response.success||!result?.success?(testResult.value={success:!1,message:result?.message||response.message||$t("admin.ai.dialogs.saveSuccessButTestFailed"),error:result?.error||"config_test_failed",details:result?.details,saveTestFailed:!0},showTestDialog.value=!0):await checkAIFeatureStatus()}else if(activeTab.value==="vector"){const vectorSettingsMap=vectorSettings.value.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{});if(!vectorSettingsMap.vector_enabled||!vectorSettingsMap.vector_api_key||!vectorSettingsMap.vector_model)return;const testParams={provider:vectorSettingsMap.vector_provider||"openai",api_key:vectorSettingsMap.vector_api_key,model:vectorSettingsMap.vector_model,base_url:vectorSettingsMap.vector_base_url||"https://api.openai.com/v1",timeout:vectorSettingsMap.vector_timeout||30,test_text:$t("admin.ai.testText")},result=await testVectorConfig(testParams);(!result.success||!result.data?.success)&&(vectorTestResult.value={success:!1,message:result.data?.message||result.message||$t("admin.ai.dialogs.saveSuccessButTestFailed"),error:result.data?.error||"config_test_failed",details:result.data?.details,saveTestFailed:!0},showVectorTestDialog.value=!0)}}catch(error){activeTab.value==="ai"?(testResult.value={success:!1,message:$t("admin.ai.dialogs.saveSuccessButTestFailed"),error:"network_error",details:error.message||$t("admin.ai.messages.networkError"),saveTestFailed:!0},showTestDialog.value=!0):activeTab.value==="vector"&&(vectorTestResult.value={success:!1,message:$t("admin.ai.dialogs.saveSuccessButTestFailed"),error:"network_error",details:error.message||$t("admin.ai.messages.networkError"),saveTestFailed:!0},showVectorTestDialog.value=!0)}},testCurrentConfiguration=async()=>{if(activeTab.value!=="ai"){toast.error($t("admin.ai.messages.onlyInAITab"));return}const currentAISettings=modifiedAISettings.value.length>0?modifiedAISettings.value:aiSettings.value,aiSettingsMap=currentAISettings.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{}),config=checkAIConfiguration(currentAISettings);if(!config.hasApiKey||!config.hasModel){toast.error($t("admin.ai.messages.needApiKeyAndModel"));return}testing.value=!0,testResult.value=null;try{const testConfig={ai_api_key:aiSettingsMap.ai_api_key,ai_proxy:aiSettingsMap.ai_proxy||"https://api.openai.com",ai_model:aiSettingsMap.ai_model,ai_temperature:aiSettingsMap.ai_temperature,ai_max_tokens:aiSettingsMap.ai_max_tokens},[response]=await Promise.all([testAIConfig(testConfig),new Promise(resolve=>setTimeout(resolve,1e3))]);if(response.success){const result=response.data?.data||response.data;testResult.value=result,result?.success?toast.success($t("admin.ai.messages.aiTestSuccess")):toast.error($t("admin.ai.messages.aiTestFailed").replace("{message}",result?.message||$t("admin.ai.messages.unknownError"))),showTestDialog.value=!0}else testResult.value={success:!1,message:response.message||$t("admin.ai.messages.testRequestFailed"),error:"api_error"},toast.error($t("admin.ai.messages.aiTestFailed").replace("{message}",response.message||$t("admin.ai.messages.unknownError"))),showTestDialog.value=!0}catch(error){const errorMessage=error.message||$t("admin.ai.messages.networkError");testResult.value={success:!1,message:$t("admin.ai.messages.testRequestFailed"),error:"network_error",details:errorMessage},toast.error(error.message),showTestDialog.value=!0}testing.value=!1},testVectorConfiguration=async()=>{if(activeTab.value!=="vector"){toast.error($t("admin.ai.messages.onlyInVectorTab"));return}const vectorSettingsMap=(modifiedVectorSettings.value.length>0?modifiedVectorSettings.value:vectorSettings.value).reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{});if(!vectorSettingsMap.vector_api_key||!vectorSettingsMap.vector_model){toast.error($t("admin.ai.messages.needVectorApiKeyAndModel"));return}vectorTesting.value=!0,vectorTestResult.value=null;try{const testParams={provider:vectorSettingsMap.vector_provider||"openai",api_key:vectorSettingsMap.vector_api_key,model:vectorSettingsMap.vector_model,base_url:vectorSettingsMap.vector_base_url||"https://api.openai.com/v1",timeout:vectorSettingsMap.vector_timeout||30,test_text:$t("admin.ai.testText")},result=await testVectorConfig(testParams);result.success?(vectorTestResult.value=result.data,result.data?.success?toast.success($t("admin.ai.messages.vectorTestSuccess")):toast.error($t("admin.ai.messages.vectorTestFailed").replace("{message}","")),showVectorTestDialog.value=!0):(vectorTestResult.value={success:!1,message:result.message||$t("admin.ai.messages.testRequestFailed"),error:"api_error"},toast.error($t("admin.ai.messages.vectorTestFailed").replace("{message}",result.message||$t("admin.ai.messages.unknownError"))),showVectorTestDialog.value=!0)}catch(error){vectorTestResult.value={success:!1,message:$t("admin.ai.messages.vectorTestFailed").replace("{message}",""),error:"network_error",details:error.message},toast.error($t("admin.ai.messages.vectorTestFailed").replace("{message}",error.message||$t("admin.ai.messages.unknownError"))),showVectorTestDialog.value=!0}vectorTesting.value=!1},regenerateVectors$1=async()=>{regeneratingVectors.value=!0;try{const result=await regenerateVectors();if(result.success){const updateCount=result.data?.updated_count||0;toast.success($t("admin.ai.messages.vectorRegenerateSuccess").replace("{count}",String(updateCount)))}else toast.error($t("admin.ai.messages.vectorRegenerateFailed").replace("{error}",result.message||$t("admin.ai.messages.unknownError")))}catch(error){toast.error($t("admin.ai.messages.vectorRegenerateFailed").replace("{error}",error.message||$t("admin.ai.messages.unknownError")))}regeneratingVectors.value=!1,showRegenerateDialog.value=!1},getTestConfig=()=>{const currentAISettings=modifiedAISettings.value.length>0?modifiedAISettings.value:aiSettings.value;if(!currentAISettings.length)return{};const aiSettingsMap=currentAISettings.reduce((acc,setting)=>(acc[setting.key]=setting.value,acc),{});return{ai_api_key:aiSettingsMap.ai_api_key||"",ai_proxy:aiSettingsMap.ai_proxy||"https://api.openai.com",ai_model:aiSettingsMap.ai_model||"",ai_temperature:aiSettingsMap.ai_temperature||.1,ai_max_tokens:aiSettingsMap.ai_max_tokens||8096}},formatConfigKey=key=>$t(`admin.ai.configFields.${key}`)||key,loadSettingsForTab=async tabId=>{isLoading.value=!0;try{if(tabId==="content-detection"){const[uploadResult,aiResult]=await Promise.all([getSettings({group:"upload"}),getSettings({group:"ai"})]),uploadSettings=uploadResult.success?uploadResult.data?.settings||[]:[],aiSettings2=aiResult.success?aiResult.data?.settings||[]:[],allSettings=[...uploadSettings,...aiSettings2],contentDetectionKeys=["content_detection_enabled","sensitive_content_handling","ai_analysis_enabled","nsfw_threshold"];contentDetectionSettings.value=allSettings.filter(s=>contentDetectionKeys.includes(s.key));const existingKeys=contentDetectionSettings.value.map(s=>s.key),missingKeys=contentDetectionKeys.filter(key=>!existingKeys.includes(key));if(missingKeys.length>0){const uploadDefaults=defaultSettings.upload||[],aiDefaults=defaultSettings.ai||[],missingSettings=[...uploadDefaults,...aiDefaults].filter(s=>missingKeys.includes(s.key));contentDetectionSettings.value=[...contentDetectionSettings.value,...missingSettings]}}else{const group=tabId,result=await getSettings({group}),settings=result.success?result.data?.settings||[]:[];if(settings.length===0){const defaults=defaultSettings[group]||[];tabId==="ai"?aiSettings.value=defaults:tabId==="vector"&&(vectorSettings.value=defaults)}else tabId==="ai"?aiSettings.value=settings:tabId==="vector"&&(vectorSettings.value=settings)}}catch(error){if(tabId==="content-detection"){const uploadDefaults=defaultSettings.upload||[],aiDefaults=defaultSettings.ai||[],allDefaults=[...uploadDefaults,...aiDefaults],contentDetectionKeys=["content_detection_enabled","sensitive_content_handling","ai_analysis_enabled","nsfw_threshold"];contentDetectionSettings.value=allDefaults.filter(s=>contentDetectionKeys.includes(s.key))}else{const defaults=defaultSettings[tabId]||[];tabId==="ai"?aiSettings.value=defaults:tabId==="vector"&&(vectorSettings.value=defaults)}toast.error(error.message)}finally{isLoading.value=!1}};return watch(()=>route.query.tab,newTab=>{newTab&&typeof newTab=="string"&&newTab!==activeTab.value&&(activeTab.value=newTab)}),watch(activeTab,async newTab=>{(newTab==="ai"&&aiSettings.value.length===0||newTab==="vector"&&vectorSettings.value.length===0||newTab==="content-detection"&&contentDetectionSettings.value.length===0)&&await loadSettingsForTab(newTab),newTab==="content-detection"&&aiSettings.value.length===0&&await loadSettingsForTab("ai")}),onMounted(async()=>{await loadSettingsForTab(activeTab.value)}),(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton"),_component_CyberSidebarNav=__unplugin_components_0,_component_CyberAdminWrapper=resolveComponent("CyberAdminWrapper"),_component_CyberLoading=resolveComponent("CyberLoading"),_component_CyberDialog=resolveComponent("CyberDialog");return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(_component_CyberAdminWrapper,{title:unref($t)("admin.ai.title"),subtitle:unref($t)("admin.ai.subtitle"),icon:"fas fa-robot","sidebar-layout":!0},{actions:withCtx(()=>[activeTab.value==="ai"?(openBlock(),createBlock(_component_CyberButton,{key:0,type:"outlined",loading:testing.value,"loading-mode":"inline",icon:"flask",disabled:aiSettings.value.length===0,class:"min-w-24",onClick:testCurrentConfiguration},{default:withCtx(()=>[createTextVNode(toDisplayString(testing.value?unref($t)("admin.ai.actions.testing"):unref($t)("admin.ai.actions.test")),1)]),_:1},8,["loading","disabled"])):createCommentVNode("",!0),activeTab.value==="vector"?(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(_component_CyberButton,{type:"outlined",loading:vectorTesting.value,"loading-mode":"inline",icon:"flask",disabled:vectorSettings.value.length===0,class:"min-w-24",onClick:testVectorConfiguration},{default:withCtx(()=>[createTextVNode(toDisplayString(vectorTesting.value?unref($t)("admin.ai.actions.testing"):unref($t)("admin.ai.actions.test")),1)]),_:1},8,["loading","disabled"]),createVNode(_component_CyberButton,{type:"warning",loading:regeneratingVectors.value,"loading-mode":"inline",icon:"sync",class:"min-w-32",onClick:_cache[0]||(_cache[0]=$event=>showRegenerateDialog.value=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(regeneratingVectors.value?unref($t)("admin.ai.actions.regenerating"):unref($t)("admin.ai.actions.regenerateVectors")),1)]),_:1},8,["loading"])],64)):createCommentVNode("",!0),createVNode(_component_CyberButton,{type:"text",class:"min-w-24",onClick:resetSettings},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.actions.reset")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",loading:isSaving.value,"loading-mode":"inline",icon:"save",class:"min-w-24",onClick:saveSettings},{default:withCtx(()=>[createTextVNode(toDisplayString(isSaving.value?unref($t)("admin.ai.actions.saving"):unref($t)("admin.ai.actions.save")),1)]),_:1},8,["loading"])]),sidebar:withCtx(()=>[createVNode(_component_CyberSidebarNav,{tabs:tabs.value,"active-tab":activeTab.value,onTabChange:updateActiveTab},null,8,["tabs","active-tab"])]),content:withCtx(()=>[withDirectives(createBaseVNode("div",_hoisted_2,[createVNode(AISettings,{settings:aiSettings.value,onUpdate:handleAISettingsUpdate},null,8,["settings"])],512),[[vShow,activeTab.value==="ai"]]),withDirectives(createBaseVNode("div",_hoisted_3,[createVNode(VectorSettings,{settings:vectorSettings.value,onUpdate:handleVectorSettingsUpdate},null,8,["settings"])],512),[[vShow,activeTab.value==="vector"]]),withDirectives(createBaseVNode("div",_hoisted_4,[createVNode(ContentDetectionSettings,{settings:contentDetectionSettings.value,"ai-settings":aiSettings.value,onUpdate:handleContentDetectionSettingsUpdate},null,8,["settings","ai-settings"])],512),[[vShow,activeTab.value==="content-detection"]])]),_:1},8,["title","subtitle"]),isLoading.value?(openBlock(),createBlock(_component_CyberLoading,{key:0})):createCommentVNode("",!0),createVNode(_component_CyberDialog,{modelValue:showTestDialog.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>showTestDialog.value=$event),width:"600px",title:testResult.value?.saveTestFailed?unref($t)("admin.ai.dialogs.aiTestFailedAfterSave"):unref($t)("admin.ai.dialogs.aiTestResult"),"show-default-footer":!1,"show-footer":!1},{default:withCtx(()=>[testResult.value?(openBlock(),createElementBlock("div",_hoisted_5,[testResult.value.saveTestFailed?(openBlock(),createElementBlock("div",_hoisted_6,[createBaseVNode("div",_hoisted_7,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-exclamation-triangle mt-0.5 text-warning"},null,-1)),createBaseVNode("div",null,[createBaseVNode("h4",_hoisted_8,toDisplayString(unref($t)("admin.ai.dialogs.saveSuccessButTestFailed")),1),createBaseVNode("p",_hoisted_9,toDisplayString(unref($t)("admin.ai.dialogs.saveSuccessButTestFailedDesc")),1)])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_10,[testResult.value.success?(openBlock(),createElementBlock("div",_hoisted_11,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-check-circle text-success"},null,-1)),createBaseVNode("span",_hoisted_12,toDisplayString(unref($t)("admin.ai.dialogs.testSuccess")),1)])):(openBlock(),createElementBlock("div",_hoisted_13,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-times-circle text-error"},null,-1)),createBaseVNode("span",_hoisted_14,toDisplayString(unref($t)("admin.ai.dialogs.testFailed")),1)]))]),testResult.value.success?(openBlock(),createElementBlock("div",_hoisted_15,[createBaseVNode("h4",_hoisted_16,toDisplayString(unref($t)("admin.ai.dialogs.testDetails")),1),createBaseVNode("div",_hoisted_17,[createBaseVNode("div",_hoisted_18,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-robot icon-muted mr-2 text-success"},null,-1)),createBaseVNode("span",_hoisted_19,toDisplayString(unref($t)("admin.ai.testResults.model"))+":",1),createBaseVNode("span",{class:"ml-2 truncate font-medium text-success",title:testResult.value.model||unref($t)("admin.ai.testResults.unknown")},toDisplayString(testResult.value.model||unref($t)("admin.ai.testResults.unknown")),9,_hoisted_20)]),createBaseVNode("div",_hoisted_21,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-coins icon-muted mr-2 text-success"},null,-1)),createBaseVNode("span",_hoisted_22,toDisplayString(unref($t)("admin.ai.testResults.tokensUsed"))+":",1),createBaseVNode("span",_hoisted_23,toDisplayString(testResult.value.tokens_used||"0"),1)]),createBaseVNode("div",_hoisted_24,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-clock icon-muted mr-2 text-success"},null,-1)),createBaseVNode("span",_hoisted_25,toDisplayString(unref($t)("admin.ai.testResults.status"))+":",1),createBaseVNode("span",_hoisted_26,toDisplayString(testResult.value.status||unref($t)("admin.ai.testResults.connected")),1)]),testResult.value.test_response?(openBlock(),createElementBlock("div",_hoisted_27,[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-comment-dots icon-muted mr-2 text-success"},null,-1)),createBaseVNode("span",_hoisted_28,toDisplayString(unref($t)("admin.ai.testResults.response"))+":",1),createBaseVNode("span",_hoisted_29,toDisplayString(testResult.value.test_response),1)])):createCommentVNode("",!0)])])):(openBlock(),createElementBlock("div",_hoisted_30,[createBaseVNode("h4",_hoisted_31,toDisplayString(unref($t)("admin.ai.dialogs.errorDetails")),1),createBaseVNode("div",_hoisted_32,[createBaseVNode("div",_hoisted_33,[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-times-circle icon-muted mr-2 mt-0.5 text-error"},null,-1)),createBaseVNode("div",null,[createBaseVNode("span",_hoisted_34,toDisplayString(unref($t)("admin.ai.testResults.errorReason"))+":",1),createBaseVNode("p",_hoisted_35,toDisplayString(testResult.value.message||unref($t)("admin.ai.messages.unknownError")),1)])]),testResult.value.details?(openBlock(),createElementBlock("div",_hoisted_36,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-info-circle icon-muted mr-2 mt-0.5 text-error"},null,-1)),createBaseVNode("div",null,[createBaseVNode("span",_hoisted_37,toDisplayString(unref($t)("admin.ai.testResults.errorDetails"))+":",1),createBaseVNode("p",_hoisted_38,toDisplayString(testResult.value.details),1)])])):createCommentVNode("",!0),testResult.value.error?(openBlock(),createElementBlock("div",_hoisted_39,[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-bug icon-muted mr-2 mt-0.5 text-error"},null,-1)),createBaseVNode("div",null,[createBaseVNode("span",_hoisted_40,toDisplayString(unref($t)("admin.ai.testResults.errorType"))+":",1),createBaseVNode("p",_hoisted_41,toDisplayString(testResult.value.error),1)])])):createCommentVNode("",!0)])])),createBaseVNode("div",_hoisted_42,[createBaseVNode("h4",_hoisted_43,toDisplayString(unref($t)("admin.ai.dialogs.testParams")),1),createBaseVNode("div",_hoisted_44,[(openBlock(!0),createElementBlock(Fragment,null,renderList(getTestConfig(),(value,key)=>(openBlock(),createElementBlock("div",{key,class:"flex items-center"},[createBaseVNode("span",_hoisted_45,toDisplayString(formatConfigKey(key))+":",1),createBaseVNode("span",_hoisted_46,toDisplayString(key==="ai_api_key"?"***"+String(value).slice(-6):value),1)]))),128))])])])):createCommentVNode("",!0)]),_:1},8,["modelValue","title"]),createVNode(_component_CyberDialog,{modelValue:showVectorTestDialog.value,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>showVectorTestDialog.value=$event),width:"600px",title:vectorTestResult.value?.saveTestFailed?unref($t)("admin.ai.dialogs.vectorTestFailedAfterSave"):unref($t)("admin.ai.dialogs.vectorTestResult"),"show-default-footer":!1,"show-footer":!1},{default:withCtx(()=>[vectorTestResult.value?(openBlock(),createElementBlock("div",_hoisted_47,[vectorTestResult.value.saveTestFailed?(openBlock(),createElementBlock("div",_hoisted_48,[createBaseVNode("div",_hoisted_49,[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-exclamation-triangle mt-0.5 text-warning"},null,-1)),createBaseVNode("div",null,[createBaseVNode("h4",_hoisted_50,toDisplayString(unref($t)("admin.ai.dialogs.saveSuccessButTestFailed")),1),createBaseVNode("p",_hoisted_51,toDisplayString(unref($t)("admin.ai.dialogs.vectorSaveSuccessButTestFailedDesc")),1)])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_52,[vectorTestResult.value.success?(openBlock(),createElementBlock("div",_hoisted_53,[_cache[18]||(_cache[18]=createBaseVNode("i",{class:"fas fa-check-circle text-success"},null,-1)),createBaseVNode("span",_hoisted_54,toDisplayString(unref($t)("admin.ai.dialogs.testSuccess")),1)])):(openBlock(),createElementBlock("div",_hoisted_55,[_cache[19]||(_cache[19]=createBaseVNode("i",{class:"fas fa-times-circle text-error"},null,-1)),createBaseVNode("span",_hoisted_56,toDisplayString(unref($t)("admin.ai.dialogs.testFailed")),1)]))]),vectorTestResult.value.success?(openBlock(),createElementBlock("div",_hoisted_57,[createBaseVNode("h4",_hoisted_58,toDisplayString(unref($t)("admin.ai.dialogs.testDetails")),1),createBaseVNode("div",_hoisted_59,[createBaseVNode("div",_hoisted_60,[_cache[20]||(_cache[20]=createBaseVNode("i",{class:"fas fa-cube icon-muted mr-2 w-4 text-success"},null,-1)),createBaseVNode("span",_hoisted_61,toDisplayString(unref($t)("admin.ai.testResults.vectorModel"))+":",1),createBaseVNode("span",_hoisted_62,toDisplayString(vectorTestResult.value.config?.model||unref($t)("admin.ai.testResults.unknown")),1)]),createBaseVNode("div",_hoisted_63,[_cache[21]||(_cache[21]=createBaseVNode("i",{class:"fas fa-ruler icon-muted mr-2 w-4 text-success"},null,-1)),createBaseVNode("span",_hoisted_64,toDisplayString(unref($t)("admin.ai.testResults.vectorDimension"))+":",1),createBaseVNode("span",_hoisted_65,toDisplayString(vectorTestResult.value.config?.dimension||unref($t)("admin.ai.testResults.unknown")),1)]),createBaseVNode("div",_hoisted_66,[_cache[22]||(_cache[22]=createBaseVNode("i",{class:"fas fa-server icon-muted mr-2 w-4 text-success"},null,-1)),createBaseVNode("span",_hoisted_67,toDisplayString(unref($t)("admin.ai.testResults.vectorProvider"))+":",1),createBaseVNode("span",_hoisted_68,toDisplayString(vectorTestResult.value.config?.provider||unref($t)("admin.ai.testResults.unknown")),1)]),createBaseVNode("div",_hoisted_69,[_cache[23]||(_cache[23]=createBaseVNode("i",{class:"fas fa-network-wired icon-muted mr-2 w-4 text-success"},null,-1)),createBaseVNode("span",_hoisted_70,toDisplayString(unref($t)("admin.ai.testResults.apiUrl"))+":",1),createBaseVNode("span",{class:"ml-2 truncate font-medium text-success",title:vectorTestResult.value.config?.baseUrl||unref($t)("admin.ai.testResults.unknown")},toDisplayString(vectorTestResult.value.config?.baseUrl||unref($t)("admin.ai.testResults.unknown")),9,_hoisted_71)]),vectorTestResult.value.response_time?(openBlock(),createElementBlock("div",_hoisted_72,[_cache[24]||(_cache[24]=createBaseVNode("i",{class:"fas fa-clock icon-muted mr-2 w-4 text-success"},null,-1)),createBaseVNode("span",_hoisted_73,toDisplayString(unref($t)("admin.ai.testResults.responseTime"))+":",1),createBaseVNode("span",_hoisted_74,toDisplayString(vectorTestResult.value.response_time)+"ms",1)])):createCommentVNode("",!0)])])):(openBlock(),createElementBlock("div",_hoisted_75,[createBaseVNode("h4",_hoisted_76,toDisplayString(unref($t)("admin.ai.dialogs.errorDetails")),1),createBaseVNode("div",_hoisted_77,[createBaseVNode("div",_hoisted_78,[_cache[25]||(_cache[25]=createBaseVNode("i",{class:"fas fa-times-circle icon-muted mr-2 mt-0.5 text-error"},null,-1)),createBaseVNode("div",null,[createBaseVNode("span",_hoisted_79,toDisplayString(unref($t)("admin.ai.testResults.errorReason"))+":",1),createBaseVNode("p",_hoisted_80,toDisplayString(vectorTestResult.value.message||unref($t)("admin.ai.messages.unknownError")),1)])]),vectorTestResult.value.details?(openBlock(),createElementBlock("div",_hoisted_81,[_cache[26]||(_cache[26]=createBaseVNode("i",{class:"fas fa-info-circle icon-muted mr-2 mt-0.5 text-error"},null,-1)),createBaseVNode("div",null,[createBaseVNode("span",_hoisted_82,toDisplayString(unref($t)("admin.ai.testResults.errorDetails"))+":",1),createBaseVNode("p",_hoisted_83,toDisplayString(vectorTestResult.value.details),1)])])):createCommentVNode("",!0)])]))])):createCommentVNode("",!0)]),_:1},8,["modelValue","title"]),createVNode(_component_CyberDialog,{modelValue:showRegenerateDialog.value,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>showRegenerateDialog.value=$event),width:"500px",title:unref($t)("admin.ai.dialogs.regenerateVectors"),"show-default-footer":!1,"show-footer":!1},{default:withCtx(()=>[createBaseVNode("div",_hoisted_84,[createBaseVNode("div",_hoisted_85,[createBaseVNode("div",_hoisted_86,[_cache[27]||(_cache[27]=createBaseVNode("i",{class:"fas fa-exclamation-triangle mt-0.5 text-warning"},null,-1)),createBaseVNode("div",null,[createBaseVNode("h4",_hoisted_87,toDisplayString(unref($t)("admin.ai.dialogs.regenerateWarning")),1),createBaseVNode("p",_hoisted_88,[createBaseVNode("strong",_hoisted_89,toDisplayString(unref($t)("admin.ai.dialogs.regenerateDestructive")),1)]),createBaseVNode("ul",_hoisted_90,[createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.dialogs.regeneratePoint1")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.dialogs.regeneratePoint2")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.dialogs.regeneratePoint3")),1),createBaseVNode("li",null,"• "+toDisplayString(unref($t)("admin.ai.dialogs.regeneratePoint4")),1)])])])]),createBaseVNode("div",_hoisted_91,[createVNode(_component_CyberButton,{type:"outlined",onClick:_cache[3]||(_cache[3]=$event=>showRegenerateDialog.value=!1)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.actions.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:"danger",loading:regeneratingVectors.value,"loading-mode":"inline",icon:"exclamation-triangle",onClick:regenerateVectors$1},{default:withCtx(()=>[createTextVNode(toDisplayString(regeneratingVectors.value?unref($t)("admin.ai.actions.regenerating"):unref($t)("admin.ai.actions.confirm")),1)]),_:1},8,["loading"])])])]),_:1},8,["modelValue","title"]),createVNode(_component_CyberDialog,{modelValue:showAIFeaturePromptDialog.value,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>showAIFeaturePromptDialog.value=$event),width:"600px",title:unref($t)("admin.ai.dialogs.aiFeatureSuccess"),"show-default-footer":!1,"show-footer":!1},{default:withCtx(()=>[createBaseVNode("div",_hoisted_92,[createBaseVNode("div",_hoisted_93,[createBaseVNode("div",_hoisted_94,[_cache[28]||(_cache[28]=createBaseVNode("i",{class:"fas fa-check-circle mt-0.5 text-success"},null,-1)),createBaseVNode("div",null,[createBaseVNode("h4",_hoisted_95,toDisplayString(unref($t)("admin.ai.dialogs.aiConfigComplete")),1),createBaseVNode("p",_hoisted_96,toDisplayString(unref($t)("admin.ai.dialogs.aiConfigCompleteDesc")),1)])])]),createBaseVNode("div",_hoisted_97,[aiFeaturePromptData.value?.needContentDetection?(openBlock(),createElementBlock("div",_hoisted_98,[_cache[29]||(_cache[29]=createBaseVNode("i",{class:"fas fa-shield-alt text-warning"},null,-1)),createBaseVNode("div",_hoisted_99,[createBaseVNode("h5",_hoisted_100,toDisplayString(unref($t)("admin.ai.contentDetection.contentDetectionFeature")),1),createBaseVNode("p",_hoisted_101,toDisplayString(unref($t)("admin.ai.contentDetection.contentDetectionFeatureDesc")),1)]),createBaseVNode("div",_hoisted_102,toDisplayString(unref($t)("admin.ai.dialogs.featureNotEnabled")),1)])):createCommentVNode("",!0),aiFeaturePromptData.value?.needAIAnalysis?(openBlock(),createElementBlock("div",_hoisted_103,[_cache[30]||(_cache[30]=createBaseVNode("i",{class:"fas fa-brain text-info"},null,-1)),createBaseVNode("div",_hoisted_104,[createBaseVNode("h5",_hoisted_105,toDisplayString(unref($t)("admin.ai.contentDetection.aiAnalysisFeature")),1),createBaseVNode("p",_hoisted_106,toDisplayString(unref($t)("admin.ai.contentDetection.aiAnalysisFeatureDesc")),1)]),createBaseVNode("div",_hoisted_107,toDisplayString(unref($t)("admin.ai.dialogs.featureNotEnabled")),1)])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_108,[createBaseVNode("div",_hoisted_109,[_cache[31]||(_cache[31]=createBaseVNode("i",{class:"fas fa-info-circle mt-0.5 text-info"},null,-1)),createBaseVNode("div",null,[createBaseVNode("h4",_hoisted_110,toDisplayString(unref($t)("admin.ai.dialogs.featureExplanation")),1),createBaseVNode("p",_hoisted_111,toDisplayString(unref($t)("admin.ai.dialogs.featureExplanationDesc")),1)])])]),createBaseVNode("div",_hoisted_112,[createVNode(_component_CyberButton,{type:"outlined",onClick:_cache[5]||(_cache[5]=$event=>showAIFeaturePromptDialog.value=!1)},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.actions.later")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",icon:"cog",onClick:goToContentDetectionSettings},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t)("admin.ai.actions.goToSettings")),1)]),_:1})])])]),_:1},8,["modelValue","title"])])}}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-fd9007cf"]]);export{index as default};
