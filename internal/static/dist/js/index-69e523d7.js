import{r as ref,w as watch,d as defineComponent,a3 as useRouter,c as computed,z as openBlock,I as createElementBlock,a0 as createBaseVNode,ab as createTextVNode,a1 as toDisplayString,u as unref,f as createVNode,L as withCtx,F as Fragment,M as renderList,R as normalizeClass,i as isRef,b as onMounted,Q as normalizeStyle,o as onUnmounted,K as createCommentVNode,E as resolveComponent,A as createBlock,n as nextTick}from"./vue-vendor-31320f47.js";import{l as lo}from"./draggable-5c726607.js";import{j as useTexts,_ as _export_sfc,y as get,q as useToast,z as formatFileSize,A as useMessageToast,E as useMessageModal,G as getUserMessages,H as getUnreadCount,I as formatMessage,J as formatRelativeTime,K as markMessageRead,t as useUploadStore,M as getCurrentLocale,N as getFileList,O as useTheme,P as getUserFolders}from"./index-ae9c3219.js";import{g as getInstanceByDom,i as init}from"./echarts-79943a2a.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const STORAGE_KEY_COMMON="dashboard_common_actions_order",STORAGE_KEY_SETTINGS="dashboard_settings_order";function useQuickActionsDrag(){const loadOrder=(storageKey,defaultItems)=>{try{const savedOrder=localStorage.getItem(storageKey);if(!savedOrder)return defaultItems;const orderIds=JSON.parse(savedOrder),orderedItems=[],itemsMap=new Map(defaultItems.map(item=>[item.id,item]));return orderIds.forEach(id=>{const item=itemsMap.get(id);item&&(orderedItems.push(item),itemsMap.delete(id))}),itemsMap.forEach(item=>{orderedItems.push(item)}),orderedItems}catch(error){return console.error("Failed to load order:",error),defaultItems}},saveOrder=(storageKey,items)=>{try{const orderIds=items.map(item=>item.id);localStorage.setItem(storageKey,JSON.stringify(orderIds))}catch(error){console.error("Failed to save order:",error)}};return{createDraggableActions:(storageKey,defaultItems)=>{const items=ref(loadOrder(storageKey,defaultItems));return watch(items,newItems=>{saveOrder(storageKey,newItems)},{deep:!0}),{items,handleDragStart:()=>{},handleDragEnd:()=>{}}},STORAGE_KEY_COMMON,STORAGE_KEY_SETTINGS}}const _hoisted_1$8={class:"quick-actions cyber-card"},_hoisted_2$8={class:"actions-content"},_hoisted_3$8={class:"actions-header"},_hoisted_4$8={class:"section-title"},_hoisted_5$8={class:"drag-hint"},_hoisted_6$8={class:"main-actions"},_hoisted_7$8=["data-color","onClick"],_hoisted_8$8={class:"btn-content"},_hoisted_9$8={class:"btn-icon"},_hoisted_10$7={class:"btn-label"},_hoisted_11$6={class:"settings-section"},_hoisted_12$6={class:"section-divider"},_hoisted_13$4={class:"divider-text"},_hoisted_14$4=["title","onClick"],_hoisted_15$4={class:"setting-icon"},_hoisted_16$4={class:"setting-label"},_sfc_main$8=defineComponent({name:"QuickActions",__name:"QuickActions",setup(__props){const router=useRouter(),{$t,currentLocale}=useTexts(),{createDraggableActions,STORAGE_KEY_COMMON:STORAGE_KEY_COMMON2,STORAGE_KEY_SETTINGS:STORAGE_KEY_SETTINGS2}=useQuickActionsDrag(),defaultCommonActions=computed(()=>[{id:1,label:$t("dashboard.quickActions.actions.myFiles"),icon:"fas fa-images",colorVar:"brand",action:"resource"},{id:2,label:$t("dashboard.quickActions.actions.folders"),icon:"fas fa-folder",colorVar:"warning",action:"folders"},{id:3,label:$t("dashboard.quickActions.actions.tagManage"),icon:"fas fa-tags",colorVar:"info",action:"tag-manage"},{id:4,label:$t("dashboard.quickActions.actions.categoryManage"),icon:"fas fa-layer-group",colorVar:"success",action:"category-manage"},{id:5,label:$t("dashboard.quickActions.actions.openApi"),icon:"fas fa-random",colorVar:"error",action:"open-api"},{id:6,label:$t("dashboard.quickActions.actions.automation"),icon:"fas fa-robot",colorVar:"brand",action:"automation"}]),defaultSettingsShortcuts=computed(()=>[{id:1,title:$t("dashboard.quickActions.settings.api"),icon:"fas fa-code",color:"blue",route:"/settings#api"},{id:2,title:$t("dashboard.quickActions.settings.profile"),icon:"fas fa-user",color:"green",route:"/settings#profile"},{id:3,title:$t("dashboard.quickActions.settings.security"),icon:"fas fa-shield-alt",color:"orange",route:"/settings#security"},{id:4,title:$t("dashboard.quickActions.settings.accessControl"),icon:"fas fa-shield",color:"purple",route:"/settings#access-control"},{id:5,title:$t("dashboard.quickActions.settings.preferences"),icon:"fas fa-cog",color:"purple",route:"/settings#preferences"}]),{items:commonActions,handleDragStart:handleCommonDragStart,handleDragEnd:handleCommonDragEnd}=createDraggableActions(STORAGE_KEY_COMMON2,defaultCommonActions.value),{items:settingsShortcuts,handleDragStart:handleSettingsDragStart,handleDragEnd:handleSettingsDragEnd}=createDraggableActions(STORAGE_KEY_SETTINGS2,defaultSettingsShortcuts.value);watch(currentLocale,()=>{const currentOrder=commonActions.value.map(item=>item.id),newActions=defaultCommonActions.value;commonActions.value=currentOrder.map(id=>newActions.find(action=>action.id===id)).filter(Boolean);const currentSettingsOrder=settingsShortcuts.value.map(item=>item.id),newSettings=defaultSettingsShortcuts.value;settingsShortcuts.value=currentSettingsOrder.map(id=>newSettings.find(setting=>setting.id===id)).filter(Boolean)});const handleAction=action=>{switch(action){case"resource":router.push("/resource");break;case"folders":router.push("/folders");break;case"tag-manage":router.push("/tag-manage");break;case"category-manage":router.push("/category-manage");break;case"open-api":router.push("/open-api");break;case"automation":router.push("/automation");break}},handleNavigation=route=>{router.push(route)};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$8,[_cache[9]||(_cache[9]=createBaseVNode("div",{class:"cyber-bg-pattern"},null,-1)),_cache[10]||(_cache[10]=createBaseVNode("div",{class:"glow-orb"},null,-1)),createBaseVNode("div",_hoisted_2$8,[createBaseVNode("div",_hoisted_3$8,[createBaseVNode("h3",_hoisted_4$8,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-bolt"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.quickActions.title"))+" ",1),createBaseVNode("span",_hoisted_5$8,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-arrows-alt"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.quickActions.dragHint")),1)])])]),createBaseVNode("div",_hoisted_6$8,[createVNode(unref(lo),{modelValue:unref(commonActions),"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>isRef(commonActions)?commonActions.value=$event:null),animation:"150","ghost-class":"action-ghost","chosen-class":"action-chosen","drag-class":"action-drag",class:"actions-grid",onStart:unref(handleCommonDragStart),onEnd:unref(handleCommonDragEnd)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(commonActions),action=>(openBlock(),createElementBlock("button",{key:action.id,class:"action-btn primary-action","data-color":action.colorVar,onClick:$event=>handleAction(action.action)},[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"btn-bg-effect"},null,-1)),createBaseVNode("div",_hoisted_8$8,[createBaseVNode("div",_hoisted_9$8,[createBaseVNode("i",{class:normalizeClass(action.icon)},null,2)]),createBaseVNode("span",_hoisted_10$7,toDisplayString(action.label),1),_cache[4]||(_cache[4]=createBaseVNode("div",{class:"btn-glow"},null,-1))])],8,_hoisted_7$8))),128))]),_:1},8,["modelValue","onStart","onEnd"])]),createBaseVNode("div",_hoisted_11$6,[createBaseVNode("div",_hoisted_12$6,[_cache[6]||(_cache[6]=createBaseVNode("div",{class:"divider-line"},null,-1)),createBaseVNode("span",_hoisted_13$4,toDisplayString(unref($t)("dashboard.quickActions.settings.divider")),1),_cache[7]||(_cache[7]=createBaseVNode("div",{class:"divider-line"},null,-1))]),createVNode(unref(lo),{modelValue:unref(settingsShortcuts),"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>isRef(settingsShortcuts)?settingsShortcuts.value=$event:null),animation:"150","ghost-class":"setting-ghost","chosen-class":"setting-chosen","drag-class":"setting-drag",class:"settings-grid",onStart:unref(handleSettingsDragStart),onEnd:unref(handleSettingsDragEnd)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(settingsShortcuts),setting=>(openBlock(),createElementBlock("button",{key:setting.id,class:normalizeClass(["setting-btn",setting.color]),title:setting.title,onClick:$event=>handleNavigation(setting.route)},[_cache[8]||(_cache[8]=createBaseVNode("div",{class:"setting-bg-effect"},null,-1)),createBaseVNode("div",_hoisted_15$4,[createBaseVNode("i",{class:normalizeClass(setting.icon)},null,2)]),createBaseVNode("span",_hoisted_16$4,toDisplayString(setting.title),1)],10,_hoisted_14$4))),128))]),_:1},8,["modelValue","onStart","onEnd"])])])]))}});const QuickActions=_export_sfc(_sfc_main$8,[["__scopeId","data-v-89220462"]]);function getWorkspaceStats(){return get("/user/personal/workspace/stats")}const _hoisted_1$7={class:"compact-stats cyber-card"},_hoisted_2$7={class:"stats-content"},_hoisted_3$7={class:"stats-header"},_hoisted_4$7={class:"section-title"},_hoisted_5$7={class:"stats-grid"},_hoisted_6$7=["data-color"],_hoisted_7$7={class:"stat-icon"},_hoisted_8$7={class:"stat-content"},_hoisted_9$7={class:"stat-value"},_hoisted_10$6={class:"stat-label"},_hoisted_11$5={class:"quotas-section"},_hoisted_12$5={class:"section-subtitle"},_hoisted_13$3={class:"quota-item"},_hoisted_14$3={class:"quota-header"},_hoisted_15$3={class:"quota-name"},_hoisted_16$3=["title"],_hoisted_17$3={class:"quota-progress"},_hoisted_18$3={class:"quota-details"},_hoisted_19$3={class:"used"},_hoisted_20$3={class:"total"},_hoisted_21$3={class:"quota-item"},_hoisted_22$3={class:"quota-header"},_hoisted_23$3={class:"quota-name"},_hoisted_24$3=["title"],_hoisted_25$3={class:"quota-progress"},_hoisted_26$3={class:"quota-details"},_hoisted_27$3={class:"used"},_hoisted_28$2={class:"total"},_sfc_main$7=defineComponent({name:"CompactStats",__name:"CompactStats",props:{refreshKey:{}},setup(__props){const props=__props,toast=useToast(),{$t}=useTexts(),loading=ref(!1),stats=ref({total_files:0,used_storage:0,used_storage_formatted:"0 B",total_storage:0,total_storage_formatted:"0 B",total_views:0,total_shares:0,used_bandwidth:0,used_bandwidth_formatted:"0 B",total_bandwidth:0,total_bandwidth_formatted:"0 B"}),fetchStats=async()=>{try{loading.value=!0;const result=await getWorkspaceStats();result.success?stats.value=result.data||stats.value:toast.error(result.message||$t("dashboard.errors.fetchStatsFailed"))}catch{toast.error($t("dashboard.errors.networkFailed"))}finally{loading.value=!1}};onMounted(()=>{fetchStats()}),watch(()=>props.refreshKey,()=>{props.refreshKey!==void 0&&fetchStats()});const storagePercent=computed(()=>stats.value.total_storage<=0?0:Math.min(Math.round(stats.value.used_storage/stats.value.total_storage*100),100)),bandwidthPercent=computed(()=>stats.value.total_bandwidth<=0?0:Math.min(Math.round(stats.value.used_bandwidth/stats.value.total_bandwidth*100),100)),getProgressColor=percentage=>{if(percentage<=60){const ratio2=percentage/60,red2=Math.floor(ratio2*150),green2=255,blue2=Math.floor(136-ratio2*50);return{gradient:`linear-gradient(90deg, var(--color-success-500), #${red2.toString(16).padStart(2,"0")}${green2.toString(16)}${blue2.toString(16).padStart(2,"0")})`,glow:`rgba(${red2}, ${green2}, ${blue2}, 0.4)`,level:"healthy"}}else if(percentage<=85){const ratio2=(percentage-60)/25,red2=255,green2=Math.floor(200-ratio2*80),blue2=Math.floor(50-ratio2*24);return{gradient:`linear-gradient(90deg, var(--color-warning-400), #${red2.toString(16)}${green2.toString(16).padStart(2,"0")}${blue2.toString(16).padStart(2,"0")})`,glow:`rgba(${red2}, ${green2}, ${blue2}, 0.4)`,level:"warning"}}const ratio=Math.min((percentage-85)/15,1),red=255,green=Math.floor(120-ratio*120),blue=Math.floor(26-ratio*26);return{gradient:`linear-gradient(90deg, var(--color-warning-600), #${red.toString(16)}${green.toString(16).padStart(2,"0")}${blue.toString(16).padStart(2,"0")})`,glow:`rgba(${red}, ${Math.max(green,50)}, ${Math.max(blue,50)}, 0.5)`,level:"danger"}},storageProgressStyle=computed(()=>{const color=getProgressColor(storagePercent.value);return{background:color.gradient,boxShadow:`0 0 12px ${color.glow}`}}),bandwidthProgressStyle=computed(()=>{const color=getProgressColor(bandwidthPercent.value);return{background:color.gradient,boxShadow:`0 0 12px ${color.glow}`}}),getProgressLevel=percentage=>getProgressColor(percentage).level,getStatusText=percentage=>percentage<=60?$t("dashboard.stats.quotas.status.healthy"):percentage<=85?$t("dashboard.stats.quotas.status.warning"):$t("dashboard.stats.quotas.status.danger"),getStatusDescription=percentage=>percentage<=60?$t("dashboard.stats.quotas.description.healthy"):percentage<=85?$t("dashboard.stats.quotas.description.warning"):$t("dashboard.stats.quotas.description.danger"),formatNumber=num=>num==null||isNaN(num)?"0":num>=1e6?`${(num/1e6).toFixed(1)}M`:num>=1e3?`${(num/1e3).toFixed(1)}K`:num.toString(),statItems=ref([{id:"images",icon:"fas fa-images",label:$t("dashboard.stats.items.images"),getValue:()=>formatNumber(stats.value.total_files),colorVar:"primary"},{id:"storage",icon:"fas fa-hdd",label:$t("dashboard.stats.items.storage"),getValue:()=>stats.value.used_storage_formatted,colorVar:"secondary"},{id:"views",icon:"fas fa-eye",label:$t("dashboard.stats.items.views"),getValue:()=>formatNumber(stats.value.total_views),colorVar:"accent"},{id:"shares",icon:"fas fa-share-alt",label:$t("dashboard.stats.items.shares"),getValue:()=>stats.value.total_shares,colorVar:"info"}]);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$7,[createBaseVNode("div",_hoisted_2$7,[createBaseVNode("div",_hoisted_3$7,[createBaseVNode("h3",_hoisted_4$7,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-chart-pie"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.stats.title")),1)])]),createBaseVNode("div",_hoisted_5$7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(statItems.value,item=>(openBlock(),createElementBlock("div",{key:item.id,class:"stat-item","data-color":item.colorVar},[createBaseVNode("div",_hoisted_7$7,[createBaseVNode("i",{class:normalizeClass(item.icon)},null,2)]),createBaseVNode("div",_hoisted_8$7,[createBaseVNode("div",_hoisted_9$7,toDisplayString(loading.value?"-":item.getValue()),1),createBaseVNode("div",_hoisted_10$6,toDisplayString(item.label),1)])],8,_hoisted_6$7))),128))]),createBaseVNode("div",_hoisted_11$5,[createBaseVNode("h4",_hoisted_12$5,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-tachometer-alt"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.stats.quotas.title")),1)]),createBaseVNode("div",_hoisted_13$3,[createBaseVNode("div",_hoisted_14$3,[createBaseVNode("span",_hoisted_15$3,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-database"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.stats.quotas.storage.label"))+" ",1),createBaseVNode("span",{class:normalizeClass(["status-badge",getProgressLevel(storagePercent.value)]),title:getStatusDescription(storagePercent.value)},toDisplayString(getStatusText(storagePercent.value)),11,_hoisted_16$3)]),createBaseVNode("span",{class:normalizeClass(["quota-value",getProgressLevel(storagePercent.value)])},toDisplayString(storagePercent.value)+"%",3)]),createBaseVNode("div",_hoisted_17$3,[createBaseVNode("div",{class:normalizeClass(["progress-bar storage",[getProgressLevel(storagePercent.value)]])},[createBaseVNode("div",{class:"progress-fill",style:normalizeStyle({width:storagePercent.value+"%",...storageProgressStyle.value})},null,4)],2)]),createBaseVNode("div",_hoisted_18$3,[createBaseVNode("span",_hoisted_19$3,toDisplayString(stats.value.used_storage_formatted),1),createBaseVNode("span",_hoisted_20$3,toDisplayString(stats.value.total_storage_formatted),1)])]),createBaseVNode("div",_hoisted_21$3,[createBaseVNode("div",_hoisted_22$3,[createBaseVNode("span",_hoisted_23$3,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-wifi"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.stats.quotas.bandwidth.label"))+" ",1),createBaseVNode("span",{class:normalizeClass(["status-badge",getProgressLevel(bandwidthPercent.value)]),title:getStatusDescription(bandwidthPercent.value)},toDisplayString(getStatusText(bandwidthPercent.value)),11,_hoisted_24$3)]),createBaseVNode("span",{class:normalizeClass(["quota-value",getProgressLevel(bandwidthPercent.value)])},toDisplayString(bandwidthPercent.value)+"%",3)]),createBaseVNode("div",_hoisted_25$3,[createBaseVNode("div",{class:normalizeClass(["progress-bar bandwidth",[getProgressLevel(bandwidthPercent.value)]])},[createBaseVNode("div",{class:"progress-fill",style:normalizeStyle({width:bandwidthPercent.value+"%",...bandwidthProgressStyle.value})},null,4)],2)]),createBaseVNode("div",_hoisted_26$3,[createBaseVNode("span",_hoisted_27$3,toDisplayString(stats.value.used_bandwidth_formatted),1),createBaseVNode("span",_hoisted_28$2,toDisplayString(stats.value.total_bandwidth_formatted),1)])])])])]))}});const CompactStats=_export_sfc(_sfc_main$7,[["__scopeId","data-v-f76197d9"]]);function getUserActivities(params){const queryParams={page:params?.page||1,size:params?.size||20};return get("/personal/activities",queryParams)}var ActivityAction=(ActivityAction2=>(ActivityAction2[ActivityAction2.CREATE=1]="CREATE",ActivityAction2[ActivityAction2.DELETE=2]="DELETE",ActivityAction2[ActivityAction2.UPDATE=3]="UPDATE",ActivityAction2[ActivityAction2.ENABLE=4]="ENABLE",ActivityAction2[ActivityAction2.DISABLE=5]="DISABLE",ActivityAction2[ActivityAction2.MOVE=6]="MOVE",ActivityAction2[ActivityAction2.RENAME=7]="RENAME",ActivityAction2[ActivityAction2.UPLOAD=8]="UPLOAD",ActivityAction2[ActivityAction2.LOGIN=9]="LOGIN",ActivityAction2[ActivityAction2.REGISTER=10]="REGISTER",ActivityAction2[ActivityAction2.CHANGE=11]="CHANGE",ActivityAction2[ActivityAction2.EXPIRE=12]="EXPIRE",ActivityAction2[ActivityAction2.CLEANUP=13]="CLEANUP",ActivityAction2[ActivityAction2.REGENERATE=14]="REGENERATE",ActivityAction2[ActivityAction2.TOGGLE=15]="TOGGLE",ActivityAction2))(ActivityAction||{});function formatActivityDescription(activity,$t){const{type,data}=activity;try{switch(type){case"user_login":return data.ip_address?$t("activity.user.loginWithIp",{ip:data.ip_address}):$t("activity.user.login");case"user_register":return $t("activity.user.register");case"batch_image_upload":return data.total_size?$t("activity.file.batchUploadWithSize",{count:data.file_count||data.count||0,size:formatFileSize(data.total_size)}):$t("activity.file.batchUpload",{count:data.file_count||data.count||0});case"file_delete":return $t("activity.file.delete",{fileName:data.file_name||"Unknown"});case"file_rename":return $t("activity.file.rename",{oldName:data.old_name||"Unknown",newName:data.new_name||"Unknown"});case"file_move":return $t("activity.file.move",{fileName:data.file_name||"Unknown",oldFolder:data.old_folder_name||$t("activity.common.rootFolder"),newFolder:data.new_folder_name||$t("activity.common.rootFolder")});case"image_access_level_change":case"file_access_level_change":{const level=$t(`activity.accessLevel.${data.new_access_level||"private"}`);return $t("activity.file.accessLevelChange",{fileName:data.file_name||"Unknown",level})}case"image_expired":case"file_expired":return data.expired_count&&data.expired_count>1?$t("activity.file.expiredBatch",{count:data.expired_count}):$t("activity.file.expired",{fileName:data.file_name||"Unknown"});case"folder_create":return data.parent_name?$t("activity.folder.createInParent",{folderName:data.folder_name||"Unknown",parentName:data.parent_name}):$t("activity.folder.create",{folderName:data.folder_name||"Unknown"});case"folder_rename":return $t("activity.folder.rename",{oldName:data.old_name||"Unknown",newName:data.new_name||"Unknown"});case"folder_delete":return data.file_count&&data.file_count>0?$t("activity.folder.deleteWithFiles",{folderName:data.folder_name||"Unknown",count:data.file_count}):$t("activity.folder.delete",{folderName:data.folder_name||"Unknown"});case"folder_access_level_change":{const oldLevel=$t(`activity.accessLevel.${data.old_access_level||"private"}`),newLevel=$t(`activity.accessLevel.${data.new_access_level||"public"}`);return $t("activity.folder.accessLevelChange",{folderName:data.folder_name||"Unknown",oldLevel,newLevel})}case"share_create":return $t("activity.share.create");case"share_delete":return $t("activity.share.delete");case"share_milestone":return $t("activity.share.milestone",{count:data.visit_count||data.milestone||0});case"apikey_create":return $t("activity.apikey.create",{keyName:data.key_name||"API Key"});case"apikey_delete":return $t("activity.apikey.delete",{keyName:data.key_name||"API Key"});case"apikey_toggle_status":return data.action===ActivityAction.ENABLE||data.new_status===1?$t("activity.apikey.toggleEnable",{keyName:data.key_name||"API Key"}):$t("activity.apikey.toggleDisable",{keyName:data.key_name||"API Key"});case"apikey_regenerate":return $t("activity.apikey.regenerate",{keyName:data.key_name||"API Key"});case"random_api_create":return $t("activity.randomApi.create",{apiName:data.api_name||"Random API"});case"random_api_delete":return $t("activity.randomApi.delete",{apiName:data.api_name||"Random API"});case"random_api_toggle_status":{const apiName=data.api_name||"Random API",folderName=data.folder_name;return data.action===ActivityAction.ENABLE||data.new_status===1?folderName?$t("activity.randomApi.toggleEnableWithFolder",{apiName,folderName}):$t("activity.randomApi.toggleEnable",{apiName}):folderName?$t("activity.randomApi.toggleDisableWithFolder",{apiName,folderName}):$t("activity.randomApi.toggleDisable",{apiName})}case"profile_update":{const key=`activity.profile.${data.field_type||"profile"}Update`;try{return $t(key)}catch{return $t("activity.profile.update")}}case"password_change":return $t("activity.profile.passwordChange");case"email_change":return $t("activity.profile.emailChange",{email:data.new_email||""});case"hotlink_protection_change":return data.action===ActivityAction.ENABLE?$t("activity.security.hotlinkProtectionEnable"):data.action===ActivityAction.DISABLE?$t("activity.security.hotlinkProtectionDisable"):$t("activity.security.hotlinkProtectionChange");case"batch_delete":return data.folder_name?$t("activity.system.batchDeleteWithFolder",{count:data.file_count||data.count||0,folderName:data.folder_name}):$t("activity.system.batchDelete",{count:data.file_count||data.count||0});case"admin_delete":return $t("activity.system.adminDelete");case"system_cleanup":return $t("activity.system.cleanup",{count:data.cleaned_count||0,type:data.cleanup_type||""});case"guest_file_expired":case"guest_image_expired":return $t("activity.system.guestImageExpired",{count:data.expired_count||0});default:return console.warn(`Unknown activity type: ${type}`,data),`Activity: ${type}`}}catch(error){return console.error("Error formatting activity description:",error,activity),`Activity: ${type}`}}const _hoisted_1$6={class:"activity-monitor cyber-card"},_hoisted_2$6={class:"monitor-content"},_hoisted_3$6={class:"monitor-header"},_hoisted_4$6={class:"section-title"},_hoisted_5$6={class:"monitor-status"},_hoisted_6$6={class:"status-text"},_hoisted_7$6={class:"stats-overview"},_hoisted_8$6={class:"stat-item"},_hoisted_9$6={class:"stat-content"},_hoisted_10$5={class:"stat-value"},_hoisted_11$4={class:"stat-label"},_hoisted_12$4={class:"stat-item"},_hoisted_13$2={class:"stat-content"},_hoisted_14$2={class:"stat-value"},_hoisted_15$2={class:"stat-label"},_hoisted_16$2={class:"recent-activities"},_hoisted_17$2={class:"activities-header"},_hoisted_18$2={class:"section-subtitle"},_hoisted_19$2={key:0,class:"activities-counter"},_hoisted_20$2={class:"activities-list"},_hoisted_21$2={key:0,class:"activity-item loading"},_hoisted_22$2={class:"activity-content"},_hoisted_23$2={class:"activity-description"},_hoisted_24$2={class:"activity-time"},_hoisted_25$2={class:"activity-content"},_hoisted_26$2={class:"activity-description"},_hoisted_27$2={class:"activity-time"},_hoisted_28$1={key:2,class:"activity-item loading-more"},_hoisted_29$1={class:"activity-content"},_hoisted_30$1={class:"activity-description"},_hoisted_31$1={class:"activity-time"},_hoisted_32$1={key:3,class:"activity-item no-more"},_hoisted_33$1={class:"activity-content"},_hoisted_34$1={class:"activity-description"},_hoisted_35={class:"activity-time"},_hoisted_36={key:4,class:"activity-item empty"},_hoisted_37={class:"activity-content"},_hoisted_38={class:"activity-description"},_hoisted_39={class:"activity-time"},_sfc_main$6=defineComponent({name:"ActivityMonitor",__name:"ActivityMonitor",setup(__props){const{$t}=useTexts(),monitorStatus=ref("active"),statusText=computed(()=>{switch(monitorStatus.value){case"active":return $t("dashboard.activityMonitor.status.active");case"warning":return $t("dashboard.activityMonitor.status.warning");case"error":return $t("dashboard.activityMonitor.status.error");default:return $t("dashboard.activityMonitor.status.offline")}}),realtimeStats=ref({uploadsPerHour:12,viewsPerHour:847}),activities=ref([]),currentPage=ref(1),pageSize=ref(15),totalActivities=ref(0),hasMore=ref(!0),initialLoading=ref(!1),loadingMore=ref(!1),scrollContainer=ref(),getActivityIcon=type=>{switch(type){case"user_login":return{icon:"fas fa-sign-in-alt",class:"login"};case"user_register":return{icon:"fas fa-user-plus",class:"register"};case"batch_image_upload":return{icon:"fas fa-upload",class:"upload"};case"file_delete":return{icon:"fas fa-file-times",class:"delete"};case"file_rename":return{icon:"fas fa-file-signature",class:"edit"};case"file_move":return{icon:"fas fa-file-export",class:"move"};case"share_create":return{icon:"fas fa-share-alt",class:"share"};case"share_delete":return{icon:"fas fa-share-square",class:"delete"};case"share_milestone":return{icon:"fas fa-eye",class:"view"};case"apikey_create":return{icon:"fas fa-key",class:"create"};case"apikey_delete":return{icon:"fas fa-key",class:"delete"};case"apikey_toggle_status":return{icon:"fas fa-toggle-on",class:"edit"};case"apikey_regenerate":return{icon:"fas fa-sync-alt",class:"security"};case"random_api_create":return{icon:"fas fa-random",class:"create"};case"random_api_delete":return{icon:"fas fa-random",class:"delete"};case"random_api_toggle_status":return{icon:"fas fa-toggle-on",class:"edit"};case"batch_delete":case"admin_delete":return{icon:"fas fa-trash",class:"delete"};case"system_cleanup":return{icon:"fas fa-cog",class:"system"};case"folder_create":return{icon:"fas fa-folder-plus",class:"folder"};case"folder_rename":return{icon:"fas fa-edit",class:"folder"};case"folder_delete":return{icon:"fas fa-folder-minus",class:"delete"};case"folder_access_level_change":return{icon:"fas fa-lock",class:"permission"};case"image_access_level_change":return{icon:"fas fa-eye-slash",class:"permission"};case"profile_update":return{icon:"fas fa-user-edit",class:"profile"};case"password_change":return{icon:"fas fa-key",class:"security"};case"email_change":return{icon:"fas fa-envelope",class:"security"};case"hotlink_protection_change":return{icon:"fas fa-shield-alt",class:"security"};case"image_expired":return{icon:"fas fa-clock",class:"expired"};case"guest_image_expired":return{icon:"fas fa-user-clock",class:"system"};default:return{icon:"fas fa-circle",class:"default"}}},loadActivities=async(reset=!0)=>{if(!(initialLoading.value||loadingMore.value))try{reset?(initialLoading.value=!0,currentPage.value=1,activities.value=[],hasMore.value=!0):loadingMore.value=!0,monitorStatus.value="active";const response=await getUserActivities({page:currentPage.value,size:pageSize.value});if(response.code===200&&response.data){const newActivities=response.data.list.map(activity=>{const iconInfo=getActivityIcon(activity.type);return{id:activity.id,type:activity.type,icon:iconInfo.icon,class:iconInfo.class,description:formatActivityDescription(activity,$t),timestamp:new Date(activity.created_at).getTime()}});if(reset)activities.value=newActivities,response.data.today_stats&&(realtimeStats.value.uploadsPerHour=response.data.today_stats.today_uploads,realtimeStats.value.viewsPerHour=response.data.today_stats.total_views);else{const existingIds=new Set(activities.value.map(a=>a.id)),uniqueNewActivities=newActivities.filter(a=>!existingIds.has(a.id));activities.value.push(...uniqueNewActivities)}totalActivities.value=response.data.total||0,hasMore.value=response.data.list.length===pageSize.value&&activities.value.length<totalActivities.value}else console.warn("Failed to fetch activity logs:",response.message),monitorStatus.value="warning"}catch{monitorStatus.value="error",reset&&(activities.value=[{id:1,type:"upload",icon:"fas fa-upload",class:"upload",description:$t("dashboard.activityMonitor.toast.noData"),timestamp:Date.now()}],totalActivities.value=1,hasMore.value=!1)}finally{initialLoading.value=!1,loadingMore.value=!1}},loadMoreActivities=async()=>{!hasMore.value||loadingMore.value||(currentPage.value++,await loadActivities(!1))},handleScroll=async event=>{const target=event.target;if(!target||!hasMore.value||loadingMore.value)return;const{scrollTop}=target,{scrollHeight}=target,{clientHeight}=target;scrollTop+clientHeight>=scrollHeight-50&&await loadMoreActivities()},formatTime=timestamp=>{const diff=Date.now()-timestamp,minutes=Math.floor(diff/(1e3*60)),hours=Math.floor(diff/(1e3*60*60));return hours>0?$t("dashboard.activityMonitor.timeAgo.hoursAgo",{hours}):minutes>0?$t("dashboard.activityMonitor.timeAgo.minutesAgo",{minutes}):$t("dashboard.activityMonitor.timeAgo.justNow")};return onMounted(()=>{loadActivities(!0);const activityInterval=setInterval(()=>{!initialLoading.value&&!loadingMore.value&&loadActivities(!0)},12e4);onUnmounted(()=>{clearInterval(activityInterval)})}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$6,[createBaseVNode("div",_hoisted_2$6,[createBaseVNode("div",_hoisted_3$6,[createBaseVNode("h3",_hoisted_4$6,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-chart-line"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.activityMonitor.title")),1)]),createBaseVNode("div",_hoisted_5$6,[createBaseVNode("div",{class:normalizeClass(["status-dot",monitorStatus.value])},null,2),createBaseVNode("span",_hoisted_6$6,toDisplayString(statusText.value),1)])]),createBaseVNode("div",_hoisted_7$6,[createBaseVNode("div",_hoisted_8$6,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"stat-icon upload"},[createBaseVNode("i",{class:"fas fa-upload"})],-1)),createBaseVNode("div",_hoisted_9$6,[createBaseVNode("div",_hoisted_10$5,toDisplayString(realtimeStats.value.uploadsPerHour),1),createBaseVNode("div",_hoisted_11$4,toDisplayString(unref($t)("dashboard.activityMonitor.todayUploads")),1)])]),createBaseVNode("div",_hoisted_12$4,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"stat-icon view"},[createBaseVNode("i",{class:"fas fa-eye"})],-1)),createBaseVNode("div",_hoisted_13$2,[createBaseVNode("div",_hoisted_14$2,toDisplayString(realtimeStats.value.viewsPerHour),1),createBaseVNode("div",_hoisted_15$2,toDisplayString(unref($t)("dashboard.activityMonitor.totalViews")),1)])])]),createBaseVNode("div",_hoisted_16$2,[createBaseVNode("div",_hoisted_17$2,[createBaseVNode("h4",_hoisted_18$2,toDisplayString(unref($t)("dashboard.activityMonitor.recentActivity")),1),activities.value.length>0?(openBlock(),createElementBlock("div",_hoisted_19$2,toDisplayString(unref($t)("dashboard.activityMonitor.recordCount",{count:totalActivities.value})),1)):createCommentVNode("",!0)]),createBaseVNode("div",{ref_key:"scrollContainer",ref:scrollContainer,class:"activities-scroll-container",onScroll:handleScroll},[createBaseVNode("div",_hoisted_20$2,[initialLoading.value?(openBlock(),createElementBlock("div",_hoisted_21$2,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"activity-icon loading"},[createBaseVNode("i",{class:"fas fa-spinner fa-spin"})],-1)),createBaseVNode("div",_hoisted_22$2,[createBaseVNode("div",_hoisted_23$2,toDisplayString(unref($t)("dashboard.activityMonitor.loadingActivities")),1),createBaseVNode("div",_hoisted_24$2,toDisplayString(unref($t)("dashboard.activityMonitor.loadingHint")),1)])])):(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(activities.value,activity=>(openBlock(),createElementBlock("div",{key:activity.id,class:"activity-item"},[createBaseVNode("div",{class:normalizeClass(["activity-icon",activity.class||activity.type])},[createBaseVNode("i",{class:normalizeClass(activity.icon)},null,2)],2),createBaseVNode("div",_hoisted_25$2,[createBaseVNode("div",_hoisted_26$2,toDisplayString(activity.description),1),createBaseVNode("div",_hoisted_27$2,toDisplayString(formatTime(activity.timestamp)),1)])]))),128)),loadingMore.value?(openBlock(),createElementBlock("div",_hoisted_28$1,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"activity-icon loading"},[createBaseVNode("i",{class:"fas fa-spinner fa-spin"})],-1)),createBaseVNode("div",_hoisted_29$1,[createBaseVNode("div",_hoisted_30$1,toDisplayString(unref($t)("dashboard.activityMonitor.loadingMore")),1),createBaseVNode("div",_hoisted_31$1,toDisplayString(unref($t)("dashboard.activityMonitor.loadingHint")),1)])])):createCommentVNode("",!0),!hasMore.value&&activities.value.length>0&&!initialLoading.value?(openBlock(),createElementBlock("div",_hoisted_32$1,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"activity-icon default"},[createBaseVNode("i",{class:"fas fa-check-circle"})],-1)),createBaseVNode("div",_hoisted_33$1,[createBaseVNode("div",_hoisted_34$1,toDisplayString(unref($t)("dashboard.activityMonitor.allLoaded")),1),createBaseVNode("div",_hoisted_35,toDisplayString(unref($t)("dashboard.activityMonitor.recordCount",{count:activities.value.length})),1)])])):createCommentVNode("",!0),!initialLoading.value&&activities.value.length===0?(openBlock(),createElementBlock("div",_hoisted_36,[_cache[6]||(_cache[6]=createBaseVNode("div",{class:"activity-icon default"},[createBaseVNode("i",{class:"fas fa-info-circle"})],-1)),createBaseVNode("div",_hoisted_37,[createBaseVNode("div",_hoisted_38,toDisplayString(unref($t)("dashboard.activityMonitor.empty")),1),createBaseVNode("div",_hoisted_39,toDisplayString(unref($t)("dashboard.activityMonitor.emptyHint")),1)])])):createCommentVNode("",!0)])],544)])])]))}});const ActivityMonitor=_export_sfc(_sfc_main$6,[["__scopeId","data-v-1d29231f"]]),_hoisted_1$5={class:"message-center cyber-card"},_hoisted_2$5={class:"center-content"},_hoisted_3$5={class:"center-header"},_hoisted_4$5={class:"section-title"},_hoisted_5$5={class:"message-stats"},_hoisted_6$5={key:0,class:"unread-count"},_hoisted_7$5={key:0,class:"loading-state"},_hoisted_8$5={key:1,class:"empty-state"},_hoisted_9$5={key:2,class:"messages-wrapper"},_hoisted_10$4={class:"messages-list"},_hoisted_11$3=["onClick"],_hoisted_12$3={class:"message-content"},_hoisted_13$1={class:"message-header"},_hoisted_14$1={class:"message-title"},_hoisted_15$1={class:"message-time"},_hoisted_16$1={class:"message-body"},_hoisted_17$1={key:0,class:"message-priority"},_hoisted_18$1={key:1,class:"unread-dot"},_hoisted_19$1={key:0,class:"message-item loading-more"},_hoisted_20$1={class:"message-content"},_hoisted_21$1={class:"message-title"},_hoisted_22$1={class:"message-body"},_hoisted_23$1={key:1,class:"message-item no-more"},_hoisted_24$1={class:"message-content"},_hoisted_25$1={class:"message-title"},_hoisted_26$1={class:"message-body"},_hoisted_27$1={key:0,class:"scroll-indicator"},_sfc_main$5=defineComponent({name:"MessageCenter",__name:"MessageCenter",props:{refreshKey:{}},setup(__props){const props=__props,router=useRouter(),toast=useToast(),{$t}=useTexts(),messageToast=useMessageToast(),messageModal=useMessageModal(),loading=ref(!1),messages=ref([]),currentPage=ref(1),pageSize=ref(15),hasMore=ref(!0),loadingMore=ref(!1),scrollContainer=ref(),unreadCount=computed(()=>messages.value.filter(m=>m.status===1).length),sortMessages=(messageList,byStatus=!1)=>messageList.sort((a,b)=>byStatus&&a.status!==b.status?a.status-b.status:new Date(b.created_at).getTime()-new Date(a.created_at).getTime()),reorganizeMessages=()=>{const unread=messages.value.filter(m=>m.status===1),read=messages.value.filter(m=>m.status===2);sortMessages(read),messages.value=[...unread,...read]},fetchMessages=async(reset=!0)=>{if(!(loading.value||loadingMore.value))try{reset?loading.value=!0:loadingMore.value=!0,reset&&(currentPage.value=1,hasMore.value=!0);const[messagesResult]=await Promise.all([getUserMessages({page:currentPage.value,pageSize:pageSize.value}),reset?getUnreadCount():Promise.resolve(null)]);if(messagesResult.success){const messageList=messagesResult.data?.items||[];if(reset)messages.value=sortMessages(messageList,!0);else{const existingIds=new Set(messages.value.map(m=>m.id)),newMessages=messageList.filter(m=>!existingIds.has(m.id)),unread=messages.value.filter(m=>m.status===1),read=[...messages.value.filter(m=>m.status===2),...newMessages.filter(m=>m.status===2)],newUnread=newMessages.filter(m=>m.status===1);sortMessages(read),messages.value=[...unread,...newUnread,...read]}hasMore.value=messageList.length===pageSize.value}}catch{}finally{loading.value=!1,loadingMore.value=!1}},loadMoreMessages=async()=>{!hasMore.value||loadingMore.value||(currentPage.value++,await fetchMessages(!1))},handleScroll=async event=>{const target=event.target;if(!target||!hasMore.value||loadingMore.value)return;const{scrollTop,scrollHeight,clientHeight}=target;scrollTop+clientHeight>=scrollHeight-50&&await loadMoreMessages()},isUnread=message=>message.status===1,MESSAGE_TYPE_MAP={"system.maintenance":"system","system.announcement":"system","account.register":"account","account.storage_granted":"account","account.bandwidth_granted":"account","content.review_approved":"content","content.review_rejected":"content","content.review_pending":"content","storage.quota_warning":"storage","storage.quota_increased":"storage","storage.quota_decreased":"storage","file.deleted_by_admin":"file","file.batch_deleted_by_admin":"file","file.hard_deleted_by_admin":"file","file.expiry_warning":"file","file.thumbnail_failed":"file","security.login_alert":"security","apikey.created":"apikey","apikey.deleted":"apikey","apikey.regenerated":"apikey","apikey.disabled":"apikey","apikey.enabled":"apikey","random_api.created":"random_api","random_api.deleted":"random_api","random_api.disabled":"random_api","random_api.enabled":"random_api","share.expiry_warning":"share"},MESSAGE_ICONS={"system.maintenance":"fas fa-tools","system.announcement":"fas fa-bullhorn","account.register":"fas fa-user-plus","account.storage_granted":"fas fa-gift","account.bandwidth_granted":"fas fa-rocket","content.review_approved":"fas fa-check-circle","content.review_rejected":"fas fa-times-circle","content.review_pending":"fas fa-clock","storage.quota_warning":"fas fa-exclamation-triangle","storage.quota_increased":"fas fa-arrow-up","storage.quota_decreased":"fas fa-arrow-down","file.deleted_by_admin":"fas fa-trash","file.batch_deleted_by_admin":"fas fa-trash-alt","file.hard_deleted_by_admin":"fas fa-skull-crossbones","file.expiry_warning":"fas fa-hourglass-half","file.thumbnail_failed":"fas fa-image","security.login_alert":"fas fa-shield-alt","apikey.created":"fas fa-key","apikey.deleted":"fas fa-key","apikey.regenerated":"fas fa-sync-alt","apikey.disabled":"fas fa-lock","apikey.enabled":"fas fa-unlock","random_api.created":"fas fa-random","random_api.deleted":"fas fa-random","random_api.disabled":"fas fa-ban","random_api.enabled":"fas fa-check-circle","share.expiry_warning":"fas fa-share-alt"},getMessageTypeClass=type=>MESSAGE_TYPE_MAP[type]||"default",getMessageIcon=type=>MESSAGE_ICONS[type]||"fas fa-bell",handleMessageClick=async message=>{if(isUnread(message))try{const messageIndex=messages.value.findIndex(m=>m.id===message.id);messageIndex!==-1&&(messages.value[messageIndex].status=2,messages.value[messageIndex].read_at=new Date().toISOString(),reorganizeMessages()),markMessageRead(message.id.toString()).catch(()=>{messageIndex!==-1&&(messages.value[messageIndex].status=1,messages.value[messageIndex].read_at=void 0,reorganizeMessages()),toast.error($t("dashboard.messages.markReadFailed"))})}catch{}messageModal.showMessageDetail(message);const formatted=formatMessage(message,$t);messageToast.showMessage({title:formatted.title,content:formatted.content,type:message.type,action_url:message.action_url,action_text:message.action_text,action_style:message.action_style})},handleViewAllClick=()=>router.push("/messages");return onMounted(()=>fetchMessages()),watch(()=>props.refreshKey,()=>{props.refreshKey!==void 0&&fetchMessages()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$5,[createBaseVNode("div",_hoisted_3$5,[createBaseVNode("h3",_hoisted_4$5,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-bell"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.messages.title")),1)]),createBaseVNode("div",_hoisted_5$5,[unreadCount.value>0?(openBlock(),createElementBlock("span",_hoisted_6$5,toDisplayString(unreadCount.value)+" "+toDisplayString(unref($t)("dashboard.messages.unread")),1)):createCommentVNode("",!0),createBaseVNode("button",{class:"view-all-btn",onClick:handleViewAllClick},[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-arrow-right"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.messages.viewAll")),1)])])]),loading.value&&messages.value.length===0?(openBlock(),createElementBlock("div",_hoisted_7$5,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"loading-spinner"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("dashboard.messages.loading")),1)])):!loading.value&&messages.value.length===0?(openBlock(),createElementBlock("div",_hoisted_8$5,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-inbox"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("dashboard.messages.empty")),1)])):(openBlock(),createElementBlock("div",_hoisted_9$5,[createBaseVNode("div",{ref_key:"scrollContainer",ref:scrollContainer,class:"messages-container",onScroll:handleScroll},[createBaseVNode("div",_hoisted_10$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(messages.value,message=>(openBlock(),createElementBlock("div",{key:message.id,class:normalizeClass(["message-item",{unread:isUnread(message)}]),onClick:$event=>handleMessageClick(message)},[createBaseVNode("div",{class:normalizeClass(["message-icon",getMessageTypeClass(message.type)])},[createBaseVNode("i",{class:normalizeClass(getMessageIcon(message.type))},null,2)],2),createBaseVNode("div",_hoisted_12$3,[createBaseVNode("div",_hoisted_13$1,[createBaseVNode("div",_hoisted_14$1,toDisplayString(unref(formatMessage)(message,unref($t)).title),1),createBaseVNode("div",_hoisted_15$1,toDisplayString(unref(formatRelativeTime)(message.created_at,unref($t))),1)]),createBaseVNode("div",_hoisted_16$1,toDisplayString(unref(formatMessage)(message,unref($t)).content),1)]),message.priority===1?(openBlock(),createElementBlock("div",_hoisted_17$1,[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-exclamation-triangle"},null,-1)])])):createCommentVNode("",!0),isUnread(message)?(openBlock(),createElementBlock("div",_hoisted_18$1)):createCommentVNode("",!0)],10,_hoisted_11$3))),128)),loadingMore.value?(openBlock(),createElementBlock("div",_hoisted_19$1,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"message-icon loading"},[createBaseVNode("i",{class:"fas fa-spinner fa-spin"})],-1)),createBaseVNode("div",_hoisted_20$1,[createBaseVNode("div",_hoisted_21$1,toDisplayString(unref($t)("dashboard.messages.loadingMore")),1),createBaseVNode("div",_hoisted_22$1,toDisplayString(unref($t)("dashboard.messages.loadingMoreDesc")),1)])])):createCommentVNode("",!0),!hasMore.value&&messages.value.length>0?(openBlock(),createElementBlock("div",_hoisted_23$1,[_cache[6]||(_cache[6]=createBaseVNode("div",{class:"message-icon default"},[createBaseVNode("i",{class:"fas fa-check-circle"})],-1)),createBaseVNode("div",_hoisted_24$1,[createBaseVNode("div",_hoisted_25$1,toDisplayString(unref($t)("dashboard.messages.noMore")),1),createBaseVNode("div",_hoisted_26$1,toDisplayString(unref($t)("dashboard.messages.noMoreDesc",{count:messages.value.length})),1)])])):createCommentVNode("",!0)])],544),messages.value.length>3?(openBlock(),createElementBlock("div",_hoisted_27$1,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-chevron-down"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("dashboard.messages.scrollHint")),1)])):createCommentVNode("",!0)]))])]))}});const MessageCenter=_export_sfc(_sfc_main$5,[["__scopeId","data-v-b3a3857b"]]),_hoisted_1$4={class:"upload-statistics cyber-card"},_hoisted_2$4={class:"stats-content"},_hoisted_3$4={class:"stats-header"},_hoisted_4$4={class:"section-title"},_hoisted_5$4={class:"header-actions"},_hoisted_6$4={class:"status-text"},_hoisted_7$4=["title"],_hoisted_8$4={class:"global-progress"},_hoisted_9$4={class:"progress-info"},_hoisted_10$3={class:"progress-label"},_hoisted_11$2={class:"progress-value"},_hoisted_12$2={class:"progress-bar"},_hoisted_13={class:"stats-grid"},_hoisted_14={class:"stat-item"},_hoisted_15={class:"stat-content"},_hoisted_16={class:"stat-value"},_hoisted_17={class:"stat-label"},_hoisted_18={class:"stat-item"},_hoisted_19={class:"stat-icon uploading"},_hoisted_20={class:"stat-content"},_hoisted_21={class:"stat-value"},_hoisted_22={class:"stat-label"},_hoisted_23={class:"stat-item"},_hoisted_24={class:"stat-content"},_hoisted_25={class:"stat-value"},_hoisted_26={class:"stat-label"},_hoisted_27={class:"stat-item"},_hoisted_28={class:"stat-content"},_hoisted_29={class:"stat-value"},_hoisted_30={class:"stat-label"},_hoisted_31={class:"stat-item"},_hoisted_32={class:"stat-content"},_hoisted_33={class:"stat-value"},_hoisted_34={class:"stat-label"},_sfc_main$4=defineComponent({name:"UploadStatistics",__name:"UploadQueue",setup(__props){const router=useRouter(),uploadStore=useUploadStore(),{$t}=useTexts(),goToUploadPage=()=>{router.push("/upload")};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$4,[createBaseVNode("div",_hoisted_3$4,[createBaseVNode("h3",_hoisted_4$4,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-chart-bar"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.uploadQueue.statsTitle")),1)]),createBaseVNode("div",_hoisted_5$4,[createBaseVNode("span",_hoisted_6$4,toDisplayString(unref($t)("dashboard.uploadQueue.totalFiles",{count:unref(uploadStore).statistics.total})),1),createBaseVNode("button",{class:"upload-entry-btn",title:unref($t)("dashboard.uploadQueue.actions.goToUpload"),onClick:goToUploadPage},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-external-link-alt"},null,-1)])],8,_hoisted_7$4)])]),createBaseVNode("div",_hoisted_8$4,[createBaseVNode("div",_hoisted_9$4,[createBaseVNode("span",_hoisted_10$3,toDisplayString(unref($t)("dashboard.uploadQueue.overallProgress")),1),createBaseVNode("span",_hoisted_11$2,toDisplayString(unref(uploadStore).globalProgress)+"%",1)]),createBaseVNode("div",_hoisted_12$2,[createBaseVNode("div",{class:"progress-fill",style:normalizeStyle({width:unref(uploadStore).globalProgress+"%"})},null,4)])]),createBaseVNode("div",_hoisted_13,[createBaseVNode("div",_hoisted_14,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"stat-icon total"},[createBaseVNode("i",{class:"fas fa-list"})],-1)),createBaseVNode("div",_hoisted_15,[createBaseVNode("div",_hoisted_16,toDisplayString(unref(uploadStore).statistics.total),1),createBaseVNode("div",_hoisted_17,toDisplayString(unref($t)("dashboard.uploadQueue.queueTotal")),1)])]),createBaseVNode("div",_hoisted_18,[createBaseVNode("div",_hoisted_19,[createBaseVNode("i",{class:normalizeClass(["fas fa-spinner",{"fa-spin":unref(uploadStore).statistics.uploading>0}])},null,2)]),createBaseVNode("div",_hoisted_20,[createBaseVNode("div",_hoisted_21,toDisplayString(unref(uploadStore).statistics.uploading),1),createBaseVNode("div",_hoisted_22,toDisplayString(unref($t)("dashboard.uploadQueue.uploading")),1)])]),createBaseVNode("div",_hoisted_23,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"stat-icon pending"},[createBaseVNode("i",{class:"fas fa-clock"})],-1)),createBaseVNode("div",_hoisted_24,[createBaseVNode("div",_hoisted_25,toDisplayString(unref(uploadStore).statistics.pending),1),createBaseVNode("div",_hoisted_26,toDisplayString(unref($t)("dashboard.uploadQueue.pending")),1)])]),createBaseVNode("div",_hoisted_27,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"stat-icon completed"},[createBaseVNode("i",{class:"fas fa-check"})],-1)),createBaseVNode("div",_hoisted_28,[createBaseVNode("div",_hoisted_29,toDisplayString(unref(uploadStore).statistics.completed),1),createBaseVNode("div",_hoisted_30,toDisplayString(unref($t)("dashboard.uploadQueue.completed")),1)])]),createBaseVNode("div",_hoisted_31,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"stat-icon failed"},[createBaseVNode("i",{class:"fas fa-times"})],-1)),createBaseVNode("div",_hoisted_32,[createBaseVNode("div",_hoisted_33,toDisplayString(unref(uploadStore).statistics.failed),1),createBaseVNode("div",_hoisted_34,toDisplayString(unref($t)("dashboard.uploadQueue.failed")),1)])])])])]))}});const UploadQueue=_export_sfc(_sfc_main$4,[["__scopeId","data-v-3ab41c35"]]),_hoisted_1$3=["title"],_hoisted_2$3={class:"image-thumbnail"},_hoisted_3$3=["src","alt"],_hoisted_4$3={class:"hover-overlay"},_hoisted_5$3={class:"image-info"},_hoisted_6$3={class:"image-name"},_hoisted_7$3={class:"image-details"},_hoisted_8$3={class:"size"},_hoisted_9$3={class:"time"},_sfc_main$3=defineComponent({name:"RecentFileItem",__name:"RecentFileItem",props:{image:{}},emits:["click"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,getImageUrl=()=>props.image.full_thumb_url||props.image.thumb_url||getPlaceholderImage(),handleImageError=event=>{const img=event.target;img.src=getPlaceholderImage()},getPlaceholderImage=()=>'data:image/svg+xml;charset=UTF-8,%3csvg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80"%3e%3crect width="80" height="80" fill="%23161b22"/%3e%3cpath d="M25 35h30v10H25z" fill="%23484f58"/%3e%3ccircle cx="35" cy="30" r="3" fill="%23484f58"/%3e%3c/svg%3e',{$t}=useTexts(),formatSize=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(1))} ${sizes[i]}`},formatTime=dateString=>{const now=new Date,date=new Date(dateString),diff=now.getTime()-date.getTime(),minutes=Math.floor(diff/(1e3*60)),hours=Math.floor(diff/(1e3*60*60)),days=Math.floor(diff/(1e3*60*60*24));return minutes<60?$t("dashboard.activityMonitor.timeAgo.minutesAgo",{minutes:String(minutes)}):hours<24?$t("dashboard.activityMonitor.timeAgo.hoursAgo",{hours:String(hours)}):days<7?$t("dashboard.activityMonitor.timeAgo.daysAgo",{days:String(days)}):date.toLocaleDateString(getCurrentLocale(),{month:"short",day:"numeric"})},handleClick=()=>{const imageUrl=props.image.full_url||props.image.url||getImageUrl();window.open(imageUrl,"_blank","noopener,noreferrer"),emit("click",props.image)};return(_ctx,_cache)=>{const _component_CyberBackground=resolveComponent("CyberBackground"),_component_cyber_file_expiry_tag=resolveComponent("cyber-file-expiry-tag");return openBlock(),createElementBlock("div",{class:"recent-image-item",title:`${__props.image.display_name} (${formatSize(__props.image.size)})`,onClick:handleClick},[createBaseVNode("div",_hoisted_2$3,[createVNode(_component_CyberBackground,{pattern:"cyber"},{default:withCtx(()=>[createBaseVNode("img",{src:getImageUrl(),alt:__props.image.display_name,onError:handleImageError},null,40,_hoisted_3$3)]),_:1}),__props.image.is_time_limited?(openBlock(),createBlock(_component_cyber_file_expiry_tag,{key:0,"expires-at":__props.image.expires_at,"storage-duration":__props.image.storage_duration,"is-time-limited":__props.image.is_time_limited,position:"top-left",mode:"both","show-icon":!0},null,8,["expires-at","storage-duration","is-time-limited"])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_4$3,[createBaseVNode("div",_hoisted_5$3,[createBaseVNode("div",_hoisted_6$3,toDisplayString(__props.image.display_name),1),createBaseVNode("div",_hoisted_7$3,[createBaseVNode("span",_hoisted_8$3,toDisplayString(formatSize(__props.image.size)),1),createBaseVNode("span",_hoisted_9$3,toDisplayString(formatTime(__props.image.created_at)),1)])])])])],8,_hoisted_1$3)}}});const RecentFileItem=_export_sfc(_sfc_main$3,[["__scopeId","data-v-82b34758"]]),_hoisted_1$2={class:"recent-uploads cyber-card"},_hoisted_2$2={class:"uploads-content"},_hoisted_3$2={class:"uploads-header"},_hoisted_4$2={class:"section-title"},_hoisted_5$2={class:"header-actions"},_hoisted_6$2=["title"],_hoisted_7$2=["title"],_hoisted_8$2={key:0,class:"loading-state"},_hoisted_9$2={class:"loading-text"},_hoisted_10$2={key:1,class:"recent-images-container"},_hoisted_11$1={key:2,class:"empty-state"},_hoisted_12$1={class:"empty-text"},_sfc_main$2=defineComponent({name:"RecentUploads",__name:"RecentUploads",props:{refreshKey:{}},setup(__props){const props=__props,router=useRouter(),toast=useToast(),{$t}=useTexts(),loading=ref(!1),recentImages=ref([]),copyAllUrls=async()=>{if(recentImages.value.length===0){toast.warning($t("dashboard.recentUploads.toast.noImages"));return}const urls=recentImages.value.map(img=>img.full_url||img.url||"").filter(Boolean).join(`
`);try{await navigator.clipboard.writeText(urls),toast.success($t("dashboard.recentUploads.toast.copySuccess").replace("{count}",recentImages.value.length.toString()))}catch{toast.error($t("dashboard.recentUploads.toast.copyFailed"))}},fetchRecentImages=async()=>{try{loading.value=!0;const result=await getFileList({page:1,size:10,sort:"newest"});result.success&&(recentImages.value=result.data?.items||[])}catch{toast.error($t("dashboard.recentUploads.toast.fetchFailed"))}finally{loading.value=!1}};return onMounted(()=>{fetchRecentImages()}),watch(()=>props.refreshKey,()=>{props.refreshKey!==void 0&&fetchRecentImages()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[createBaseVNode("h3",_hoisted_4$2,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-history"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.recentUploads.title")),1)]),createBaseVNode("div",_hoisted_5$2,[createBaseVNode("button",{class:"action-btn",title:unref($t)("dashboard.recentUploads.actions.copyAll"),onClick:copyAllUrls},[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])],8,_hoisted_6$2),createBaseVNode("button",{class:"action-btn",title:unref($t)("dashboard.recentUploads.actions.viewAll"),onClick:_cache[0]||(_cache[0]=$event=>unref(router).push("/folders"))},[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fas fa-external-link-alt"},null,-1)])],8,_hoisted_7$2)])]),loading.value?(openBlock(),createElementBlock("div",_hoisted_8$2,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"loading-spinner"},[createBaseVNode("i",{class:"fas fa-spinner fa-spin"})],-1)),createBaseVNode("div",_hoisted_9$2,toDisplayString(unref($t)("dashboard.recentUploads.loading")),1)])):recentImages.value.length>0?(openBlock(),createElementBlock("div",_hoisted_10$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(recentImages.value,image=>(openBlock(),createBlock(RecentFileItem,{key:image.id,image},null,8,["image"]))),128))])):(openBlock(),createElementBlock("div",_hoisted_11$1,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"empty-icon"},[createBaseVNode("i",{class:"fas fa-image"})],-1)),createBaseVNode("div",_hoisted_12$1,toDisplayString(unref($t)("dashboard.recentUploads.empty")),1)]))])]))}});const RecentUploads=_export_sfc(_sfc_main$2,[["__scopeId","data-v-59ab0d27"]]),_hoisted_1$1={key:0,class:"folder-distribution cyber-card"},_hoisted_2$1={class:"section-title"},_hoisted_3$1={class:"folder-count"},_hoisted_4$1={class:"chart-info"},_hoisted_5$1={class:"info-text"},_hoisted_6$1={class:"folder-total"},_hoisted_7$1={key:1,class:"folder-distribution cyber-card empty"},_hoisted_8$1={class:"section-title"},_hoisted_9$1={class:"empty-state"},_hoisted_10$1={class:"empty-text"},_sfc_main$1=defineComponent({name:"FolderDistribution",__name:"FolderDistribution",props:{refreshKey:{}},setup(__props){const{$t}=useTexts(),props=__props,{appliedTheme,isDark}=useTheme(),folders=ref([]),chartContainer=ref(null),chartInstance=ref(null),lastOption=ref(null),resizeTimeout=ref(null),isInitializing=ref(!1),resizeObserver=ref(null),sortedFolders=computed(()=>!folders.value||!Array.isArray(folders.value)?[]:[...folders.value].filter(folder=>folder&&typeof folder.name=="string").sort((a,b)=>a.total_size===0&&b.total_size===0?a.name.localeCompare(b.name):(b.total_size||0)-(a.total_size||0))),maxSize=computed(()=>sortedFolders.value.length&&Math.max(...sortedFolders.value.map(folder=>folder.total_size))||1),getBrandColorFromCSS=()=>{if(typeof window>"u"||!document.documentElement)return{r:96,g:165,b:250};const brandRgb=getComputedStyle(document.documentElement).getPropertyValue("--color-brand-500-rgb").trim();if(brandRgb){const[r,g,b]=brandRgb.split(",").map(v=>parseInt(v.trim(),10));if(!isNaN(r)&&!isNaN(g)&&!isNaN(b))return{r,g,b}}return{r:96,g:165,b:250}},rgbToHsl=(r,g,b)=>{r/=255,g/=255,b/=255;const max=Math.max(r,g,b),min=Math.min(r,g,b);let h=0,s=0;const l=(max+min)/2;if(max!==min){const d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=((g-b)/d+(g<b?6:0))/6;break;case g:h=((b-r)/d+2)/6;break;case b:h=((r-g)/d+4)/6;break}}return{h:h*360,s:s*100,l:l*100}},hslToRgb=(h,s,l)=>{h/=360,s/=100,l/=100;let r,g,b;if(s===0)r=g=b=l;else{const hue2rgb=(p2,q2,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<.16666666666666666?p2+(q2-p2)*6*t:t<.5?q2:t<.6666666666666666?p2+(q2-p2)*(.6666666666666666-t)*6:p2),q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}},generateDynamicColor=(index2,ratio)=>{const brandColor=getBrandColorFromCSS(),hsl=rgbToHsl(brandColor.r,brandColor.g,brandColor.b),hueShift=index2*25%360,newHue=(hsl.h+hueShift)%360,saturation=Math.max(40,Math.min(100,hsl.s+(ratio-.5)*20)),lightness=isDark.value?Math.max(35,Math.min(65,hsl.l+(ratio-.5)*15)):Math.max(40,Math.min(70,hsl.l+(ratio-.5)*10)),rgb=hslToRgb(newHue,saturation,lightness),baseAlpha=.5+ratio*.3,alpha=Math.max(.5,Math.min(.85,baseAlpha));return`rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${alpha})`},getTooltipColors=()=>{const brandColor=getBrandColorFromCSS();return isDark.value?{bg:"rgba(17, 24, 39, 0.95)",border:`rgba(${brandColor.r}, ${brandColor.g}, ${brandColor.b}, 0.5)`}:{bg:"rgba(255, 255, 255, 0.98)",border:`rgba(${brandColor.r}, ${brandColor.g}, ${brandColor.b}, 0.5)`}},getBrandColorRgbString=()=>{const{r,g,b}=getBrandColorFromCSS();return`${r}, ${g}, ${b}`},fetchFolders=async()=>{try{const response=await getUserFolders({with_stats:!0});folders.value=response.data&&response.data.folders?response.data.folders:[]}catch{folders.value=[]}},getCyberColor=(size,isEmpty,_name,index2)=>{if(isEmpty)return isDark.value?"rgba(44, 43, 60, 0.4)":"rgba(229, 231, 235, 0.5)";if(typeof size!="number"||size<=0||maxSize.value<=0)return isDark.value?"rgba(20, 25, 35, 0.5)":"rgba(243, 244, 246, 0.6)";const ratio=size/maxSize.value;return generateDynamicColor(index2,ratio)},prepareChartData=()=>{if(!sortedFolders.value.length)return[];const allEmpty=sortedFolders.value.every(folder=>!folder.total_size||folder.total_size<=0);return sortedFolders.value.map((folder,index2)=>{let actualValue;if(allEmpty)actualValue=100;else if(folder.total_size>0)actualValue=folder.total_size;else{const maxFolderSize=Math.max(...sortedFolders.value.map(f=>f.total_size));actualValue=Math.max(maxFolderSize*.01,1)}const folderName=folder.name||$t("dashboard.folderDistribution.unnamed"),sizeFormatted=folder.total_size_formatted||"0 B",fileCount=folder.file_count||0,isEmpty=folder.total_size<=0;return{name:folderName,value:actualValue,sizeFormatted,fileCount,isEmpty,itemStyle:{color:getCyberColor(folder.total_size,isEmpty,folderName,index2),borderColor:"rgba(0, 130, 153, 0.25)",borderWidth:1},label:{show:!0,color:isDark.value?"rgba(255, 255, 255, 0.95)":"rgba(31, 41, 55, 0.95)",fontSize:12,fontWeight:"bold"}}})},getTotalSize=()=>sortedFolders.value.reduce((total,folder)=>total+(folder.total_size||0),0)||1,initChart=async()=>{if(!(!chartContainer.value||!sortedFolders.value.length)&&!isInitializing.value){isInitializing.value=!0;try{await nextTick();const existing=getInstanceByDom(chartContainer.value);existing?(chartInstance.value=existing,chartInstance.value.clear()):chartInstance.value=init(chartContainer.value,isDark.value?"dark":null,{renderer:"svg"});const brandRgb=getBrandColorRgbString(),chartData=prepareChartData(),tooltipColors=getTooltipColors(),option={backgroundColor:"transparent",tooltip:{trigger:"item",formatter(params){const{data}=params;if(!data)return"";const totalSize=getTotalSize(),percentage=totalSize>0?(data.value/totalSize*100).toFixed(1):"0.0",textColor=isDark.value?"#ffffff":"#1f2937",subTextColor=isDark.value?"rgba(255, 255, 255, 0.85)":"rgba(107, 114, 128, 0.9)";return`
          <div style="padding: 10px 12px; background: ${tooltipColors.bg}; border-radius: var(--radius-sm); border: 2px solid ${tooltipColors.border}; backdrop-filter: blur(12px); box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.3), 0 0 20px ${tooltipColors.border};">
            <div style="color: ${textColor}; font-weight: 600; margin-bottom: 6px; font-size: 13px;">${data.name||"unknown"}</div>
            <div style="color: ${subTextColor}; font-size: 12px; line-height: 1.6;">${$t("dashboard.folderDistribution.tooltipSize",{size:data.sizeFormatted||"0 B"})}</div>
            <div style="color: ${subTextColor}; font-size: 12px; line-height: 1.6;">${$t("dashboard.folderDistribution.tooltipFiles",{count:data.fileCount||0})}</div>
            <div style="color: ${subTextColor}; font-size: 12px; line-height: 1.6;">${$t("dashboard.folderDistribution.tooltipPercent",{percent:percentage})}</div>
            </div>
          `},backgroundColor:"transparent",borderColor:"transparent",confine:!0,appendToBody:!1,textStyle:{color:"#ffffff"}},series:[{type:"treemap",width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,roam:!1,nodeClick:!1,breadcrumb:{show:!1},label:{show:!0,position:"inside",align:"center",verticalAlign:"middle",lineHeight:16,fontSize:12,fontWeight:"bold",color:isDark.value?"rgba(255, 255, 255, 0.95)":"rgba(31, 41, 55, 0.95)",formatter(params){const{data}=params;return data?`${data.name||""}
${data.sizeFormatted||""}  ${$t("dashboard.folderDistribution.tooltipFiles",{count:data.fileCount||0})}`:""}},labelLayout(params){const r=params.rect;return r?{x:r.x+r.width/2,y:r.y+r.height/2,align:"center",verticalAlign:"middle"}:{}},upperLabel:{show:!1},itemStyle:{borderColor:"rgba(0, 130, 153, 0.25)",borderWidth:1,gapWidth:1},emphasis:{focus:"none",itemStyle:{borderColor:`rgba(${brandRgb}, 0.8)`,borderWidth:2,shadowBlur:10,shadowColor:`rgba(${brandRgb}, 0.3)`},label:{color:"rgba(255, 255, 255, 1)",fontSize:13,fontWeight:"bold"}},levels:[{itemStyle:{borderColor:"rgba(0, 130, 153, 0.25)",borderWidth:1,gapWidth:1}}],leaves:{label:{show:!0,position:"inside",align:"center",verticalAlign:"middle",lineHeight:16,fontSize:12,fontWeight:"bold",color:isDark.value?"rgba(255, 255, 255, 0.95)":"rgba(31, 41, 55, 0.95)",formatter(params){const{data}=params;return data?`${data.name||""}
${data.sizeFormatted||""}  ${$t("dashboard.folderDistribution.tooltipFiles",{count:data.fileCount||0})}`:""}},upperLabel:{show:!1}},data:chartData}]};chartInstance.value.setOption(option),lastOption.value=option,chartInstance.value.off("finished"),chartInstance.value.on("finished",()=>{setTimeout(()=>{addGridBackgrounds()},50)}),setTimeout(()=>{addGridBackgrounds()},200)}finally{isInitializing.value=!1}}},addGridBackgrounds=()=>{if(!chartContainer.value)return;chartContainer.value.querySelectorAll("g[clip-path]").forEach(group=>{group.querySelectorAll("rect").forEach(rect=>{if(rect.hasAttribute("data-grid-added"))return;const svgRect=rect,x=parseFloat(svgRect.getAttribute("x")||"0"),y=parseFloat(svgRect.getAttribute("y")||"0"),width=parseFloat(svgRect.getAttribute("width")||"0"),height=parseFloat(svgRect.getAttribute("height")||"0");if(width>40&&height>40){const defs=group.ownerDocument?.querySelector("defs")||group.ownerDocument?.createElementNS("http://www.w3.org/2000/svg","defs");group.ownerDocument?.querySelector("defs")||group.ownerDocument?.querySelector("svg")?.appendChild(defs);const brandRgb=getBrandColorRgbString(),patternId=`grid-pattern-${Math.random().toString(36).substr(2,9)}`,pattern=group.ownerDocument?.createElementNS("http://www.w3.org/2000/svg","pattern");if(pattern&&defs){pattern.setAttribute("id",patternId),pattern.setAttribute("patternUnits","userSpaceOnUse"),pattern.setAttribute("width","20"),pattern.setAttribute("height","20");const gridLines=`
            <line x1="0" y1="20" x2="20" y2="20" stroke="rgba(${brandRgb}, 0.25)" stroke-width="1.2"/>
            <line x1="20" y1="0" x2="20" y2="20" stroke="rgba(${brandRgb}, 0.25)" stroke-width="1.2"/>
          `;pattern.innerHTML=gridLines,defs.appendChild(pattern);const gridOverlay=group.ownerDocument?.createElementNS("http://www.w3.org/2000/svg","rect");gridOverlay&&(gridOverlay.setAttribute("x",x.toString()),gridOverlay.setAttribute("y",y.toString()),gridOverlay.setAttribute("width",width.toString()),gridOverlay.setAttribute("height",height.toString()),gridOverlay.setAttribute("fill",`url(#${patternId})`),gridOverlay.setAttribute("pointer-events","none"),rect.parentNode?.insertBefore(gridOverlay,rect.nextSibling))}}rect.setAttribute("data-grid-added","true")})})},calculateChartHeight=()=>{try{const viewportHeight=window.innerHeight||900;return viewportHeight<600?250:viewportHeight<900?300:350}catch{return 300}},handleResize=()=>{clearTimeout(resizeTimeout.value),resizeTimeout.value=setTimeout(()=>{chartInstance.value&&chartInstance.value.resize()},200)},setupContainerObserver=()=>{!chartContainer.value||resizeObserver.value||(resizeObserver.value=new ResizeObserver(()=>{clearTimeout(resizeTimeout.value),resizeTimeout.value=setTimeout(()=>{chartInstance.value&&!isInitializing.value&&requestAnimationFrame(()=>{chartInstance.value&&(chartInstance.value.resize(),lastOption.value&&chartInstance.value.setOption(lastOption.value,!0))})},100)}),resizeObserver.value.observe(chartContainer.value))};return onMounted(async()=>{await fetchFolders(),await initChart(),await nextTick(),setupContainerObserver(),window.addEventListener("resize",handleResize)}),onUnmounted(()=>{resizeObserver.value&&(resizeObserver.value.disconnect(),resizeObserver.value=null),chartInstance.value&&(chartInstance.value.dispose(),chartInstance.value=null),window.removeEventListener("resize",handleResize),resizeTimeout.value&&clearTimeout(resizeTimeout.value)}),watch(()=>props.refreshKey,async()=>{await fetchFolders(),await nextTick(),await initChart()}),watch(()=>appliedTheme.value,async()=>{await initChart()}),watch(()=>folders.value,async newVal=>{newVal&&Array.isArray(newVal)&&newVal.length>0&&(await nextTick(),await initChart())},{deep:!0}),(_ctx,_cache)=>folders.value&&folders.value.length>0?(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("h3",_hoisted_2$1,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-folder"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.folderDistribution.title"))+" ",1),createBaseVNode("span",_hoisted_3$1,"("+toDisplayString(folders.value.length)+")",1)]),createBaseVNode("div",{ref_key:"chartContainer",ref:chartContainer,class:"treemap-container",style:normalizeStyle({height:`${calculateChartHeight()}px`})},null,4),createBaseVNode("div",_hoisted_4$1,[createBaseVNode("div",_hoisted_5$1,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-info-circle"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.folderDistribution.description")),1)]),createBaseVNode("div",_hoisted_6$1,toDisplayString(unref($t)("dashboard.folderDistribution.totalFolders",{count:folders.value.length})),1)])])):(openBlock(),createElementBlock("div",_hoisted_7$1,[createBaseVNode("h3",_hoisted_8$1,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-folder"},null,-1)),createTextVNode(" "+toDisplayString(unref($t)("dashboard.folderDistribution.title")),1)]),createBaseVNode("div",_hoisted_9$1,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"empty-icon"},[createBaseVNode("i",{class:"fas fa-folder-open"})],-1)),createBaseVNode("div",_hoisted_10$1,toDisplayString(unref($t)("dashboard.folderDistribution.empty")),1)])]))}});const FolderDistribution=_export_sfc(_sfc_main$1,[["__scopeId","data-v-971abcb5"]]),_hoisted_1={class:"workspace-dashboard"},_hoisted_2={class:"workspace-main"},_hoisted_3={class:"main-workspace"},_hoisted_4={class:"left-column"},_hoisted_5={class:"main-actions"},_hoisted_6={class:"stats-section"},_hoisted_7={class:"recent-section"},_hoisted_8={class:"folder-section"},_hoisted_9={class:"side-panels"},_hoisted_10={class:"side-item"},_hoisted_11={class:"side-item"},_hoisted_12={class:"side-item"},_sfc_main=defineComponent({name:"WorkspaceDashboard",__name:"index",setup(__props){const refreshKey=ref(0);return onMounted(()=>{setInterval(()=>{refreshKey.value++},3e4)}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1,[_cache[0]||(_cache[0]=createBaseVNode("div",{class:"cyber-decorations"},[createBaseVNode("div",{class:"corner-decoration top-left"}),createBaseVNode("div",{class:"corner-decoration top-right"})],-1)),createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[createVNode(QuickActions)]),createBaseVNode("div",_hoisted_6,[(openBlock(),createBlock(CompactStats,{key:refreshKey.value}))]),createBaseVNode("div",_hoisted_7,[createVNode(RecentUploads)]),createBaseVNode("div",_hoisted_8,[createVNode(FolderDistribution)])]),createBaseVNode("div",_hoisted_9,[createBaseVNode("div",_hoisted_10,[(openBlock(),createBlock(MessageCenter,{key:refreshKey.value}))]),createBaseVNode("div",_hoisted_11,[createVNode(ActivityMonitor)]),createBaseVNode("div",_hoisted_12,[createVNode(UploadQueue)])])])])]))}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-5043ceb9"]]);export{index as default};
