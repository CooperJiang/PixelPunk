import{Y as defineStore,r as ref,c as computed,g as getCurrentInstance,Z as readonly,_ as triggerRef,d as defineComponent,b as onMounted,w as watch,H as withDirectives,$ as vShow,z as openBlock,I as createElementBlock,a0 as createBaseVNode,R as normalizeClass,K as createCommentVNode,a1 as toDisplayString,a as reactive,h,a2 as render,a3 as useRouter,a4 as useRoute,o as onUnmounted,A as createBlock,f as createVNode,L as withCtx,u as unref,Q as normalizeStyle,a5 as withModifiers,a6 as Transition,T as Teleport,E as resolveComponent,F as Fragment,a7 as createRouter,a8 as createWebHistory,v as createApp,M as renderList,n as nextTick,a9 as vModelText,aa as withKeys,ab as createTextVNode,J as renderSlot,N as resolveDynamicComponent,ac as createStaticVNode,O as mergeProps,ad as useSlots,ae as useAttrs,j as onBeforeUnmount,s as shallowRef,t as toRefs,af as storeToRefs,ag as TransitionGroup,ah as vModelCheckbox,ai as useCssVars,aj as createSlots,ak as normalizeProps,al as createPinia}from"./vue-vendor-31320f47.js";import{_ as __vitePreload}from"./editor-markdown-0b2e1ce5.js";import{a as axios}from"./axios-c2a59b9f.js";import{S as SparkMD5}from"./spark-md5-d0a97131.js";import{w as wrap,p as proxy}from"./comlink-c7be92b7.js";/* empty css                 */import{o as onClickOutside,u as useEventListener,a as useElementBounding,b as useWindowSize,c as useDebounceFn}from"./vueuse-2480d07f.js";import{d}from"./marked-e9418aa8.js";import{p as purify}from"./dompurify-76a35038.js";import{u as useVueTable,g as getCoreRowModel,a as getSortedRowModel,b as getFilteredRowModel,c as getPaginationRowModel,F as FlexRender}from"./vue-table-79795ca5.js";import"./highlight-common-d6c232ae.js";(function(){const relList=document.createElement("link").relList;if(relList&&relList.supports&&relList.supports("modulepreload"))return;for(const link of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(link);new MutationObserver(mutations=>{for(const mutation of mutations)if(mutation.type==="childList")for(const node of mutation.addedNodes)node.tagName==="LINK"&&node.rel==="modulepreload"&&processPreload(node)}).observe(document,{childList:!0,subtree:!0});function getFetchOpts(link){const fetchOpts={};return link.integrity&&(fetchOpts.integrity=link.integrity),link.referrerPolicy&&(fetchOpts.referrerPolicy=link.referrerPolicy),link.crossOrigin==="use-credentials"?fetchOpts.credentials="include":link.crossOrigin==="anonymous"?fetchOpts.credentials="omit":fetchOpts.credentials="same-origin",fetchOpts}function processPreload(link){if(link.ep)return;link.ep=!0;const fetchOpts=getFetchOpts(link);fetch(link.href,fetchOpts)}})();class StorageUtil{static isBrowser(){return typeof window<"u"&&typeof localStorage<"u"}static set(key,value,expires){if(!this.isBrowser())return;const storageData={data:value};if(expires!==void 0){const expiresTime=new Date().getTime()+expires*60*60*1e3;storageData.expires=expiresTime}localStorage.setItem(key,JSON.stringify(storageData))}static get(key){if(!this.isBrowser())return null;const value=localStorage.getItem(key);if(!value)return null;try{const storageData=JSON.parse(value);return storageData.expires&&storageData.expires<new Date().getTime()?(this.remove(key),null):storageData.data}catch(error2){return console.error("Ëß£ÊûêÊú¨Âú∞Â≠òÂÇ®Êï∞ÊçÆÂ§±Ë¥•:",error2),this.remove(key),null}}static remove(key){this.isBrowser()&&localStorage.removeItem(key)}static clear(){this.isBrowser()&&localStorage.clear()}static has(key){return this.get(key)!==null}static keys(){if(!this.isBrowser())return[];const keys=[];for(let i=0;i<localStorage.length;i++){const key=localStorage.key(i);key&&keys.push(key)}return keys}}const STORAGE_KEY="chunked_upload_sessions",SESSION_EXPIRE_TIME=24*60*60*1e3;class UploadStorageManager{static saveSession(sessionData){try{const sessions=this.getAllSessions();sessions[sessionData.id]={...sessionData,lastActivity:Date.now()},localStorage.setItem(STORAGE_KEY,JSON.stringify(sessions))}catch(error2){console.error("‰øùÂ≠ò‰∏ä‰º†‰ºöËØùÂ§±Ë¥•:",error2)}}static getSession(id){try{const session=this.getAllSessions()[id];return session?Date.now()-session.createdAt>SESSION_EXPIRE_TIME?(this.removeSession(id),null):session:null}catch(error2){return console.error("Ëé∑Âèñ‰∏ä‰º†‰ºöËØùÂ§±Ë¥•:",error2),null}}static getAllSessions(){try{const data=localStorage.getItem(STORAGE_KEY);return data?JSON.parse(data):{}}catch(error2){return console.error("Ëé∑ÂèñÊâÄÊúâ‰ºöËØùÂ§±Ë¥•:",error2),{}}}static updateSessionProgress(id,uploadedChunks){try{const sessions=this.getAllSessions();sessions[id]&&(sessions[id].uploadedChunks=uploadedChunks,sessions[id].lastActivity=Date.now(),localStorage.setItem(STORAGE_KEY,JSON.stringify(sessions)))}catch(error2){console.error("Êõ¥Êñ∞‰ºöËØùËøõÂ∫¶Â§±Ë¥•:",error2)}}static addUploadedChunk(id,chunkNumber){try{const session=this.getSession(id);session&&(session.uploadedChunks.includes(chunkNumber)||(session.uploadedChunks.push(chunkNumber),session.uploadedChunks.sort((a,b)=>a-b),this.saveSession(session)))}catch(error2){console.error("Ê∑ªÂä†Â∑≤‰∏ä‰º†ÂàÜÁâáÂ§±Ë¥•:",error2)}}static removeSession(id){try{const sessions=this.getAllSessions();delete sessions[id],localStorage.setItem(STORAGE_KEY,JSON.stringify(sessions))}catch(error2){console.error("ÁßªÈô§‰ºöËØùÂ§±Ë¥•:",error2)}}static cleanExpiredSessions(){try{const sessions=this.getAllSessions(),now=Date.now();let hasChanges=!1;Object.keys(sessions).forEach(id=>{now-sessions[id].createdAt>SESSION_EXPIRE_TIME&&(delete sessions[id],hasChanges=!0)}),hasChanges&&localStorage.setItem(STORAGE_KEY,JSON.stringify(sessions))}catch(error2){console.error("Ê∏ÖÁêÜËøáÊúü‰ºöËØùÂ§±Ë¥•:",error2)}}static getResumableSessions(){try{this.cleanExpiredSessions();const sessions=this.getAllSessions();return Object.values(sessions).filter(session=>session.uploadedChunks.length<session.totalChunks).sort((a,b)=>b.lastActivity-a.lastActivity)}catch(error2){return console.error("Ëé∑ÂèñÂèØÊÅ¢Â§ç‰ºöËØùÂ§±Ë¥•:",error2),[]}}static findExistingSession(fileMD5,fileSize){try{const sessions=this.getAllSessions();for(const session of Object.values(sessions))if(session.fileMD5===fileMD5&&session.fileSize===fileSize&&Date.now()-session.createdAt<=SESSION_EXPIRE_TIME)return session;return null}catch(error2){return console.error("Êü•ÊâæÁé∞Êúâ‰ºöËØùÂ§±Ë¥•:",error2),null}}static clearAllSessions(){try{localStorage.removeItem(STORAGE_KEY)}catch(error2){console.error("Ê∏ÖÁ©∫ÊâÄÊúâ‰ºöËØùÂ§±Ë¥•:",error2)}}static getStorageInfo(){try{const sessions=this.getAllSessions(),sessionList=Object.values(sessions),storageData=localStorage.getItem(STORAGE_KEY)||"{}",storageSize=new Blob([storageData]).size;let oldestSession,newestSession;return sessionList.length>0&&(oldestSession=sessionList.reduce((oldest,current)=>current.createdAt<oldest.createdAt?current:oldest),newestSession=sessionList.reduce((newest,current)=>current.lastActivity>newest.lastActivity?current:newest)),{sessionCount:sessionList.length,storageSize,oldestSession,newestSession}}catch(error2){return console.error("Ëé∑ÂèñÂ≠òÂÇ®‰ø°ÊÅØÂ§±Ë¥•:",error2),{sessionCount:0,storageSize:0}}}static cleanExpiredSessionsWithCount(){const sessions=this.getAllSessions(),expiredTime=Date.now()-24*60*60*1e3;let cleanedCount=0;const validSessions={};return Object.entries(sessions).forEach(([key,session])=>{session.lastActivity<expiredTime?cleanedCount++:validSessions[key]=session}),cleanedCount>0&&this.saveSessions(validSessions),cleanedCount}static getSessionStats(){const sessions=this.getAllSessions(),expiredTime=Date.now()-24*60*60*1e3;let activeSessions=0,expiredSessions=0,totalSize=0;return Object.values(sessions).forEach(session=>{totalSize+=session.fileSize,session.lastActivity<expiredTime?expiredSessions++:activeSessions++}),{totalSessions:Object.keys(sessions).length,activeSessions,expiredSessions,totalSize}}static startPeriodicCleanup(){this.cleanExpiredSessions();const intervalId=setInterval(()=>{this.cleanExpiredSessions()},60*60*1e3);return()=>{clearInterval(intervalId)}}}const TOKEN_KEY="token",USER_INFO_KEY="userInfo",TOKEN_EXPIRES=24*7,LAYOUT_MODE_KEY="layoutMode",SIDEBAR_COLLAPSED_KEY="sidebarCollapsed",LAYOUT={PAGE_SIZE_OPTIONS:[10,20,50,100],DEFAULT_PAGE_SIZE:20,GRID:{MIN_SIZE:120,MAX_SIZE:300,DEFAULT_SIZE:150,STEP:5},WATERFALL:{DEFAULT_COLUMNS:4,DEFAULT_COLUMN_WIDTH:250,DEFAULT_GAP:15,INITIAL_LOAD_COUNT:20,MIN_LOAD_COUNT:12,MAX_LOAD_COUNT:24,MAX_TAGS_TO_SHOW:2,DEFAULT_IMAGE_HEIGHT:300,INFO_AREA_HEIGHT:140,MIN_COLUMN_WIDTH_RATIO:1.2,MIN_COLUMN_WIDTH:180},PAGINATION:{MAX_VISIBLE_PAGES:7,FRONT_PAGES_THRESHOLD:4,BACK_PAGES_THRESHOLD:3,DROPDOWN_ITEM_HEIGHT:40}},TIMING={TOAST:{DEFAULT_DURATION:3e3,ANIMATION_DELAY:300,SHOW_DELAY:50,MARGIN:16,INITIAL_TOP:20},SCROLL:{DEBOUNCE_TIME:50,UPLOAD_DEBOUNCE_TIME:500},ANIMATION:{HIGHLIGHT_DURATION:1500,PRELOAD_DELAY:50,LOADING_DELAY:300},REQUEST:{SHORT_TIMEOUT:5e3,MEDIUM_TIMEOUT:8e3,LONG_TIMEOUT:1e4}},Z_INDEX$1={BASE:1,CONTENT:10,DROPDOWN:1e3,MODAL:2e3,TOAST:9999,OVERLAY:5e3,LOADING:100,IMAGE_INFO:5,INDICATOR:2},SIZE_LIMITS={MAX_FILE_SIZE:20*1024*1024,MAX_IMAGE_COUNT:500,IMAGE:{MIN_WIDTH:100,MAX_WIDTH:8192,MIN_HEIGHT:100,MAX_HEIGHT:8192,THUMBNAIL_SIZE:200},COMPONENT:{UPLOAD_SCROLL_HEIGHT:500,GRID_SELECTOR_WIDTH:280,PRELOAD_BATCH_SIZE:3}},HTTP_STATUS={OK:200,CREATED:201,NO_CONTENT:204,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,CONFLICT:409,PAYLOAD_TOO_LARGE:413,UNPROCESSABLE_ENTITY:422,TOO_MANY_REQUESTS:429,INTERNAL_SERVER_ERROR:500,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504},REQUEST_TIMEOUT={DEFAULT:5e3,UPLOAD:3e5,DOWNLOAD:3e4,AUTH:8e3,SEARCH:1e4},APP_CONFIG={name:"PIXELPUNK",description:"Êñá‰ª∂ÂàÜ‰∫´‰∏éÁÆ°ÁêÜÂπ≥Âè∞",brand:{name:"PIXELPUNK",pixel:"PIXEL",punk:"PUNK",logo:"/logo.png",favicon:"/favicon.ico"}},isDevelopment=!1,isProduction=!0,API_BASE_URL="/api/v1",DEBUG_CONFIG={enableNetworkLogging:isDevelopment},ErrorCodes={SUCCESS:200,SYSTEM_ERROR:500,USER_NOT_FOUND:1e3,INVALID_CREDENTIALS:1001,USER_DISABLED:1002,USER_ALREADY_EXISTS:1003,INVALID_AUTH_TOKEN:1004,EXPIRED_AUTH_TOKEN:1005,INVALID_VERIFY_CODE:1006,EMAIL_EXISTS:1007,EMAIL_SEND_FAILED:1008,SYSTEM_NOT_INSTALLED:7001,INSTALLATION_FAILED:7002,CONFIGURATION_ERROR:7003,FILE_TOO_LARGE:4001,INVALID_FILE_TYPE:4002,FILE_NOT_FOUND:4003,UPLOAD_FAILED:4004,FOLDER_NOT_FOUND:5001,FOLDER_ALREADY_EXISTS:5002,FOLDER_NOT_EMPTY:5003,IP_NOT_IN_WHITELIST:6001,IP_IN_BLACKLIST:6002,DOMAIN_NOT_IN_WHITELIST:6004,DOMAIN_IN_BLACKLIST:6005},SILENT_ERROR_CODES=[],THROW_ERROR_CODES=[ErrorCodes.SYSTEM_ERROR,ErrorCodes.IP_NOT_IN_WHITELIST,ErrorCodes.IP_IN_BLACKLIST,ErrorCodes.DOMAIN_NOT_IN_WHITELIST,ErrorCodes.DOMAIN_IN_BLACKLIST],ERROR_CATEGORY_MAP={999:"network",502:"network",503:"network",504:"network",401:"auth",[ErrorCodes.SYSTEM_NOT_INSTALLED]:"auth",[ErrorCodes.INVALID_CREDENTIALS]:"auth",[ErrorCodes.USER_NOT_FOUND]:"auth",[ErrorCodes.USER_DISABLED]:"auth",[ErrorCodes.INVALID_AUTH_TOKEN]:"auth",[ErrorCodes.EXPIRED_AUTH_TOKEN]:"auth",[ErrorCodes.INVALID_VERIFY_CODE]:"auth",[ErrorCodes.EMAIL_EXISTS]:"auth",403:"permission",500:"system",[ErrorCodes.SYSTEM_ERROR]:"system",[ErrorCodes.IP_NOT_IN_WHITELIST]:"access",[ErrorCodes.IP_IN_BLACKLIST]:"access",[ErrorCodes.DOMAIN_NOT_IN_WHITELIST]:"access",[ErrorCodes.DOMAIN_IN_BLACKLIST]:"access"};function getErrorCategory(code){return ERROR_CATEGORY_MAP[code]||"business"}function shouldShowError(code,config){return!(config.silent||config.autoShowError===!1||SILENT_ERROR_CODES.includes(code))}function shouldThrowError(code,config){return config.throwOnError===!0?!0:THROW_ERROR_CODES.includes(code)}const DEFAULT_LOCALE="zh-CN",DEFAULT_THEME="normal",localeCache=new Map,loadingLocales=new Map;async function loadLocale(locale){switch(locale){case"zh-CN":return(await __vitePreload(()=>import("./index-b94feea2.js"),[])).zhCN;case"en-US":return(await __vitePreload(()=>import("./index-046dce78.js"),[])).enUS;case"ja-JP":return(await __vitePreload(()=>import("./index-24fbfb49.js"),[])).jaJP;default:return(await __vitePreload(()=>import("./index-b94feea2.js"),[])).zhCN}}async function getLocale(locale){if(localeCache.has(locale))return localeCache.get(locale);if(loadingLocales.has(locale))return loadingLocales.get(locale);const loadPromise=loadLocale(locale).then(data=>(localeCache.set(locale,data),loadingLocales.delete(locale),data)).catch(error2=>{throw loadingLocales.delete(locale),error2});return loadingLocales.set(locale,loadPromise),loadPromise}function isLocaleSupported(locale){return["zh-CN","en-US","ja-JP"].includes(locale)}function preloadLocales(locales){typeof requestIdleCallback<"u"?requestIdleCallback(()=>{locales.forEach(locale=>{getLocale(locale).catch(()=>{})})},{timeout:2e3}):setTimeout(()=>{locales.forEach(locale=>{getLocale(locale).catch(()=>{})})},1e3)}function detectBrowserLanguage(){const browserLang=navigator.language||navigator.userLanguage,langMap={zh:"zh-CN","zh-CN":"zh-CN","zh-Hans":"zh-CN","zh-SG":"zh-CN","zh-TW":"zh-CN","zh-HK":"zh-CN","zh-Hant":"zh-CN",en:"en-US","en-US":"en-US","en-GB":"en-US","en-AU":"en-US","en-CA":"en-US","en-NZ":"en-US",ja:"ja-JP","ja-JP":"ja-JP"};if(langMap[browserLang])return langMap[browserLang];const langPrefix=browserLang.split("-")[0];return langMap[langPrefix]?langMap[langPrefix]:"zh-CN"}const useTextThemeStore=defineStore("textTheme",()=>{const currentLocale=ref(DEFAULT_LOCALE),currentTheme=ref(DEFAULT_THEME),isInitializing=ref(!0),localeData=ref(null),themeTexts=computed(()=>localeData.value?.themes[currentTheme.value]||{}),commonTexts=computed(()=>localeData.value?.common||{}),isCyberTheme=computed(()=>currentTheme.value==="cyber");async function initialize2(){try{const savedTheme=localStorage.getItem("text-theme"),savedLocale=localStorage.getItem("locale");if(savedTheme&&(savedTheme==="normal"||savedTheme==="cyber")&&(currentTheme.value=savedTheme),savedLocale&&isLocaleSupported(savedLocale))currentLocale.value=savedLocale;else try{const{getGlobalSettings:getGlobalSettings2}=await __vitePreload(()=>import("./index-0554d7f7.js"),["js/index-0554d7f7.js","js/defaults-c53003a8.js","js/oauth-e58d389a.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/lightbox-594f31d9.css"]),response=await getGlobalSettings2();if(response.code===200&&response.data?.appearance){const defaultLanguage=response.data.appearance.default_language;if(response.data.appearance.enable_multi_language&&defaultLanguage){let targetLocale;defaultLanguage==="auto"?targetLocale=detectBrowserLanguage():isLocaleSupported(defaultLanguage)?targetLocale=defaultLanguage:targetLocale=DEFAULT_LOCALE,currentLocale.value=targetLocale,localStorage.setItem("locale",targetLocale)}}}catch{}localeData.value=await getLocale(currentLocale.value);const otherLocales=["zh-CN","en-US","ja-JP"].filter(locale=>locale!==currentLocale.value);preloadLocales(otherLocales)}catch{currentTheme.value=DEFAULT_THEME,currentLocale.value=DEFAULT_LOCALE;try{localeData.value=await getLocale(DEFAULT_LOCALE)}catch{localeData.value={common:{},themes:{normal:{},cyber:{}}}}}finally{isInitializing.value=!1}}function setTheme(theme){currentTheme.value=theme,localStorage.setItem("text-theme",theme)}async function setLocale(locale){isInitializing.value=!0;try{currentLocale.value=locale,localStorage.setItem("locale",locale),localeData.value=await getLocale(locale)}catch{currentLocale.value=DEFAULT_LOCALE,localStorage.setItem("locale",DEFAULT_LOCALE);try{localeData.value=await getLocale(DEFAULT_LOCALE)}catch{localeData.value={common:{},themes:{normal:{},cyber:{}}}}}finally{isInitializing.value=!1}}function toggleTheme(){const newTheme=currentTheme.value==="normal"?"cyber":"normal";setTheme(newTheme)}function getThemeText(key){return themeTexts.value[key]||key}function getCommonText(key){return commonTexts.value[key]||key}function getNestedValue2(obj,path){return path.split(".").reduce((current,key)=>current&&typeof current=="object"?current[key]:void 0,obj)}function getText(key){if(!localeData.value)return key;if(key.includes(".")){const themeValue=getNestedValue2(themeTexts.value,key);if(themeValue)return themeValue;const commonValue=getNestedValue2(commonTexts.value,key);if(commonValue)return commonValue}else{if(key in themeTexts.value)return themeTexts.value[key];if(key in commonTexts.value)return commonTexts.value[key]}return key}async function reset(){setTheme(DEFAULT_THEME),await setLocale(DEFAULT_LOCALE)}return{currentLocale,currentTheme,isInitializing,localeData,themeTexts,commonTexts,isCyberTheme,initialize:initialize2,setTheme,setLocale,toggleTheme,getThemeText,getCommonText,getText,reset}});async function initializeTextTheme(){await useTextThemeStore().initialize()}const textTheme=Object.freeze(Object.defineProperty({__proto__:null,initializeTextTheme,useTextThemeStore},Symbol.toStringTag,{value:"Module"}));var __defProp$a=Object.defineProperty,__defNormalProp$a=(obj,key,value)=>key in obj?__defProp$a(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$a=(obj,key,value)=>(__defNormalProp$a(obj,typeof key!="symbol"?key+"":key,value),value);class LoadingManager{constructor(){__publicField$a(this,"loadingGroups",new Map)}incrementLoading(loadingRef,options={}){const{minLoadingTime=300,groupId}=options;loadingRef._refCount||(loadingRef._refCount=0),loadingRef._refCount++,loadingRef._refCount===1&&(loadingRef.value=!0,loadingRef._startTime=Date.now(),loadingRef._minTime=minLoadingTime),groupId&&(this.loadingGroups.has(groupId)||this.loadingGroups.set(groupId,new Set),this.loadingGroups.get(groupId)?.add(loadingRef))}decrementLoading(loadingRef,groupId){!loadingRef._refCount||loadingRef._refCount<=0||(loadingRef._refCount--,loadingRef._refCount===0&&this.resetLoadingWithMinTime(loadingRef),groupId&&this.loadingGroups.get(groupId)?.delete(loadingRef))}resetLoadingWithMinTime(loadingRef){const elapsed=Date.now()-(loadingRef._startTime||0),minTime=loadingRef._minTime||300;loadingRef._timeoutId&&clearTimeout(loadingRef._timeoutId),elapsed<minTime?loadingRef._timeoutId=setTimeout(()=>{loadingRef.value=!1,loadingRef._refCount=0},minTime-elapsed):(loadingRef.value=!1,loadingRef._refCount=0)}forceResetLoading(loadingRef,groupId){loadingRef._timeoutId&&clearTimeout(loadingRef._timeoutId),loadingRef.value=!1,loadingRef._refCount=0,groupId&&this.loadingGroups.get(groupId)?.delete(loadingRef)}resetGroup(groupId){const group=this.loadingGroups.get(groupId);group&&(group.forEach(loadingRef=>{this.forceResetLoading(loadingRef)}),this.loadingGroups.delete(groupId))}}const loadingManager=new LoadingManager;var __defProp$9=Object.defineProperty,__defNormalProp$9=(obj,key,value)=>key in obj?__defProp$9(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$9=(obj,key,value)=>(__defNormalProp$9(obj,typeof key!="symbol"?key+"":key,value),value);const LOADING_PATTERNS=[/^loading$/,/^isLoading$/,/^.*Loading$/,/^submitting$/,/^.*Submitting$/,/^fetching$/,/^.*Fetching$/,/^pending$/,/^.*Pending$/];class SmartLoadingManager{constructor(){__publicField$9(this,"loadingStates",new Map)}detectLoadingRefs(){const instance2=getCurrentInstance();if(!instance2)return[];const foundRefs=[];return instance2.setupState&&Object.entries(instance2.setupState).forEach(([key,value])=>{this.isLoadingPattern(key)&&this.isRef(value)&&foundRefs.push(value)}),foundRefs}isLoadingPattern(name){return LOADING_PATTERNS.some(pattern=>pattern.test(name))}isRef(value){return value&&typeof value=="object"&&"value"in value}startLoading(refs,_minTime=300){refs.forEach(ref2=>{this.loadingStates.has(ref2)||(this.loadingStates.set(ref2,{count:0,startTime:Date.now()}),ref2.value=!0);const state=this.loadingStates.get(ref2);state&&state.count++})}stopLoading(refs,minTime=300){refs.forEach(ref2=>{const state=this.loadingStates.get(ref2);if(state&&(state.count--,state.count<=0)){const elapsed=Date.now()-state.startTime;elapsed<minTime?setTimeout(()=>{ref2.value=!1,this.loadingStates.delete(ref2)},minTime-elapsed):(ref2.value=!1,this.loadingStates.delete(ref2))}})}resetAll(){this.loadingStates.forEach((state,ref2)=>{ref2.value=!1}),this.loadingStates.clear()}}const smartLoadingManager=new SmartLoadingManager,showToast={success:message=>{__vitePreload(()=>Promise.resolve().then(()=>useToast$1),void 0).then(({useToast:useToast2})=>{useToast2().success(message)}).catch(()=>{})},error:message=>{__vitePreload(()=>Promise.resolve().then(()=>useToast$1),void 0).then(({useToast:useToast2})=>{useToast2().error(message)}).catch(()=>{})}},getTranslation$1=async(key,params)=>{let text;try{text=useTextThemeStore().getText(key)}catch{}return(!text||text===key)&&(text=await getFallbackTranslation(key)),applyParams(text||key,params)};async function getFallbackTranslation(key){try{const locale=await getLocale(getPreferredLocale()),theme=getPreferredTheme(),themeTexts=locale.themes?.[theme],themeValue=getNestedValue(themeTexts,key);if(typeof themeValue=="string")return themeValue;const commonValue=getNestedValue(locale.common,key);if(typeof commonValue=="string")return commonValue}catch{}return key}function getNestedValue(source,path){if(!(!source||typeof source!="object"))return path.split(".").reduce((current,segment)=>{if(current&&typeof current=="object")return current[segment]},source)}function applyParams(text,params){if(!params)return text;let result=text;return Object.entries(params).forEach(([key,value])=>{const placeholder=`{${key}}`;result=result.split(placeholder).join(String(value))}),result}function getPreferredLocale(){if(typeof window>"u")return DEFAULT_LOCALE;const savedLocale=localStorage.getItem("locale");return savedLocale&&isLocaleSupported(savedLocale)?savedLocale:DEFAULT_LOCALE}function getPreferredTheme(){if(typeof window>"u")return DEFAULT_THEME;const savedTheme=localStorage.getItem("text-theme");return savedTheme==="normal"||savedTheme==="cyber"?savedTheme:DEFAULT_THEME}const IP_NOT_IN_WHITELIST=6001,IP_IN_BLACKLIST=6002,DOMAIN_NOT_IN_WHITELIST=6004,DOMAIN_IN_BLACKLIST=6005,USER_ACCOUNT_DISABLED=1002,IP_RESTRICTED_KEY$1="ip_restricted",IP_ADDRESS_KEY="ip_restricted_address",IP_ERROR_CODE_KEY="ip_restricted_code",IP_ERROR_MSG_KEY="ip_restricted_message",DOMAIN_KEY="domain_restricted_name",USER_DISABLED_KEY$1="user_disabled",REQUEST_DEDUP_WHITELIST=["/files/upload","/files/guest/upload","/user/personal/profile","/files/chunked/upload","/config/upload","/settings","/common/settings","/folders/","/admin/file/upload"],isUrlInWhitelist=url=>REQUEST_DEDUP_WHITELIST.some(whitelistUrl=>url===whitelistUrl||url.startsWith(whitelistUrl)),pendingRequests=new Map,generateRequestKey=config=>{const{method,url,params,data}=config,paramsStr=params?JSON.stringify(params):"",dataStr=data?JSON.stringify(data):"";return`${method}:${url}:${paramsStr}:${dataStr}`},addPendingRequest=config=>{const requestKey=generateRequestKey(config);if(isUrlInWhitelist(config.url||"")){const cancelToken2=axios.CancelToken.source();config.cancelToken=cancelToken2.token;const uniqueKey=`${requestKey}_${Date.now()}_${Math.random()}`;pendingRequests.set(uniqueKey,{url:config.url||"",method:config.method||"",params:generateRequestKey(config),cancelToken:cancelToken2,timestamp:Date.now()});return}const existingRequest=pendingRequests.get(requestKey);existingRequest&&(getTranslation$1("utils.http.cancelDuplicate",{method:config.method?.toUpperCase()||"",url:config.url||""}).then(msg=>existingRequest.cancelToken.cancel(msg)),pendingRequests.delete(requestKey));const cancelToken=axios.CancelToken.source();config.cancelToken=cancelToken.token,pendingRequests.set(requestKey,{url:config.url||"",method:config.method||"",params:generateRequestKey(config),cancelToken,timestamp:Date.now()})},removePendingRequest=config=>{const requestKey=generateRequestKey(config);if(isUrlInWhitelist(config.url||"")){const keysToRemove=[];for(const[key,request]of pendingRequests.entries())request.url===config.url&&key.startsWith(requestKey)&&keysToRemove.push(key);keysToRemove.forEach(key=>pendingRequests.delete(key));return}pendingRequests.has(requestKey)&&pendingRequests.delete(requestKey)},cleanupTimeoutRequests=()=>{const now=Date.now(),timeout=REQUEST_TIMEOUT.UPLOAD;for(const[key,request]of pendingRequests.entries())now-request.timestamp>timeout&&(getTranslation$1("utils.http.requestTimeout").then(msg=>request.cancelToken.cancel(msg)),pendingRequests.delete(key))};setInterval(cleanupTimeoutRequests,REQUEST_TIMEOUT.DEFAULT);let isRedirecting=!1;const getApiBaseUrl=()=>{try{if(typeof import.meta<"u"&&{VITE_SITE_DOMAIN:"/",VITE_API_BASE_URL:"/api/v1",VITE_APP_TITLE:"PixelPunk",VITE_APP_DESCRIPTION:"Êñ∞‰∏Ä‰ª£Êô∫ËÉΩAIÂõæÂ∫äÊúçÂä°",VITE_ENABLE_ANALYTICS:"false",VITE_ENABLE_ERROR_REPORTING:"false",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})return"/api/v1";if(typeof window<"u"&&window.__VITE_API_BASE_URL__)return window.__VITE_API_BASE_URL__}catch{console.warn("Unable to read environment variable VITE_API_BASE_URL:",error)}return"/api/v1"},apiBaseUrl=getApiBaseUrl(),instance=axios.create({baseURL:apiBaseUrl,timeout:REQUEST_TIMEOUT.UPLOAD,headers:{"Content-Type":"application/json"}});function createApiResult(success,code,message,data,request_id){return{success,code,message,data,request_id,timestamp:Date.now()}}async function createSuccessResult(data,message="",request_id){const msg=message||await getTranslation$1("utils.http.operationSuccess");return createApiResult(!0,ErrorCodes.SUCCESS,msg,data,request_id)}function createErrorResult(code,message,request_id){return createApiResult(!1,code,message,null,request_id)}instance.interceptors.request.use(config=>{addPendingRequest(config);const token=StorageUtil.get(TOKEN_KEY);token&&(config.headers.Authorization=`Bearer ${token}`);try{const currentLocale=useTextThemeStore().currentLocale;currentLocale&&(config.headers["Accept-Language"]=currentLocale)}catch{config.headers["Accept-Language"]="zh-CN"}if(config.autoShowError===void 0&&(config.autoShowError=!0),config.silent===void 0&&(config.silent=!1),config.showLoading===void 0&&(config.showLoading=!1),config.autoShowSuccess===void 0&&(config.autoShowSuccess=!1),config.throwOnError===void 0&&(config.throwOnError=!1),config.useResultMode===void 0&&(config.useResultMode=!1),config.minLoadingTime===void 0&&(config.minLoadingTime=300),config.smartLoading===void 0&&(config.smartLoading=!0),config.smartLoading&&!config.loadingTarget){const detectedRefs=smartLoadingManager.detectLoadingRefs();detectedRefs.length>0&&(config._detectedLoadingRefs=detectedRefs,smartLoadingManager.startLoading(detectedRefs,config.minLoadingTime))}if(config.loadingTarget){const loadingMode=config.loadingMode||"auto";loadingMode==="shared"?loadingManager.incrementLoading(config.loadingTarget,{minLoadingTime:config.minLoadingTime,groupId:config.loadingGroup}):loadingMode==="auto"&&(config.loadingTarget.value=!0,config._startTime=Date.now())}return config},error2=>Promise.reject(error2));const handleAccessRestriction=async error2=>{if(!error2.response||!error2.response.data)return!1;const{code,message,ip,domain}=error2.response.data;let restrictionMsgKey="",addressValue="";const unknownText=await getTranslation$1("utils.http.unknown");switch(code){case IP_NOT_IN_WHITELIST:restrictionMsgKey="utils.http.ipNotInWhitelist",addressValue=ip||unknownText;break;case IP_IN_BLACKLIST:restrictionMsgKey="utils.http.ipInBlacklist",addressValue=ip||unknownText;break;case DOMAIN_NOT_IN_WHITELIST:restrictionMsgKey="utils.http.domainNotInWhitelist",addressValue=domain||unknownText,StorageUtil.set(DOMAIN_KEY,domain||unknownText,1);break;case DOMAIN_IN_BLACKLIST:restrictionMsgKey="utils.http.domainInBlacklist",addressValue=domain||unknownText,StorageUtil.set(DOMAIN_KEY,domain||unknownText,1);break;case USER_ACCOUNT_DISABLED:restrictionMsgKey="utils.http.userAccountDisabled";const restrictionMsg2=await getTranslation$1(restrictionMsgKey);return StorageUtil.set(USER_DISABLED_KEY$1,"true",1),StorageUtil.set(IP_ERROR_CODE_KEY,code.toString(),1),StorageUtil.set(IP_ERROR_MSG_KEY,message||restrictionMsg2,1),typeof window<"u"&&window.location.pathname!=="/refuse"&&(window.location.href="/refuse"),!0;default:return!1}const restrictionMsg=await getTranslation$1(restrictionMsgKey);return StorageUtil.set(IP_RESTRICTED_KEY$1,"true",1),StorageUtil.set(IP_ADDRESS_KEY,addressValue,1),StorageUtil.set(IP_ERROR_CODE_KEY,code.toString(),1),StorageUtil.set(IP_ERROR_MSG_KEY,message||restrictionMsg,1),typeof window<"u"&&window.location.pathname!=="/refuse"&&(window.location.href="/refuse"),!0},resetLoadingState=config=>{if(config._detectedLoadingRefs){smartLoadingManager.stopLoading(config._detectedLoadingRefs,config.minLoadingTime);return}if(!config.loadingTarget)return;const loadingMode=config.loadingMode||"auto";if(loadingMode==="shared")loadingManager.decrementLoading(config.loadingTarget,config.loadingGroup);else if(loadingMode==="auto"&&config._startTime){const elapsed=Date.now()-config._startTime,minTime=config.minLoadingTime||300;elapsed<minTime?setTimeout(()=>{config.loadingTarget&&(config.loadingTarget.value=!1)},minTime-elapsed):config.loadingTarget.value=!1}};instance.interceptors.response.use(async response=>{removePendingRequest(response.config),resetLoadingState(response.config);const responseData=response.data,config=response.config,requestId=responseData.request_id||response.headers?.["x-request-id"];if(responseData.code===ErrorCodes.SUCCESS)return config.autoShowSuccess&&responseData.message&&!config.silent&&showToast.success(responseData.message),await createSuccessResult(responseData.data,responseData.message,requestId);if(responseData.code===ErrorCodes.SYSTEM_NOT_INSTALLED)return(typeof window<"u"?window.location.pathname:"")!=="/setup"&&setTimeout(()=>{window.location.pathname!=="/setup"&&(window.location.href="/setup")},0),await createSuccessResult(responseData.data,responseData.message,requestId);if(responseData.code===USER_ACCOUNT_DISABLED){const msg=responseData.message||await getTranslation$1("utils.http.userAccountDisabled");StorageUtil.set(USER_DISABLED_KEY$1,"true",1),StorageUtil.set(IP_ERROR_CODE_KEY,responseData.code.toString(),1),StorageUtil.set(IP_ERROR_MSG_KEY,msg,1),typeof window<"u"&&window.location.pathname!=="/refuse"&&(window.location.href="/refuse");const errorResult2=createErrorResult(responseData.code,msg,requestId);return Promise.reject(errorResult2)}const errorResult=createErrorResult(responseData.code,responseData.message,requestId);if(shouldShowError(responseData.code,config)){const msg=responseData.message||await getTranslation$1("utils.http.operationFailed");showToast.error(msg)}return config.useResultMode===!0?shouldThrowError(responseData.code,config)?Promise.reject(errorResult):errorResult:Promise.reject(errorResult)},async error2=>{!axios.isCancel(error2)&&error2.config&&(removePendingRequest(error2.config),resetLoadingState(error2.config));const config=error2.config;if(axios.isCancel(error2)){const msg=await getTranslation$1("utils.http.requestCancelled"),cancelError=createErrorResult(-1,msg);return Promise.reject(cancelError)}let message="",errorCode=999;if(error2.response){switch(errorCode=error2.response.status,error2.response.status){case HTTP_STATUS.UNAUTHORIZED:message=await getTranslation$1("constants.api.errors.unauthorized"),config?.silent||showToast.error(message),StorageUtil.remove(TOKEN_KEY);const currentPath=window.location.pathname;!isRedirecting&&currentPath!=="/auth"&&currentPath!=="/login"&&(isRedirecting=!0,__vitePreload(()=>Promise.resolve().then(()=>auth),void 0).then(module=>{module.useAuthStore().logout(),setTimeout(()=>{isRedirecting=!1},1e3)}));break;case HTTP_STATUS.FORBIDDEN:message=await getTranslation$1("constants.api.errors.forbidden");break;case HTTP_STATUS.NOT_FOUND:message=await getTranslation$1("constants.api.errors.notFound");break;case 451:message=await getTranslation$1("constants.api.errors.unavailableForLegalReasons");break;case HTTP_STATUS.INTERNAL_SERVER_ERROR:message=await getTranslation$1("constants.api.errors.internalServerError");break;case HTTP_STATUS.BAD_GATEWAY:message=await getTranslation$1("constants.api.errors.badGateway");break;case HTTP_STATUS.SERVICE_UNAVAILABLE:message=await getTranslation$1("constants.api.errors.serviceUnavailable");break;case HTTP_STATUS.GATEWAY_TIMEOUT:message=await getTranslation$1("constants.api.errors.gatewayTimeout");break;default:message=await getTranslation$1("utils.http.requestFailedWithStatus",{status:error2.response.status})}if(await handleAccessRestriction(error2)){const accessError=createErrorResult(error2.response.data.code,error2.response.data.message,error2.response.data.request_id);return Promise.reject(accessError)}if(error2.response.data&&error2.response.data.code&&error2.response.data.message){const serverError=error2.response.data,errorResult2=createErrorResult(serverError.code,serverError.message,serverError.request_id);return shouldShowError(serverError.code,config)&&showToast.error(serverError.message),Promise.reject(errorResult2)}}else error2.request?message=await getTranslation$1("utils.http.networkError"):message=await getTranslation$1("utils.http.configError");config?.silent||showToast.error(message);const errorResult=createErrorResult(errorCode,message,error2.response?.headers?.["x-request-id"]||""),category=getErrorCategory(errorCode);return console.error(`[HTTP ${category.toUpperCase()}]`,{url:config?.url||"unknown",method:config?.method||"unknown",_error:error2,originalError:error2}),Promise.reject(errorResult)});function get(url,params,config){return instance.get(url,{params,...config})}function post(url,data,config){return instance.post(url,data,config)}function put(url,data,config){return instance.put(url,data,config)}function del(url,params,config){return instance.delete(url,{params,...config})}function upload(url,file,data,onUploadProgress,config){const formData=new FormData;return formData.append("file",file),data&&Object.keys(data).forEach(key=>{const value=data[key];if(value!=null)if(typeof value=="boolean")formData.append(key,value.toString());else if(typeof value=="object"&&value!==null)if("value"in value){const actualValue=value.value;formData.append(key,actualValue!=null?String(actualValue):"")}else formData.append(key,String(value));else formData.append(key,String(value));else formData.append(key,"")}),instance.post(url,formData,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress,...config})}function uploadBatch(url,files,data,onUploadProgress,config){const formData=new FormData;return files.forEach((file,_index)=>{formData.append("files[]",file)}),data&&Object.keys(data).forEach(key=>{const value=data[key];if(value!=null)if(typeof value=="boolean")formData.append(key,value.toString());else if(typeof value=="object"&&value!==null)if("value"in value){const actualValue=value.value;formData.append(key,actualValue!=null?String(actualValue):"")}else formData.append(key,String(value));else formData.append(key,String(value));else formData.append(key,"")}),instance.post(url,formData,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress,...config})}const AccessRestrictionCodes={IP_NOT_IN_WHITELIST,IP_IN_BLACKLIST,DOMAIN_NOT_IN_WHITELIST,DOMAIN_IN_BLACKLIST,USER_ACCOUNT_DISABLED},AccessRestrictionKeys={IP_RESTRICTED_KEY:IP_RESTRICTED_KEY$1,IP_ADDRESS_KEY,IP_ERROR_CODE_KEY,IP_ERROR_MSG_KEY,DOMAIN_KEY,USER_DISABLED_KEY:USER_DISABLED_KEY$1};function useTexts(){const store=useTextThemeStore(),currentTheme=computed(()=>store.currentTheme),currentLocale=computed(()=>store.currentLocale),isCyberTheme=computed(()=>store.isCyberTheme),texts=computed(()=>store.themeTexts),common=computed(()=>store.commonTexts);return{currentTheme,currentLocale,isCyberTheme,texts,common,$t:(key,params)=>{let text=store.getText(key);return params&&Object.keys(params).forEach(paramKey=>{const placeholder=`{${paramKey}}`,value=String(params[paramKey]);text=text.replaceAll(placeholder,value)}),text},$tr:key=>computed(()=>store.getText(key)),getThemeText:key=>store.getThemeText(key),getCommonText:key=>store.getCommonText(key),setTheme:theme=>{store.setTheme(theme)},toggleTheme:()=>{store.toggleTheme()},setLocale:locale=>{store.setLocale(locale)}}}function useQuickTexts(){const{$t:$t2}=useTexts();return{upload:computed(()=>$t2("upload")),download:computed(()=>$t2("download")),delete:computed(()=>$t2("delete")),save:computed(()=>$t2("save")),cancel:computed(()=>$t2("cancel")),confirm:computed(()=>$t2("confirm")),loading:computed(()=>$t2("loading")),success:computed(()=>$t2("success")),error:computed(()=>$t2("error")),zoomIn:computed(()=>$t2("zoomIn")),zoomOut:computed(()=>$t2("zoomOut")),previous:computed(()=>$t2("previous")),next:computed(()=>$t2("next")),fullscreen:computed(()=>$t2("fullscreen")),text:$t2}}const useTexts$1=Object.freeze(Object.defineProperty({__proto__:null,useQuickTexts,useTexts},Symbol.toStringTag,{value:"Module"})),defaultConfig$1={maxFileSize:100*1024*1024,allowedTypes:["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/bmp","image/svg+xml","image/x-icon","image/vnd.microsoft.icon","image/tiff","image/x-tga"],clientMaxConcurrentUploads:3,chunkedUpload:{enabled:!0,isAllowChunkUpload:!1,threshold:10*1024*1024,chunkSize:2*1024*1024,maxConcurrency:4,retryCount:3}},uploadConfig=ref(defaultConfig$1),isConfigLoaded=ref(!1),isLoading=ref(!1),capabilities=ref(null);function useUploadConfig(){const{$t:$t2}=useTexts(),loadConfig=async()=>{if(!isLoading.value&&!isConfigLoaded.value){isLoading.value=!0;try{try{const capsResp=await get("/config/upload/capabilities");capabilities.value=capsResp?.data}catch{capabilities.value=null}const serverConfig=(await get("/config/upload")).data,capMime=capabilities.value?.mime_map||{},addMime=(set,extOrMime)=>{const v=extOrMime.trim().toLowerCase();if(v.startsWith("image/")){set.add(v);return}const ext=v.replace(/^\./,""),mapped=capMime[ext];if(mapped)set.add(mapped),ext==="ico"&&set.add("image/vnd.microsoft.icon");else switch(ext){case"jpg":case"jpeg":set.add("image/jpeg");break;case"png":set.add("image/png");break;case"gif":set.add("image/gif");break;case"webp":set.add("image/webp");break;case"bmp":set.add("image/bmp");break;case"svg":set.add("image/svg+xml");break;case"ico":set.add("image/x-icon"),set.add("image/vnd.microsoft.icon");break;case"apng":set.add("image/apng");break;case"jp2":set.add("image/jp2");break;case"tiff":case"tif":set.add("image/tiff");break;case"tga":set.add("image/x-tga");break;default:set.add(`image/${ext}`)}},rawAllowed=Array.isArray(serverConfig?.allowed_types)?serverConfig.allowed_types:defaultConfig$1.allowedTypes,allowedTypesSet=new Set;for(const t of rawAllowed)typeof t=="string"&&addMime(allowedTypesSet,t);uploadConfig.value={maxFileSize:Math.max((serverConfig?.max_file_size||100)*1024*1024,50*1024*1024),allowedTypes:Array.from(allowedTypesSet),clientMaxConcurrentUploads:serverConfig?.client_max_concurrent_uploads||3,chunkedUpload:{enabled:serverConfig?.chunked_upload?.enabled??!0,isAllowChunkUpload:serverConfig?.chunked_upload?.is_allow_chunk_upload??!1,threshold:(serverConfig?.chunked_upload?.threshold||20)*1024*1024,chunkSize:(serverConfig?.chunked_upload?.chunk_size||2)*1024*1024,maxConcurrency:serverConfig?.chunked_upload?.max_concurrency||4,retryCount:serverConfig?.chunked_upload?.retry_count||3}},isConfigLoaded.value=!0}catch(error2){console.warn($t2("composables.useUploadConfig.errors.loadFailed"),error2),uploadConfig.value=defaultConfig$1,isConfigLoaded.value=!0}finally{isLoading.value=!1}}},getClientMaxConcurrentUploads=()=>uploadConfig.value.clientMaxConcurrentUploads,getChunkedThreshold=()=>uploadConfig.value.chunkedUpload.threshold,getChunkSize=()=>uploadConfig.value.chunkedUpload.chunkSize,getChunkedMaxConcurrency=()=>uploadConfig.value.chunkedUpload.maxConcurrency,getRetryCount=()=>uploadConfig.value.chunkedUpload.retryCount,isAllowedFileType=mimeType=>uploadConfig.value.allowedTypes.includes(mimeType),isAllowedFileSize=fileSize=>fileSize<=uploadConfig.value.maxFileSize,shouldUseChunkedUpload=fileSize=>uploadConfig.value.chunkedUpload.enabled&&uploadConfig.value.chunkedUpload.isAllowChunkUpload&&fileSize>=uploadConfig.value.chunkedUpload.threshold,formatFileSize2=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},chunkedUploadEnabled=computed(()=>uploadConfig.value.chunkedUpload.enabled),maxFileSize=computed(()=>uploadConfig.value.maxFileSize),allowedTypes=computed(()=>uploadConfig.value.allowedTypes);return{uploadConfig:computed(()=>uploadConfig.value),isConfigLoaded:computed(()=>isConfigLoaded.value),chunkedUploadEnabled,maxFileSize,allowedTypes,loadConfig,getClientMaxConcurrentUploads,getChunkedThreshold,getChunkSize,getChunkedMaxConcurrency,getRetryCount,isAllowedFileType,isAllowedFileSize,shouldUseChunkedUpload,formatFileSize:formatFileSize2}}const globalOptions=ref({folderId:null,accessLevel:"public",optimize:!0,autoRemove:!1}),regularQueue=ref([]),chunkedUploadInstance=ref(null),isChunkedReady=ref(!1),runningUploads=ref(new Set),previewUrls=ref(new Set),$t=ref(),translations=computed(()=>{if(!$t.value)return null;const t=$t.value;return{control:{paused:t("store.upload.control.paused"),preparingResume:t("store.upload.control.preparingResume"),userCancelled:t("store.upload.control.userCancelled"),cancelled:t("store.upload.control.cancelled"),preparingRetry:t("store.upload.control.preparingRetry")},queue:{preparingAnalysis:t("store.upload.queue.preparingAnalysis"),analyzing:t("store.upload.queue.analyzing"),checkingInstant:t("store.upload.queue.checkingInstant"),calculatingMD5:t("store.upload.queue.calculatingMD5"),checkingServerDuplicate:t("store.upload.queue.checkingServerDuplicate"),preparingUpload:t("store.upload.queue.preparingUpload"),instantComplete:t("store.upload.queue.instantComplete"),analysisComplete:t("store.upload.queue.analysisComplete"),waitingUpload:t("store.upload.queue.waitingUpload")},upload:{analyzingFile:t("store.upload.upload.analyzingFile"),analyzingProgress:t("store.upload.upload.analyzingProgress"),instantProgress:t("store.upload.upload.instantProgress"),instantComplete:t("store.upload.upload.instantComplete"),uploading:t("store.upload.upload.uploading"),mergingChunks:t("store.upload.upload.mergingChunks"),uploadComplete:t("store.upload.upload.uploadComplete"),uploadFailed:t("store.upload.upload.uploadFailed"),instantFailed:t("store.upload.upload.instantFailed"),preparingRetry:t("store.upload.upload.preparingRetry"),retrying:t("store.upload.upload.retrying"),postProcessing:t("store.upload.upload.postProcessing"),analysisError:t("store.upload.upload.analysisError")}}}),MessageStatus={UNREAD:1,READ:2,DELETED:3},MessagePriority={HIGH:1,NORMAL:2,LOW:3},MessageType={SYSTEM_MAINTENANCE:"system.maintenance",SYSTEM_UPDATE:"system.update",SYSTEM_ANNOUNCEMENT:"system.announcement",ACCOUNT_REGISTER:"account.register",ACCOUNT_STORAGE_GRANTED:"account.storage_granted",ACCOUNT_BANDWIDTH_GRANTED:"account.bandwidth_granted",CONTENT_REVIEW_APPROVED:"content.review_approved",CONTENT_REVIEW_REJECTED:"content.review_rejected",CONTENT_REVIEW_PENDING:"content.review_pending",STORAGE_QUOTA_WARNING:"storage.quota_warning",STORAGE_QUOTA_EXCEEDED:"storage.quota_exceeded",STORAGE_QUOTA_INCREASED:"storage.quota_increased",STORAGE_QUOTA_DECREASED:"storage.quota_decreased",FILE_DELETED_BY_ADMIN:"file.deleted_by_admin",FILE_BATCH_DELETED_BY_ADMIN:"file.batch_deleted_by_admin",FILE_HARD_DELETED_BY_ADMIN:"file.hard_deleted_by_admin",FILE_EXPIRY_WARNING:"file.expiry_warning",FILE_THUMBNAIL_FAILED:"file.thumbnail_failed",SECURITY_LOGIN_ALERT:"security.login_alert",SECURITY_PASSWORD_CHANGED:"security.password_changed",APIKEY_CREATED:"apikey.created",APIKEY_DELETED:"apikey.deleted",APIKEY_REGENERATED:"apikey.regenerated",APIKEY_DISABLED:"apikey.disabled",APIKEY_ENABLED:"apikey.enabled",RANDOM_API_CREATED:"random_api.created",RANDOM_API_DELETED:"random_api.deleted",RANDOM_API_DISABLED:"random_api.disabled",RANDOM_API_ENABLED:"random_api.enabled",SHARE_EXPIRY_WARNING:"share.expiry_warning"},getMessageTypeConfig=$t2=>({[MessageType.SYSTEM_MAINTENANCE]:{label:$t2("api.message.types.system.maintenance"),icon:"üîß",color:"orange"},[MessageType.SYSTEM_UPDATE]:{label:$t2("api.message.types.system.update"),icon:"üîÑ",color:"blue"},[MessageType.SYSTEM_ANNOUNCEMENT]:{label:$t2("api.message.types.system.announcement"),icon:"üì¢",color:"blue"},[MessageType.ACCOUNT_REGISTER]:{label:$t2("api.message.types.account.register"),icon:"üéâ",color:"green"},[MessageType.ACCOUNT_STORAGE_GRANTED]:{label:$t2("api.message.types.account.storage_granted"),icon:"üíæ",color:"purple"},[MessageType.ACCOUNT_BANDWIDTH_GRANTED]:{label:$t2("api.message.types.account.bandwidth_granted"),icon:"üöÄ",color:"cyan"},[MessageType.CONTENT_REVIEW_APPROVED]:{label:$t2("api.message.types.content.review_approved"),icon:"‚úÖ",color:"green"},[MessageType.CONTENT_REVIEW_REJECTED]:{label:$t2("api.message.types.content.review_rejected"),icon:"‚ùå",color:"red"},[MessageType.CONTENT_REVIEW_PENDING]:{label:$t2("api.message.types.content.review_pending"),icon:"‚è≥",color:"yellow"},[MessageType.STORAGE_QUOTA_WARNING]:{label:$t2("api.message.types.storage.quota_warning"),icon:"‚ö†Ô∏è",color:"yellow"},[MessageType.STORAGE_QUOTA_EXCEEDED]:{label:$t2("api.message.types.storage.quota_exceeded"),icon:"üö´",color:"red"},[MessageType.STORAGE_QUOTA_INCREASED]:{label:$t2("api.message.types.storage.quota_increased"),icon:"üìà",color:"green"},[MessageType.STORAGE_QUOTA_DECREASED]:{label:$t2("api.message.types.storage.quota_decreased"),icon:"üìâ",color:"orange"},[MessageType.FILE_DELETED_BY_ADMIN]:{label:$t2("api.message.types.file.deleted_by_admin"),icon:"üóëÔ∏è",color:"red"},[MessageType.FILE_BATCH_DELETED_BY_ADMIN]:{label:$t2("api.message.types.file.batch_deleted_by_admin"),icon:"üóÇÔ∏è",color:"red"},[MessageType.FILE_HARD_DELETED_BY_ADMIN]:{label:$t2("api.message.types.file.hard_deleted_by_admin"),icon:"‚ö†Ô∏è",color:"red"},[MessageType.FILE_EXPIRY_WARNING]:{label:$t2("api.message.types.file.expiry_warning"),icon:"‚è∞",color:"yellow"},[MessageType.FILE_THUMBNAIL_FAILED]:{label:$t2("api.message.types.file.thumbnail_failed"),icon:"üñºÔ∏è",color:"orange"},[MessageType.SECURITY_LOGIN_ALERT]:{label:$t2("api.message.types.security.login_alert"),icon:"üîí",color:"red"},[MessageType.SECURITY_PASSWORD_CHANGED]:{label:$t2("api.message.types.security.password_changed"),icon:"üîë",color:"orange"},[MessageType.APIKEY_CREATED]:{label:$t2("api.message.types.apikey.created"),icon:"üîë",color:"green"},[MessageType.APIKEY_DELETED]:{label:$t2("api.message.types.apikey.deleted"),icon:"üóëÔ∏è",color:"red"},[MessageType.APIKEY_REGENERATED]:{label:$t2("api.message.types.apikey.regenerated"),icon:"üîÑ",color:"blue"},[MessageType.APIKEY_DISABLED]:{label:$t2("api.message.types.apikey.disabled"),icon:"‚õî",color:"orange"},[MessageType.APIKEY_ENABLED]:{label:$t2("api.message.types.apikey.enabled"),icon:"‚úÖ",color:"green"},[MessageType.RANDOM_API_CREATED]:{label:$t2("api.message.types.random_api.created"),icon:"üé≤",color:"green"},[MessageType.RANDOM_API_DELETED]:{label:$t2("api.message.types.random_api.deleted"),icon:"üóëÔ∏è",color:"red"},[MessageType.RANDOM_API_DISABLED]:{label:$t2("api.message.types.random_api.disabled"),icon:"‚õî",color:"orange"},[MessageType.RANDOM_API_ENABLED]:{label:$t2("api.message.types.random_api.enabled"),icon:"‚úÖ",color:"green"},[MessageType.SHARE_EXPIRY_WARNING]:{label:$t2("api.message.types.share.expiry_warning"),icon:"üì§",color:"yellow"}}),getPriorityConfig=$t2=>({[MessagePriority.HIGH]:{label:$t2("api.message.priority.high"),color:"red",class:"text-red-500 bg-red-50"},[MessagePriority.NORMAL]:{label:$t2("api.message.priority.normal"),color:"orange",class:"text-orange-500 bg-orange-50"},[MessagePriority.LOW]:{label:$t2("api.message.priority.low"),color:"gray",class:"text-gray-500 bg-gray-50"}}),getStatusConfig=$t2=>({[MessageStatus.UNREAD]:{label:$t2("api.message.status.unread"),color:"blue",class:"text-blue-500 bg-blue-50"},[MessageStatus.READ]:{label:$t2("api.message.status.read"),color:"gray",class:"text-gray-500 bg-gray-50"},[MessageStatus.DELETED]:{label:$t2("api.message.status.deleted"),color:"gray",class:"text-gray-400 bg-gray-50"}});function createFolder(data){return post("/folders/create",data)}function getFolderList(parentId){return get("/folders/list",parentId?{parent_id:parentId}:void 0)}function getFolderListWithImages(parentId){return get("/folders/contents",parentId?{parent_id:parentId}:void 0)}function getFolderDetail(folderId){return get(`/folders/${folderId}`)}function updateFolder(data){return post("/folders/update",data)}function deleteFolder(folderId){return del(`/folders/${folderId}`)}function visibilityFolder(folderId){return post(`/folders/${folderId}/toggle-access-level`)}function reorderFolders(data){return post("/folders/reorder",data)}function getFolderTree(){return get("/folders/tree")}function getFolderPathChain(folderId){return get(`/folders/${folderId}/path-chain`)}function getBatchFolderPathChains(folderIds){return post("/folders/batch-path-chains",{folder_ids:folderIds})}function searchFolders(keyword){return get("/folders/search",{keyword})}function moveFolders(folderIds,newParentId){return post("/folders/move",{folder_ids:folderIds,new_parent_id:newParentId||""})}function moveFolder(folderId,newParentId){return moveFolders([folderId],newParentId)}const index$1={createFolder,getFolderList,getFolderDetail,updateFolder,deleteFolder,getFolderListWithImages,visibilityFolder,reorderFolders,getFolderTree,getFolderPathChain,getBatchFolderPathChains,searchFolders,moveFolders,moveFolder},folderApi=Object.freeze(Object.defineProperty({__proto__:null,createFolder,default:index$1,deleteFolder,getBatchFolderPathChains,getFolderDetail,getFolderList,getFolderListWithImages,getFolderPathChain,getFolderTree,moveFolder,moveFolders,reorderFolders,searchFolders,updateFolder,visibilityFolder},Symbol.toStringTag,{value:"Module"})),instantUploadAPI={async checkDuplicate(data){const endpoint=useAuthStore().isLoggedIn?"/files/check-duplicate":"/files/guest/check-duplicate";return(await post(endpoint,data,{silent:!0})).data},async instantUpload(data){const endpoint=useAuthStore().isLoggedIn?"/files/instant-upload":"/files/guest/instant-upload";return(await post(endpoint,data,{silent:!0})).data}};function uploadFile(file,options,onUploadProgress,config){return upload("/files/upload",file,options,onUploadProgress,config)}function uploadAvatar(file){return upload("/avatar/upload",file)}function uploadFiles(files,options,onUploadProgress){return uploadBatch("/files/batch-upload",files,options,onUploadProgress)}function getFileList(params){return get("/files/list",params)}function getFileDetail(fileId){return get(`/files/${fileId}`)}function getFileStats(fileId,period){return get(`/files/${fileId}/stats`,{period})}function updateFile(fileId,data){return put(`/files/${fileId}`,data)}function deleteFile(fileId){return del(`/files/${fileId}`)}function batchDeleteFiles(fileIds){return post("/files/batch-delete",{file_ids:fileIds})}function moveFiles(fileIds,folderId){return post("/files/move",{file_ids:fileIds,target_folder_id:folderId})}function guestUpload(file,options,onUploadProgress){return upload("/files/guest/upload",file,options,onUploadProgress)}function toggleAccessLevel(fileId){return post(`/files/${fileId}/toggle-access-level`)}function getRandomRecommendedFile(){return get("/files/guest/random")}function downloadSharedFile(fileId,shareKey,accessToken,options,onProgress){const params=new URLSearchParams;options?.quality&&params.append("quality",options.quality),options?.format&&params.append("format",options.format),accessToken&&params.append("access_token",accessToken);const url=`/shares/public/${shareKey}/files/${fileId}/download${params.toString()?`?${params.toString()}`:""}`;return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest;xhr.open("GET",getApiBaseUrl()+url,!0),xhr.responseType="blob",xhr.onprogress=event=>{if(event.lengthComputable&&onProgress){const percent=Math.round(event.loaded/event.total*100);onProgress({loaded:event.loaded,total:event.total,percent})}},xhr.onload=()=>{if(xhr.status===200){const contentDisposition=xhr.getResponseHeader("Content-Disposition");let filename="";if(contentDisposition){const filenameStarMatch=contentDisposition.match(/filename\*=UTF-8''([^;]+)/);if(filenameStarMatch)try{filename=decodeURIComponent(filenameStarMatch[1])}catch{}if(!filename){const filenameMatch=contentDisposition.match(/filename="?([^"]+)"?/);filenameMatch&&(filename=filenameMatch[1])}}const result={blob:xhr.response,filename};resolve(result)}else reject(new Error(`Download failed: ${xhr.status}`))},xhr.onerror=()=>{reject(new Error("Download request failed"))},xhr.send()})}function downloadFile(fileId,options,onProgress){const params=new URLSearchParams;options?.quality&&params.append("quality",options.quality),options?.format&&params.append("format",options.format);const url=`/files/${fileId}/download${params.toString()?`?${params.toString()}`:""}`;return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest;xhr.open("GET",getApiBaseUrl()+url,!0),xhr.responseType="blob";const tokenStr=StorageUtil.get("token");if(tokenStr)try{const token=JSON.parse(tokenStr).data||tokenStr;xhr.setRequestHeader("Authorization",`Bearer ${token}`)}catch{xhr.setRequestHeader("Authorization",`Bearer ${tokenStr}`)}xhr.onprogress=event=>{if(event.lengthComputable&&onProgress){const percent=Math.round(event.loaded/event.total*100);onProgress({loaded:event.loaded,total:event.total,percent})}},xhr.onload=()=>{if(xhr.status===200){const contentDisposition=xhr.getResponseHeader("Content-Disposition");let filename="";if(contentDisposition){const filenameStarMatch=contentDisposition.match(/filename\*=UTF-8''([^;]+)/);if(filenameStarMatch)try{filename=decodeURIComponent(filenameStarMatch[1])}catch{}if(!filename){const filenameMatch=contentDisposition.match(/filename="?([^"]+)"?/);filenameMatch&&(filename=filenameMatch[1])}}const result={blob:xhr.response,filename};resolve(result)}else reject(new Error(`Download failed: ${xhr.status}`))},xhr.onerror=()=>{reject(new Error("Download request failed"))},xhr.send()})}function reorderFiles(data){return post("/files/reorder",data)}const imageAPI={uploadFile,uploadFiles,uploadAvatar,guestUpload,getFileList,getFileDetail,getFileStats,updateFile,deleteFile,batchDeleteFiles,toggleAccessLevel,getRandomRecommendedFile,downloadFile,downloadSharedFile,reorderFiles,moveFiles,...instantUploadAPI},fileApi=Object.freeze(Object.defineProperty({__proto__:null,batchDeleteFiles,default:imageAPI,deleteFile,downloadFile,downloadSharedFile,getFileDetail,getFileList,getFileStats,getRandomRecommendedFile,guestUpload,moveFiles,reorderFiles,toggleAccessLevel,updateFile,uploadAvatar,uploadFile,uploadFiles},Symbol.toStringTag,{value:"Module"}));function register(data){return post("/user/register",data)}function login(data){return post("/user/login",data,{autoShowError:!1,useResultMode:!0})}function sendRegistrationCode(data){return post("/user/send-registration-code",data,{autoShowError:!1})}function sendResetPasswordCode(data){return post("/user/send-reset-password-code",data,{autoShowError:!1})}function resetPassword(data){return post("/user/reset-password",data)}function getUserProfile(){return get("/user/personal/profile")}function updateUserProfile(data){return post("/user/personal/profile",data)}function updatePassword(data){return post("/user/personal/update-password",data)}function getUserFolders(params){return get("/user/personal/folders",params)}function sendChangeEmailCode(data){return post("/user/personal/send-change-email-code",data)}function changeEmail(data){return post("/user/personal/change-email",data)}function getAccessControlConfig(){return get("/user/personal/access-control")}function createOrUpdateAccessControl(data){return post("/user/personal/access-control/createOrUpdate",data)}function resetAccessControlConfig(){return post("/user/personal/access-control/reset")}const index={register,login,sendRegistrationCode,sendResetPasswordCode,resetPassword,sendChangeEmailCode,changeEmail,getAccessControlConfig,createOrUpdateAccessControl,resetAccessControlConfig},userApi=Object.freeze(Object.defineProperty({__proto__:null,changeEmail,createOrUpdateAccessControl,default:index,getAccessControlConfig,getUserFolders,getUserProfile,login,register,resetAccessControlConfig,resetPassword,sendChangeEmailCode,sendRegistrationCode,sendResetPasswordCode,updatePassword,updateUserProfile},Symbol.toStringTag,{value:"Module"})),useAuthStore=defineStore("auth",{state:()=>{const storedUser=typeof window<"u"?StorageUtil.get(USER_INFO_KEY):null,storedToken=typeof window<"u"?StorageUtil.get(TOKEN_KEY):null;return{user:storedUser,token:storedToken,isAuthenticated:!!(storedToken&&storedUser),avatarUrl:storedUser?.avatarFullPath||storedUser?.avatar||null,initialized:!1}},getters:{userInfo:state=>state.user,isLoggedIn:state=>state.isAuthenticated&&!!state.token&&!!state.user,userAvatar:state=>state.avatarUrl,isAdmin:state=>[1,2].includes(state.user?.role)},actions:{initAuth(){this.initialized||typeof window>"u"||(this.checkAuth(),this.refreshCookie(),this.initialized=!0)},async login(loginData){const result=await login(loginData);if(result.success){const{userInfo,token}=result.data;return this.setUserInfo(userInfo),this.setToken(token),result.data}const errorMessage=result.message||"Login failed",error2=new Error(errorMessage);throw error2.response={data:result},error2},async register(registerData){const result=await register(registerData);if(result.success)return result.data;throw new Error(result.message||"Registration failed")},setUserInfo(user){this.user=user,this.isAuthenticated=!0,this.avatarUrl=user.avatarFullPath||user.avatar,StorageUtil.set(USER_INFO_KEY,user,TOKEN_EXPIRES)},setToken(token){this.token=token,StorageUtil.set(TOKEN_KEY,token,TOKEN_EXPIRES);const tokenExpireTime=this.getTokenExpireTime(token);if(tokenExpireTime>0)document.cookie=`token=${token}; path=/; max-age=${tokenExpireTime}; SameSite=Lax`;else{const maxAgeSeconds=TOKEN_EXPIRES*3600;document.cookie=`token=${token}; path=/; max-age=${maxAgeSeconds}; SameSite=Lax`}},logout(){this.user=null,this.token=null,this.isAuthenticated=!1,this.avatarUrl=null,this.initialized=!1,StorageUtil.remove(TOKEN_KEY),StorageUtil.remove(USER_INFO_KEY),StorageUtil.remove("rememberedLogin"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;";const currentPath=window.location.pathname;currentPath!=="/auth"&&currentPath!=="/login"&&window.location.replace("/auth")},checkAuth(){if(typeof window>"u")return;const token=StorageUtil.get(TOKEN_KEY),userInfo=StorageUtil.get(USER_INFO_KEY);token&&userInfo?(this.token=token,this.user=userInfo,this.isAuthenticated=!0,this.avatarUrl=userInfo.avatarFullPath||userInfo.avatar):(this.isAuthenticated=!1,this.user=null,this.token=null,this.avatarUrl=null,(!token||!userInfo)&&(StorageUtil.remove(TOKEN_KEY),StorageUtil.remove(USER_INFO_KEY)))},updateUserAvatar(avatarUrl,fullUrl){this.user&&(this.user.avatar=avatarUrl,fullUrl?(this.user.avatarFullPath=fullUrl,this.avatarUrl=fullUrl):this.avatarUrl=avatarUrl,StorageUtil.set(USER_INFO_KEY,this.user,TOKEN_EXPIRES))},updateUserInfo(newUserInfo){this.user&&(this.user={...this.user,...newUserInfo},newUserInfo.avatarFullPath?this.avatarUrl=newUserInfo.avatarFullPath:newUserInfo.avatar&&(this.avatarUrl=newUserInfo.avatar),StorageUtil.set(USER_INFO_KEY,this.user,TOKEN_EXPIRES))},refreshCookie(){if(!(typeof window>"u")&&this.token&&this.isAuthenticated){const tokenExpireTime=this.getTokenExpireTime(this.token);if(tokenExpireTime>0)document.cookie=`token=${this.token}; path=/; max-age=${tokenExpireTime}; SameSite=Lax`;else{const maxAgeSeconds=TOKEN_EXPIRES*3600;document.cookie=`token=${this.token}; path=/; max-age=${maxAgeSeconds}; SameSite=Lax`}}},getTokenExpireTime(token){try{const parts=token.split(".");if(parts.length!==3)return 0;const payload=parts[1],paddedPayload=payload+"==".substring(0,(4-payload.length%4)%4),decodedPayload=atob(paddedPayload.replace(/-/g,"+").replace(/_/g,"/")),claims=JSON.parse(decodedPayload);if(claims.exp&&typeof claims.exp=="number"){const now=Math.floor(Date.now()/1e3),maxAge=claims.exp-now;return maxAge>0?maxAge:0}return 0}catch{return 0}}}}),auth=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore},Symbol.toStringTag,{value:"Module"}));function isHEICFile(file){const fileName=file.name.toLowerCase();return fileName.endsWith(".heic")||fileName.endsWith(".heif")}function getHEICPlaceholder$1(){return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(`<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#1e1e1e"/>
        <stop offset="100%" style="stop-color:#2d2d2d"/>
      </linearGradient>
      <linearGradient id="icon" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#6366f1"/>
        <stop offset="100%" style="stop-color:#8b5cf6"/>
      </linearGradient>
    </defs>
    <rect width="200" height="200" fill="url(#bg)" rx="8"/>
    <!-- ÁÖßÁâáÂõæÊ†áÔºöÂ±±+Â§™Èò≥ -->
    <g transform="translate(100, 100)">
      <!-- Â§ñÊ°Ü -->
      <rect x="-45" y="-35" width="90" height="70" rx="6" fill="none" stroke="url(#icon)" stroke-width="4"/>
      <!-- Â§™Èò≥ -->
      <circle cx="-20" cy="-15" r="10" fill="url(#icon)" opacity="0.8"/>
      <!-- Â±±Â≥∞ -->
      <path d="M -45 35 L -15 -5 L 10 20 L 45 -10 L 45 35 Z" fill="url(#icon)" opacity="0.6"/>
      <!-- ÂâçÊôØÂ±± -->
      <path d="M -45 35 L -10 5 L 20 35 Z" fill="url(#icon)"/>
    </g>
  </svg>`)))}`}async function createFileObjectURL(file){return isHEICFile(file)?getHEICPlaceholder$1():URL.createObjectURL(file)}async function createFileDataURL(file){return isHEICFile(file)?getHEICPlaceholder$1():new Promise((resolve,reject)=>{const reader=new FileReader;reader.onload=e=>{resolve(e.target?.result)},reader.onerror=e=>{reject(e)},reader.readAsDataURL(file)})}const heicConverter=Object.freeze(Object.defineProperty({__proto__:null,createFileDataURL,createFileObjectURL,isHEICFile},Symbol.toStringTag,{value:"Module"}));function getHEICPlaceholder(){return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(`<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#1e1e1e"/>
        <stop offset="100%" style="stop-color:#2d2d2d"/>
      </linearGradient>
      <linearGradient id="icon" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#6366f1"/>
        <stop offset="100%" style="stop-color:#8b5cf6"/>
      </linearGradient>
    </defs>
    <rect width="200" height="200" fill="url(#bg)" rx="8"/>
    <g transform="translate(100, 100)">
      <rect x="-45" y="-35" width="90" height="70" rx="6" fill="none" stroke="url(#icon)" stroke-width="4"/>
      <circle cx="-20" cy="-15" r="10" fill="url(#icon)" opacity="0.8"/>
      <path d="M -45 35 L -15 -5 L 10 20 L 45 -10 L 45 35 Z" fill="url(#icon)" opacity="0.6"/>
      <path d="M -45 35 L -10 5 L 20 35 Z" fill="url(#icon)"/>
    </g>
  </svg>`)))}`}const allUploads=computed(()=>{const regular=regularQueue.value.map(item=>{if(!item.preview&&item.file.type.startsWith("image/"))if(isHEICFile(item.file))item.preview=getHEICPlaceholder(),item.previewLoaded=!0;else{const url=URL.createObjectURL(item.file);previewUrls.value.add(url),item.preview=url,item.previewLoaded=!0}return item});let chunked=[];return isChunkedReady.value&&chunkedUploadInstance.value?.uploadQueue&&(chunked=chunkedUploadInstance.value.uploadQueue.map(item=>{let previewUrl=item.preview,previewLoaded=item.previewLoaded;return!previewUrl&&item.file.type.startsWith("image/")&&(isHEICFile(item.file)?(previewUrl=getHEICPlaceholder(),previewLoaded=!0):(previewUrl=URL.createObjectURL(item.file),previewUrls.value.add(previewUrl),previewLoaded=!0)),{...item,type:"chunked",preview:previewUrl,previewLoaded}})),[...regular,...chunked]}),globalProgress=computed(()=>{const total=allUploads.value.length;if(total===0)return 0;const totalProgress=allUploads.value.reduce((sum,item)=>sum+item.progress,0);return Math.round(totalProgress/total)}),globalSpeed=computed(()=>allUploads.value.reduce((sum,item)=>sum+(item.speed||0),0)),isUploading=computed(()=>runningUploads.value.size>0||allUploads.value.some(item=>item.status==="uploading"||item.status==="preparing")),statistics=computed(()=>({pending:allUploads.value.filter(f=>f.status==="pending"||f.status==="paused").length,uploading:allUploads.value.filter(f=>f.status==="uploading"||f.status==="analyzing"||f.status==="preparing"||f.status==="retrying").length,completed:allUploads.value.filter(f=>f.status==="completed").length,failed:allUploads.value.filter(f=>f.status==="failed").length,total:allUploads.value.length})),maxConcurrentUploads=computed(()=>{const authStore=useAuthStore(),uploadConfig2=useUploadConfig();return authStore.isLoggedIn?uploadConfig2.getClientMaxConcurrentUploads():1});computed(()=>globalOptions.value),computed(()=>runningUploads.value);const chunkedUploadAPI={async init(data){return(await post("/files/chunked/init",data)).data},async uploadChunk(data,chunkFile){const formData=new FormData;return formData.append("session_id",data.session_id),formData.append("chunk_number",data.chunk_number.toString()),formData.append("chunk_md5",data.chunk_md5),formData.append("file",chunkFile),(await post("/files/chunked/upload",formData,{headers:{"Content-Type":"multipart/form-data"}})).data},async complete(sessionId){return(await post("/files/chunked/complete",{session_id:sessionId})).data},async getStatus(sessionId){return(await get("/files/chunked/status",{session_id:sessionId})).data},async cancel(sessionId){return(await del("/files/chunked/cancel",{session_id:sessionId})).data}};function WorkerWrapper(){return new Worker("/assets/upload.worker-4c1a0ef6.js",{type:"module"})}var __defProp$8=Object.defineProperty,__defNormalProp$8=(obj,key,value)=>key in obj?__defProp$8(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$8=(obj,key,value)=>(__defNormalProp$8(obj,typeof key!="symbol"?key+"":key,value),value);class UploadWorkerManager{constructor(config={}){__publicField$8(this,"pool",[]),__publicField$8(this,"taskQueue",[]),__publicField$8(this,"maxWorkers"),__publicField$8(this,"initialized",!1),this.maxWorkers=config.maxWorkers||2}async initialize(){if(!this.initialized){for(let i=0;i<this.maxWorkers;i++)try{const worker=new WorkerWrapper,api=wrap(worker);this.pool.push({worker,api,busy:!1,taskCount:0})}catch{}this.initialized=!0}}getIdleWorker(){let selected=this.pool.find(w=>!w.busy);return selected||(selected=this.pool.reduce((prev,curr)=>prev.taskCount<curr.taskCount?prev:curr)),selected}async executeTask(task){const worker=this.getIdleWorker();if(!worker){this.taskQueue.push(task);return}worker.busy=!0,worker.taskCount++;try{const result=await worker.api[task.method](...task.args);task.resolve(result)}catch(error2){task.reject(error2)}finally{worker.busy=!1,worker.taskCount--,this.processQueue()}}processQueue(){if(this.taskQueue.length===0)return;const task=this.taskQueue.shift();task&&this.executeTask(task)}async calculateMD5(file,onProgress){return this.initialized||await this.initialize(),new Promise((resolve,reject)=>{const task={id:`md5-${Date.now()}`,method:"calculateMD5",args:[file,onProgress?proxy(onProgress):void 0],resolve,reject};this.executeTask(task)})}async createChunks(file,chunkSize){return this.initialized||await this.initialize(),new Promise((resolve,reject)=>{const task={id:`chunk-${Date.now()}`,method:"createChunks",args:[file,chunkSize],resolve,reject};this.executeTask(task)})}async calculateChunkMD5(chunk){return this.initialized||await this.initialize(),new Promise((resolve,reject)=>{const task={id:`chunk-md5-${Date.now()}`,method:"calculateChunkMD5",args:[chunk],resolve,reject};this.executeTask(task)})}async verifyFileIntegrity(file,expectedHash){return this.initialized||await this.initialize(),new Promise((resolve,reject)=>{const task={id:`verify-${Date.now()}`,method:"verifyFileIntegrity",args:[file,expectedHash],resolve,reject};this.executeTask(task)})}destroy(){for(const item of this.pool)item.worker.terminate();this.pool=[],this.taskQueue=[],this.initialized=!1}getStatus(){return{initialized:this.initialized,workers:this.pool.length,busyWorkers:this.pool.filter(w=>w.busy).length,queuedTasks:this.taskQueue.length,totalTasks:this.pool.reduce((sum,w)=>sum+w.taskCount,0)}}}const uploadWorkerManager=new UploadWorkerManager({maxWorkers:navigator.hardwareConcurrency>4?3:2}),shouldUseWorker=fileSize=>fileSize>2*1024*1024;function formatText$2(template,params){let result=template;return Object.keys(params).forEach(key=>{result=result.replace(new RegExp(`\\{${key}\\}`,"g"),String(params[key]))}),result}async function calculateFileMD5(file,onProgress){if(shouldUseWorker(file.size))try{return await uploadWorkerManager.calculateMD5(file,onProgress)}catch{}return calculateFileMD5InMainThread(file,onProgress)}function calculateFileMD5InMainThread(file,onProgress){return new Promise((resolve,reject)=>{const store=useTextThemeStore(),spark=new SparkMD5.ArrayBuffer,fileReader=new FileReader,chunkSize=2097152;let currentChunk=0;const chunks=Math.ceil(file.size/chunkSize);let retryCount=0;const maxRetries=3;fileReader.onload=e=>{try{if(e.target?.result){if(spark.append(e.target.result),currentChunk++,retryCount=0,onProgress){const progress=Math.round(currentChunk/chunks*100);onProgress(progress)}currentChunk<chunks?loadNext():resolve(spark.end())}else throw new Error(store.getText("utils.file.fileHash.errors.emptyResult"))}catch(error2){reject(new Error(formatText$2(store.getText("utils.file.fileHash.errors.md5Failed"),{error:String(error2)})))}},fileReader.onerror=_e=>{retryCount<maxRetries?(retryCount++,setTimeout(()=>loadNext(),1e3*retryCount)):reject(new Error(formatText$2(store.getText("utils.file.fileHash.errors.readFailedAfterRetries"),{maxRetries})))},fileReader.onabort=()=>{reject(new Error(store.getText("utils.file.fileHash.errors.readAborted")))};function loadNext(){try{const start=currentChunk*chunkSize,end=Math.min(start+chunkSize,file.size);if(start>=file.size){reject(new Error(store.getText("utils.file.fileHash.errors.chunkIndexOutOfRange")));return}const slice=file.slice(start,end);fileReader.readAsArrayBuffer(slice)}catch(error2){reject(new Error(formatText$2(store.getText("utils.file.fileHash.errors.chunkCreationFailed"),{error:String(error2)})))}}loadNext()})}async function calculateChunkMD5(chunk){if(chunk.size>1024*1024)try{return await uploadWorkerManager.calculateChunkMD5(chunk)}catch{}return new Promise((resolve,reject)=>{const store=useTextThemeStore(),spark=new SparkMD5.ArrayBuffer,fileReader=new FileReader;fileReader.onload=e=>{e.target?.result&&(spark.append(e.target.result),resolve(spark.end()))},fileReader.onerror=_e=>{reject(new Error(store.getText("utils.file.fileHash.errors.chunkReadFailed")))},fileReader.readAsArrayBuffer(chunk)})}function generateId(){return Math.random().toString(36).substr(2,9)+Date.now().toString(36)}class InstantUploadUtil{static async checkInstantUpload(file,onProgress){try{const md5=await calculateFileMD5(file,progress=>{onProgress?.(progress*.8)}),checkResult=await imageAPI.checkDuplicate({md5,filename:file.name,file_size:file.size});return onProgress?.(100),{canInstant:checkResult.exists,md5,checkResult}}catch(error2){throw console.error("Ê£ÄÊü•Áßí‰º†Â§±Ë¥•:",error2),error2}}static async executeInstantUpload(file,md5,options){try{return await imageAPI.instantUpload({md5,filename:file.name,file_size:file.size,folder_id:options?.folder_id,access_level:options?.access_level,optimize:options?.optimize})}catch(error2){throw console.error("Áßí‰º†Â§±Ë¥•:",error2),error2}}static async attemptInstantUpload(file,options,onProgress){try{const checkResult=await this.checkInstantUpload(file,progress=>{onProgress?.(progress*.5)});if(!checkResult.canInstant)return null;onProgress?.(75);const uploadResult=await this.executeInstantUpload(file,checkResult.md5,options);return onProgress?.(100),uploadResult}catch(error2){throw console.error("Áßí‰º†ÊµÅÁ®ãÂ§±Ë¥•:",error2),error2}}}const PREVIEW_WIDTH=2e3,PREVIEW_HEIGHT=1200;function convertWatermarkConfigForActualFile(config,actualWidth,actualHeight){if(config.offsetUnit){const converted2=JSON.parse(JSON.stringify(config));if(config.offsetUnit==="px"){const canvasRatio2=PREVIEW_WIDTH/PREVIEW_HEIGHT,imgRatio2=actualWidth/actualHeight;let previewDrawnWidth2,previewDrawnHeight;imgRatio2>canvasRatio2?(previewDrawnWidth2=PREVIEW_WIDTH,previewDrawnHeight=PREVIEW_WIDTH/imgRatio2):(previewDrawnHeight=PREVIEW_HEIGHT,previewDrawnWidth2=PREVIEW_HEIGHT*imgRatio2);const scaleX=actualWidth/previewDrawnWidth2,scaleY=actualHeight/previewDrawnHeight;converted2.offsetX=Math.round((config.offsetX||0)*scaleX),converted2.offsetY=Math.round((config.offsetY||0)*scaleY),config.shadow&&(converted2.shadowOffsetX=Math.round((config.shadowOffsetX||0)*scaleX),converted2.shadowOffsetY=Math.round((config.shadowOffsetY||0)*scaleY),converted2.shadowBlur=Math.round((config.shadowBlur||0)*Math.max(scaleX,scaleY)))}return converted2}const canvasRatio=PREVIEW_WIDTH/PREVIEW_HEIGHT,imgRatio=actualWidth/actualHeight;let previewDrawnWidth;imgRatio>canvasRatio?previewDrawnWidth=PREVIEW_WIDTH:previewDrawnWidth=PREVIEW_HEIGHT*imgRatio;const scaleRatio=actualWidth/previewDrawnWidth,converted=JSON.parse(JSON.stringify(config));return config.generateMode==="frontend"&&config.fileBase64||(converted.scale=config.scale*scaleRatio,config.position!=="custom"&&Object.assign(converted,convertFixedPositionToCustom(converted,actualWidth,actualHeight)),config.type==="text"&&(converted.fontSize=Math.round(config.fontSize*scaleRatio)),converted.shadow&&(converted.shadowBlur=Math.round(converted.shadowBlur*scaleRatio),converted.shadowOffsetX=Math.round(converted.shadowOffsetX*scaleRatio),converted.shadowOffsetY=Math.round(converted.shadowOffsetY*scaleRatio))),converted}function convertFixedPositionToCustom(config,actualWidth,actualHeight){const canvasRatio=PREVIEW_WIDTH/PREVIEW_HEIGHT,imgRatio=actualWidth/actualHeight;let previewDrawnWidth;imgRatio>canvasRatio?previewDrawnWidth=PREVIEW_WIDTH:previewDrawnWidth=PREVIEW_HEIGHT*imgRatio;const margin=20*(actualWidth/previewDrawnWidth);let customX=.5,customY=.5,watermarkWidth=100,watermarkHeight=30;switch(config.type==="text"?(watermarkWidth=config.text.length*config.fontSize*.6*config.scale,watermarkHeight=config.fontSize*config.scale):(watermarkWidth=100*config.scale,watermarkHeight=30*config.scale),config.position){case"top-left":customX=(margin+watermarkWidth/2)/actualWidth,customY=(margin+watermarkHeight/2)/actualHeight;break;case"top-center":customX=.5,customY=(margin+watermarkHeight/2)/actualHeight;break;case"top-right":customX=(actualWidth-margin-watermarkWidth/2)/actualWidth,customY=(margin+watermarkHeight/2)/actualHeight;break;case"middle-left":customX=(margin+watermarkWidth/2)/actualWidth,customY=.5;break;case"middle-center":customX=.5,customY=.5;break;case"middle-right":customX=(actualWidth-margin-watermarkWidth/2)/actualWidth,customY=.5;break;case"bottom-left":customX=(margin+watermarkWidth/2)/actualWidth,customY=(actualHeight-margin-watermarkHeight/2)/actualHeight;break;case"bottom-center":customX=.5,customY=(actualHeight-margin-watermarkHeight/2)/actualHeight;break;case"bottom-right":customX=(actualWidth-margin-watermarkWidth/2)/actualWidth,customY=(actualHeight-margin-watermarkHeight/2)/actualHeight;break}return customX=Math.max(.05,Math.min(.95,customX)),customY=Math.max(.05,Math.min(.95,customY)),{...config,position:"custom",customX,customY}}async function getFileDimensions(file){const{createFileObjectURL:createFileObjectURL2}=await __vitePreload(()=>Promise.resolve().then(()=>heicConverter),void 0),{useTextThemeStore:useTextThemeStore2}=await __vitePreload(()=>Promise.resolve().then(()=>textTheme),void 0),store=useTextThemeStore2();return new Promise((resolve,reject)=>{const img=new Image;createFileObjectURL2(file).then(objectUrl=>{img.onload=()=>{resolve({width:img.naturalWidth,height:img.naturalHeight}),URL.revokeObjectURL(objectUrl)},img.onerror=()=>{reject(new Error(store.getText("utils.file.watermark.errors.cannotLoadImage"))),URL.revokeObjectURL(objectUrl)},img.src=objectUrl}).catch(error2=>{reject(error2)})})}function getSettings(params){return get("/settings",params)}function getSetting(key){return get(`/settings/${key}`)}function createSetting(setting){return post("/settings",setting)}function updateSetting(setting){return put("/settings",setting)}function batchUpsertSettings(settings){return post("/settings/upsert",{settings})}function deleteSetting(key){return del(`/settings/${key}`)}function getGlobalSettings(){return get("/common/settings/global")}function getGlobalSettingsByGroup(group="construction"){return get(`/common/settings/global?group=${group}`)}function getLegalDocuments(){return get("/common/settings/legal")}var __defProp$7=Object.defineProperty,__defNormalProp$7=(obj,key,value)=>key in obj?__defProp$7(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$7=(obj,key,value)=>(__defNormalProp$7(obj,typeof key!="symbol"?key+"":key,value),value),LogLevel=(LogLevel2=>(LogLevel2[LogLevel2.DEBUG=0]="DEBUG",LogLevel2[LogLevel2.INFO=1]="INFO",LogLevel2[LogLevel2.WARN=2]="WARN",LogLevel2[LogLevel2.ERROR=3]="ERROR",LogLevel2[LogLevel2.FATAL=4]="FATAL",LogLevel2))(LogLevel||{}),LogType=(LogType2=>(LogType2.SYSTEM="system",LogType2.API="api",LogType2.USER="user",LogType2.PERFORMANCE="performance",LogType2.SECURITY="security",LogType2.BUSINESS="business",LogType2))(LogType||{});const defaultConfig={level:1,enableConsole:isDevelopment,enableStorage:!0,enableRemote:isProduction,maxStorageEntries:1e3,bufferSize:50,flushInterval:3e4};class Logger{constructor(config={}){__publicField$7(this,"config"),__publicField$7(this,"buffer",[]),__publicField$7(this,"storageKey","app_logs"),__publicField$7(this,"sessionId"),__publicField$7(this,"flushTimer"),__publicField$7(this,"timers",new Map),this.config={...defaultConfig,...config},this.sessionId=this.generateSessionId(),this.initFlushTimer()}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}initFlushTimer(){this.config.enableRemote&&this.config.flushInterval>0&&(this.flushTimer=setInterval(()=>{this.flush()},this.config.flushInterval))}createLogEntry(level,type,message,data,source){return{level,type,message,data,timestamp:Date.now(),source,sessionId:this.sessionId,userId:this.getCurrentUserId(),requestId:this.getCurrentRequestId(),stack:level>=3?new Error().stack:void 0}}getCurrentUserId(){try{return}catch{return}}getCurrentRequestId(){}shouldLog(level){return level>=this.config.level}formatConsoleOutput(entry){const timestamp=new Date(entry.timestamp).toISOString(),levelName=LogLevel[entry.level],outputs=[`%c${`[${timestamp}] [${levelName}] [${entry.type.toUpperCase()}]`} ${entry.message}`,this.getConsoleStyle(entry.level)];return entry.data&&outputs.push(`
Data:`,entry.data),entry.source&&outputs.push(`
Source:`,entry.source),entry.stack&&entry.level>=3&&outputs.push(`
Stack:`,entry.stack),outputs}getConsoleStyle(level){return{0:"color: #888; font-size: 12px;",1:"color: #2196F3; font-weight: bold;",2:"color: #FF9800; font-weight: bold;",3:"color: #F44336; font-weight: bold;",4:"color: #fff; background: #F44336; font-weight: bold; padding: 2px 4px;"}[level]||""}outputToConsole(entry){if(!this.config.enableConsole)return;const outputs=this.formatConsoleOutput(entry);switch(entry.level){case 0:break;case 1:break;case 2:console.warn(...outputs);break;case 3:case 4:console.error(...outputs);break}}storeLocally(entry){if(this.config.enableStorage)try{const existingLogs=this.getStoredLogs();existingLogs.push(entry),existingLogs.length>this.config.maxStorageEntries&&existingLogs.splice(0,existingLogs.length-this.config.maxStorageEntries),StorageUtil.set(this.storageKey,existingLogs)}catch(error2){console.error("Failed to store log entry:",error2)}}getStoredLogs(){try{return StorageUtil.get(this.storageKey)||[]}catch{return[]}}addToBuffer(entry){this.config.enableRemote&&(this.buffer.push(entry),this.buffer.length>=this.config.bufferSize&&this.flush())}async flush(){if(!this.config.enableRemote||!this.config.remoteUrl||this.buffer.length===0)return;const logsToSend=[...this.buffer];this.buffer=[];try{await fetch(this.config.remoteUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({logs:logsToSend,sessionId:this.sessionId,userAgent:navigator.userAgent,url:window.location.href})})}catch(error2){this.buffer.unshift(...logsToSend),console.error("Failed to send logs to remote:",error2)}}log(level,type,message,data,source){if(!this.shouldLog(level))return;const entry=this.createLogEntry(level,type,message,data,source);this.outputToConsole(entry),this.storeLocally(entry),this.addToBuffer(entry)}debug(message,data,source){this.log(0,"system",message,data,source)}info(message,data,source){this.log(1,"system",message,data,source)}warn(message,data,source){this.log(2,"system",message,data,source)}error(message,data,source){this.log(3,"system",message,data,source)}fatal(message,data,source){this.log(4,"system",message,data,source)}api(message,data,source){this.log(1,"api",message,data,source)}user(message,data,source){this.log(1,"user",message,data,source)}performance(message,data,source){this.log(1,"performance",message,data,source)}security(message,data,source){this.log(2,"security",message,data,source)}business(message,data,source){this.log(1,"business",message,data,source)}batch(entries){entries.forEach(entry=>{this.log(entry.level,entry.type,entry.message,entry.data,entry.source)})}time(label){this.timers.set(label,performance.now())}timeEnd(label){const startTime=this.timers.get(label);if(startTime!==void 0){const duration=performance.now()-startTime;return this.timers.delete(label),this.performance(`Timer "${label}" took ${duration.toFixed(2)}ms`,{duration}),duration}return 0}getStats(){const logs=this.getStoredLogs(),stats={total:logs.length,byLevel:{},byType:{},sessionId:this.sessionId,bufferSize:this.buffer.length};return logs.forEach(log2=>{const levelName=LogLevel[log2.level],typeName=log2.type;stats.byLevel[levelName]=(stats.byLevel[levelName]||0)+1,stats.byType[typeName]=(stats.byType[typeName]||0)+1}),stats}clear(){StorageUtil.remove(this.storageKey),this.buffer=[]}async flushNow(){await this.flush()}destroy(){this.flushTimer&&clearInterval(this.flushTimer),this.flush()}updateConfig(config){this.config={...this.config,...config},this.flushTimer&&clearInterval(this.flushTimer),this.initFlushTimer()}}const logger=new Logger({enableConsole:DEBUG_CONFIG.enableNetworkLogging,enableRemote:isProduction,remoteUrl:{}.VITE_LOG_ENDPOINT}),log=logger.info.bind(logger),logError=logger.error.bind(logger),logApi=logger.api.bind(logger),logUser=logger.user.bind(logger),logPerformance=logger.performance.bind(logger);function logExecutionTime(target,propertyName,descriptor){const method=descriptor.value;return descriptor.value=function(...args){const label=`${target.constructor.name}.${propertyName}`;logger.time(label);try{const result=method.apply(this,args);return result&&typeof result.then=="function"?result.finally(()=>{logger.timeEnd(label)}):(logger.timeEnd(label),result)}catch(error2){throw logger.timeEnd(label),logger.error(`Error in ${label}`,error2),error2}},descriptor}const logger$1=Object.freeze(Object.defineProperty({__proto__:null,LogLevel,LogType,default:logger,log,logApi,logError,logExecutionTime,logPerformance,logUser,logger},Symbol.toStringTag,{value:"Module"}));var __defProp$6=Object.defineProperty,__defNormalProp$6=(obj,key,value)=>key in obj?__defProp$6(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$6=(obj,key,value)=>(__defNormalProp$6(obj,typeof key!="symbol"?key+"":key,value),value);class FaviconManager{static setImmediate(){const cachedUrl=localStorage.getItem(this.STORAGE_KEY);return cachedUrl&&cachedUrl!=="null"&&cachedUrl.trim()?(this.updateFavicon(cachedUrl),!0):!1}static updateAndCache(url){url&&url.trim()?(this.updateFavicon(url),localStorage.setItem(this.STORAGE_KEY,url)):(this.updateFavicon(this.defaultFavicon),localStorage.removeItem(this.STORAGE_KEY))}static updateFavicon(url){let link=document.querySelector("link[rel*='icon']");link||(link=document.createElement("link"),link.rel="icon",link.type="image/x-icon",document.head.appendChild(link)),link.href=url}static clearCache(){localStorage.removeItem(this.STORAGE_KEY),this.updateFavicon(this.defaultFavicon)}static getCachedUrl(){return localStorage.getItem(this.STORAGE_KEY)}static hasCache(){const cached=this.getCachedUrl();return cached!==null&&cached!=="null"&&cached.trim()!==""}}__publicField$6(FaviconManager,"STORAGE_KEY","site_favicon_url");__publicField$6(FaviconManager,"defaultFavicon","/favicon.ico");class SEOManager{static setTitle(title,siteName){let fullTitle=title;siteName&&siteName.trim()&&(fullTitle=title?`${title} - ${siteName}`:siteName),document.title=fullTitle}static setDescription(description){if(!description||!description.trim())return;let metaDesc=document.querySelector('meta[name="description"]');metaDesc||(metaDesc=document.createElement("meta"),metaDesc.name="description",document.head.appendChild(metaDesc)),metaDesc.content=description}static setKeywords(keywords){if(!keywords||!keywords.trim())return;let metaKeywords=document.querySelector('meta[name="keywords"]');metaKeywords||(metaKeywords=document.createElement("meta"),metaKeywords.name="keywords",document.head.appendChild(metaKeywords)),metaKeywords.content=keywords}static setSEO(options){(options.title!==void 0||options.siteName!==void 0)&&this.setTitle(options.title||"",options.siteName),options.description&&this.setDescription(options.description),options.keywords&&this.setKeywords(options.keywords)}static setDefaultSEO(settingsStore,pageTitle){this.setSEO({title:pageTitle,siteName:settingsStore.siteName,description:settingsStore.siteDescription,keywords:settingsStore.siteKeywords})}}function useWebsiteSettingsModule(){const settings=ref({}),adminEmail=computed(()=>settings.value.admin_email||""),siteBaseUrl=computed(()=>settings.value.site_base_url||"");return{websiteSettings:settings,adminEmail,siteBaseUrl,updateWebsiteSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetWebsiteSettings:()=>{settings.value={}}}}function useWebsiteInfoSettingsModule(){const{$t:$t2}=useTexts(),settings=ref({}),siteName=computed(()=>settings.value.site_name||"PixelPunk"),siteDescription=computed(()=>settings.value.site_description||$t2("store.settings.defaults.siteDescription")),siteKeywords=computed(()=>settings.value.site_keywords||""),icpNumber=computed(()=>settings.value.icp_number||""),siteLogoUrl=computed(()=>settings.value.site_logo_url||"/logo.png"),faviconUrl=computed(()=>settings.value.favicon_url||"/favicon.ico"),copyrightText=computed(()=>settings.value.copyright_text||""),contactEmail=computed(()=>settings.value.contact_email||""),footerCustomText=computed(()=>settings.value.footer_custom_text||""),siteHeroTitle=computed(()=>settings.value.site_hero_title||""),siteFeaturesText=computed(()=>settings.value.site_features_text||""),siteSlogan=computed(()=>settings.value.site_slogan||""),showImageCount=computed(()=>settings.value.show_file_count??!1),showStorageUsage=computed(()=>settings.value.show_storage_usage??!1);return{websiteInfoSettings:settings,siteName,siteDescription,siteKeywords,icpNumber,siteLogoUrl,faviconUrl,copyrightText,contactEmail,footerCustomText,siteHeroTitle,siteFeaturesText,siteSlogan,showImageCount,showStorageUsage,updateWebsiteInfoSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetWebsiteInfoSettings:()=>{settings.value={}}}}function useUploadSettingsModule(){const{$t:$t2}=useTexts(),settings=ref({}),allowedImageFormats=computed(()=>settings.value.allowed_image_formats||["jpg","jpeg","png","gif","webp","bmp","svg","ico","apng","tiff","tif","heic","heif"]),maxFileSize=computed(()=>{const size=settings.value.max_file_size;return typeof size=="number"?size:20}),maxBatchSize=computed(()=>{const size=settings.value.max_batch_size;return typeof size=="number"?size:100}),allowedFormatsText=computed(()=>(settings.value.allowed_image_formats||["JPG","PNG","GIF","WebP"]).map(f=>f.toUpperCase()).join("„ÄÅ")),uploadLimitText=computed(()=>{const maxSize=maxFileSize.value,formatsText=allowedFormatsText.value;return maxSize===0?$t2("store.settings.upload.limitTextUnlimited",{formats:formatsText}):$t2("store.settings.upload.limitTextWithMax",{formats:formatsText,maxSize:String(maxSize)})}),thumbnailQuality=computed(()=>settings.value.thumbnail_quality??85),thumbnailMaxWidth=computed(()=>settings.value.thumbnail_max_width??800),thumbnailMaxHeight=computed(()=>settings.value.thumbnail_max_height??800),preserveExif=computed(()=>settings.value.preserve_exif??!1),dailyUploadLimit=computed(()=>settings.value.daily_upload_limit??0);return{uploadSettings:settings,allowedImageFormats,maxFileSize,maxBatchSize,allowedFormatsText,uploadLimitText,thumbnailQuality,thumbnailMaxWidth,thumbnailMaxHeight,preserveExif,dailyUploadLimit,updateUploadSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetUploadSettings:()=>{settings.value={}}}}function useRegistrationSettingsModule(){const settings=ref({}),isRegistrationEnabled=computed(()=>settings.value.enable_registration??!0),isEmailVerificationEnabled=computed(()=>settings.value.email_verification??!0);return{registrationSettings:settings,isRegistrationEnabled,isEmailVerificationEnabled,updateRegistrationSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetRegistrationSettings:()=>{settings.value={}}}}function useVersionSettingsModule(){const settings=ref({}),currentVersion=computed(()=>settings.value.current_version||"1.0.0"),buildTime=computed(()=>settings.value.build_time||""),isUpdateAvailable=computed(()=>settings.value.update_available??!1),lastUpdateCheck=computed(()=>settings.value.last_update_check||"");return{versionSettings:settings,currentVersion,buildTime,isUpdateAvailable,lastUpdateCheck,updateVersionSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetVersionSettings:()=>{settings.value={}}}}function useAppearanceSettingsModule(){const settings=ref({}),showOfficialSite=computed(()=>settings.value.show_official_site??!1),officialSiteUrl=computed(()=>settings.value.official_site_url||""),showGithubLink=computed(()=>settings.value.show_github_link??!1),githubUrl=computed(()=>settings.value.github_url||""),showWechatGroup=computed(()=>settings.value.show_wechat_group??!1),wechatQrImageUrl=computed(()=>settings.value.wechat_qr_image_url||""),wechatContactAccount=computed(()=>settings.value.wechat_contact_account||""),showQqGroup=computed(()=>settings.value.show_qq_group??!1),qqQrImageUrl=computed(()=>settings.value.qq_qr_image_url||""),qqGroupNumber=computed(()=>settings.value.qq_group_number||""),enableMultiLayout=computed(()=>settings.value.enable_multi_layout??!1),defaultLayout=computed(()=>settings.value.default_layout||"default"),enableMultiLanguage=computed(()=>settings.value.enable_multi_language??!1),defaultLanguage=computed(()=>settings.value.default_language||"zh-CN"),defaultTheme=computed(()=>settings.value.default_theme||"");return{appearanceSettings:settings,showOfficialSite,officialSiteUrl,showGithubLink,githubUrl,showWechatGroup,wechatQrImageUrl,wechatContactAccount,showQqGroup,qqQrImageUrl,qqGroupNumber,enableMultiLayout,defaultLayout,enableMultiLanguage,defaultLanguage,defaultTheme,updateAppearanceSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetAppearanceSettings:()=>{settings.value={}}}}function useAISettingsModule(){const aiSettings=ref({}),vectorSettings=ref({}),isAIEnabled=computed(()=>aiSettings.value.ai_enabled??!1),isVectorEnabled=computed(()=>vectorSettings.value.vector_enabled??!1);return{aiSettings,vectorSettings,isAIEnabled,isVectorEnabled,updateAISettings:newSettings=>{aiSettings.value={...aiSettings.value,...newSettings}},updateVectorSettings:newSettings=>{vectorSettings.value={...vectorSettings.value,...newSettings}},resetAISettings:()=>{aiSettings.value={},vectorSettings.value={}}}}function useAnalyticsSettingsModule(){const settings=ref({}),baiduEnabled=computed(()=>settings.value.baidu_analytics_enabled===!0||settings.value.baidu_analytics_enabled==="true"),baiduSiteId=computed(()=>settings.value.baidu_analytics_site_id||""),googleEnabled=computed(()=>settings.value.google_analytics_enabled===!0||settings.value.google_analytics_enabled==="true"),googleMeasurementId=computed(()=>settings.value.google_analytics_measurement_id||"");return{analyticsSettings:settings,baiduEnabled,baiduSiteId,googleEnabled,googleMeasurementId,updateAnalyticsSettings:newSettings=>{settings.value={...settings.value,...newSettings}},resetAnalyticsSettings:()=>{settings.value={}}}}const useSettingsStore=defineStore("settings",()=>{const{$t:$t2}=useTexts(),website=useWebsiteSettingsModule(),websiteInfo=useWebsiteInfoSettingsModule(),upload2=useUploadSettingsModule(),registration=useRegistrationSettingsModule(),version=useVersionSettingsModule(),appearance=useAppearanceSettingsModule(),ai=useAISettingsModule(),analytics=useAnalyticsSettingsModule(),isLoaded=ref(!1),loading2=ref(!1),rawSettings=ref(null);async function loadGlobalSettings(){if(!loading2.value){loading2.value=!0;try{const response=await getGlobalSettings();if(response.code===200&&response.data){const data=response.data;rawSettings.value=data,data.website&&website.updateWebsiteSettings(data.website),data.website_info&&websiteInfo.updateWebsiteInfoSettings(data.website_info),data.upload&&upload2.updateUploadSettings(data.upload),data.registration&&registration.updateRegistrationSettings(data.registration),data.version&&version.updateVersionSettings(data.version),data.appearance&&appearance.updateAppearanceSettings(data.appearance),data.ai&&ai.updateAISettings(data.ai),data.vector&&ai.updateVectorSettings(data.vector),data.analytics&&analytics.updateAnalyticsSettings(data.analytics),data.website_info?.favicon_url&&FaviconManager.update(data.website_info.favicon_url),SEOManager.setSEO({siteName:data.website_info?.site_name||"PixelPunk",description:data.website_info?.site_description||$t2("store.settings.defaults.siteDescription"),keywords:data.website_info?.site_keywords||""}),isLoaded.value=!0}}catch(error2){console.error("Âä†ËΩΩÂÖ®Â±ÄËÆæÁΩÆÂ§±Ë¥•:",error2)}finally{loading2.value=!1}}}function reset(){website.resetWebsiteSettings(),websiteInfo.resetWebsiteInfoSettings(),upload2.resetUploadSettings(),registration.resetRegistrationSettings(),version.resetVersionSettings(),appearance.resetAppearanceSettings(),ai.resetAISettings(),analytics.resetAnalyticsSettings(),isLoaded.value=!1,loading2.value=!1,rawSettings.value=null}return{isLoaded,loading:loading2,rawSettings,...website,...websiteInfo,...upload2,...registration,...version,...appearance,...ai,...analytics,loadGlobalSettings,reset}});var UploadStatus=(UploadStatus2=>(UploadStatus2.PENDING="pending",UploadStatus2.PREPARING="preparing",UploadStatus2.UPLOADING="uploading",UploadStatus2.PAUSED="paused",UploadStatus2.COMPLETED="completed",UploadStatus2.FAILED="failed",UploadStatus2.CANCELLED="cancelled",UploadStatus2.RETRYING="retrying",UploadStatus2.ANALYZING="analyzing",UploadStatus2))(UploadStatus||{});function useChunkedUpload(options={}){const{$t:$t2}=useTexts(),{chunkSize=2*1024*1024,concurrency=3,retryCount=3,folderId,accessLevel="private",optimize=!0,watermarkEnabled,watermarkConfig}=options,uploadQueue=ref([]),isUploading2=ref(!1),globalProgress2=computed(()=>{if(uploadQueue.value.length===0)return 0;const totalProgress=uploadQueue.value.reduce((sum,item)=>sum+item.progress,0);return Math.round(totalProgress/uploadQueue.value.length)}),globalSpeed2=computed(()=>uploadQueue.value.reduce((sum,item)=>sum+item.speed,0)),addFiles2=async files=>{const fileArray=Array.from(files),uploadItems=[];for(const file of fileArray){if(!isValidImageFile(file)){console.warn(`‚ö†Ô∏è [ChunkedUpload] Ë∑≥ËøáÊó†ÊïàÊñá‰ª∂: ${file.name}`);continue}const totalChunks=Math.ceil(file.size/chunkSize),uploadItem={id:generateId(),file,status:UploadStatus.ANALYZING,statusMessage:$t2("upload.smartUpload.status.analyzing"),progress:0,totalChunks,uploadedChunks:0,uploadedChunksList:[],failedChunks:new Set,speed:0,remainingTime:0,chunkSize,folderId,accessLevel,optimize,watermarkEnabled,watermarkConfig,retryCount:0,maxRetries:retryCount,totalBytesUploaded:0,averageSpeed:0};uploadQueue.value.push(uploadItem),uploadItems.push(uploadItem)}const analysisPromises=uploadItems.map(async uploadItem=>{try{const analysisTimeout=new Promise((_,reject)=>{setTimeout(()=>reject(new Error($t2("upload.smartUpload.error.analysisTimeout"))),3e4)}),onMD5Progress=progress=>{uploadItem.statusMessage=$t2("upload.smartUpload.status.analyzingProgress",{progress}),triggerRef(uploadQueue)},fileMD5=await Promise.race([calculateFileMD5(uploadItem.file,onMD5Progress),analysisTimeout]);if(uploadItem.fileMD5=fileMD5,uploadItem.file.type.startsWith("image/"))try{const dimensions=await getFileDimensions(uploadItem.file);uploadItem.dimensions=dimensions}catch(error2){console.warn(`‚ö†Ô∏è [ChunkedUpload] Ëé∑ÂèñÊñá‰ª∂Â∞∫ÂØ∏Â§±Ë¥•: ${uploadItem.file.name}`,error2)}if(useSettingsStore().rawSettings?.upload?.instant_upload_enabled??!1)try{uploadItem.statusMessage=$t2("upload.smartUpload.status.checkingInstant"),triggerRef(uploadQueue);const instantResult=await InstantUploadUtil.attemptInstantUpload(uploadItem.file,{folder_id:uploadItem.folderId,access_level:uploadItem.accessLevel,optimize:uploadItem.optimize},progress=>{uploadItem.progress=Math.floor(progress),uploadItem.statusMessage=$t2("upload.smartUpload.status.checkingInstantProgress",{progress:uploadItem.progress}),triggerRef(uploadQueue)});if(instantResult){uploadItem.status=UploadStatus.COMPLETED,uploadItem.progress=100,uploadItem.statusMessage=$t2("upload.smartUpload.status.instantCompleted"),uploadItem.result=instantResult.file_info||instantResult,uploadItem.endTime=Date.now(),triggerRef(uploadQueue);return}}catch{}const existingSession=UploadStorageManager.findExistingSession(fileMD5,uploadItem.file.size);existingSession?(uploadItem.sessionId=existingSession.sessionId,uploadItem.status=UploadStatus.PAUSED,uploadItem.statusMessage=$t2("upload.smartUpload.status.foundResumable"),uploadItem.progress=Math.round(existingSession.uploadedChunks.length/uploadItem.totalChunks*100),uploadItem.uploadedChunks=existingSession.uploadedChunks.length,uploadItem.uploadedChunksList=existingSession.uploadedChunks,uploadItem.folderId=existingSession.folderId||folderId,uploadItem.accessLevel=existingSession.accessLevel||accessLevel,uploadItem.optimize=existingSession.optimize??optimize,triggerRef(uploadQueue)):(uploadItem.status=UploadStatus.PENDING,uploadItem.statusMessage=$t2("upload.smartUpload.status.analyzingCompleted")),triggerRef(uploadQueue)}catch(error2){console.error(`‚ùå [ChunkedUpload] Êñá‰ª∂ÂàÜÊûêÂ§±Ë¥•: ${uploadItem.file.name}`,error2),uploadItem.status=UploadStatus.FAILED,uploadItem.error=error2 instanceof Error?error2.message:$t2("upload.smartUpload.error.analysisFailed"),uploadItem.statusMessage=$t2("upload.smartUpload.status.analyzingFailed",{error:uploadItem.error}),triggerRef(uploadQueue)}});return Promise.allSettled(analysisPromises).then(results=>(results.filter(r=>r.status==="fulfilled").length,results.filter(r=>r.status==="rejected").length,results))},startUpload2=async itemId=>{if(itemId){const item=uploadQueue.value.find(item2=>item2.id===itemId);item&&item.status===UploadStatus.PENDING&&await uploadSingleFile(item)}else{isUploading2.value=!0;const pendingItems=uploadQueue.value.filter(item=>item.status===UploadStatus.PENDING||item.status===UploadStatus.PAUSED);for(const item of pendingItems){if(!isUploading2.value)break;await uploadSingleFile(item)}isUploading2.value=!1}},pauseUpload2=itemId=>{const item=uploadQueue.value.find(item2=>item2.id===itemId);item&&item.status===UploadStatus.UPLOADING&&(item.status=UploadStatus.PAUSED)},resumeUpload2=async itemId=>{const item=uploadQueue.value.find(item2=>item2.id===itemId);item&&item.status===UploadStatus.PAUSED&&await uploadSingleFile(item)},cancelUpload2=async itemId=>{const item=uploadQueue.value.find(item2=>item2.id===itemId);if(item){if(item.sessionId)try{await chunkedUploadAPI.cancel(item.sessionId)}catch(error2){console.error("ÂèñÊ∂à‰∏ä‰º†Â§±Ë¥•:",error2)}item.status=UploadStatus.CANCELLED}},retryUpload2=async itemId=>{const item=uploadQueue.value.find(item2=>item2.id===itemId);!item||item.status!==UploadStatus.FAILED&&item.status!==UploadStatus.CANCELLED||(item.retryCount=0,item.status=UploadStatus.RETRYING,item.statusMessage=$t2("upload.smartUpload.status.retryingUpload"),item.error=void 0,item.failedChunks.clear(),await uploadSingleFile(item))},removeUploadItem2=itemId=>{const index2=uploadQueue.value.findIndex(item=>item.id===itemId);index2>-1&&(UploadStorageManager.removeSession(itemId),uploadQueue.value.splice(index2,1))},clearQueue2=()=>{uploadQueue.value.forEach(item=>{UploadStorageManager.removeSession(item.id)}),uploadQueue.value=[]},getResumableUploads=()=>UploadStorageManager.getResumableSessions(),cleanExpiredSessions=()=>{UploadStorageManager.cleanExpiredSessions()},clearAllSessions2=()=>{localStorage.removeItem("chunked_upload_sessions")},uploadSingleFile=async item=>{try{item.startTime=Date.now();let sessionData;if(item.sessionId&&(item.status===UploadStatus.PAUSED||item.status===UploadStatus.RETRYING)){item.status=UploadStatus.UPLOADING,item.statusMessage=$t2("upload.smartUpload.status.resumingUpload");try{const serverStatus=await chunkedUploadAPI.getStatus(item.sessionId);item.uploadedChunks=serverStatus.uploaded_chunks,item.progress=serverStatus.progress,item.statusMessage=$t2("upload.smartUpload.status.continuingUpload"),item.uploadedChunksList=Array.from({length:serverStatus.uploaded_chunks},(_,i)=>i),sessionData=createSessionData(item)}catch(error2){console.error("Ëé∑ÂèñÂêéÁ´ØÁä∂ÊÄÅÂ§±Ë¥•ÔºåÈáçÊñ∞ÂºÄÂßã‰∏ä‰º†:",error2),item.statusMessage=$t2("upload.smartUpload.status.restartingUpload"),sessionData=await createNewSession(item)}}else item.status=UploadStatus.PREPARING,item.statusMessage=$t2("upload.smartUpload.status.preparingSession"),sessionData=await createNewSession(item);if(UploadStorageManager.saveSession(sessionData),item.status=UploadStatus.UPLOADING,item.statusMessage=$t2("upload.smartUpload.status.uploading"),await uploadChunksWithConcurrency(item),item.statusMessage=$t2("upload.smartUpload.status.verifyingIntegrity"),!item.sessionId)throw new Error($t2("composables.chunkedUpload.errors.sessionNotFound"));try{const finalStatus=await chunkedUploadAPI.getStatus(item.sessionId);if(finalStatus.uploaded_chunks<item.totalChunks)throw new Error(`Upload incomplete, uploaded ${finalStatus.uploaded_chunks}/${item.totalChunks} chunks`);item.uploadedChunks=finalStatus.uploaded_chunks,item.progress=finalStatus.progress}catch(statusError){throw console.error("ÊúÄÁªàÁä∂ÊÄÅÈ™åËØÅÂ§±Ë¥•:",statusError),statusError}item.statusMessage=$t2("upload.smartUpload.status.completingUpload");const completeResponse=await chunkedUploadAPI.complete(item.sessionId);let responseData=completeResponse;if(completeResponse.data&&(responseData=completeResponse.data),item.status=UploadStatus.COMPLETED,item.progress=100,item.endTime=Date.now(),item.statusMessage=$t2("upload.smartUpload.status.completed"),item.result=responseData,item.startTime&&item.endTime){const totalTime=(item.endTime-item.startTime)/1e3;item.averageSpeed=Math.round(item.file.size/totalTime/1024)}UploadStorageManager.removeSession(item.id)}catch(error2){item.status=UploadStatus.FAILED,item.error=error2.message||$t2("upload.smartUpload.error.uploadFailed"),item.statusMessage=$t2("upload.smartUpload.status.failed",{error:item.error}),item.retryCount++,console.error("‰∏ä‰º†Â§±Ë¥•:",error2);const sessionData=createSessionData(item);UploadStorageManager.saveSession(sessionData),item.retryCount<item.maxRetries&&setTimeout(()=>{item.status===UploadStatus.FAILED&&retryUpload2(item.id)},2e3*item.retryCount)}},createNewSession=async item=>{item.fileMD5||(item.fileMD5=await calculateFileMD5(item.file));const resolveValue=value=>value&&typeof value=="object"&&"value"in value?value.value:value;let watermarkConfigForUpload;if(resolveValue(item.watermarkEnabled)&&item.watermarkConfig)try{const config={...item.watermarkConfig};let finalScale=1;if(item.dimensions&&config.generatedWidth){const targetImageWidth=item.dimensions.width,watermarkOriginalWidth=config.generatedWidth,relativeSize=config.relativeSize||.15,calculatedScale=targetImageWidth*relativeSize/watermarkOriginalWidth;finalScale=Math.max(.1,Math.min(5,calculatedScale))}else config.scale&&(finalScale=config.scale);watermarkConfigForUpload={enabled:!0,type:config.type||"image",fileBase64:config.fileBase64||"",position:config.position||"bottom-right",offsetX:config.offsetX??20,offsetY:config.offsetY??20,offsetUnit:"px",opacity:config.opacity??.7,scale:finalScale}}catch(error2){console.warn("[ChunkedUpload] Ê∞¥Âç∞ÈÖçÁΩÆÂáÜÂ§áÂ§±Ë¥•:",error2)}const initResponse=await chunkedUploadAPI.init({file_name:item.file.name,file_size:item.file.size,file_md5:item.fileMD5,mime_type:item.file.type,chunk_size:item.chunkSize,folder_id:resolveValue(item.folderId)||void 0,access_level:resolveValue(item.accessLevel),optimize:resolveValue(item.optimize),watermark_config:watermarkConfigForUpload});return item.sessionId=initResponse.session_id,item.status=UploadStatus.UPLOADING,createSessionData(item)},createSessionData=item=>{const resolveValue=value=>value&&typeof value=="object"&&"value"in value?value.value:value;if(!item.sessionId||!item.fileMD5)throw new Error($t2("composables.chunkedUpload.errors.sessionDataMissing"));return{id:item.id,sessionId:item.sessionId,fileName:item.file.name,fileSize:item.file.size,fileMD5:item.fileMD5,mimeType:item.file.type,chunkSize:item.chunkSize,totalChunks:item.totalChunks,uploadedChunks:item.uploadedChunksList,folderId:resolveValue(item.folderId),accessLevel:resolveValue(item.accessLevel),optimize:resolveValue(item.optimize),createdAt:Date.now(),lastActivity:Date.now()}},uploadChunksWithConcurrency=async item=>{if(!item.sessionId)throw new Error($t2("composables.chunkedUpload.errors.sessionIdMissing"));const chunksToUpload=[];for(let chunkNumber=0;chunkNumber<item.totalChunks;chunkNumber++)item.uploadedChunksList.includes(chunkNumber)||chunksToUpload.push(chunkNumber);if(chunksToUpload.length===0)return;let currentConcurrency=concurrency,failedAttempts=0;const maxFailedAttempts=3;for(let i=0;i<chunksToUpload.length&&item.status===UploadStatus.UPLOADING;i+=currentConcurrency){const batch=chunksToUpload.slice(i,i+currentConcurrency),batchStartTime=Date.now(),batchPromises=batch.map(chunkNumber=>uploadSingleChunk(item,chunkNumber).catch(error2=>{throw console.error(`ÂàÜÁâá ${chunkNumber} ÊâπÊ¨°‰∏ä‰º†Â§±Ë¥•:`,error2),failedAttempts++,error2}));try{await Promise.allSettled(batchPromises);const avgTimePerChunk=(Date.now()-batchStartTime)/batch.length;avgTimePerChunk>1e4&&currentConcurrency>1?currentConcurrency=Math.max(1,currentConcurrency-1):avgTimePerChunk<3e3&&currentConcurrency<concurrency&&(currentConcurrency=Math.min(concurrency,currentConcurrency+1)),failedAttempts=0}catch(error2){console.error("ÊâπÊ¨°‰∏ä‰º†Â§±Ë¥•:",error2),failedAttempts>=maxFailedAttempts&&currentConcurrency>1&&(currentConcurrency=Math.max(1,Math.floor(currentConcurrency/2)),failedAttempts=0)}i+currentConcurrency<chunksToUpload.length&&await new Promise(resolve=>setTimeout(resolve,100))}},uploadSingleChunk=async(item,chunkNumber,_startTime)=>{if(item.status!==UploadStatus.UPLOADING)return;let attempts=0,lastError=null;for(;attempts<retryCount;)try{const start=chunkNumber*item.chunkSize,end=Math.min(start+item.chunkSize,item.file.size),chunk=item.file.slice(start,end);let chunkMD5;attempts===0?chunkMD5=await calculateChunkMD5(chunk):chunkMD5=await calculateChunkMD5(chunk);const chunkStartTime=Date.now(),_networkCheckStart=Date.now();await chunkedUploadAPI.uploadChunk({session_id:item.sessionId,chunk_number:chunkNumber,chunk_md5:chunkMD5},chunk),item.uploadedChunks++,item.uploadedChunksList.push(chunkNumber),item.uploadedChunksList.sort((a,b)=>a-b),item.progress=Math.round(item.uploadedChunks/item.totalChunks*100),item.totalBytesUploaded+=chunk.size;const uploadTime=Date.now()-chunkStartTime;if(uploadTime>0){const instantSpeed=chunk.size/(uploadTime/1e3)/1024;item.speed=item.speed===0?instantSpeed:item.speed*.7+instantSpeed*.3;const remainingBytes=item.file.size-item.totalBytesUploaded;item.remainingTime=item.speed>0?Math.round(remainingBytes/(item.speed*1024)):0}const speedText=item.speed>1024?`${(item.speed/1024).toFixed(1)} MB/s`:`${Math.round(item.speed)} KB/s`,remainingText=item.remainingTime>60?$t2("upload.smartUpload.time.minutes",{minutes:Math.floor(item.remainingTime/60),seconds:item.remainingTime%60}):$t2("upload.smartUpload.time.seconds",{seconds:item.remainingTime});item.statusMessage=$t2("upload.smartUpload.status.uploadingWithProgress",{progress:item.progress,speed:speedText,remaining:remainingText}),item.failedChunks.delete(chunkNumber),UploadStorageManager.addUploadedChunk(item.id,chunkNumber);return}catch(error2){attempts++,lastError=error2,console.error(`ÂàÜÁâá ${chunkNumber} ‰∏ä‰º†Â§±Ë¥• (Â∞ùËØï ${attempts}/${retryCount}):`,error2);const isNetworkError=error2.name==="NetworkError"||error2.message?.includes("fetch")||error2.message?.includes("timeout")||error2.code==="NETWORK_ERROR",isServerError=error2.status>=500&&error2.status<600,isRateLimited=error2.status===429;if(attempts>=retryCount){item.failedChunks.add(chunkNumber);let fullError=error2.message||$t2("composables.chunkedUpload.errors.unknownError");throw isNetworkError?fullError+=$t2("composables.chunkedUpload.errors.networkError"):isServerError?fullError+=$t2("composables.chunkedUpload.errors.serverError"):isRateLimited&&(fullError+=$t2("composables.chunkedUpload.errors.rateLimited")),item.statusMessage=$t2("upload.smartUpload.status.chunkUploadFailed",{chunk:chunkNumber,error:fullError}),error2}let retryDelay=1e3*Math.pow(2,attempts-1);isRateLimited?retryDelay=Math.max(retryDelay,5e3):isServerError?retryDelay=Math.max(retryDelay,2e3):isNetworkError&&(retryDelay=Math.max(retryDelay,3e3)),retryDelay+=Math.random()*1e3,item.statusMessage=$t2("upload.smartUpload.status.chunkRetrying",{chunk:chunkNumber,attempt:attempts,maxRetry:retryCount,delay:Math.round(retryDelay/1e3)}),await new Promise(resolve=>setTimeout(resolve,retryDelay))}throw lastError||new Error(`Chunk ${chunkNumber} upload failed after ${retryCount} retries`)},isValidImageFile=file=>["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/bmp"].includes(file.type);return{uploadQueue:readonly(uploadQueue),isUploading:readonly(isUploading2),globalProgress:globalProgress2,globalSpeed:globalSpeed2,addFiles:addFiles2,startUpload:startUpload2,pauseUpload:pauseUpload2,resumeUpload:resumeUpload2,cancelUpload:cancelUpload2,retryUpload:retryUpload2,removeUploadItem:removeUploadItem2,clearQueue:clearQueue2,getResumableUploads,cleanExpiredSessions,clearAllSessions:clearAllSessions2}}function initChunkedUpload(){if(chunkedUploadInstance.value)return;const uploadConfig2=useUploadConfig();chunkedUploadInstance.value=useChunkedUpload({chunkSize:uploadConfig2.getChunkSize(),concurrency:uploadConfig2.getChunkedMaxConcurrency(),retryCount:uploadConfig2.getRetryCount(),folderId:computed(()=>globalOptions.value.folderId),accessLevel:computed(()=>globalOptions.value.accessLevel),optimize:computed(()=>globalOptions.value.optimize),watermarkEnabled:computed(()=>globalOptions.value.watermarkEnabled),watermarkConfig:computed(()=>globalOptions.value.watermarkConfig)}),isChunkedReady.value=!0}function setGlobalOptions(options){globalOptions.value={...globalOptions.value,...options}}async function initialize(){const uploadConfig2=useUploadConfig();uploadConfig2.isConfigLoaded.value||await uploadConfig2.loadConfig(),initChunkedUpload()}const _hoisted_1$1x={key:0,class:"toast-icon"},_hoisted_2$1q={class:"toast-content"},_sfc_main$1I=defineComponent({name:"CyberToast",__name:"index",props:{type:{default:"info"},message:{},duration:{default:TIMING.TOAST.DEFAULT_DURATION},visible:{type:Boolean,default:!0}},emits:["update","close"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,closeToast=()=>{emit("close"),emit("update",!1)};onMounted(()=>{emit("update",!0)}),watch(()=>props.visible,val=>{emit("update",val)});const toastClass=computed(()=>({[`toast-${props.type}`]:!0})),iconClass=computed(()=>({success:"fas fa-check-circle",error:"fas fa-times-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"})[props.type]||"fas fa-info-circle");return(_ctx,_cache)=>withDirectives((openBlock(),createElementBlock("div",{class:normalizeClass(["toast",toastClass.value])},[__props.type!=="default"?(openBlock(),createElementBlock("div",_hoisted_1$1x,[createBaseVNode("i",{class:normalizeClass(iconClass.value)},null,2)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_2$1q,toDisplayString(__props.message),1),createBaseVNode("div",{class:"toast-close",onClick:closeToast},[..._cache[0]||(_cache[0]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])],2)),[[vShow,__props.visible]])}});const _export_sfc=(sfc,props)=>{const target=sfc.__vccOpts||sfc;for(const[key,val]of props)target[key]=val;return target},Toast=_export_sfc(_sfc_main$1I,[["__scopeId","data-v-2f9274fe"]]),toastList=reactive([]);let toastIdCounter=0;const calculateToastPositions=()=>{let totalHeight=TIMING.TOAST.INITIAL_TOP;toastList.filter(toast=>toast.visible).forEach(toast=>{toast.top=totalHeight,toast.el&&(toast.el.style.transition="top 0.3s ease",toast.el.style.top=`${totalHeight}px`),totalHeight+=(toast.height||60)+TIMING.TOAST.MARGIN})};function useToast(){const addToast=options=>{const{message,type="info",duration=TIMING.TOAST.DEFAULT_DURATION}=options,id=toastIdCounter++,container=document.createElement("div");container.className="cyber-toast-wrapper",container.style.position="fixed",container.style.left="50%",container.style.transform="translateX(-50%)",container.style.zIndex=String(Z_INDEX$1.TOAST),container.style.top=`${TIMING.TOAST.INITIAL_TOP-20}px`,container.style.opacity="0",container.style.transition="top 0.3s ease, opacity 0.3s ease";const visible=ref(!0),hide=()=>{const index2=toastList.findIndex(item=>item.id===id);index2!==-1&&(toastList[index2].visible=!1,visible.value=!1,container&&document.body.contains(container)&&(container.style.opacity="0",container.style.transform="translateX(-50%) translateY(-20px)"),calculateToastPositions(),setTimeout(()=>{if(document.body.contains(container))try{render(null,container),document.body.removeChild(container);const removeIndex=toastList.findIndex(item=>item.id===id);removeIndex!==-1&&toastList.splice(removeIndex,1)}catch{}},TIMING.TOAST.ANIMATION_DELAY))},toastInstance={id,el:container,height:0,visible:!0,hide,top:0};document.body.appendChild(container);const vnode=h(Toast,{type,message,duration,visible:visible.value,onUpdate:val=>{visible.value=val},onClose:()=>{hide()}});return render(vnode,container),toastList.push(toastInstance),setTimeout(()=>{container.firstElementChild&&(toastInstance.height=container.firstElementChild.getBoundingClientRect().height,calculateToastPositions(),container.style.opacity="1",container.style.top=`${toastInstance.top}px`)},TIMING.TOAST.SHOW_DELAY),duration>0&&setTimeout(hide,duration),{close:hide}};return{success:(message,duration)=>addToast({message,type:"success",duration}),error:(message,duration)=>addToast({message,type:"error",duration}),info:(message,duration)=>addToast({message,type:"info",duration}),warning:(message,duration)=>addToast({message,type:"warning",duration}),show:addToast,clearAll:()=>{[...toastList].forEach(toast=>{toast.hide()})}}}const useToast$1=Object.freeze(Object.defineProperty({__proto__:null,useToast},Symbol.toStringTag,{value:"Module"}));var __defProp$5=Object.defineProperty,__defNormalProp$5=(obj,key,value)=>key in obj?__defProp$5(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$5=(obj,key,value)=>(__defNormalProp$5(obj,typeof key!="symbol"?key+"":key,value),value);function formatText$1(template,params){let result=template;return Object.keys(params).forEach(key=>{result=result.replace(new RegExp(`\\{${key}\\}`,"g"),String(params[key]))}),result}class CanvasWatermarkGenerator{constructor(){__publicField$5(this,"canvas"),__publicField$5(this,"ctx"),this.canvas=document.createElement("canvas");const ctx=this.canvas.getContext("2d",{alpha:!0});if(!ctx){const store=useTextThemeStore();throw new Error(store.getText("utils.file.watermark.errors.canvasContextFailed"))}this.ctx=ctx}async generateWatermark(config){const startTime=Date.now();try{if(!config.enabled)return{success:!0,base64Data:"",width:0,height:0,generateTime:0};let watermarkWidth,watermarkHeight;const store=useTextThemeStore();if(config.type==="text"){const textMetrics=this.calculateTextSize(config);watermarkWidth=Math.ceil(textMetrics.width),watermarkHeight=Math.ceil(textMetrics.height)}else if(config.type==="image"){const img=await this.loadWatermarkImage(config);watermarkWidth=Math.ceil(img.width*config.scale),watermarkHeight=Math.ceil(img.height*config.scale)}else throw new Error(store.getText("utils.file.watermark.errors.unsupportedWatermarkType"));let canvasWidth=watermarkWidth,canvasHeight=watermarkHeight;if(config.rotation!==0){const rad=Math.abs(config.rotation)*Math.PI/180,cos=Math.abs(Math.cos(rad)),sin=Math.abs(Math.sin(rad));canvasWidth=Math.ceil(watermarkWidth*cos+watermarkHeight*sin),canvasHeight=Math.ceil(watermarkWidth*sin+watermarkHeight*cos)}return this.setupCanvas(canvasWidth,canvasHeight),this.ctx.clearRect(0,0,canvasWidth,canvasHeight),config.type==="text"?await this.generateTextWatermarkContent(config,canvasWidth,canvasHeight):config.type==="image"&&await this.generateImageWatermarkContent(config,canvasWidth,canvasHeight),{success:!0,base64Data:this.canvas.toDataURL("image/png"),width:canvasWidth,height:canvasHeight,generateTime:Date.now()-startTime}}catch(error2){console.error("[CanvasÊ∞¥Âç∞ÁîüÊàêÂô®] ÁîüÊàêÂ§±Ë¥•:",error2);const store=useTextThemeStore();return{success:!1,width:0,height:0,error:error2 instanceof Error?error2.message:store.getText("utils.file.watermark.errors.watermarkGenerationFailed"),generateTime:Date.now()-startTime}}}setupCanvas(width,height){this.canvas.width=width,this.canvas.height=height,this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.setTransform(1,0,0,1,0,0)}calculateTextSize(config){const store=useTextThemeStore(),tempCtx=document.createElement("canvas").getContext("2d");if(!tempCtx)throw new Error(store.getText("utils.file.watermark.errors.tempCanvasContextFailed"));const actualFontSize=config.fontSize*config.scale;tempCtx.font=`${config.fontWeight} ${actualFontSize}px ${config.fontFamily}`;const textWidth=tempCtx.measureText(config.text).width,textHeight=actualFontSize,padding=config.shadow?Math.max(config.shadowBlur,Math.abs(config.shadowOffsetX),Math.abs(config.shadowOffsetY)):0;return{width:textWidth+padding*2,height:textHeight+padding*2}}async generateTextWatermarkContent(config,width,height){const{text,fontSize,fontFamily,fontColor,fontWeight:_fontWeight,opacity}=config;await this.ensureFontLoaded(fontFamily);const actualFontSize=fontSize*config.scale;this.ctx.font=`${config.fontWeight} ${actualFontSize}px ${config.fontFamily}`,this.ctx.textAlign="center",this.ctx.textBaseline="middle";const color=this.parseColor(fontColor);this.ctx.fillStyle=this.applyOpacity(color,opacity);const centerX=width/2,centerY=height/2;config.rotation!==0&&(this.ctx.save(),this.ctx.translate(centerX,centerY),this.ctx.rotate(config.rotation*Math.PI/180),this.ctx.translate(-centerX,-centerY)),config.shadow&&(this.ctx.save(),this.ctx.fillStyle=this.applyOpacity(this.parseColor(config.shadowColor),opacity*.5),this.ctx.fillText(text,centerX+config.shadowOffsetX,centerY+config.shadowOffsetY),this.ctx.restore()),this.ctx.fillStyle=this.applyOpacity(color,opacity),this.ctx.fillText(text,centerX,centerY),config.rotation!==0&&this.ctx.restore()}async generateImageWatermarkContent(config,width,height){const watermarkImage=await this.loadWatermarkImage(config),scaledWidth=watermarkImage.width*config.scale,scaledHeight=watermarkImage.height*config.scale,centerX=width/2,centerY=height/2;this.ctx.globalAlpha=config.opacity,config.rotation!==0&&(this.ctx.save(),this.ctx.translate(centerX,centerY),this.ctx.rotate(config.rotation*Math.PI/180),this.ctx.translate(-centerX,-centerY)),config.shadow&&(this.ctx.save(),this.ctx.globalAlpha=config.opacity*.3,this.ctx.fillStyle=config.shadowColor,this.ctx.fillRect(centerX-scaledWidth/2+config.shadowOffsetX,centerY-scaledHeight/2+config.shadowOffsetY,scaledWidth,scaledHeight),this.ctx.restore(),this.ctx.globalAlpha=config.opacity),this.ctx.drawImage(watermarkImage,centerX-scaledWidth/2,centerY-scaledHeight/2,scaledWidth,scaledHeight),config.rotation!==0&&this.ctx.restore(),this.ctx.globalAlpha=1}async loadWatermarkImage(config){if(config.imageFile)return await this.loadImageFromFile(config.imageFile);if(config.imageUrl)return await this.loadImageFromUrl(config.imageUrl);const store=useTextThemeStore();throw new Error(store.getText("utils.file.watermark.errors.noWatermarkFile"))}async ensureFontLoaded(fontFamily){if(!document.fonts)return!0;try{return await document.fonts.load(`16px "${fontFamily}"`),document.fonts.check(`16px "${fontFamily}"`)}catch(error2){return console.warn(`Â≠ó‰ΩìÂä†ËΩΩÂ§±Ë¥•: ${fontFamily}`,error2),!1}}async loadImageFromFile(file){const{createFileObjectURL:createFileObjectURL2}=await __vitePreload(()=>Promise.resolve().then(()=>heicConverter),void 0),store=useTextThemeStore();return new Promise((resolve,reject)=>{const img=new Image;createFileObjectURL2(file).then(url=>{img.onload=()=>{URL.revokeObjectURL(url),resolve(img)},img.onerror=()=>{URL.revokeObjectURL(url),reject(new Error(store.getText("utils.file.watermark.errors.fileLoadFailed")))},img.src=url}).catch(error2=>{reject(error2)})})}loadImageFromUrl(url){return new Promise((resolve,reject)=>{const store=useTextThemeStore(),img=new Image;img.onload=()=>resolve(img),img.onerror=()=>reject(new Error(formatText$1(store.getText("utils.file.watermark.errors.imageLoadFailed"),{url}))),img.crossOrigin="anonymous",img.src=url})}parseColor(colorStr){return colorStr.startsWith("#")?colorStr:`#${colorStr}`}applyOpacity(color,opacity){const hex=color.replace("#",""),r=parseInt(hex.substr(0,2),16),g=parseInt(hex.substr(2,2),16),b=parseInt(hex.substr(4,2),16);return`rgba(${r}, ${g}, ${b}, ${opacity})`}destroy(){this.canvas.remove()}}const generateWatermark=async config=>{const generator=new CanvasWatermarkGenerator;try{return await generator.generateWatermark(config)}finally{generator.destroy()}};async function prepareWatermarkConfig(item){const baseConfig={...globalOptions.value.watermarkConfig||{}};if(baseConfig.generatedImage&&!baseConfig.fileBase64)try{baseConfig.fileBase64=String(baseConfig.generatedImage).replace(/^data:image\/\w+;base64,/,"")}catch{}const sanitizeByType=conf=>{const c={...conf};return c.type==="text"||(c.type="image",delete c.text,delete c.fontSize,delete c.fontFamily,delete c.fontColor,delete c.fontWeight),c};if(!globalOptions.value.watermarkEnabled||!baseConfig||!item.dimensions){const sanitized=sanitizeByType({...baseConfig,type:baseConfig?.type||"image"});return{watermark:globalOptions.value.watermarkEnabled?JSON.stringify(sanitized):void 0}}let configToConvert=sanitizeByType({...baseConfig});if(configToConvert.fileBase64&&configToConvert.generateMode==="frontend"){configToConvert.type="image";const targetImageWidth=item.dimensions.width,watermarkOriginalWidth=configToConvert.generatedWidth||100,relativeSize=configToConvert.relativeSize||.15,calculatedScale=targetImageWidth*relativeSize/watermarkOriginalWidth;configToConvert.scale=Math.max(.1,Math.min(5,calculatedScale)),configToConvert.rotation=0,configToConvert.shadow=!1,configToConvert.shadowBlur=0,configToConvert.shadowOffsetX=0,configToConvert.shadowOffsetY=0}else if(configToConvert.type==="text"&&configToConvert.text&&configToConvert.text.trim())try{const canvasConfig={...configToConvert,targetWidth:item.dimensions.width,targetHeight:item.dimensions.height},result=await generateWatermark(canvasConfig);if(result.success&&result.base64Data){const pureBase64=result.base64Data.replace(/^data:image\/\w+;base64,/,""),targetImageWidth=item.dimensions.width,watermarkOriginalWidth=result.width,relativeSize=configToConvert.relativeSize||.15,calculatedScale=targetImageWidth*relativeSize/watermarkOriginalWidth,finalScale=Math.max(.1,Math.min(5,calculatedScale));configToConvert={...configToConvert,type:"image",generateMode:"frontend",generatedImage:result.base64Data,generatedWidth:result.width,generatedHeight:result.height,fileBase64:pureBase64,imageUrl:void 0,imageFile:void 0,scale:finalScale,rotation:0,shadow:!1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}else return console.error("[Ê∞¥Âç∞ÈÖçÁΩÆ] ÊñáÊú¨Ê∞¥Âç∞ÁîüÊàêÂ§±Ë¥•ÔºöÁîüÊàêÁªìÊûúÊó†Êïà"),{watermark:void 0}}catch(error2){return console.error("[Ê∞¥Âç∞ÈÖçÁΩÆ] ÊñáÊú¨Ê∞¥Âç∞ÁîüÊàêÂºÇÂ∏∏:",error2),{watermark:void 0}}else if(configToConvert.type!=="text"&&(configToConvert.type="image",!configToConvert.fileBase64&&configToConvert.generatedFile))try{configToConvert.fileBase64=String(configToConvert.generatedFile).replace(/^data:image\/\w+;base64,/,"")}catch(error2){console.warn("[Ê∞¥Âç∞ÈÖçÁΩÆ] generatedFileÊ†ºÂºèËΩ¨Êç¢Â§±Ë¥•:",error2)}const convertedConfig=convertWatermarkConfigForActualFile(configToConvert,item.dimensions.width,item.dimensions.height),finalConfig=sanitizeByType(convertedConfig);if(finalConfig.type==="image"&&!finalConfig.fileBase64&&finalConfig.generatedFile)try{finalConfig.fileBase64=String(finalConfig.generatedFile).replace(/^data:image\/\w+;base64,/,"")}catch(error2){console.warn("[Ê∞¥Âç∞ÈÖçÁΩÆ] ÊúÄÁªàbase64ËΩ¨Êç¢Â§±Ë¥•:",error2)}const backendConfig={enabled:!0,type:finalConfig.type,fileBase64:finalConfig.fileBase64||"",position:finalConfig.position||"bottom-right",offsetX:finalConfig.offsetX??20,offsetY:finalConfig.offsetY??20,offsetUnit:"px",opacity:finalConfig.opacity??.7,scale:finalConfig.scale??1};return{watermark:JSON.stringify(backendConfig)}}async function createUploadItemWithDimensions(file,itemId,type="regular"){const baseItem={id:itemId,file,status:"pending",progress:0,speed:0,remainingTime:0,type};try{if(file.type.startsWith("image/")){const dimensions=await getFileDimensions(file);baseItem.dimensions=dimensions}}catch(error2){console.warn(`‚ö†Ô∏è [UploadStore] Ëé∑ÂèñÊñá‰ª∂Â∞∫ÂØ∏Â§±Ë¥•: ${file.name}`,error2)}return baseItem}async function addFiles(files){const uploadConfig2=useUploadConfig(),toast=useToast(),{$t:$t2}=useTexts();uploadConfig2.isConfigLoaded.value||await uploadConfig2.loadConfig(),isChunkedReady.value||initChunkedUpload();const fileArray=Array.from(files),validFiles=[];for(const file of fileArray){if(!uploadConfig2.isAllowedFileType(file.type)){toast.error($t2("upload.uploadProgress.toast.fileTypeNotSupported",{name:file.name}));continue}if(!uploadConfig2.isAllowedFileSize(file.size)){toast.error($t2("upload.uploadProgress.toast.fileSizeExceeded",{name:file.name,size:uploadConfig2.formatFileSize(file.size)}));continue}const id=generateId();regularQueue.value.push({id,file,status:"pending",progress:0,speed:0,remainingTime:0,statusMessage:translations.value?.queue.waitingUpload||"Ready to upload",type:"regular"}),validFiles.push({file,id})}const MAX_CONCURRENT_PREVIEW=5,previewQueue=[...validFiles],processingPreviews=[];for(;previewQueue.length>0||processingPreviews.length>0;){for(;processingPreviews.length<MAX_CONCURRENT_PREVIEW&&previewQueue.length>0;){const{file,id}=previewQueue.shift(),promise=createPreviewForFile(file,id).finally(()=>{const index2=processingPreviews.indexOf(promise);index2>-1&&processingPreviews.splice(index2,1)});processingPreviews.push(promise)}processingPreviews.length>0&&await Promise.race(processingPreviews)}}async function createPreviewForFile(file,itemId){const item=regularQueue.value.find(i=>i.id===itemId);if(item)try{const uploadItem=await createUploadItemWithDimensions(file,itemId,"regular");Object.assign(item,uploadItem)}catch{}}function removeUploadItem(itemId){if(chunkedUploadInstance.value&&chunkedUploadInstance.value.uploadQueue.find(item=>item.id===itemId)){chunkedUploadInstance.value.removeUploadItem(itemId);return}const index2=regularQueue.value.findIndex(item=>item.id===itemId);if(index2>-1){const item=regularQueue.value[index2];item.preview&&previewUrls.value.has(item.preview)&&(URL.revokeObjectURL(item.preview),previewUrls.value.delete(item.preview)),regularQueue.value.splice(index2,1)}}const MAX_CONCURRENT_INSTANT_CHECK=5;function scheduleNextUploads(uploadRegularFile2){const currentRunning=runningUploads.value.size,maxConcurrent=Math.max(maxConcurrentUploads.value,MAX_CONCURRENT_INSTANT_CHECK);if(currentRunning>=maxConcurrent)return;const pendingFiles=allUploads.value.filter(item=>item.status==="pending"&&!runningUploads.value.has(item.id)),canStart=Math.min(pendingFiles.length,maxConcurrent-currentRunning);if(canStart!==0)for(let i=0;i<canStart;i++)startSingleFileUpload(pendingFiles[i],uploadRegularFile2)}async function startSingleFileUpload(file,uploadRegularFile2){runningUploads.value.add(file.id),file.uploadSessionId||(file.uploadSessionId=`${Date.now()}-${Math.random().toString(36).substring(2,9)}`);try{if(file.status==="failed")return;if(file.type==="chunked")await chunkedUploadInstance.value.startUpload(file.id);else{const instantSuccess=await attemptInstantUploadForItem(file);if(file.status==="failed")return;instantSuccess||await uploadRegularFile2(file)}}finally{runningUploads.value.delete(file.id),scheduleNextUploads(uploadRegularFile2)}}async function attemptInstantUploadForItem(item){if(!(useSettingsStore().rawSettings?.upload?.instant_upload_enabled??!1)||item.status==="failed")return!1;const currentSessionId=item.uploadSessionId;try{item.status="analyzing",item.progress=0,item.statusMessage=translations.value?.queue.checkingInstant||"Checking instant upload...";const instantResult=await InstantUploadUtil.attemptInstantUpload(item.file,{folder_id:globalOptions.value.folderId||void 0,access_level:globalOptions.value.accessLevel,optimize:globalOptions.value.optimize},progress=>{item.uploadSessionId!==currentSessionId||item.status==="failed"||(item.progress=progress,progress<50?item.statusMessage=translations.value?.queue.calculatingMD5?.replace("{progress}",String(progress))||`Calculating MD5... ${progress}%`:progress<75?item.statusMessage=translations.value?.queue.checkingServerDuplicate||"Checking duplicates...":item.statusMessage=translations.value?.queue.preparingUpload||"Instant uploading...")});if(item.status==="failed")return!1;if(instantResult){const resultData=instantResult.file_info||instantResult.data||instantResult;return item.status="completed",item.progress=100,item.statusMessage=translations.value?.queue.instantComplete||"Instant upload completed",item.result=resultData,globalOptions.value.autoRemove&&setTimeout(()=>{removeUploadItem(item.id)},500),!0}return!1}catch{return item.status==="failed",!1}}function generateSimpleFingerprint(){const components=[];components.push(navigator.userAgent),components.push(`${screen.width}x${screen.height}x${screen.colorDepth}`),components.push(Intl.DateTimeFormat().resolvedOptions().timeZone),components.push(navigator.language),components.push(navigator.platform),components.push(navigator.hardwareConcurrency?.toString()||"unknown"),components.push(navigator.deviceMemory?.toString()||"unknown"),components.push(navigator.maxTouchPoints>0?"touch":"notouch");const fingerprint=components.join("|");let hash=0;for(let i=0;i<fingerprint.length;i++){const char=fingerprint.charCodeAt(i);hash=(hash<<5)-hash+char,hash=hash&hash}return Math.abs(hash).toString(36)}async function uploadRegularFile(item){const toast=useToast(),{$t:$t2}=useTexts(),authStore=useAuthStore();if(item.status==="failed")return;const currentSessionId=item.uploadSessionId;try{item.status="uploading",item.progress=0,item.statusMessage=translations.value?.upload.uploading||"Uploading...";const startTime=Date.now();let result;if(authStore.isLoggedIn){const watermarkConfig=await prepareWatermarkConfig(item);result=await uploadFile(item.file,{folder_id:globalOptions.value.folderId||void 0,access_level:globalOptions.value.accessLevel,optimize:globalOptions.value.optimize,storage_duration:globalOptions.value.storageDuration,...watermarkConfig},progressEvent=>{if(!(item.uploadSessionId!==currentSessionId||item.status==="failed")&&progressEvent.lengthComputable){item.progress=Math.round(progressEvent.loaded/progressEvent.total*100);const elapsed=(Date.now()-startTime)/1e3;if(elapsed>0){item.speed=Math.round(progressEvent.loaded/elapsed/1024);const remainingBytes=progressEvent.total-progressEvent.loaded;item.remainingTime=item.speed>0?Math.round(remainingBytes/(item.speed*1024)):0;const speedText=item.speed>1024?`${(item.speed/1024).toFixed(1)} MB/s`:`${item.speed} KB/s`,remainingText=item.remainingTime>60?$t2("store.upload.upload.remainingTimeMinutes",{minutes:Math.floor(item.remainingTime/60),seconds:item.remainingTime%60}):$t2("store.upload.upload.remainingTimeSeconds",{seconds:item.remainingTime});item.statusMessage=$t2("store.upload.upload.uploadingProgress",{progress:item.progress,speed:speedText,remaining:remainingText})}}},{silent:!0}),item.result=result.data||result}else{const watermarkConfig=await prepareWatermarkConfig(item);result=await guestUpload(item.file,{access_level:"public",optimize:globalOptions.value.optimize,storage_duration:globalOptions.value.storageDuration||"7d",fingerprint:generateSimpleFingerprint(),...watermarkConfig},progressEvent=>{if(!(item.uploadSessionId!==currentSessionId||item.status==="failed")&&progressEvent.lengthComputable){item.progress=Math.round(progressEvent.loaded/progressEvent.total*100);const elapsed=(Date.now()-startTime)/1e3;if(elapsed>0){item.speed=Math.round(progressEvent.loaded/elapsed/1024);const remainingBytes=progressEvent.total-progressEvent.loaded;item.remainingTime=item.speed>0?Math.round(remainingBytes/(item.speed*1024)):0;const speedText=item.speed>1024?`${(item.speed/1024).toFixed(1)} MB/s`:`${item.speed} KB/s`,remainingText=item.remainingTime>60?$t2("store.upload.upload.remainingTimeMinutes",{minutes:Math.floor(item.remainingTime/60),seconds:item.remainingTime%60}):$t2("store.upload.upload.remainingTimeSeconds",{seconds:item.remainingTime});item.statusMessage=$t2("store.upload.upload.uploadingProgress",{progress:item.progress,speed:speedText,remaining:remainingText})}}}),item.result=result.data.file_info,result.data.remaining_count!==void 0&&toast.success($t2("upload.uploadProgress.toast.uploadSuccessWithRemainingCount",{count:result.data.remaining_count}));const guestFileData=item.result;guestFileData&&globalOptions.value.watermarkEnabled&&guestFileData.watermark_applied===!1&&guestFileData.watermark_failure_reason&&toast.warning($t2("upload.uploadProgress.toast.watermarkApplyFailed",{reason:guestFileData.watermark_failure_reason}))}if(item.status==="failed")return;const fileData=item.result;fileData&&globalOptions.value.watermarkEnabled&&fileData.watermark_applied===!1&&fileData.watermark_failure_reason&&toast.warning($t2("upload.uploadProgress.toast.watermarkApplyFailed",{reason:fileData.watermark_failure_reason})),fileData&&fileData.thumbnail_generation_failed&&fileData.thumbnail_failure_reason&&toast.warning($t2("upload.uploadProgress.toast.thumbnailGenerationFailed",{reason:fileData.thumbnail_failure_reason})),item.status="completed",item.progress=100,item.statusMessage=translations.value?.upload.uploadComplete||"Upload completed",globalOptions.value.autoRemove&&setTimeout(()=>{removeUploadItem(item.id)},500)}catch(error2){item.status="failed",item.error=error2.message||translations.value?.upload.uploadFailed||"Upload failed",item.statusMessage=$t2("store.upload.upload.uploadFailedWithError",{error:item.error})}}function startUpload(){scheduleNextUploads(uploadRegularFile)}function pauseUpload(itemId){if(itemId){const item=allUploads.value.find(i=>i.id===itemId);item&&(item.type==="chunked"?chunkedUploadInstance.value?.pauseUpload(itemId):(item.status="paused",item.statusMessage=translations.value?.control.paused||"Paused"))}else allUploads.value.forEach(item=>{item.status==="uploading"&&pauseUpload(item.id)})}async function resumeUpload(itemId){const item=allUploads.value.find(i=>i.id===itemId);item&&(item.type==="chunked"?await chunkedUploadInstance.value?.resumeUpload(itemId):(item.status="pending",item.statusMessage=translations.value?.control.preparingResume||"Preparing to resume",scheduleNextUploads(uploadRegularFile)))}function cancelUpload(itemId){if(itemId){const item=allUploads.value.find(i=>i.id===itemId);item&&(item.type==="chunked"?chunkedUploadInstance.value?.cancelUpload(itemId):(item.status="failed",item.error=translations.value?.control.userCancelled||"Cancelled by user",item.statusMessage=translations.value?.control.cancelled||"Cancelled"),runningUploads.value.delete(itemId))}else allUploads.value.filter(item=>item.status==="uploading"||item.status==="pending"||item.status==="analyzing"||item.status==="preparing"||item.status==="retrying").forEach(item=>{cancelUpload(item.id)})}async function retryUpload(itemId){const item=allUploads.value.find(i=>i.id===itemId);!item||item.status!=="failed"||(item.type==="chunked"?await chunkedUploadInstance.value?.retryUpload(itemId):(item.uploadSessionId=`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,item.status="pending",item.progress=0,item.error=void 0,item.statusMessage=translations.value?.control.preparingRetry||"Preparing to retry",scheduleNextUploads(uploadRegularFile)))}function clearQueue(){chunkedUploadInstance.value?.clearQueue(),regularQueue.value=[],previewUrls.value.forEach(url=>URL.revokeObjectURL(url)),previewUrls.value.clear(),runningUploads.value.clear()}function clearAllSessions(){const toast=useToast(),{$t:$t2}=useTexts();chunkedUploadInstance.value?.clearAllSessions(),toast.success($t2("upload.uploadProgress.toast.cacheCleared"))}function cleanup(){previewUrls.value.forEach(url=>URL.revokeObjectURL(url)),previewUrls.value.clear()}const useUploadStore=defineStore("upload",()=>{const uploadConfig2=useUploadConfig(),{$t:$t$1}=useTexts();return $t.value=$t$1,initialize(),{allUploads,globalProgress,globalSpeed,isUploading,statistics,maxConcurrentUploads,globalOptions,runningUploads:computed(()=>runningUploads.value),setGlobalOptions,addFiles,startUpload,pauseUpload,resumeUpload,cancelUpload,retryUpload,removeUploadItem,clearQueue,clearAllSessions,cleanup,formatFileSize:uploadConfig2.formatFileSize,isValidFileType:file=>uploadConfig2.isAllowedFileType(file.type)}}),_hoisted_1$1w=["title"],_hoisted_2$1p={class:"button-content"},_hoisted_3$1e={key:0,class:"queue-badge"},_sfc_main$1H=defineComponent({name:"UploadFloatButton",__name:"index",setup(__props){const{$t:$t2}=useTexts(),router2=useRouter(),route=useRoute(),uploadStore=useUploadStore(),authStore=useAuthStore(),fileInput=ref(),isDragging=ref(!1),dragOffset=ref({x:0,y:0}),currentPosition=ref({x:0,y:0}),dragStartTime=ref(0),getSavedPosition=()=>StorageUtil.get("upload-float-button-position"),savePosition=(x,y)=>{StorageUtil.set("upload-float-button-position",{x,y})},initializePosition=()=>{const savedPos=getSavedPosition(),{innerWidth:windowWidth,innerHeight:windowHeight}=window,elementSize=70;let x,y;savedPos&&savedPos.x!==0&&savedPos.y!==0&&savedPos.x>=0&&savedPos.y>=0&&savedPos.x+elementSize<=windowWidth&&savedPos.y+elementSize<=windowHeight?(x=savedPos.x,y=savedPos.y):(x=windowWidth-elementSize-100,y=windowHeight-elementSize-150),currentPosition.value.x=Math.max(0,Math.min(x,windowWidth-elementSize)),currentPosition.value.y=Math.max(0,Math.min(y,windowHeight-elementSize))},floatStyle=computed(()=>({position:"fixed",zIndex:1e3,pointerEvents:"auto",userSelect:"none",cursor:isDragging.value?"grabbing":"grab",left:`${currentPosition.value.x}px`,top:`${currentPosition.value.y}px`,transform:"none"})),handleMouseDown=e=>{dragStartTime.value=Date.now();const rect=e.currentTarget.getBoundingClientRect();dragOffset.value={x:e.clientX-rect.left,y:e.clientY-rect.top},currentPosition.value={x:rect.left,y:rect.top},isDragging.value=!0,document.addEventListener("mousemove",handleMouseMove,{passive:!1}),document.addEventListener("mouseup",handleMouseUp,{passive:!1}),e.preventDefault(),e.stopPropagation()},handleMouseMove=e=>{if(!isDragging.value)return;const elementSize=70,maxX=window.innerWidth-elementSize,maxY=window.innerHeight-elementSize;currentPosition.value.x=Math.max(0,Math.min(e.clientX-dragOffset.value.x,maxX)),currentPosition.value.y=Math.max(0,Math.min(e.clientY-dragOffset.value.y,maxY)),e.preventDefault()},handleMouseUp=e=>{isDragging.value&&(isDragging.value=!1,savePosition(currentPosition.value.x,currentPosition.value.y),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),e.preventDefault(),e.stopPropagation())},handleClick=()=>{Date.now()-dragStartTime.value<200&&fileInput.value?.click()},handleFileSelect=async event=>{const{files}=event.target;files&&files.length>0&&(await uploadStore.addFiles(files),router2.push("/upload")),fileInput.value&&(fileInput.value.value="")},isDragOver=ref(!1),handleDragOver=e=>{e.dataTransfer?.types.includes("Files")&&(isDragOver.value=!0)},handleDragLeave=()=>{isDragOver.value=!1},handleDrop=async e=>{isDragOver.value=!1;const files=e.dataTransfer?.files;files&&files.length>0&&(await uploadStore.addFiles(files),router2.push("/upload"))},visible=computed(()=>authStore.isLoggedIn?["/dashboard","/folders","/resource"].some(allowedRoute=>route.path.startsWith(allowedRoute)):!1);return onMounted(()=>{initializePosition(),window.addEventListener("resize",initializePosition)}),onUnmounted(()=>{window.removeEventListener("resize",initializePosition),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-float"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["upload-float-button",{"drag-over":isDragOver.value,"has-files":unref(uploadStore).statistics.total>0,dragging:isDragging.value}]),style:normalizeStyle(floatStyle.value),title:unref(uploadStore).statistics.total>0?unref($t2)("upload.queueHasFiles",{count:unref(uploadStore).statistics.total}):unref($t2)("upload.uploadFiles"),onMousedown:handleMouseDown,onClick:handleClick,onDragover:withModifiers(handleDragOver,["prevent"]),onDragleave:withModifiers(handleDragLeave,["prevent"]),onDrop:withModifiers(handleDrop,["prevent"])},[createBaseVNode("div",_hoisted_2$1p,[_cache[0]||(_cache[0]=createBaseVNode("div",{class:"upload-icon"},[createBaseVNode("i",{class:"fas fa-cloud-upload-alt"})],-1)),unref(uploadStore).statistics.total>0?(openBlock(),createElementBlock("div",_hoisted_3$1e,toDisplayString(unref(uploadStore).statistics.total),1)):createCommentVNode("",!0)]),createBaseVNode("input",{ref_key:"fileInput",ref:fileInput,type:"file",multiple:"",accept:"image/*",style:{display:"none"},onChange:handleFileSelect},null,544)],46,_hoisted_1$1w)):createCommentVNode("",!0)]),_:1})]))}});const __unplugin_components_0$5=_export_sfc(_sfc_main$1H,[["__scopeId","data-v-a45026ad"]]),initBaiduAnalytics=siteId=>{try{if(typeof window>"u"||window._hmt&&document.querySelector(`script[src*="hm.baidu.com/hm.js?${siteId}"]`))return;window._hmt=window._hmt||[];const hm=document.createElement("script");hm.src=`https://hm.baidu.com/hm.js?${siteId}`,hm.onerror=()=>{console.error("[Baidu Analytics] Failed to load script")};const s=document.getElementsByTagName("script")[0];s.parentNode?.insertBefore(hm,s)}catch(error2){console.error("[Baidu Analytics] Failed to initialize:",error2)}},checkBaiduAnalytics=()=>{const initialized=!!(window._hmt&&window._hmt.length>=0),script=document.querySelector('script[src*="hm.baidu.com/hm.js"]'),scriptLoaded=!!script,siteId=script?.src.match(/hm\.js\?(.+)$/)?.[1];return{initialized,siteId,scriptLoaded}},initGoogleAnalytics=measurementId=>{try{if(typeof window>"u"||window.gtag&&document.querySelector(`script[src*="googletagmanager.com/gtag/js?id=${measurementId}"]`))return;window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)};const script=document.createElement("script");script.async=!0,script.src=`https://www.googletagmanager.com/gtag/js?id=${measurementId}`,script.onload=()=>{window.gtag("js",new Date),window.gtag("config",measurementId)},script.onerror=()=>{console.error("[Google Analytics] Failed to load script")};const firstScript=document.getElementsByTagName("script")[0];firstScript.parentNode?.insertBefore(script,firstScript)}catch(error2){console.error("[Google Analytics] Failed to initialize:",error2)}},checkGoogleAnalytics=()=>{const initialized=!!(window.gtag&&window.dataLayer),script=document.querySelector('script[src*="googletagmanager.com/gtag/js"]'),scriptLoaded=!!script,measurementId=script?.src.match(/id=(G-[A-Z0-9]+)/)?.[1];return{initialized,measurementId,scriptLoaded}},_sfc_main$1G=defineComponent({__name:"App",setup(__props){const showUploadDrawer=ref(!1),route=useRoute(),settingsStore=useSettingsStore(),shouldShowUploadFloat=computed(()=>!["/auth","/setup","/docs","/refuse"].some(r=>route.path.startsWith(r)));return watch(()=>[settingsStore.baiduEnabled,settingsStore.baiduSiteId],([enabled,siteId])=>{enabled&&siteId&&initBaiduAnalytics(siteId)},{immediate:!0}),watch(()=>[settingsStore.googleEnabled,settingsStore.googleMeasurementId],([enabled,measurementId])=>{enabled&&measurementId&&initGoogleAnalytics(measurementId)},{immediate:!0}),(_ctx,_cache)=>{const _component_router_view=resolveComponent("router-view"),_component_UploadFloatButton=__unplugin_components_0$5,_component_CyberGlobalUploadFloat=resolveComponent("CyberGlobalUploadFloat"),_component_CyberGlobalUploadDrawer=resolveComponent("CyberGlobalUploadDrawer"),_component_CyberDrawer=resolveComponent("CyberDrawer");return openBlock(),createElementBlock(Fragment,null,[createVNode(_component_router_view),shouldShowUploadFloat.value?(openBlock(),createBlock(_component_UploadFloatButton,{key:0})):createCommentVNode("",!0),shouldShowUploadFloat.value?(openBlock(),createBlock(_component_CyberGlobalUploadFloat,{key:1,onOpenDrawer:_cache[0]||(_cache[0]=$event=>showUploadDrawer.value=!0)})):createCommentVNode("",!0),shouldShowUploadFloat.value?(openBlock(),createBlock(_component_CyberDrawer,{key:2,modelValue:showUploadDrawer.value,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>showUploadDrawer.value=$event),title:_ctx.$t("app.uploadQueue"),width:"480px","mask-closable":!0},{"title-icon":withCtx(()=>[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fas fa-cloud-upload-alt text-content"},null,-1)])]),default:withCtx(()=>[createVNode(_component_CyberGlobalUploadDrawer,{onClose:_cache[1]||(_cache[1]=$event=>showUploadDrawer.value=!1)})]),_:1},8,["modelValue","title"])):createCommentVNode("",!0)],64)}}});const DEFAULT_CONFIG={sidebarWidth:210,collapsedWidth:50,breakpoints:{mobile:768,tablet:1024,desktop:1280}},useLayoutStore=defineStore("layout",{state:()=>{const savedMode=StorageUtil.get(LAYOUT_MODE_KEY);return{mode:savedMode==="top"||savedMode==="left"?savedMode:"top",sidebarCollapsed:StorageUtil.get(SIDEBAR_COLLAPSED_KEY)||!1,config:DEFAULT_CONFIG}},getters:{isTopLayout:state=>state.mode==="top",isLeftLayout:state=>state.mode==="left",canToggleLayout:()=>useSettingsStore().enableMultiLayout??!1,currentSidebarWidth:state=>state.mode==="top"?0:state.sidebarCollapsed?state.config.collapsedWidth:state.config.sidebarWidth,mainContentMargin:state=>state.mode==="top"?0:state.sidebarCollapsed?state.config.collapsedWidth:state.config.sidebarWidth,layoutClasses:state=>({"layout-top":state.mode==="top","layout-left":state.mode==="left","sidebar-collapsed":state.sidebarCollapsed}),containerStyle:state=>state.mode==="top"?{}:{marginLeft:`${state.sidebarCollapsed?state.config.collapsedWidth:state.config.sidebarWidth}px`}},actions:{async initializeLayout(){const settingsStore=useSettingsStore();settingsStore.isLoaded||await settingsStore.loadGlobalSettings();const multiLayoutEnabled=settingsStore.enableMultiLayout,rawDefaultLayout=settingsStore.defaultLayout,rawUserSelectedLayout=StorageUtil.get(LAYOUT_MODE_KEY),defaultLayout=(layout=>layout==="top"||layout==="left"?layout:"top")(rawDefaultLayout),userSelectedLayout=rawUserSelectedLayout==="top"||rawUserSelectedLayout==="left"?rawUserSelectedLayout:null;if(multiLayoutEnabled){const targetLayout=userSelectedLayout||defaultLayout;this.setLayoutMode(targetLayout)}else{const targetLayout=defaultLayout;this.setLayoutMode(targetLayout)}},setLayoutMode(mode){this.mode=mode,StorageUtil.set(LAYOUT_MODE_KEY,mode),mode==="top"&&this._resetSidebarState()},toggleLayoutMode(){const newMode=this.mode==="left"?"top":"left";return this.setLayoutMode(newMode),newMode},toggleSidebar(){this.mode==="left"&&(this.sidebarCollapsed=!this.sidebarCollapsed,this._saveSidebarState())},setSidebarCollapsed(collapsed){this.mode==="left"&&(this.sidebarCollapsed=collapsed,this._saveSidebarState())},handleResize(width){if(this.mode==="left"){const{tablet,desktop}=this.config.breakpoints;width<tablet?this.setSidebarCollapsed(!0):width>=desktop&&this.setSidebarCollapsed(!1)}},_saveSidebarState(){StorageUtil.set(SIDEBAR_COLLAPSED_KEY,this.sidebarCollapsed)},_resetSidebarState(){this.sidebarCollapsed=!1,this._saveSidebarState()}}}),routes=[{path:"/",component:()=>__vitePreload(()=>import("./MainLayout-62b46b65.js"),["js/MainLayout-62b46b65.js","js/vue-vendor-31320f47.js","js/FolderBreadcrumb-9a556665.js","assets/FolderBreadcrumb-f5b99cd2.css","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/MainLayout-86459432.css","assets/lightbox-594f31d9.css"]),children:[{path:"",name:"home",component:()=>__vitePreload(()=>import("./index-2b2928be.js"),["js/index-2b2928be.js","js/editor-markdown-0b2e1ce5.js","js/vue-vendor-31320f47.js","assets/editor-markdown-b9033212.css","js/index-121a3036.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-ea4b6d98.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.home"}},{path:"explore",name:"explore",component:()=>__vitePreload(()=>import("./index-e7c5fd49.js"),["js/index-e7c5fd49.js","js/vue-vendor-31320f47.js","js/filterOptions-1ed3ac9a.js","js/index-121a3036.js","js/EmptyState-d1c9e231.js","assets/EmptyState-93363cb4.css","js/CreateShareDialog-15304665.js","js/index-cecfa401.js","js/clipboard-b54d9428.js","assets/CreateShareDialog-7fd46af8.css","js/useLoading-8da70177.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-aae2be5f.css","assets/selection-9f9decd8.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.explore"}},{path:"upload",name:"upload",component:()=>__vitePreload(()=>import("./index-dc26e712.js"),["js/index-dc26e712.js","js/vue-vendor-31320f47.js","js/virtual-scroller-ec106627.js","assets/virtual-scroller-04df68c2.css","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-232acffb.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.upload"}},{path:"dashboard",name:"dashboard",component:()=>__vitePreload(()=>import("./index-69e523d7.js"),["js/index-69e523d7.js","js/vue-vendor-31320f47.js","js/draggable-5c726607.js","js/echarts-79943a2a.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-235fb4ef.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.dashboard"}},{path:"messages",name:"messages",component:()=>__vitePreload(()=>import("./index-40db72f1.js"),["js/index-40db72f1.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-a7b900ac.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.messages"}},{path:"resource",name:"resource",component:()=>__vitePreload(()=>import("./index-60855659.js"),["js/index-60855659.js","js/vue-vendor-31320f47.js","js/useResponsivePageSize-3b6a8f45.js","js/index-121a3036.js","js/filterOptions-1ed3ac9a.js","js/CreateShareDialog-15304665.js","js/index-cecfa401.js","js/clipboard-b54d9428.js","assets/CreateShareDialog-7fd46af8.css","js/EmptyState-d1c9e231.js","assets/EmptyState-93363cb4.css","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-4fa10890.css","assets/selection-9f9decd8.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.resource"}},{path:"folders",name:"folders",component:()=>__vitePreload(()=>import("./index-12805048.js"),["js/index-12805048.js","js/vue-vendor-31320f47.js","js/CreateShareDialog-15304665.js","js/index-cecfa401.js","js/clipboard-b54d9428.js","assets/CreateShareDialog-7fd46af8.css","js/draggable-5c726607.js","js/FilesGridView-50f28b1b.js","js/dialog-751d4bcf.js","assets/FilesGridView-361c8999.css","js/FolderBreadcrumb-9a556665.js","assets/FolderBreadcrumb-f5b99cd2.css","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-7d26e37a.css","assets/selection-9f9decd8.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.folders"}},{path:"folders/:folderPath*",name:"foldersWithPath",component:()=>__vitePreload(()=>import("./index-12805048.js"),["js/index-12805048.js","js/vue-vendor-31320f47.js","js/CreateShareDialog-15304665.js","js/index-cecfa401.js","js/clipboard-b54d9428.js","assets/CreateShareDialog-7fd46af8.css","js/draggable-5c726607.js","js/FilesGridView-50f28b1b.js","js/dialog-751d4bcf.js","assets/FilesGridView-361c8999.css","js/FolderBreadcrumb-9a556665.js","assets/FolderBreadcrumb-f5b99cd2.css","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-7d26e37a.css","assets/selection-9f9decd8.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.folders"}},{path:"shares",name:"shares",component:()=>__vitePreload(()=>import("./index-a039591f.js"),["js/index-a039591f.js","js/vue-vendor-31320f47.js","js/index-cecfa401.js","js/clipboard-b54d9428.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-ea20b8be.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.shares"}},{path:"settings",name:"settings",component:()=>__vitePreload(()=>import("./index-1bba4e9b.js"),["js/index-1bba4e9b.js","js/vue-vendor-31320f47.js","js/index-ba06884f.js","js/index-f018b591.js","js/index-cecfa401.js","js/index-62f7003b.js","js/storageOptions-66a07ca4.js","js/dialog-751d4bcf.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-5d8dd6b5.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.settings"}},{path:"tag-manage",name:"tagManage",component:()=>__vitePreload(()=>import("./index-ed8086a1.js"),["js/index-ed8086a1.js","js/vue-vendor-31320f47.js","js/pinyin-291c7dd8.js","js/pinyin-02edb7aa.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-7c6c4ef3.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.tagManage"}},{path:"category-manage",name:"categoryManage",component:()=>__vitePreload(()=>import("./index-a979c353.js"),["js/index-a979c353.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-302b9bde.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.categoryManage"}},{path:"automation",name:"automation",component:()=>__vitePreload(()=>import("./index-bc46bd10.js"),["js/index-bc46bd10.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-7425ad71.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.automation"}},{path:"open-api",name:"openApi",component:()=>__vitePreload(()=>import("./index-0d7ba729.js"),["js/index-0d7ba729.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-58d94f75.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,title:"routes.openApi"}},{path:"random",name:"random",component:()=>__vitePreload(()=>import("./index-3c3f314a.js"),["js/index-3c3f314a.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-5f15ff16.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.random"}}]},{path:"/hive",name:"hive",component:()=>__vitePreload(()=>import("./index-0718eaf7.js"),["js/index-0718eaf7.js","js/vue-vendor-31320f47.js","js/index-121a3036.js","js/domUtils-0c63d6d8.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-dcd94f08.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.hive",skipAuth:!0}},{path:"/docs",name:"docs",component:()=>__vitePreload(()=>import("./index-d0b8435a.js"),["js/index-d0b8435a.js","js/vue-vendor-31320f47.js","js/highlight-core-d3d00c28.js","js/highlight-common-d6c232ae.js","js/highlight-other-84e6ee74.js","assets/highlight-core-b334430f.css","js/filterOptions-1ed3ac9a.js","js/navigationOptions-d958d3cc.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-c8bf0436.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.docs"}},{path:"/author/:id",name:"author",component:()=>__vitePreload(()=>import("./index-2f37ae15.js"),["js/index-2f37ae15.js","js/vue-vendor-31320f47.js","js/index-62f7003b.js","js/FolderBreadcrumb-9a556665.js","assets/FolderBreadcrumb-f5b99cd2.css","js/FilesGridView-50f28b1b.js","js/draggable-5c726607.js","js/dialog-751d4bcf.js","assets/FilesGridView-361c8999.css","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-41a523ec.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.author",skipAuth:!0}},{path:"/author/:authorId/folder/:folderId",name:"authorFolder",component:()=>__vitePreload(()=>import("./folder-62cab713.js"),["js/folder-62cab713.js","js/vue-vendor-31320f47.js","js/index-62f7003b.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/folder-9b70ae29.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.authorFolder",skipAuth:!0}},{path:"/share/:key",name:"share",component:()=>__vitePreload(()=>import("./index-4f2af732.js"),["js/index-4f2af732.js","js/vue-vendor-31320f47.js","js/vueuse-2480d07f.js","js/FolderBreadcrumb-9a556665.js","assets/FolderBreadcrumb-f5b99cd2.css","js/index-cecfa401.js","js/domUtils-0c63d6d8.js","js/jszip-101de1ae.js","js/highlight-common-d6c232ae.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/comlink-c7be92b7.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-a8d4c0ad.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.share",skipAuth:!0}},{path:"/auth",name:"auth",component:()=>__vitePreload(()=>import("./index-f08a12bb.js"),["js/index-f08a12bb.js","js/vue-vendor-31320f47.js","js/useLoading-8da70177.js","js/auth-eda49e32.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/oauth-e58d389a.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/vue-table-79795ca5.js","assets/index-50f7c282.css","assets/lightbox-594f31d9.css"]),meta:{guest:!0,title:"routes.auth"}},{path:"/reset-password",name:"resetPassword",component:()=>__vitePreload(()=>import("./index-07216e10.js"),["js/index-07216e10.js","js/vue-vendor-31320f47.js","js/auth-eda49e32.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-cf93caeb.css","assets/lightbox-594f31d9.css"]),meta:{guest:!0,title:"routes.resetPassword",skipAuth:!0}},{path:"/setup",name:"setup",component:()=>__vitePreload(()=>import("./index-c2098936.js"),["js/index-c2098936.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-f5ba3b1a.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.setup",skipAuth:!0}},{path:"/admin",name:"admin",component:()=>__vitePreload(()=>import("./AdminLayout-8603ed49.js"),["js/AdminLayout-8603ed49.js","js/vue-vendor-31320f47.js","js/websocket-626c23bb.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/navigationOptions-d958d3cc.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/AdminLayout-2a67924c.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.admin"},redirect:"/admin/dashboard",children:[{path:"dashboard",name:"adminDashboard",component:()=>__vitePreload(()=>import("./index-842fd5dd.js"),["js/index-842fd5dd.js","js/vue-vendor-31320f47.js","js/index-c3ee96be.js","js/index-2a7fa302.js","js/echarts-79943a2a.js","js/useResponsivePageSize-3b6a8f45.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-f52c3108.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminDashboard"}},{path:"users",name:"adminUsers",component:()=>__vitePreload(()=>import("./index-893a5276.js"),["js/index-893a5276.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/dialog-751d4bcf.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-e40f7b71.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminUsers"}},{path:"channels",name:"adminChannels",component:()=>__vitePreload(()=>import("./index-452c16f8.js"),["js/index-452c16f8.js","js/index-f018b591.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-6e9fe2a5.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminChannels"}},{path:"settings",name:"adminSettings",component:()=>__vitePreload(()=>import("./index-3d8d9f8c.js"),["js/index-3d8d9f8c.js","js/vue-vendor-31320f47.js","js/defaults-c53003a8.js","js/oauth-e58d389a.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-f9193db8.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminSettings"}},{path:"files",name:"adminFiles",component:()=>__vitePreload(()=>import("./index-25826b2b.js"),["js/index-25826b2b.js","js/vue-vendor-31320f47.js","js/filterOptions-1ed3ac9a.js","js/storageOptions-66a07ca4.js","js/useResponsivePageSize-3b6a8f45.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-b3d72b90.css","assets/selection-9f9decd8.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminFiles"}},{path:"tags",name:"adminTags",component:()=>__vitePreload(()=>import("./index-ec3acb15.js"),["js/index-ec3acb15.js","js/index-ba06884f.js","js/vue-vendor-31320f47.js","js/pinyin-291c7dd8.js","js/pinyin-02edb7aa.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-ffe63cfd.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminTags"}},{path:"categories",name:"adminCategories",component:()=>__vitePreload(()=>import("./index-bb4c8ab2.js"),["js/index-bb4c8ab2.js","js/dialog-751d4bcf.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-2ef6e6fc.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminCategories"}},{path:"tagging",name:"adminTagging",component:()=>__vitePreload(()=>import("./index-9a273789.js"),["js/index-9a273789.js","js/vue-vendor-31320f47.js","js/websocket-626c23bb.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/index-c3ee96be.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-eebb73db.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminTagging"}},{path:"vectors",name:"adminVectors",component:()=>__vitePreload(()=>import("./index-d82394a7.js"),["js/index-d82394a7.js","js/websocket-626c23bb.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/index-2a7fa302.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-bc7c2e43.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminVectors"}},{path:"ai",name:"adminAI",component:()=>__vitePreload(()=>import("./index-f3dc83c6.js"),["js/index-f3dc83c6.js","js/vue-vendor-31320f47.js","js/defaults-c53003a8.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-430b5db0.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminAI"}},{path:"shares",name:"adminShares",component:()=>__vitePreload(()=>import("./index-cc209067.js"),["js/index-cc209067.js","js/vue-vendor-31320f47.js","js/index-cecfa401.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-16861863.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminShares"}},{path:"construction",name:"adminConstruction",component:()=>__vitePreload(()=>import("./index-4ef2a4b0.js"),["js/index-4ef2a4b0.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/index-389672fa.js","js/defaults-c53003a8.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-c750419f.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminConstruction"}},{path:"announcements",name:"adminAnnouncements",component:()=>__vitePreload(()=>import("./index-9537bc87.js"),["js/index-9537bc87.js","js/dialog-751d4bcf.js","js/editor-markdown-0b2e1ce5.js","js/vue-vendor-31320f47.js","assets/editor-markdown-b9033212.css","js/index-389672fa.js","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-a7ed9f97.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminAnnouncements"}},{path:"content-review",name:"adminContentReview",component:()=>__vitePreload(()=>import("./index-7431c17b.js"),["js/index-7431c17b.js","js/vue-vendor-31320f47.js","js/useResponsivePageSize-3b6a8f45.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-d05e5d02.css","assets/lightbox-594f31d9.css"]),meta:{requiresAuth:!0,requiresAdmin:!0,title:"routes.adminContentReview"}}]},{path:"/404",name:"notFound",component:()=>__vitePreload(()=>import("./index-af9c2196.js"),["js/index-af9c2196.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-f77557f5.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.notFound"}},{path:"/refuse",name:"refuse",component:()=>__vitePreload(()=>import("./index-44f66f08.js"),["js/index-44f66f08.js","js/index-121a3036.js","js/vue-vendor-31320f47.js","js/editor-markdown-0b2e1ce5.js","assets/editor-markdown-b9033212.css","js/axios-c2a59b9f.js","js/spark-md5-d0a97131.js","js/highlight-common-d6c232ae.js","js/comlink-c7be92b7.js","js/vueuse-2480d07f.js","js/marked-e9418aa8.js","js/dompurify-76a35038.js","js/vue-table-79795ca5.js","assets/index-ad687896.css","assets/lightbox-594f31d9.css"]),meta:{title:"routes.refuse",skipAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/404"}];function getInstallStatus(){return get("/setup/status")}function testDatabaseConnection(data){return post("/setup/test-connection",data)}function installSystem(data){return post("/setup/install",data)}const setupApi={getInstallStatus,testDatabaseConnection,installSystem},IP_RESTRICTED_KEY="ip_restricted",USER_DISABLED_KEY="user_disabled",router=createRouter({history:createWebHistory(),routes,scrollBehavior(to,from,savedPosition){return savedPosition||{top:0,left:0,behavior:"instant"}}});router.beforeEach(async(to,from,next)=>{const authStore=useAuthStore(),layoutStore=useLayoutStore(),requiresAuth=to.matched.some(record=>record.meta.requiresAuth),requiresAdmin=to.matched.some(record=>record.meta.requiresAdmin),skipAuth=to.matched.some(record=>record.meta.skipAuth),isIpRestricted=StorageUtil.get(IP_RESTRICTED_KEY)==="true",isUserDisabled=StorageUtil.get(USER_DISABLED_KEY)==="true",isAccessRestricted=isIpRestricted||isUserDisabled;if(isAccessRestricted&&to.name!=="refuse")return next({name:"refuse"});if(to.name==="refuse"&&!isAccessRestricted)return next({path:"/"});if(to.name==="setup")try{if((await setupApi.getInstallStatus()).data.installed)return next({path:"/"})}catch{}authStore.initialized||authStore.initAuth();const isAdmin=[1,2].includes(authStore.userInfo?.role);if(to.path==="/"&&layoutStore.isLeftLayout)return next({path:"/dashboard"});if(to.name==="auth"&&authStore.isLoggedIn){const targetPath=layoutStore.isLeftLayout?"/dashboard":"/";return next({path:targetPath})}if(skipAuth)next();else if(requiresAuth&&!authStore.isLoggedIn){const redirectQuery={redirect:to.fullPath};next({path:"/auth",query:redirectQuery})}else requiresAdmin&&!isAdmin?next({path:"/"}):next()});router.afterEach(async to=>{const titleKey=to.meta.title;if(titleKey){const settingsStore=useSettingsStore(),textThemeStore=useTextThemeStore(),siteName=settingsStore.siteName;if(textThemeStore.isInitializing){const checkInterval=setInterval(()=>{if(!textThemeStore.isInitializing&&textThemeStore.localeData){clearInterval(checkInterval);const{$t:$t2}=useTexts(),title=$t2(titleKey);document.title=`${title} - ${siteName}`}},50);setTimeout(()=>clearInterval(checkInterval),3e3)}else if(textThemeStore.localeData){const{$t:$t2}=useTexts(),title=$t2(titleKey);document.title=`${title} - ${siteName}`}else document.title=`${titleKey} - ${siteName}`}typeof window<"u"&&window._hmt&&window._hmt.push(["_trackPageview",to.fullPath]),typeof window<"u"&&(window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0,setTimeout(()=>{const contentBody=document.querySelector(".content-body");contentBody&&(contentBody.scrollTop=0);const adminContentWrapper=document.querySelector(".admin-content-wrapper");adminContentWrapper&&(adminContentWrapper.scrollTop=0)},0))});const lazyElements=new Map;let observer=null;const createObserver=()=>{"IntersectionObserver"in window&&(observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){const element=entry.target,loadHandler=lazyElements.get(element);loadHandler&&(loadHandler(),observer?.unobserve(element),lazyElements.delete(element))}})},{rootMargin:"100px",threshold:.1}))},lazy={mounted(el,binding){if(observer||createObserver(),!observer){if(el.tagName==="IMG"){const img=el,dataSrc=img.getAttribute("data-src");dataSrc&&(img.src=dataSrc,img.removeAttribute("data-src"))}el.style.opacity="1";return}if(!(binding.value!==!1)){if(el.tagName==="IMG"){const img=el,dataSrc=img.getAttribute("data-src");dataSrc&&(img.src=dataSrc,img.removeAttribute("data-src"))}el.style.opacity="1";return}if(el.tagName==="IMG"){const img=el;img.src&&(img.setAttribute("data-src",img.src),img.removeAttribute("src"))}el.style.opacity="0",el.style.transition="opacity 0.3s ease-in-out";const loadHandler=()=>{if(el.tagName==="IMG"){const img=el,dataSrc=img.getAttribute("data-src");dataSrc?(img.src=dataSrc,img.removeAttribute("data-src"),img.onload=()=>{el.style.opacity="1"},img.onerror=()=>{el.style.opacity="1"}):el.style.opacity="1"}else el.style.opacity="1"};lazyElements.set(el,loadHandler),observer.observe(el)},updated(el,binding){if(!(binding.value!==!1)&&el.style.opacity==="0"){if(el.tagName==="IMG"){const img=el,dataSrc=img.getAttribute("data-src");dataSrc&&(img.src=dataSrc,img.removeAttribute("data-src"))}el.style.opacity="1",observer?.unobserve(el),lazyElements.delete(el)}},beforeUnmount(el){observer?.unobserve(el),lazyElements.delete(el)}},lazyDirective={install(app){app.directive("lazy",lazy)}},loadingInstances=new Map,getTranslation=key=>{try{const{$t:$t2}=useTexts();return $t2(key)}catch{return"Loading..."}},LoadingComponent={name:"VLoadingComponent",props:{text:{type:String,default:""},background:{type:String,default:"rgba(var(--color-background-800-rgb), 0.85)"},textColor:{type:String,default:"var(--color-cyber-blue)"},type:{type:String,default:"default",validator:value=>["default","progress","pulse"].includes(value)},progress:{type:Number,default:0,validator:value=>value>=0&&value<=100},loading:{type:Boolean,default:!0}},computed:{displayText(){return this.text||getTranslation("status.loading")}},data(){return{animatedProgress:this.type==="progress"?Math.max(5,this.progress):Math.floor(Math.random()*100),progressTimer:null}},mounted(){this.type==="progress"&&this.animateProgress()},watch:{loading(newValue){this.type==="progress"&&!newValue&&this.completeProgress()}},beforeUnmount(){this.progressTimer&&clearTimeout(this.progressTimer)},methods:{animateProgress(){if(!this.loading)return;const increment=()=>{if(this.loading&&this.animatedProgress<85){const rate=this.animatedProgress>70?.3:2;this.animatedProgress=Math.min(85,this.animatedProgress+Math.random()*rate),this.progressTimer=setTimeout(increment,Math.random()*400+300)}};increment()},completeProgress(){this.progressTimer&&clearTimeout(this.progressTimer);const complete=()=>{this.animatedProgress<100&&(this.animatedProgress=Math.min(100,this.animatedProgress+8),setTimeout(complete,50))};complete()}},render(){const renderText=(size=null,forceHide=!1)=>{if(!this.displayText||forceHide)return null;const textSize=size?.fontSize||"14px";return size?.showText!==!1?h("div",{class:"loading-text",style:{fontSize:textSize,fontWeight:"500",color:"var(--color-brand-400)",textAlign:"center",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginTop:size?.containerSize==="tiny"?"1px":"2px",letterSpacing:"0.3px",textShadow:"0 0 8px rgba(var(--color-brand-500-rgb), 0.6)",opacity:"0.9",animation:"textFade 1.5s ease-in-out infinite"}},this.displayText):null},getResponsiveSize=()=>{const containerRect=this.$el?.parentElement?.getBoundingClientRect()||{width:300,height:200},containerWidth=Math.min(containerRect.width,containerRect.height);let containerSize,iconSize,fontSize,showText;return containerWidth<80?(containerSize="tiny",iconSize=Math.max(30,containerWidth*.6),fontSize="10px",showText=!1):containerWidth<120?(containerSize="small",iconSize=Math.max(32,containerWidth*.4),fontSize="10px",showText=containerWidth>100):containerWidth<200?(containerSize="medium",iconSize=Math.max(45,containerWidth*.35),fontSize="12px",showText=!0):(containerSize="normal",iconSize=Math.max(60,Math.min(90,containerWidth*.35)),fontSize="14px",showText=!0),{containerSize,iconSize,fontSize,showText,animationSize:`${iconSize}px`,hexagonSize:`${Math.floor(iconSize*.6)}px`,gap:containerSize==="tiny"?"0.125rem":containerSize==="small"?"0.25rem":"0.375rem"}},renderDefaultType=()=>{const size=getResponsiveSize();return h("div",{class:"loading-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:size.gap,padding:"0.25rem"}},[h("div",{class:"simple-loading-core",style:{width:size.animationSize,height:size.animationSize,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}},[h("div",{class:"spinner-ring",style:{width:"100%",height:"100%",border:`${size.containerSize==="tiny"?"2px":"3px"} solid rgba(var(--color-brand-500-rgb), 0.15)`,borderTopColor:"var(--color-brand-500)",borderRadius:"50%",position:"absolute",animation:"smoothRotate 1.2s cubic-bezier(0.4, 0.0, 0.2, 1) infinite"}}),h("div",{class:"spinner-ring-middle",style:{width:"60%",height:"60%",border:`${size.containerSize==="tiny","2px"} solid rgba(var(--color-brand-400-rgb), 0.2)`,borderRightColor:"var(--color-brand-400)",borderRadius:"50%",position:"absolute",animation:"smoothRotate 1.8s cubic-bezier(0.4, 0.0, 0.2, 1) infinite reverse",opacity:.7}}),h("div",{class:"spinner-center",style:{position:"absolute",width:size.containerSize==="tiny"?"6px":"8px",height:size.containerSize==="tiny"?"6px":"8px",background:"var(--color-brand-500)",borderRadius:"50%",boxShadow:"0 0 12px rgba(var(--color-brand-500-rgb), 0.6)",animation:"centerGlow 2s ease-in-out infinite"}})]),renderText(size)])},renderProgressType=()=>{const size=getResponsiveSize(),progressHeight=size.containerSize==="tiny"?"8px":size.containerSize==="small"?"10px":"12px",progressWidth=size.containerSize==="tiny"?"120px":size.containerSize==="small"?"150px":"250px";return h("div",{class:"loading-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:size.gap,maxWidth:"100%",padding:"0.25rem"}},[h("div",{class:"cyber-progress-container",style:{width:"100%",maxWidth:progressWidth,position:"relative",marginBottom:"8px"}},[h("div",{class:"progress-track",style:{width:"100%",height:progressHeight,background:"rgba(30, 41, 59, 0.8)",borderRadius:"8px",position:"relative",overflow:"hidden",border:"2px solid #00d4ff",boxShadow:"0 0 15px rgba(0, 212, 255, 0.4)",backdropFilter:"blur(10px)"}},[h("div",{class:"progress-fill",style:{width:`${Math.max(5,this.animatedProgress||this.progress)}%`,height:"100%",background:"linear-gradient(90deg, #00d4ff, #ff0080)",borderRadius:"6px",position:"relative",transition:"width 0.5s ease-out",boxShadow:"0 0 20px #00d4ff, inset 0 0 10px rgba(255,255,255,0.2)",minWidth:"8px"}}),h("div",{class:"progress-scanner",style:{position:"absolute",top:"0",left:"0",width:"40px",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent)",animation:"progressScan 2.5s infinite linear",borderRadius:"6px",pointerEvents:"none"}})]),h("div",{class:"progress-text",style:{position:"absolute",top:`${parseInt(progressHeight)+12}px`,left:"50%",transform:"translateX(-50%)",color:"#00d4ff",fontSize:size.fontSize,fontWeight:"700",textShadow:"0 0 10px #00d4ff, 0 0 20px #00d4ff",fontFamily:"'Orbitron', sans-serif",letterSpacing:"1px"}},`${Math.floor(this.animatedProgress||this.progress)}%`)])])},renderPulseType=()=>{const size=getResponsiveSize();return h("div",{class:"loading-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:size.gap}},[h("div",{class:"pulse-rings",style:{position:"relative",width:`${size.iconSize}px`,height:`${size.iconSize}px`,display:"flex",alignItems:"center",justifyContent:"center"}},[h("div",{class:"pulse-ring pulse-ring-1"}),h("div",{class:"pulse-ring pulse-ring-2"}),h("div",{class:"pulse-ring pulse-ring-3"}),h("div",{style:{width:`${Math.max(8,size.iconSize*.1)}px`,height:`${Math.max(8,size.iconSize*.1)}px`,borderRadius:"50%",background:this.textColor,boxShadow:`0 0 ${Math.max(10,size.iconSize*.17)}px ${this.textColor}`,animation:"centerPulse 1.5s infinite"}})]),renderText(size)])};return h("div",{class:"v-loading-mask",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"var(--z-index-toast)",backdropFilter:"blur(3px)",background:"transparent",display:"flex",alignItems:"center",justifyContent:"center"}},[(()=>{switch(this.type){case"progress":return renderProgressType();case"pulse":return renderPulseType();default:return renderDefaultType()}})()])}},createLoadingInstance=(el,options={})=>{const app=createApp(LoadingComponent,{text:options.text||"",type:options.type||"default",progress:options.progress||0,loading:options.loading!==!1,background:options.background,textColor:options.textColor}),container=document.createElement("div"),instance2=app.mount(container);if(!document.querySelector("#v-loading-styles")){const style=document.createElement("style");style.id="v-loading-styles",style.textContent=`
      .hexagon::before,
      .hexagon::after,
      .hex-inner::before,
      .hex-inner::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        background: transparent;
        border: 2px solid var(--color-cyber-blue);
        animation: hexPulse 1.5s infinite alternate, hexGlitch 3s infinite;
      }

      .hexagon::before {
        clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      }

      .hexagon::after {
        clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        border-color: var(--color-cyber-pink);
        opacity: 0.7;
        animation-delay: 0.3s;
      }

      .hex-inner {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
      }

      .hex-inner::before {
        clip-path: polygon(50% 10%, 90% 30%, 90% 70%, 50% 90%, 10% 70%, 10% 30%);
        border-color: var(--color-cyber-blue);
        opacity: 0.3;
        transform: scale(0.8);
        animation-delay: 0.6s;
      }

      .hex-inner::after {
        clip-path: polygon(50% 20%, 80% 35%, 80% 65%, 50% 80%, 20% 65%, 20% 35%);
        border-color: var(--color-cyber-pink);
        opacity: 0.5;
        transform: scale(0.6);
        animation-delay: 0.9s;
      }

      .circle {
        position: absolute;
        border-radius: 50%;
        border: 1px solid transparent;
        animation: circlePulse 2s infinite;
      }

      .circle-1 {
        width: 50px;
        height: 50px;
        border-top-color: var(--color-cyber-blue);
        border-right-color: var(--color-cyber-blue);
        animation-delay: 0s;
      }

      .circle-2 {
        width: 70px;
        height: 70px;
        border-right-color: var(--color-cyber-pink);
        border-left-color: var(--color-cyber-pink);
        animation-delay: 0.3s;
      }

      .circle-3 {
        width: 90px;
        height: 90px;
        border-bottom-color: var(--color-primary);
        border-left-color: var(--color-primary);
        animation-delay: 0.6s;
      }

      .scan-line {
        position: absolute;
        width: 100%;
        height: 2px;
        background: linear-gradient(to right, transparent, var(--color-cyber-blue), var(--color-cyber-pink), transparent);
        animation: scanLine 1.5s infinite;
      }

      .text-glitch {
        position: relative;
        animation: textFlicker 3s infinite;
      }

      .text-glitch::before,
      .text-glitch::after {
        content: attr(data-text);
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0.8;
      }

      .text-glitch::before {
        left: 2px;
        color: var(--color-cyber-pink);
        text-shadow: -1px 0 var(--color-cyber-blue);
        clip: rect(44px, 450px, 56px, 0);
        animation: textGlitch 5s infinite linear alternate-reverse;
      }

      .text-glitch::after {
        left: -2px;
        color: var(--color-cyber-blue);
        text-shadow: 2px 0 var(--color-cyber-pink);
        clip: rect(44px, 450px, 56px, 0);
        animation: textGlitch 6s infinite linear alternate-reverse;
      }

      @keyframes hexPulse {
        0% { transform: scale(1); opacity: 1; }
        100% { transform: scale(1.1); opacity: 0.8; }
      }

      @keyframes hexGlitch {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-2px); }
        50% { transform: translateX(2px); }
        75% { transform: translateX(-1px); }
      }

      @keyframes circlePulse {
        0% { transform: rotate(0deg) scale(1); opacity: 0.8; }
        50% { transform: rotate(180deg) scale(1.2); opacity: 0.5; }
        100% { transform: rotate(360deg) scale(1); opacity: 0.8; }
      }

      @keyframes scanLine {
        0% { top: 0%; opacity: 0; }
        25% { opacity: 1; }
        75% { opacity: 1; }
        100% { top: 100%; opacity: 0; }
      }

      @keyframes textFlicker {
        0%, 100% { opacity: 1; }
        8%, 10% { opacity: 0.8; }
        9%, 50%, 70% { opacity: 1; }
        59.5%, 60%, 69.5% { opacity: 0.6; }
      }

      @keyframes textGlitch {
        0% { clip: rect(68px, 350px, 29px, 0); }
        5.88235% { clip: rect(52px, 350px, 16px, 0); }
        11.76471% { clip: rect(22px, 350px, 76px, 0); }
        17.64706% { clip: rect(60px, 350px, 56px, 0); }
        23.52941% { clip: rect(3px, 350px, 86px, 0); }
        29.41176% { clip: rect(87px, 350px, 47px, 0); }
        35.29412% { clip: rect(67px, 350px, 70px, 0); }
        41.17647% { clip: rect(84px, 350px, 23px, 0); }
        47.05882% { clip: rect(89px, 350px, 17px, 0); }
        52.94118% { clip: rect(38px, 350px, 92px, 0); }
        58.82353% { clip: rect(95px, 350px, 3px, 0); }
        64.70588% { clip: rect(12px, 350px, 5px, 0); }
        70.58824% { clip: rect(23px, 350px, 50px, 0); }
        76.47059% { clip: rect(18px, 350px, 30px, 0); }
        82.35294% { clip: rect(2px, 350px, 29px, 0); }
        88.23529% { clip: rect(42px, 350px, 15px, 0); }
        94.11765% { clip: rect(10px, 350px, 49px, 0); }
        100% { clip: rect(31px, 350px, 13px, 0); }
      }

      @keyframes progressScan {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }

      @keyframes energyRing {
        0% {
          transform: rotate(0deg) scale(1);
          filter: drop-shadow(0 0 10px #00d4ff) brightness(1);
        }
        33% {
          transform: rotate(120deg) scale(1.05);
          filter: drop-shadow(0 0 20px #ff0080) brightness(1.2);
        }
        66% {
          transform: rotate(240deg) scale(0.95);
          filter: drop-shadow(0 0 15px #00ff88) brightness(1.1);
        }
        100% {
          transform: rotate(360deg) scale(1);
          filter: drop-shadow(0 0 10px #00d4ff) brightness(1);
        }
      }

      @keyframes hexagonRotate {
        0% {
          transform: rotate(0deg) scale(1);
          opacity: 0.8;
        }
        25% {
          transform: rotate(90deg) scale(1.1);
          opacity: 1;
        }
        50% {
          transform: rotate(180deg) scale(0.9);
          opacity: 0.9;
        }
        75% {
          transform: rotate(270deg) scale(1.05);
          opacity: 1;
        }
        100% {
          transform: rotate(360deg) scale(1);
          opacity: 0.8;
        }
      }

      @keyframes coreGlow {
        0% {
          transform: scale(1) rotate(0deg);
          box-shadow: 0 0 30px #00d4ff, 0 0 60px #ff0080, inset 0 0 20px rgba(255,255,255,0.4);
          filter: brightness(1);
        }
        50% {
          transform: scale(1.1) rotate(180deg);
          box-shadow: 0 0 40px #ff0080, 0 0 80px #00ff88, inset 0 0 30px rgba(255,255,255,0.6);
          filter: brightness(1.3);
        }
        100% {
          transform: scale(1) rotate(360deg);
          box-shadow: 0 0 30px #00d4ff, 0 0 60px #ff0080, inset 0 0 20px rgba(255,255,255,0.4);
          filter: brightness(1);
        }
      }

      @keyframes dataFlow {
        0% { transform: rotate(0deg); opacity: 0.6; }
        50% { opacity: 1; }
        100% { transform: rotate(360deg); opacity: 0.6; }
      }

      @keyframes dataNodePulse {
        0% {
          transform: scale(1);
          opacity: 0.7;
        }
        100% {
          transform: scale(1.5);
          opacity: 1;
        }
      }

      @keyframes scanBeam {
        0% {
          transform: rotate(0deg);
          opacity: 0.8;
        }
        25% { opacity: 1; }
        50% {
          transform: rotate(180deg);
          opacity: 0.9;
        }
        75% { opacity: 1; }
        100% {
          transform: rotate(360deg);
          opacity: 0.8;
        }
      }

      @keyframes energyCore {
        0% {
          transform: scale(1);
          box-shadow: 0 0 20px #ffffff, 0 0 40px #00d4ff, 0 0 60px rgba(0, 212, 255, 0.3);
        }
        100% {
          transform: scale(1.3);
          box-shadow: 0 0 30px #ffffff, 0 0 60px #00d4ff, 0 0 90px rgba(0, 212, 255, 0.5);
        }
      }

      @keyframes gridShift {
        0% {
          transform: rotate(0deg);
          opacity: 0.3;
        }
        50% {
          opacity: 0.1;
        }
        100% {
          transform: rotate(360deg);
          opacity: 0.3;
        }
      }

      .pulse-ring {
        position: absolute;
        border: 2px solid var(--color-cyber-blue);
        border-radius: 50%;
        animation: pulseRing 2s infinite;
      }

      .pulse-ring-1 {
        width: 40px;
        height: 40px;
        animation-delay: 0s;
      }

      .pulse-ring-2 {
        width: 60px;
        height: 60px;
        border-color: var(--color-cyber-pink);
        animation-delay: 0.3s;
      }

      .pulse-ring-3 {
        width: 80px;
        height: 80px;
        border-color: var(--color-cyber-purple);
        animation-delay: 0.6s;
      }

      @keyframes pulseRing {
        0% {
          transform: scale(0.8);
          opacity: 1;
        }
        50% {
          transform: scale(1.2);
          opacity: 0.7;
        }
        100% {
          transform: scale(1.6);
          opacity: 0;
        }
      }

      @keyframes centerPulse {
        0%, 100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.5);
          opacity: 0.8;
        }
      }

      @keyframes smoothRotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes centerGlow {
        0%, 100% {
          transform: scale(1);
          opacity: 0.8;
          box-shadow: 0 0 12px rgba(var(--color-brand-500-rgb), 0.6);
        }
        50% {
          transform: scale(1.1);
          opacity: 1;
          box-shadow: 0 0 16px rgba(var(--color-brand-500-rgb), 0.8);
        }
      }

      @keyframes textFade {
        0%, 100% {
          opacity: 0.7;
        }
        50% {
          opacity: 1;
        }
      }

    `,document.head.appendChild(style)}return{instance:instance2,element:container.firstChild,app}},showLoading=(el,options={})=>{getComputedStyle(el).position==="static"&&(el.style.position="relative");const loadingInstance=createLoadingInstance(el,options);el.appendChild(loadingInstance.element),loadingInstances.set(el,loadingInstance)},hideLoading=el=>{const loadingInstance=loadingInstances.get(el);loadingInstance&&(loadingInstance.element&&loadingInstance.element.parentNode&&loadingInstance.element.parentNode.removeChild(loadingInstance.element),loadingInstance.app.unmount(),loadingInstances.delete(el))},parseLoadingOptions=value=>typeof value=="boolean"?{shouldShow:value,options:{}}:typeof value=="object"&&value!==null?{shouldShow:value.loading||value.visible||!1,options:value}:typeof value=="string"?{shouldShow:!0,options:{text:value}}:value?{shouldShow:!0,options:{}}:{shouldShow:!1,options:{}},loading={mounted(el,binding){const{shouldShow,options}=parseLoadingOptions(binding.value);shouldShow&&showLoading(el,options)},updated(el,binding){const{value,oldValue}=binding;if(value===oldValue)return;const isCurrentlyLoading=loadingInstances.has(el),{shouldShow,options}=parseLoadingOptions(value);if(shouldShow&&!isCurrentlyLoading)showLoading(el,options);else if(!shouldShow&&isCurrentlyLoading)hideLoading(el);else if(shouldShow&&isCurrentlyLoading){const currentInstance=loadingInstances.get(el);if(currentInstance&&currentInstance.app){const component=currentInstance.app._instance;component&&component.props?(Object.assign(component.props,{text:options.text||"",type:options.type||"default",progress:options.progress||0,loading:options.loading!==!1,background:options.background,textColor:options.textColor}),component.update?.()):(hideLoading(el),showLoading(el,options))}else hideLoading(el),showLoading(el,options)}},beforeUnmount(el){hideLoading(el)}},loadingDirective={install(app){app.directive("loading",loading)}},vLayoutAdaptive={mounted(el,binding){updateElementStyles(el,binding.value);const unwatch=useLayoutStore().$subscribe(()=>{updateElementStyles(el,binding.value)});el._layoutAdaptiveUnwatch=unwatch},updated(el,binding){updateElementStyles(el,binding.value)},unmounted(el){const unwatch=el._layoutAdaptiveUnwatch;unwatch&&(unwatch(),delete el._layoutAdaptiveUnwatch)}};function updateElementStyles(el,options={}){const store=useLayoutStore(),{top={},left={},common={}}=options;Object.entries(common).forEach(([property,value])=>{el.style.setProperty(property,value)});const targetStyles=store.isTopLayout?top:left;Object.entries(targetStyles).forEach(([property,value])=>{el.style.setProperty(property,value)}),el.classList.remove("layout-top","layout-left"),el.classList.add(store.isTopLayout?"layout-top":"layout-left"),options.pageType&&(Array.from(el.classList).forEach(cls=>{cls.startsWith("page-type-")&&el.classList.remove(cls)}),el.classList.add(`page-type-${options.pageType}`))}const vResponsiveSpacing={mounted(el,binding){updateSpacing(el,binding.value);const unwatch=useLayoutStore().$subscribe(()=>{updateSpacing(el,binding.value)});el._spacingUnwatch=unwatch},updated(el,binding){updateSpacing(el,binding.value)},unmounted(el){const unwatch=el._spacingUnwatch;unwatch&&(unwatch(),delete el._spacingUnwatch)}};function updateSpacing(el,spacingType="element"){const store=useLayoutStore(),spacingMap={element:store.isTopLayout?"1rem":"0.75rem",card:store.isTopLayout?"1.5rem":"1rem",section:store.isTopLayout?"2rem":"1.5rem"},spacing=spacingMap[spacingType]||spacingMap.element;el.style.setProperty("--responsive-spacing",spacing)}const vResponsiveGrid={mounted(el,binding){updateGrid(el,binding.value);const unwatch=useLayoutStore().$subscribe(()=>{updateGrid(el,binding.value)});el._gridUnwatch=unwatch},updated(el,binding){updateGrid(el,binding.value)},unmounted(el){const unwatch=el._gridUnwatch;unwatch&&(unwatch(),delete el._gridUnwatch)}};function updateGrid(el,options={}){const store=useLayoutStore(),{minWidth=300,gap}=options,adjustedMinWidth=store.isTopLayout?minWidth:Math.max(minWidth-50,200);el.style.display="grid",el.style.gridTemplateColumns=`repeat(auto-fill, minmax(${adjustedMinWidth}px, 1fr))`,gap?el.style.gap=gap:el.style.gap=store.isTopLayout?"1.5rem":"1rem"}const _hoisted_1$1v={key:0,class:"cyber-context-menu-item__divider"},_hoisted_2$1o={key:1,class:"cyber-context-menu-item__content"},_hoisted_3$1d={key:0,class:"cyber-context-menu-item__icon"},_hoisted_4$19={class:"cyber-context-menu-item__label"},_hoisted_5$12={key:1,class:"cyber-context-menu-item__shortcut"},_hoisted_6$W={key:2,class:"cyber-context-menu-item__arrow"},_hoisted_7$N={key:0,class:"cyber-context-menu-item__loading"},_hoisted_8$K={class:"cyber-context-menu-item__loading-text"},_hoisted_9$H={key:1,class:"cyber-context-menu-item__error"},_hoisted_10$E={class:"cyber-context-menu-item__error-text"},_sfc_main$1F=defineComponent({name:"CyberContextMenuItem",__name:"CyberContextMenuItem",props:{item:{},isFirst:{type:Boolean}},emits:["item-click"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,showSubMenu=ref(!1),isActive=ref(!1),isHovered=ref(!1),submenuRef=ref(),submenuStyle=ref({}),localChildren=ref(props.item.children??[]),isLoading2=ref(!1),loadError=ref(void 0),submenuOpensLeft=ref(!1);let openTimer=null;const hasChildren=computed(()=>localChildren.value&&localChildren.value.length>0||props.item.hasAsyncChildren);watch(()=>props.item.children,val=>{Array.isArray(val)&&(localChildren.value=val)}),watch([localChildren,isLoading2,loadError],async()=>{showSubMenu.value&&(await nextTick(),calculateSubmenuPosition())});const handleClick=async event=>{if(event.stopPropagation(),props.item.divided&&!props.item.label||props.item.disabled)return;if(!!event.target.closest(".cyber-context-menu-item__arrow")&&hasChildren.value){showSubMenu.value=!showSubMenu.value,showSubMenu.value&&nextTick(()=>{calculateSubmenuPosition()});return}if(props.item.onClick){await Promise.resolve(props.item.onClick(props.item,event)),emit("item-click",props.item,event);return}hasChildren.value?(showSubMenu.value=!showSubMenu.value,showSubMenu.value&&nextTick(()=>{calculateSubmenuPosition()})):emit("item-click",props.item,event)},handleMouseEnter=async event=>{if(props.item.disabled)return;const target=event.target,currentTarget=event.currentTarget;(target.classList.contains("cyber-context-menu-item__content")||target.closest(".cyber-context-menu-item")===currentTarget)&&(target.closest(".cyber-context-submenu")||(isHovered.value=!0)),isActive.value=!0,hasChildren.value&&(openTimer&&(clearTimeout(openTimer),openTimer=null),openTimer=window.setTimeout(async()=>{if(props.item.hasAsyncChildren&&localChildren.value.length===0&&props.item.loadChildren){isLoading2.value=!0,showSubMenu.value=!0,await nextTick(),calculateSubmenuPosition();try{const children=await props.item.loadChildren();localChildren.value=Array.isArray(children)?children:[],loadError.value=void 0}catch(error2){console.error("Failed to load submenu children:",error2),loadError.value=$t2("components.cyberContextMenu.loadFailed")}finally{isLoading2.value=!1,await nextTick(),calculateSubmenuPosition()}}else showSubMenu.value=!0,await nextTick(),calculateSubmenuPosition()},140))},handleMouseLeave=event=>{const rect=event.currentTarget.getBoundingClientRect();(event.clientX<rect.left||event.clientX>rect.right||event.clientY<rect.top||event.clientY>rect.bottom)&&(isHovered.value=!1),isActive.value=!1,openTimer&&(clearTimeout(openTimer),openTimer=null),hasChildren.value&&setTimeout(()=>{const hoveringCurrent=submenuRef.value?submenuRef.value.matches(":hover"):!1,hoveringDescendant=submenuRef.value?!!submenuRef.value.querySelector(".cyber-context-submenu:hover"):!1;!isActive.value&&!isSubmenuHovered.value&&!hoveringCurrent&&!hoveringDescendant&&(showSubMenu.value=!1)},250)},isSubmenuHovered=ref(!1),handleSubmenuMouseEnter=()=>{isSubmenuHovered.value=!0,isActive.value=!0,isHovered.value=!1},handleSubmenuMouseLeave=()=>{isSubmenuHovered.value=!1,isActive.value=!1,setTimeout(()=>{!isActive.value&&!isSubmenuHovered.value&&(showSubMenu.value=!1)},100)},calculateSubmenuPosition=()=>{if(!submenuRef.value)return;const rect=submenuRef.value.getBoundingClientRect(),parentRect=submenuRef.value.parentElement.getBoundingClientRect(),viewportWidth=window.innerWidth,viewportHeight=window.innerHeight;let left="100%",right="auto",topOffset=0;const margin=10;parentRect.right+rect.width>viewportWidth-10?(submenuOpensLeft.value=!0,left="auto",right="100%"):(submenuOpensLeft.value=!1,left="100%",right="auto");const minTopOffset=margin-parentRect.top,maxTopOffset=viewportHeight-rect.height-margin-parentRect.top;topOffset=Math.min(Math.max(0,minTopOffset),maxTopOffset),submenuStyle.value={left,right,top:`${Math.round(topOffset)}px`}};return(_ctx,_cache)=>{const _component_CyberContextMenuItem=resolveComponent("CyberContextMenuItem",!0);return openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-context-menu-item",{"cyber-context-menu-item--disabled":__props.item.disabled,"cyber-context-menu-item--danger":__props.item.danger&&!__props.item.disabled,"cyber-context-menu-item--has-children":hasChildren.value,"cyber-context-menu-item--active":isActive.value,"cyber-context-menu-item--has-active-submenu":hasChildren.value&&showSubMenu.value,"cyber-context-menu-item--hover":isHovered.value&&!__props.item.disabled}]),onClick:handleClick,onMouseenter:handleMouseEnter,onMouseleave:handleMouseLeave},[__props.item.divided&&!__props.isFirst?(openBlock(),createElementBlock("div",_hoisted_1$1v)):createCommentVNode("",!0),!__props.item.divided||__props.item.label?(openBlock(),createElementBlock("div",_hoisted_2$1o,[__props.item.icon?(openBlock(),createElementBlock("span",_hoisted_3$1d,[createBaseVNode("i",{class:normalizeClass(__props.item.icon)},null,2)])):createCommentVNode("",!0),createBaseVNode("span",_hoisted_4$19,toDisplayString(__props.item.label),1),__props.item.shortcut?(openBlock(),createElementBlock("span",_hoisted_5$12,toDisplayString(__props.item.shortcut),1)):createCommentVNode("",!0),hasChildren.value?(openBlock(),createElementBlock("span",_hoisted_6$W,[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-chevron-right"},null,-1)])])):createCommentVNode("",!0)])):createCommentVNode("",!0),createVNode(Transition,{name:"cyber-context-submenu",appear:""},{default:withCtx(()=>[hasChildren.value&&showSubMenu.value?(openBlock(),createElementBlock("div",{key:0,ref_key:"submenuRef",ref:submenuRef,class:normalizeClass(["cyber-context-submenu",{"cyber-context-submenu--left":submenuOpensLeft.value}]),style:normalizeStyle(submenuStyle.value),onClick:_cache[1]||(_cache[1]=withModifiers(()=>{},["stop"])),onMouseenter:handleSubmenuMouseEnter,onMouseleave:handleSubmenuMouseLeave},[isLoading2.value?(openBlock(),createElementBlock("div",_hoisted_7$N,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-spinner fa-spin cyber-context-menu-item__loading-icon"},null,-1)),createBaseVNode("span",_hoisted_8$K,toDisplayString(unref($t2)("components.cyberContextMenu.loading")),1)])):loadError.value?(openBlock(),createElementBlock("div",_hoisted_9$H,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-exclamation-triangle cyber-context-menu-item__error-icon"},null,-1)),createBaseVNode("span",_hoisted_10$E,toDisplayString(loadError.value),1)])):(openBlock(!0),createElementBlock(Fragment,{key:2},renderList(localChildren.value,(childItem,index2)=>(openBlock(),createBlock(_component_CyberContextMenuItem,{key:childItem.key,item:childItem,"is-first":index2===0,onItemClick:_cache[0]||(_cache[0]=(item,event)=>_ctx.$emit("item-click",item,event))},null,8,["item","is-first"]))),128))],38)):createCommentVNode("",!0)]),_:1})],34)}}});const CyberContextMenuItem=_export_sfc(_sfc_main$1F,[["__scopeId","data-v-26738f55"]]),_hoisted_1$1u={class:"cyber-context-menu__content"},_hoisted_2$1n={class:"cyber-context-menu__content"},_sfc_main$1E=defineComponent({name:"CyberContextMenu",__name:"index",props:{modelValue:{type:Boolean,default:!1},items:{},x:{default:0},y:{default:0},trigger:{},zIndex:{default:9999},className:{},placement:{default:"auto"}},emits:["update:modelValue","item-click","close"],setup(__props,{emit:__emit}){const props=__props,useDirectTeleport=computed(()=>!props.trigger),emit=__emit,menuRef=ref(),menuPosition=ref({x:props.x,y:props.y,placement:"bottom"}),currentFocusIndex=ref(-1),finalPlacement=computed(()=>props.placement==="auto"?menuPosition.value.placement:props.placement),menuStyle=computed(()=>({left:`${menuPosition.value.x}px`,top:`${menuPosition.value.y}px`,zIndex:props.zIndex})),flattenedItems=computed(()=>{const items=[],flatten=menuItems=>{menuItems.forEach(item=>{item.divided||items.push(item),item.children&&flatten(item.children)})};return flatten(props.items),items.filter(item=>!item.disabled)}),calculatePosition=async()=>{if(await nextTick(),!menuRef.value)return;const menuRect=menuRef.value.getBoundingClientRect(),viewportWidth=window.innerWidth,viewportHeight=window.innerHeight;let x=props.x,y=props.y,placement="bottom";if(props.placement==="auto")viewportHeight-props.y>=menuRect.height+8?(placement="bottom",y=props.y):(placement="top",y=props.y-menuRect.height),x=props.x,x+menuRect.width>viewportWidth-10&&(x=viewportWidth-menuRect.width-10),x<10&&(x=10),y<10&&(y=10),y+menuRect.height>viewportHeight-10&&(y=viewportHeight-menuRect.height-10);else switch(props.placement){case"top":y=props.y-menuRect.height,placement="top";break;case"left":x=props.x-menuRect.width,placement="left";break;case"right":x=props.x,placement="right";break;default:placement="bottom"}x=Math.max(10,Math.min(x,viewportWidth-menuRect.width-10)),y=Math.max(10,Math.min(y,viewportHeight-menuRect.height-10)),menuPosition.value={x,y,placement}},handleItemClick=(item,event)=>{emit("item-click",item,event),closeMenu()},handleOverlayClick=()=>{closeMenu()},closeMenu=()=>{emit("update:modelValue",!1),emit("close"),currentFocusIndex.value=-1},handleKeydown=event=>{switch(event.key){case"Escape":event.preventDefault(),closeMenu();break;case"ArrowDown":event.preventDefault(),navigateMenu(1);break;case"ArrowUp":event.preventDefault(),navigateMenu(-1);break;case"Enter":case" ":if(event.preventDefault(),currentFocusIndex.value>=0){const item=flattenedItems.value[currentFocusIndex.value];item&&!item.disabled&&handleItemClick(item,event)}break}},navigateMenu=direction=>{const items=flattenedItems.value;items.length!==0&&(currentFocusIndex.value=Math.max(0,Math.min(items.length-1,currentFocusIndex.value+direction)))};watch(()=>props.modelValue,newValue=>{newValue?(menuPosition.value.x=props.x,menuPosition.value.y=props.y,calculatePosition(),nextTick(()=>{menuRef.value?.focus()})):currentFocusIndex.value=-1}),watch([()=>props.x,()=>props.y],([newX,newY])=>{menuPosition.value.x=newX,menuPosition.value.y=newY,props.modelValue&&calculatePosition()}),onMounted(()=>{props.modelValue&&calculatePosition()});const handleGlobalKeydown=event=>{if(!props.modelValue)return;if(event.key==="Escape"){closeMenu();return}const shortcutKey=getShortcutKey(event);if(shortcutKey){const matchingItem=findItemByShortcut(props.items,shortcutKey);matchingItem&&!matchingItem.disabled&&(event.preventDefault(),event.stopPropagation(),handleItemClick(matchingItem,event))}},getShortcutKey=event=>{const modifiers=[];(event.ctrlKey||event.metaKey)&&modifiers.push("Ctrl"),event.altKey&&modifiers.push("Alt"),event.shiftKey&&modifiers.push("Shift");let key=event.key;return key===" "&&(key="Space"),modifiers.length>0?`${modifiers.join("+")}+${key}`:key},findItemByShortcut=(items,shortcut)=>{for(const item of items){if(item.shortcut===shortcut)return item;if(item.children){const found=findItemByShortcut(item.children,shortcut);if(found)return found}}return null};return onMounted(()=>{document.addEventListener("keydown",handleGlobalKeydown)}),onUnmounted(()=>{document.removeEventListener("keydown",handleGlobalKeydown)}),(_ctx,_cache)=>useDirectTeleport.value?(openBlock(),createBlock(Teleport,{key:0,to:"body"},[createVNode(Transition,{name:"cyber-context-menu",appear:""},{default:withCtx(()=>[__props.modelValue?(openBlock(),createElementBlock("div",{key:0,ref_key:"menuRef",ref:menuRef,class:normalizeClass(["cyber-context-menu",[__props.className,`cyber-context-menu--${finalPlacement.value}`]]),style:normalizeStyle(menuStyle.value),tabindex:"-1",onClick:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"])),onKeydown:handleKeydown},[createBaseVNode("div",_hoisted_1$1u,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.items,(item,index2)=>(openBlock(),createBlock(CyberContextMenuItem,{key:item.key,item,"is-first":index2===0,onItemClick:handleItemClick},null,8,["item","is-first"]))),128))])],38)):createCommentVNode("",!0)]),_:1}),__props.modelValue?(openBlock(),createElementBlock("div",{key:0,class:"cyber-context-menu-overlay",onClick:handleOverlayClick,onContextmenu:withModifiers(handleOverlayClick,["prevent"])},null,32)):createCommentVNode("",!0)])):(openBlock(),createBlock(Transition,{key:1,name:"cyber-context-menu",appear:""},{default:withCtx(()=>[__props.modelValue?(openBlock(),createElementBlock("div",{key:0,ref_key:"menuRef",ref:menuRef,class:normalizeClass(["cyber-context-menu",[__props.className,`cyber-context-menu--${finalPlacement.value}`]]),style:normalizeStyle(menuStyle.value),tabindex:"-1",onClick:_cache[1]||(_cache[1]=withModifiers(()=>{},["stop"])),onKeydown:handleKeydown},[createBaseVNode("div",_hoisted_2$1n,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.items,(item,index2)=>(openBlock(),createBlock(CyberContextMenuItem,{key:item.key,item,"is-first":index2===0,onItemClick:handleItemClick},null,8,["item","is-first"]))),128))])],38)):createCommentVNode("",!0)]),_:1}))}});const __unplugin_components_1$1=_export_sfc(_sfc_main$1E,[["__scopeId","data-v-cd010abd"]]);let globalMenuContainer=null,globalMenuVNode=null;const getGlobalMenuContainer=()=>(globalMenuContainer||(globalMenuContainer=document.createElement("div"),globalMenuContainer.id="global-context-menu-container",globalMenuContainer.style.position="absolute",globalMenuContainer.style.top="0",globalMenuContainer.style.left="0",globalMenuContainer.style.pointerEvents="auto",globalMenuContainer.style.zIndex="9999",document.body.appendChild(globalMenuContainer)),globalMenuContainer),showContextMenu=options=>{const container=getGlobalMenuContainer(),menuVNode=h(__unplugin_components_1$1,{modelValue:!0,items:options.items,x:options.x,y:options.y,zIndex:options.zIndex,className:options.className,placement:options.placement,trigger:options.trigger??container,"onUpdate:modelValue":value=>{value||hideContextMenu()},onClose:()=>{hideContextMenu()},onItemClick:(_item,_event)=>{hideContextMenu()}});render(menuVNode,container),globalMenuVNode=menuVNode},hideContextMenu=()=>{globalMenuContainer&&globalMenuVNode&&(render(null,globalMenuContainer),globalMenuVNode=null)},parseDirectiveValue=value=>Array.isArray(value)?{items:value,trigger:"contextmenu"}:{trigger:"contextmenu",...value},createEventHandler=options=>event=>{event.preventDefault(),event.stopPropagation(),hideContextMenu();let x=event.clientX,y=event.clientY;options.offset&&(x+=options.offset.x,y+=options.offset.y),setTimeout(()=>{showContextMenu({items:options.items,x,y,zIndex:options.zIndex,className:options.className,placement:options.placement,trigger:event.currentTarget||void 0})},0)};let globalClickHandler=null;const setupGlobalClickHandler=()=>{globalClickHandler||(globalClickHandler=event=>{const target=event.target;target&&(target.closest(".cyber-context-menu")||target.closest(".cyber-context-submenu")||target.closest(".cyber-context-menu-overlay"))||hideContextMenu()},document.addEventListener("click",globalClickHandler,!0),document.addEventListener("contextmenu",globalClickHandler,!0))},vContextMenu={mounted(el,binding){if(!binding.value)return;setupGlobalClickHandler();const options=parseDirectiveValue(binding.value);el.__contextMenuOptions=options;const handler=createEventHandler(options);el.__contextMenuHandler=handler;const eventType=options.trigger==="click"?"click":"contextmenu";el.addEventListener(eventType,handler,{passive:!1}),el.style.cursor=eventType==="contextmenu"?"context-menu":"pointer"},updated(el,binding){if(!binding.value){if(el.__contextMenuHandler&&el.__contextMenuOptions){const eventType2=el.__contextMenuOptions.trigger==="click"?"click":"contextmenu";el.removeEventListener(eventType2,el.__contextMenuHandler),el.__contextMenuHandler=void 0,el.__contextMenuOptions=void 0,el.style.cursor=""}return}const options=parseDirectiveValue(binding.value),oldOptions=el.__contextMenuOptions;if(el.__contextMenuHandler&&oldOptions){const oldEventType=oldOptions.trigger==="click"?"click":"contextmenu";el.removeEventListener(oldEventType,el.__contextMenuHandler)}const handler=createEventHandler(options);el.__contextMenuHandler=handler;const eventType=options.trigger==="click"?"click":"contextmenu";el.addEventListener(eventType,handler,{passive:!1}),el.style.cursor=eventType==="contextmenu"?"context-menu":"pointer",el.__contextMenuOptions=options},unmounted(el){if(el.__contextMenuHandler&&el.__contextMenuOptions){const eventType=el.__contextMenuOptions.trigger==="click"?"click":"contextmenu";el.removeEventListener(eventType,el.__contextMenuHandler),el.__contextMenuHandler=void 0,el.__contextMenuOptions=void 0,el.style.cursor=""}}},directivesPlugin={install(app){app.use(lazyDirective),app.use(loadingDirective),app.directive("layout-adaptive",vLayoutAdaptive),app.directive("responsive-grid",vResponsiveGrid),app.directive("responsive-spacing",vResponsiveSpacing),app.directive("context-menu",vContextMenu)}},_hoisted_1$1t=["checked","disabled"],_hoisted_2$1m={key:0,class:"cyber-switch__label"},_sfc_main$1D=defineComponent({name:"CyberSwitch",__name:"index",props:{modelValue:{type:Boolean,default:!1},label:{default:""},disabled:{type:Boolean,default:!1},size:{default:"medium"}},emits:["update:modelValue","change"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,toggle=()=>{if(props.disabled)return;const newValue=!props.modelValue;emit("update:modelValue",newValue),emit("change",newValue)};return(_ctx,_cache)=>(openBlock(),createElementBlock("label",{class:normalizeClass(["cyber-switch",{"cyber-switch--disabled":__props.disabled,"cyber-switch--checked":__props.modelValue,[`cyber-switch--${__props.size}`]:__props.size}])},[createBaseVNode("input",{type:"checkbox",checked:__props.modelValue,disabled:__props.disabled,onChange:toggle},null,40,_hoisted_1$1t),_cache[0]||(_cache[0]=createBaseVNode("div",{class:"cyber-switch__track"},[createBaseVNode("div",{class:"cyber-switch__knob"},[createBaseVNode("div",{class:"cyber-switch__glow"}),createBaseVNode("div",{class:"cyber-switch__flare"})])],-1)),__props.label?(openBlock(),createElementBlock("span",_hoisted_2$1m,toDisplayString(__props.label),1)):createCommentVNode("",!0)],2))}});const Switch=_export_sfc(_sfc_main$1D,[["__scopeId","data-v-3070e0f4"]]),Z_INDEX={BASE:1,NORMAL:1,TABLE_HEADER:100,TOOLTIP:500,DROPDOWN:1e3,POPOVER:1500,MODAL_BACKDROP:2e3,MODAL:2100,MESSAGE:3e3,DRAWER:5e3,DRAWER_MODAL:5100,FULLSCREEN_MODAL:9e3,TOAST:1e4,LOADING:10100},_hoisted_1$1s={class:"cyber-dropdown__content"},_hoisted_2$1l=["placeholder","onKeydown"],_hoisted_3$1c={key:0,class:"cyber-dropdown__tags"},_hoisted_4$18=["onMouseenter"],_hoisted_5$11=["onClick"],_hoisted_6$V={key:1,class:"cyber-dropdown__selected"},_hoisted_7$M={key:0,class:"cyber-dropdown__selected-icon"},_hoisted_8$J={class:"cyber-dropdown__selected-label"},_hoisted_9$G={key:2,class:"cyber-dropdown__placeholder"},_hoisted_10$D=["title"],_hoisted_11$A={key:0,class:"cyber-dropdown__loading"},_hoisted_12$u=["onClick","onMouseover"],_hoisted_13$s=["onClick"],_hoisted_14$p={class:"cyber-dropdown__checkbox"},_hoisted_15$o={key:0,class:"fas fa-check"},_hoisted_16$o={key:1,class:"cyber-dropdown__option-icon"},_hoisted_17$l={key:1,class:"fas fa-plus-circle cyber-dropdown__create-icon"},_hoisted_18$h={class:"cyber-dropdown__option-label"},_hoisted_19$f={key:0,class:"cyber-dropdown__loading-more"},_hoisted_20$e={key:1,class:"cyber-dropdown__no-more"},_hoisted_21$d={key:2,class:"cyber-dropdown__empty"},_sfc_main$1C=defineComponent({name:"CyberDropdown",__name:"index",props:{modelValue:{type:[String,Number,Boolean,null,Array],default:""},options:{default:()=>[]},placeholder:{default:void 0},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},maxHeight:{default:"250px"},borderColor:{default:"var(--color-brand-500)"},textColor:{default:"var(--color-content-default)"},bgColor:{default:"var(--color-background-800)"},isColorMode:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},allowCreate:{type:Boolean,default:!1},createLabel:{default:void 0},pagination:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!0},pageSize:{default:20},width:{default:"100%"},height:{default:void 0}},emits:["update:modelValue","change","create","load-more","search"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,isOpen=ref(!1),searchQuery=ref(""),highlightedIndex=ref(-1);ref(null);const triggerInput=ref(null),dropdownRef=ref(null),dropdownMenuRef=ref(null),showClearButton=ref(!1),hoveredTag=ref(null),customOptions=ref([]),shouldOpenUpward=ref(!1),menuTopPosition=ref(0),menuLeftPosition=ref(0),menuWidth=ref(0),instanceId=Math.random().toString(36).slice(2),inputBlurTimeout=ref(null),placeholder=computed(()=>props.placeholder||$t2("components.dropdown.placeholder")),wrapperStyle=computed(()=>{const style={};return props.width&&(style.width=props.width),props.height&&(style.height=props.height,style.minHeight=props.height),style}),getSmartZIndex=()=>{let element=dropdownRef.value?.parentElement,maxZIndex=Z_INDEX.DROPDOWN;for(;element&&element!==document.body;){const computedStyle=getComputedStyle(element),zIndex=parseInt(computedStyle.zIndex);if(!isNaN(zIndex)&&zIndex>0)if(zIndex>=1e4){maxZIndex=zIndex+100;break}else zIndex>maxZIndex&&(maxZIndex=zIndex+10);element=element.parentElement}return maxZIndex},dropdownPosition=computed(()=>({top:menuTopPosition.value,left:menuLeftPosition.value,width:menuWidth.value,zIndex:getSmartZIndex()}));onClickOutside(dropdownRef,event=>{if(!isOpen.value)return;const target=event.target;dropdownMenuRef.value&&dropdownMenuRef.value.contains(target)||close()});const mergedOptions=computed(()=>[...props.options,...customOptions.value]),filteredOptions=computed(()=>{const query=searchQuery.value.toLowerCase();if(!query)return mergedOptions.value;const filtered=mergedOptions.value.filter(option=>option.label.toLowerCase().includes(query));return props.allowCreate&&query&&!mergedOptions.value.some(option=>option.label.toLowerCase()===query)?[...filtered,{value:`create-option-${query}`,label:`${props.createLabel} "${query}"`,isCreateOption:!0,originalValue:query}]:filtered}),selectedOption=computed(()=>props.multiple?null:mergedOptions.value.find(option=>option.value===props.modelValue||String(option.value)===String(props.modelValue))),selectedOptions=computed(()=>!props.multiple||!Array.isArray(props.modelValue)?[]:mergedOptions.value.filter(option=>props.modelValue.some(value=>value===option.value||String(value)===String(option.value)))),isSelected=value=>props.multiple&&Array.isArray(props.modelValue)?props.modelValue.some(selectedValue=>selectedValue===value||String(selectedValue)===String(value)):props.modelValue===value||String(props.modelValue)===String(value),selectOption=option=>{if(!(props.disabled||option.disabled)){if(inputBlurTimeout.value&&(clearTimeout(inputBlurTimeout.value),inputBlurTimeout.value=null),option.isCreateOption&&props.allowCreate){const newOption={value:option.originalValue,label:option.originalValue};if(customOptions.value.push(newOption),props.multiple){const newValue=Array.isArray(props.modelValue)?[...props.modelValue]:[];newValue.push(newOption.value),emit("update:modelValue",newValue),emit("change",newValue)}else emit("update:modelValue",newOption.value),emit("change",newOption.value),close();searchQuery.value="",emit("create",newOption);return}if(props.multiple){const newValue=Array.isArray(props.modelValue)?[...props.modelValue]:[],index2=newValue.indexOf(option.value);index2===-1?newValue.push(option.value):newValue.splice(index2,1),emit("update:modelValue",newValue),emit("change",newValue)}else emit("update:modelValue",option.value),emit("change",option.value),close()}},removeSelected=value=>{if(!props.disabled&&props.multiple&&Array.isArray(props.modelValue)){const newValue=[...props.modelValue],index2=newValue.indexOf(value);index2!==-1&&(newValue.splice(index2,1),emit("update:modelValue",newValue),emit("change",newValue))}},clearAllSelected=()=>{props.disabled||(props.multiple?(emit("update:modelValue",[]),emit("change",[])):(emit("update:modelValue",""),emit("change","")))},calculateMenuPosition=()=>{if(!dropdownRef.value)return;const rect=dropdownRef.value.getBoundingClientRect(),triggerTop=rect.top,triggerBottom=rect.bottom,triggerLeft=rect.left,triggerWidth=rect.width;menuLeftPosition.value=triggerLeft,menuWidth.value=triggerWidth;const estimatedMenuHeight=(parseInt(props.maxHeight)||250)+80,spaceBelow=window.innerHeight-triggerBottom,spaceAbove=triggerTop;shouldOpenUpward.value=spaceBelow<estimatedMenuHeight&&spaceAbove>spaceBelow,shouldOpenUpward.value?menuTopPosition.value=triggerTop-estimatedMenuHeight:menuTopPosition.value=triggerBottom+2,shouldOpenUpward.value&&nextTick(()=>{if(dropdownMenuRef.value&&dropdownRef.value){const actualMenuHeight=dropdownMenuRef.value.offsetHeight,currentRect=dropdownRef.value.getBoundingClientRect();menuTopPosition.value=currentRect.top-actualMenuHeight-8}})},handleTriggerClick=()=>{props.disabled||isOpen.value||(calculateMenuPosition(),isOpen.value=!0,window.dispatchEvent(new CustomEvent("cyber-dropdown-open",{detail:{id:instanceId}})),nextTick(()=>{calculateMenuPosition(),props.searchable&&triggerInput.value&&triggerInput.value.focus()}),highlightedIndex.value=-1)},close=()=>{isOpen.value=!1,searchQuery.value=""},handleEnterKey=()=>{if(highlightedIndex.value>=0&&filteredOptions.value[highlightedIndex.value])selectOption(filteredOptions.value[highlightedIndex.value]);else if(props.allowCreate&&searchQuery.value.trim()){const newOption={value:searchQuery.value.trim(),label:searchQuery.value.trim(),isCreateOption:!0,originalValue:searchQuery.value.trim()};selectOption(newOption)}},handleEscKey=()=>{close(),triggerInput.value?.blur()},handleArrowDown=()=>{isOpen.value?highlightedIndex.value<filteredOptions.value.length-1?highlightedIndex.value++:highlightedIndex.value=0:handleTriggerClick()},handleArrowUp=()=>{isOpen.value?highlightedIndex.value>0?highlightedIndex.value--:highlightedIndex.value=filteredOptions.value.length-1:handleTriggerClick()},handleInputBlur=()=>{inputBlurTimeout.value=window.setTimeout(()=>{close()},200)},handleScroll=event=>{if(!props.pagination||props.loadingMore||!props.hasMore)return;const target=event.target,scrollTop=target.scrollTop,scrollHeight=target.scrollHeight,clientHeight=target.clientHeight;scrollHeight-scrollTop-clientHeight<50&&emit("load-more")};return watch(searchQuery,(newQuery,oldQuery)=>{props.pagination&&newQuery!==oldQuery&&setTimeout(()=>{searchQuery.value===newQuery&&emit("search",newQuery)},300)}),useEventListener(window,"keydown",e=>{if(isOpen.value)switch(e.key){case"ArrowDown":e.preventDefault(),highlightedIndex.value<filteredOptions.value.length-1?highlightedIndex.value++:highlightedIndex.value=0;break;case"ArrowUp":e.preventDefault(),highlightedIndex.value>0?highlightedIndex.value--:highlightedIndex.value=filteredOptions.value.length-1;break;case"Enter":e.preventDefault(),highlightedIndex.value>=0&&selectOption(filteredOptions.value[highlightedIndex.value]);break;case"Escape":e.preventDefault(),close();break}}),useEventListener(window,"cyber-dropdown-open",e=>{e.detail?.id!==instanceId&&isOpen.value&&close()}),useEventListener(window,"resize",()=>{isOpen.value&&calculateMenuPosition()}),useEventListener(window,"scroll",()=>{isOpen.value&&calculateMenuPosition()},{passive:!0}),useEventListener(document,"scroll",()=>{isOpen.value&&calculateMenuPosition()},{capture:!0,passive:!0}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-dropdown",[{"cyber-dropdown--open":isOpen.value,"cyber-dropdown--disabled":__props.disabled}]]),style:normalizeStyle(wrapperStyle.value),ref_key:"dropdownRef",ref:dropdownRef},[createBaseVNode("div",{class:"cyber-dropdown__trigger",onClick:withModifiers(handleTriggerClick,["stop"])},[createBaseVNode("div",_hoisted_1$1s,[__props.searchable&&(isOpen.value||searchQuery.value)?withDirectives((openBlock(),createElementBlock("input",{key:0,ref_key:"triggerInput",ref:triggerInput,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>searchQuery.value=$event),class:"cyber-dropdown__trigger-input",placeholder:placeholder.value,onClick:_cache[1]||(_cache[1]=withModifiers(()=>{},["stop"])),onKeydown:[withKeys(withModifiers(handleEnterKey,["prevent"]),["enter"]),withKeys(withModifiers(handleEscKey,["prevent"]),["esc"]),withKeys(withModifiers(handleArrowDown,["prevent"]),["down"]),withKeys(withModifiers(handleArrowUp,["prevent"]),["up"])],onBlur:handleInputBlur},null,40,_hoisted_2$1l)),[[vModelText,searchQuery.value]]):(openBlock(),createElementBlock(Fragment,{key:1},[__props.multiple&&selectedOptions.value.length?(openBlock(),createElementBlock("div",_hoisted_3$1c,[(openBlock(!0),createElementBlock(Fragment,null,renderList(selectedOptions.value,option=>(openBlock(),createElementBlock("div",{key:option.value,class:"cyber-dropdown__tag",onMouseenter:$event=>hoveredTag.value=option.value,onMouseleave:_cache[2]||(_cache[2]=$event=>hoveredTag.value=null)},[__props.isColorMode&&option.color?(openBlock(),createElementBlock("span",{key:0,class:"cyber-dropdown__color-block",style:normalizeStyle({backgroundColor:option.color})},null,4)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(option.label)+" ",1),createBaseVNode("span",{class:normalizeClass(["cyber-dropdown__tag-remove",{"cyber-dropdown__tag-remove--visible":hoveredTag.value===option.value}]),onClick:withModifiers($event=>removeSelected(option.value),["stop"])},"√ó",10,_hoisted_5$11)],40,_hoisted_4$18))),128))])):!__props.multiple&&selectedOption.value?(openBlock(),createElementBlock("div",_hoisted_6$V,[_ctx.$slots["selected-icon"]||__props.isColorMode&&selectedOption.value.color?(openBlock(),createElementBlock("span",_hoisted_7$M,[renderSlot(_ctx.$slots,"selected-icon",{option:selectedOption.value,isPermanent:selectedOption.value.value==="permanent"},()=>[__props.isColorMode&&selectedOption.value.color?(openBlock(),createElementBlock("span",{key:0,class:"cyber-dropdown__color-block",style:normalizeStyle({backgroundColor:selectedOption.value.color})},null,4)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0),createBaseVNode("span",_hoisted_8$J,toDisplayString(selectedOption.value.label),1)])):(openBlock(),createElementBlock("span",_hoisted_9$G,toDisplayString(placeholder.value),1))],64))]),createBaseVNode("div",{class:"cyber-dropdown__suffix",onMouseenter:_cache[3]||(_cache[3]=$event=>showClearButton.value=!0),onMouseleave:_cache[4]||(_cache[4]=$event=>showClearButton.value=!1)},[(__props.multiple?selectedOptions.value.length>0:selectedOption.value)&&showClearButton.value&&__props.clearable?(openBlock(),createElementBlock("span",{key:0,class:"cyber-dropdown__clear",onClick:withModifiers(clearAllSelected,["stop"]),title:unref($t2)("components.dropdown.clearAll")},[..._cache[7]||(_cache[7]=[createBaseVNode("i",{class:"fas fa-times-circle"},null,-1)])],8,_hoisted_10$D)):(openBlock(),createElementBlock("i",{key:1,class:normalizeClass(["fas fa-chevron-down cyber-dropdown__arrow",{"cyber-dropdown__arrow--open":isOpen.value}])},null,2))],32)]),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-dropdown"},{default:withCtx(()=>[isOpen.value?(openBlock(),createElementBlock("div",{key:0,class:"cyber-dropdown__menu",style:normalizeStyle({maxHeight:__props.maxHeight,position:"fixed",top:dropdownPosition.value.top+"px",left:dropdownPosition.value.left+"px",width:dropdownPosition.value.width+"px",zIndex:dropdownPosition.value.zIndex}),ref_key:"dropdownMenuRef",ref:dropdownMenuRef,onClick:_cache[6]||(_cache[6]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",{class:"cyber-dropdown__options",onScroll:handleScroll},[__props.loading&&filteredOptions.value.length===0?(openBlock(),createElementBlock("div",_hoisted_11$A,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-spinner fa-spin"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.dropdown.loading")),1)])):filteredOptions.value.length?(openBlock(),createElementBlock(Fragment,{key:1},[(openBlock(!0),createElementBlock(Fragment,null,renderList(filteredOptions.value,option=>(openBlock(),createElementBlock(Fragment,{key:option.value},[_ctx.$slots.option?renderSlot(_ctx.$slots,"option",{key:0,option,isSelected:isSelected(option.value),isColorMode:__props.isColorMode,onSelect:()=>selectOption(option),isHighlighted:highlightedIndex.value===filteredOptions.value.indexOf(option),isCreateOption:option.isCreateOption},void 0,!0):(openBlock(),createElementBlock("div",{key:`default-${option.value}`,class:normalizeClass(["cyber-dropdown__option",{"cyber-dropdown__option--selected":isSelected(option.value),"cyber-dropdown__option--highlighted":highlightedIndex.value===filteredOptions.value.indexOf(option),"cyber-dropdown__option--color":__props.isColorMode&&option.color,"cyber-dropdown__option--create":option.isCreateOption}]),onMousedown:_cache[5]||(_cache[5]=withModifiers(()=>{inputBlurTimeout.value&&(_ctx.clearTimeout(inputBlurTimeout.value),inputBlurTimeout.value=null)},["prevent"])),onClick:withModifiers($event=>selectOption(option),["stop"]),onMouseover:$event=>highlightedIndex.value=filteredOptions.value.indexOf(option)},[__props.multiple?(openBlock(),createElementBlock("div",{key:0,class:"cyber-dropdown__checkbox-wrapper",onClick:withModifiers($event=>selectOption(option),["stop"])},[createBaseVNode("span",_hoisted_14$p,[isSelected(option.value)?(openBlock(),createElementBlock("i",_hoisted_15$o)):createCommentVNode("",!0)])],8,_hoisted_13$s)):createCommentVNode("",!0),_ctx.$slots["option-icon"]||__props.isColorMode&&option.color||option.isCreateOption?(openBlock(),createElementBlock("span",_hoisted_16$o,[renderSlot(_ctx.$slots,"option-icon",{option,isSelected:isSelected(option.value),isPermanent:option.value==="permanent"},()=>[__props.isColorMode&&option.color?(openBlock(),createElementBlock("span",{key:0,class:"cyber-dropdown__color-block",style:normalizeStyle({backgroundColor:option.color})},null,4)):option.isCreateOption?(openBlock(),createElementBlock("i",_hoisted_17$l)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0),createBaseVNode("span",_hoisted_18$h,toDisplayString(option.label),1)],42,_hoisted_12$u))],64))),128)),__props.pagination&&__props.loadingMore?(openBlock(),createElementBlock("div",_hoisted_19$f,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-spinner fa-spin"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.dropdown.loadingMore")),1)])):__props.pagination&&!__props.hasMore?(openBlock(),createElementBlock("div",_hoisted_20$e,toDisplayString(unref($t2)("components.dropdown.noMore")),1)):createCommentVNode("",!0)],64)):(openBlock(),createElementBlock("div",_hoisted_21$d,toDisplayString(unref($t2)("components.dropdown.empty")),1))],32)],4)):createCommentVNode("",!0)]),_:3})]))],6))}});const Dropdown=_export_sfc(_sfc_main$1C,[["__scopeId","data-v-b6a21451"]]),loadedThemes=new Set,loadingThemes=new Map,DEFAULT_THEMES=["dark","light","cyberpunk-cyan"],themeLinkElements=new Map,themeModules=Object.assign({"/src/styles/design-system/theme-aurora-night.css":()=>__vitePreload(()=>import("./theme-aurora-night-8123aaf3.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-coral-sunset.css":()=>__vitePreload(()=>import("./theme-coral-sunset-2c251d7f.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-cotton-candy.css":()=>__vitePreload(()=>import("./theme-cotton-candy-ed0bb482.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-cyberpunk-cyan.css":()=>__vitePreload(()=>import("./theme-cyberpunk-cyan-f5dd2e51.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-cyberpunk-neon.css":()=>__vitePreload(()=>import("./theme-cyberpunk-neon-fedcc7a1.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-dark.css":()=>__vitePreload(()=>import("./theme-dark-112d1eb4.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-forest-night.css":()=>__vitePreload(()=>import("./theme-forest-night-ca4323d2.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-lavender-dream.css":()=>__vitePreload(()=>import("./theme-lavender-dream-9d16714c.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-lemon-yellow.css":()=>__vitePreload(()=>import("./theme-lemon-yellow-b11adfe4.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-light.css":()=>__vitePreload(()=>import("./theme-light-2f5f0ef1.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-midnight-ocean.css":()=>__vitePreload(()=>import("./theme-midnight-ocean-d782f368.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-sky-azure.css":()=>__vitePreload(()=>import("./theme-sky-azure-244f487e.js"),[]).then(m=>m.default),"/src/styles/design-system/theme-template.css":()=>__vitePreload(()=>import("./theme-template-5de08154.js"),[]).then(m=>m.default)});async function loadTheme(theme){if(DEFAULT_THEMES.includes(theme)||loadedThemes.has(theme))return;if(loadingThemes.has(theme))return loadingThemes.get(theme);const loadPromise=new Promise((resolve,reject)=>{(async()=>{try{const possiblePaths=[`/src/styles/design-system/theme-${theme}.css`,`@/styles/design-system/theme-${theme}.css`];let themeLoader=null;for(const path of possiblePaths)if(themeModules[path]){themeLoader=themeModules[path];break}if(!themeLoader)throw new Error(`Theme module not found: ${theme}`);const themeUrl=await themeLoader(),link=document.createElement("link");link.rel="stylesheet",link.href=themeUrl,link.setAttribute("data-theme",theme),link.onload=()=>{loadedThemes.add(theme),themeLinkElements.set(theme,link),loadingThemes.delete(theme),resolve()},link.onerror=()=>{document.head.removeChild(link),loadingThemes.delete(theme),reject(new Error(`Failed to load theme: ${theme}`))},document.head.appendChild(link)}catch(error2){loadingThemes.delete(theme),reject(error2)}})()});return loadingThemes.set(theme,loadPromise),loadPromise}function preloadThemes(themes){typeof requestIdleCallback<"u"?requestIdleCallback(()=>{themes.forEach(theme=>{loadTheme(theme).catch(()=>{})})},{timeout:2e3}):setTimeout(()=>{themes.forEach(theme=>{loadTheme(theme).catch(()=>{})})},1e3)}const useVisualThemeStore=defineStore("visualTheme",()=>{const selectedTheme=ref("dark"),appliedTheme=ref("dark"),isInitializing=ref(!0),isLight=computed(()=>["light","lavender-dream","lemon-yellow","cotton-candy","coral-sunset","sky-azure"].includes(appliedTheme.value)),isDark=computed(()=>!isLight.value),isCyberpunk=computed(()=>appliedTheme.value==="cyberpunk-cyan"||appliedTheme.value==="cyberpunk-neon"),isCyberpunkCyan=computed(()=>appliedTheme.value==="cyberpunk-cyan"),isCyberpunkNeon=computed(()=>appliedTheme.value==="cyberpunk-neon"),isSynthwave=computed(()=>appliedTheme.value==="synthwave");function applyThemeToDOM(theme){if(typeof document>"u")return;const html=document.documentElement;html.removeAttribute("data-theme"),html.classList.remove("theme-light","theme-dark","theme-cyberpunk"),html.setAttribute("data-theme",theme),html.classList.add(`theme-${theme}`),updateMetaThemeColor()}function updateMetaThemeColor(_theme){if(typeof document>"u")return;const html=document.documentElement,themeColor=getComputedStyle(html).getPropertyValue("--color-background-900").trim()||"#0a0e17";let metaThemeColor=document.querySelector('meta[name="theme-color"]');metaThemeColor||(metaThemeColor=document.createElement("meta"),metaThemeColor.setAttribute("name","theme-color"),document.head.appendChild(metaThemeColor)),metaThemeColor.setAttribute("content",themeColor)}async function initialize2(systemDefaultTheme){try{const savedTheme=localStorage.getItem("visual-theme"),validThemes=["light","dark","cyberpunk-cyan","cyberpunk-neon","midnight-ocean","forest-night","lavender-dream","lemon-yellow","cotton-candy","coral-sunset","aurora-night","sky-azure"];savedTheme&&validThemes.includes(savedTheme)?selectedTheme.value=savedTheme:systemDefaultTheme&&validThemes.includes(systemDefaultTheme)?selectedTheme.value=systemDefaultTheme:selectedTheme.value="dark",await loadTheme(selectedTheme.value),appliedTheme.value=selectedTheme.value,applyThemeToDOM(selectedTheme.value),preloadThemes(["cyberpunk-cyan","light"])}catch{selectedTheme.value="dark",appliedTheme.value="dark",applyThemeToDOM("dark")}finally{isInitializing.value=!1}}async function setTheme(theme){try{await loadTheme(theme),selectedTheme.value=theme,appliedTheme.value=theme,applyThemeToDOM(theme);try{localStorage.setItem("visual-theme",theme)}catch{}}catch(error2){throw error2}}function toggleTheme(){const newTheme=appliedTheme.value==="dark"?"light":"dark";setTheme(newTheme)}function reset(){setTheme("dark")}function cleanup2(){}return{selectedTheme,appliedTheme,isInitializing,isLight,isDark,isCyberpunk,isCyberpunkCyan,isCyberpunkNeon,isSynthwave,initialize:initialize2,setTheme,toggleTheme,reset,cleanup:cleanup2}});function useTheme(){const visualThemeStore=useVisualThemeStore(),textThemeStore=useTextThemeStore(),selectedTheme=computed(()=>visualThemeStore.selectedTheme),appliedTheme=computed(()=>visualThemeStore.appliedTheme),isInitializing=computed(()=>visualThemeStore.isInitializing),isLight=computed(()=>visualThemeStore.isLight),isDark=computed(()=>visualThemeStore.isDark),isCyberpunk=computed(()=>visualThemeStore.isCyberpunk);function setVisualTheme(theme){visualThemeStore.setTheme(theme)}function toggleVisualTheme(){visualThemeStore.toggleTheme()}function resetVisualTheme(){visualThemeStore.reset()}const currentTextTheme=computed(()=>textThemeStore.currentTheme),isCyberText=computed(()=>textThemeStore.isCyberTheme);function setTextTheme(theme){textThemeStore.setTheme(theme)}function toggleTextTheme(){textThemeStore.toggleTheme()}function getText(key){return textThemeStore.getText(key)}async function initialize2(systemDefaultTheme){await Promise.all([visualThemeStore.initialize(systemDefaultTheme),textThemeStore.initialize()])}function reset(){visualThemeStore.reset(),textThemeStore.reset()}function setTheme(theme){setVisualTheme(theme)}function toggleTheme(){toggleVisualTheme()}function resetTheme(){resetVisualTheme()}const{$t:$t2}=useTexts(),THEME_CONFIGS=computed(()=>[{label:$t2("themes.light.label"),value:"light",description:$t2("themes.light.description"),icon:"sun",isDark:!1},{label:$t2("themes.dark.label"),value:"dark",description:$t2("themes.dark.description"),icon:"moon",isDark:!0},{label:$t2("themes.cyberpunk-cyan.label"),value:"cyberpunk-cyan",description:$t2("themes.cyberpunk-cyan.description"),icon:"bolt",isDark:!0},{label:$t2("themes.cyberpunk-neon.label"),value:"cyberpunk-neon",description:$t2("themes.cyberpunk-neon.description"),icon:"fire",isDark:!0},{label:$t2("themes.midnight-ocean.label"),value:"midnight-ocean",description:$t2("themes.midnight-ocean.description"),icon:"water",isDark:!0},{label:$t2("themes.forest-night.label"),value:"forest-night",description:$t2("themes.forest-night.description"),icon:"tree",isDark:!0},{label:$t2("themes.aurora-night.label"),value:"aurora-night",description:$t2("themes.aurora-night.description"),icon:"star",isDark:!0},{label:$t2("themes.sky-azure.label"),value:"sky-azure",description:$t2("themes.sky-azure.description"),icon:"cloud-sun",isDark:!1},{label:$t2("themes.lavender-dream.label"),value:"lavender-dream",description:$t2("themes.lavender-dream.description"),icon:"wand-magic-sparkles",isDark:!1},{label:$t2("themes.lemon-yellow.label"),value:"lemon-yellow",description:$t2("themes.lemon-yellow.description"),icon:"lemon",isDark:!1},{label:$t2("themes.cotton-candy.label"),value:"cotton-candy",description:$t2("themes.cotton-candy.description"),icon:"candy-cane",isDark:!1},{label:$t2("themes.coral-sunset.label"),value:"coral-sunset",description:$t2("themes.coral-sunset.description"),icon:"palette",isDark:!1}]);function getThemeLabel(theme){return THEME_CONFIGS.value.find(t=>t.value===theme)?.label||theme}function getThemeDescription(theme){return THEME_CONFIGS.value.find(t=>t.value===theme)?.description||""}function getThemeIcon(theme){return THEME_CONFIGS.value.find(t=>t.value===theme)?.icon||"palette"}const allThemes=computed(()=>THEME_CONFIGS.value.map(t=>t.value)),themeOptions=THEME_CONFIGS,currentThemeInfo=computed(()=>{const theme=selectedTheme.value;return THEME_CONFIGS.value.find(t=>t.value===theme)||THEME_CONFIGS.value[1]});return{selectedTheme,appliedTheme,isInitializing,isLight,isDark,isCyberpunk,setVisualTheme,toggleVisualTheme,resetVisualTheme,currentTextTheme,isCyberText,setTextTheme,toggleTextTheme,getText,initialize:initialize2,reset,getThemeLabel,getThemeDescription,getThemeIcon,themeOptions,currentThemeInfo,allThemes,setTheme,toggleTheme,resetTheme}}function useConfig(){const appInfo=computed(()=>({name:APP_CONFIG.name,description:APP_CONFIG.description})),brand=computed(()=>APP_CONFIG.brand);return{appInfo,brand}}const _hoisted_1$1r=["src","alt"],_hoisted_2$1k=["src","alt"],_hoisted_3$1b={key:2,class:"brand-text"},_hoisted_4$17={class:"brand-word brand-color-1"},_sfc_main$1B=defineComponent({name:"BrandLogo",__name:"index",props:{size:{default:"md"},showVersion:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},clickable:{type:Boolean,default:!0},collapsed:{type:Boolean,default:!1},containerClass:{default:""},shape:{default:"rectangle"}},setup(__props){const props=__props,{appInfo,brand}=useConfig(),settingsStore=useSettingsStore(),versionDisplay=computed(()=>{const version=settingsStore.currentVersion;return version&&version!=="1.0.0"?`VERSION v${version}`:"VERSION v1.0.0"}),dynamicSiteName=computed(()=>{const siteName=settingsStore.siteName;if(siteName){const words=siteName.split(" ").filter(word=>word.trim());return words.length>=2?{firstWord:words[0],otherWords:words.slice(1)}:{firstWord:siteName,otherWords:[]}}return{firstWord:brand.pixel,otherWords:[brand.punk]}}),dynamicLogo=computed(()=>settingsStore.siteLogoUrl||brand.logo),sizeClasses=computed(()=>({xs:{container:"brand-xs",icon:"w-5 h-5",title:"text-base",version:"text-[0.5rem]"},sm:{container:"brand-sm",icon:"w-6 h-6",title:"text-lg",version:"text-[0.55rem]"},md:{container:"brand-md",icon:"w-7 h-7",title:"text-xl",version:"text-[0.6rem]"},lg:{container:"brand-lg",icon:"w-9 h-9",title:"text-2xl",version:"text-xs"},xl:{container:"brand-xl",icon:"w-12 h-12",title:"text-3xl",version:"text-sm"}})[props.size]),shapeClasses=computed(()=>({rectangle:"brand-rectangle",square:"brand-square",circle:"brand-circle rounded-full"})[props.shape]);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["brand-logo",[sizeClasses.value.container,shapeClasses.value,__props.containerClass,{"brand-collapsed":__props.collapsed,"brand-clickable":__props.clickable}]])},[(openBlock(),createBlock(resolveDynamicComponent(__props.clickable?"router-link":"div"),{to:__props.clickable?"/":void 0,class:"brand-link"},{default:withCtx(()=>[__props.showIcon&&!__props.collapsed?(openBlock(),createElementBlock("img",{key:0,src:dynamicLogo.value,alt:unref(settingsStore).siteName||unref(appInfo).name,class:normalizeClass(["brand-icon",sizeClasses.value.icon])},null,10,_hoisted_1$1r)):createCommentVNode("",!0),__props.collapsed?(openBlock(),createElementBlock("img",{key:1,src:dynamicLogo.value,alt:unref(settingsStore).siteName||unref(appInfo).name,class:normalizeClass(["brand-icon-only",sizeClasses.value.icon])},null,10,_hoisted_2$1k)):createCommentVNode("",!0),__props.collapsed?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_3$1b,[createBaseVNode("h1",{class:normalizeClass(["brand-title",sizeClasses.value.title])},[createBaseVNode("span",_hoisted_4$17,toDisplayString(dynamicSiteName.value.firstWord),1),(openBlock(!0),createElementBlock(Fragment,null,renderList(dynamicSiteName.value.otherWords,(word,index2)=>(openBlock(),createElementBlock("span",{key:index2,class:normalizeClass(`brand-word brand-color-${(index2+1)%5+1}`)},toDisplayString(word),3))),128))],2),__props.showVersion?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(["brand-version",sizeClasses.value.version])},toDisplayString(versionDisplay.value),3)):createCommentVNode("",!0)]))]),_:1},8,["to"]))],2))}});const BrandLogo=_export_sfc(_sfc_main$1B,[["__scopeId","data-v-26803247"]]),_sfc_main$1A=defineComponent({name:"NavbarBrand",__name:"NavbarBrand",setup(__props){return(_ctx,_cache)=>(openBlock(),createBlock(BrandLogo))}}),useThemeStore=defineStore("theme",()=>({getSiteMode:()=>"website",isWebsiteMode:()=>!0}));function useNavigation(){const route=useRoute(),themeStore=useThemeStore(),{$t:$t2}=useTexts(),baseNavItems=computed(()=>[{path:"/",name:$t2("navigation.home"),icon:"fas fa-home"},{path:"/explore",name:$t2("navigation.explore"),icon:"fas fa-images"},{path:"/random",name:$t2("navigation.random"),icon:"fas fa-random"},{path:"/upload",name:$t2("navigation.upload"),icon:"fas fa-upload"},{path:"/hive",name:$t2("navigation.hive"),icon:"fas fa-th",external:!0,target:"_blank"},{path:"/docs",name:$t2("navigation.api"),icon:"fas fa-code",external:!0,target:"_blank"}]);return computed(()=>[{path:"/dashboard",name:$t2("navigation.dashboard"),icon:"fas fa-tachometer-alt",requiresAuth:!0},{path:"/my-files",name:$t2("navigation.myFiles"),icon:"fas fa-image",requiresAuth:!0},{path:"/folders",name:$t2("navigation.folders"),icon:"fas fa-folder",requiresAuth:!0},{path:"/shares",name:$t2("navigation.shares"),icon:"fas fa-share-alt",requiresAuth:!0},{path:"/settings",name:$t2("navigation.settings"),icon:"fas fa-user-cog",requiresAuth:!0}]),{navigationItems:computed(()=>baseNavItems.value),isRouteActive:path=>path==="/"?route.path==="/":route.path.startsWith(path)||route.path===path,getHomePath:()=>"/",getPath:basePath=>basePath,siteMode:computed(()=>themeStore.getSiteMode())}}const _hoisted_1$1q={class:"navbar-nav desktop-only"},_hoisted_2$1j={class:"nav-items"},_hoisted_3$1a={class:"nav-group primary"},_hoisted_4$16=["href","target"],_hoisted_5$10={key:0,class:"fas fa-external-link-alt external-icon"},_sfc_main$1z=defineComponent({__name:"DesktopNav",setup(__props){const{navigationItems:allNavItems,isRouteActive}=useNavigation(),authStore=useAuthStore(),navigationItems=computed(()=>allNavItems.value.filter(item=>item.requiresAuth?authStore.isLoggedIn:!0)),getNavItemClass=item=>{const classes=[];return item.path==="/upload"?classes.push("nav-upload"):item.path==="/hive"?classes.push("nav-hive"):item.path==="/docs"&&classes.push("nav-docs"),classes};return(_ctx,_cache)=>{const _component_router_link=resolveComponent("router-link");return openBlock(),createElementBlock("div",_hoisted_1$1q,[createBaseVNode("div",_hoisted_2$1j,[createBaseVNode("div",_hoisted_3$1a,[(openBlock(!0),createElementBlock(Fragment,null,renderList(navigationItems.value,item=>(openBlock(),createElementBlock(Fragment,{key:item.path},[item.external?(openBlock(),createElementBlock("a",{key:0,href:item.path,target:item.target||"_self",class:normalizeClass(["nav-item",getNavItemClass(item)])},[createBaseVNode("i",{class:normalizeClass(["nav-icon",item.icon])},null,2),createBaseVNode("span",null,toDisplayString(item.name),1),item.external?(openBlock(),createElementBlock("i",_hoisted_5$10)):createCommentVNode("",!0)],10,_hoisted_4$16)):(openBlock(),createBlock(_component_router_link,{key:1,to:item.path,class:normalizeClass(["nav-item",[getNavItemClass(item),{active:unref(isRouteActive)(item.path)}]])},{default:withCtx(()=>[createBaseVNode("i",{class:normalizeClass(["nav-icon",item.icon])},null,2),createBaseVNode("span",null,toDisplayString(item.name),1)]),_:2},1032,["to","class"]))],64))),128))])])])}}});const DesktopNav=_export_sfc(_sfc_main$1z,[["__scopeId","data-v-d2ac33eb"]]);function useAppearanceSettings(){const settingsStore=useSettingsStore(),loadSettings=async()=>{settingsStore.isLoaded||await settingsStore.loadGlobalSettings()},socialLinks=computed(()=>({official:{show:settingsStore.showOfficialSite,url:settingsStore.officialSiteUrl},github:{show:settingsStore.showGithubLink,url:settingsStore.githubUrl},wechat:{show:settingsStore.showWechatGroup,qrImage:settingsStore.wechatQrImageUrl,account:settingsStore.wechatContactAccount,hasConfig:!!(settingsStore.wechatQrImageUrl||settingsStore.wechatContactAccount)},qq:{show:settingsStore.showQqGroup,qrImage:settingsStore.qqQrImageUrl,groupNumber:settingsStore.qqGroupNumber,hasConfig:!!(settingsStore.qqQrImageUrl||settingsStore.qqGroupNumber)}})),layoutSettings=computed(()=>({multiLayoutEnabled:settingsStore.enableMultiLayout,defaultLayout:settingsStore.defaultLayout})),languageSettings=computed(()=>({multiLanguageEnabled:settingsStore.enableMultiLanguage,defaultLanguage:settingsStore.defaultLanguage}));return{socialLinks,layoutSettings,languageSettings,isLoading:computed(()=>settingsStore.loading),isLoaded:computed(()=>settingsStore.isLoaded),loadSettings}}const _hoisted_1$1p=["src","alt"],_hoisted_2$1i={key:1,class:"avatar-placeholder"},_sfc_main$1y=defineComponent({name:"CyberUserAvatar",__name:"index",props:{avatarUrl:{default:""},username:{default:""},size:{default:"md"},showBorder:{type:Boolean,default:!0},showGlow:{type:Boolean,default:!0},customStyles:{default:()=>({})}},setup(__props){const props=__props,{$t:$t2}=useTexts(),hasImageError=ref(!1),handleImageError=()=>{hasImageError.value=!0},initials=computed(()=>{if(hasImageError.value||!props.avatarUrl){const username=props.username||"";return username?username.charAt(0).toUpperCase():"?"}return""}),sizeClass=computed(()=>{switch(props.size){case"sm":return"size-sm";case"lg":return"size-lg";default:return"size-md"}});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-avatar",[sizeClass.value,{"with-border":__props.showBorder},{"with-glow":__props.showGlow}]]),style:normalizeStyle(__props.customStyles)},[__props.avatarUrl?(openBlock(),createElementBlock("img",{key:0,src:__props.avatarUrl,class:"avatar-image",alt:unref($t2)("theme.user.avatarAlt"),onError:handleImageError},null,40,_hoisted_1$1p)):(openBlock(),createElementBlock("div",_hoisted_2$1i,[createBaseVNode("span",null,toDisplayString(initials.value),1)]))],6))}});const UserAvatar=_export_sfc(_sfc_main$1y,[["__scopeId","data-v-227dbc0f"]]);function getCurrentLocale(){return"zh-CN"}function getUserMessages(params){return get("/messages",params)}function getUnreadCount(){return get("/messages/unread-count")}function markMessageRead(messageId){return post(`/messages/${messageId}/read`)}function markAllMessagesRead(){return post("/messages/read-all")}function deleteMessage(messageId){return del(`/messages/${messageId}`)}function formatRelativeTime$1(dateString,$t2){const date=new Date(dateString),diffMs=new Date().getTime()-date.getTime(),diffMinutes=Math.floor(diffMs/(1e3*60)),diffHours=Math.floor(diffMs/(1e3*60*60)),diffDays=Math.floor(diffMs/(1e3*60*60*24));return diffMinutes<1?$t2("api.message.time.justNow"):diffMinutes<60?$t2("api.message.time.minutesAgo",{n:diffMinutes}):diffHours<24?$t2("api.message.time.hoursAgo",{n:diffHours}):diffDays<7?$t2("api.message.time.daysAgo",{n:diffDays}):date.toLocaleDateString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}const _hoisted_1$1o={key:0,class:"pointer-events-auto relative w-full max-w-sm sm:w-auto",role:"alert","aria-live":"assertive","aria-atomic":"true"},_hoisted_2$1h={class:"toast-content"},_hoisted_3$19={class:"toast-icon"},_hoisted_4$15={class:"toast-text"},_hoisted_5$$={class:"toast-title"},_hoisted_6$U={key:0,class:"toast-message"},_hoisted_7$L=["aria-label"],_sfc_main$1x=defineComponent({__name:"MessageToast",props:{type:{default:"info"},title:{},message:{},duration:{default:5e3},actionText:{},actionUrl:{},actionStyle:{default:"primary"},id:{}},emits:["close"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,emit=__emit,visible=ref(!1);let timer=null;useRouter();const{$t:$t2}=useTexts(),isActionable=computed(()=>!!(props.actionText&&props.actionUrl)),iconClass=computed(()=>({success:"fas fa-check-circle",error:"fas fa-times-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle"})[props.type]),show=()=>{visible.value=!0,props.duration>0&&(timer=setTimeout(()=>{handleClose()},props.duration))},handleClose=()=>{timer&&(clearTimeout(timer),timer=null),visible.value=!1},handleAfterLeave=()=>{emit("close")};return onMounted(()=>{requestAnimationFrame(()=>{show()})}),onUnmounted(()=>{timer&&clearTimeout(timer)}),__expose({close:handleClose}),(_ctx,_cache)=>(openBlock(),createBlock(Transition,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 translate-y-2 sm:translate-x-2 sm:translate-y-0","enter-to-class":"transform opacity-100 translate-y-0 sm:translate-x-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 translate-y-0 sm:translate-x-0","leave-to-class":"transform opacity-0 translate-y-2 sm:translate-x-2 sm:translate-y-0",onAfterLeave:handleAfterLeave},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",_hoisted_1$1o,[createBaseVNode("div",{class:normalizeClass(["message-toast",[`toast-${__props.type}`,{"toast-actionable":isActionable.value}]])},[createBaseVNode("div",_hoisted_2$1h,[createBaseVNode("div",_hoisted_3$19,[createBaseVNode("i",{class:normalizeClass([iconClass.value,"text-lg"])},null,2)]),createBaseVNode("div",_hoisted_4$15,[createBaseVNode("p",_hoisted_5$$,toDisplayString(__props.title),1),__props.message?(openBlock(),createElementBlock("p",_hoisted_6$U,toDisplayString(__props.message),1)):createCommentVNode("",!0)]),createBaseVNode("button",{class:"toast-close","aria-label":unref($t2)("components.messageToast.close"),onClick:handleClose},[..._cache[0]||(_cache[0]=[createBaseVNode("i",{class:"fas fa-times text-sm"},null,-1)])],8,_hoisted_7$L)])],2)])):createCommentVNode("",!0)]),_:1}))}});const MessageToast=_export_sfc(_sfc_main$1x,[["__scopeId","data-v-75431051"]]);var __defProp$4=Object.defineProperty,__defNormalProp$4=(obj,key,value)=>key in obj?__defProp$4(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$4=(obj,key,value)=>(__defNormalProp$4(obj,typeof key!="symbol"?key+"":key,value),value);class ToastManager{constructor(){__publicField$4(this,"toasts",new Map),__publicField$4(this,"container",null),__publicField$4(this,"toastIds",new Set)}generateId(){return`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}ensureContainer(){this.container||(this.container=document.createElement("div"),this.container.id="message-toast-container",this.container.className="fixed top-0 right-0 z-[9999] p-4 space-y-3 pointer-events-none",this.container.style.cssText=`
        position: fixed;
        top: 1rem;
        right: 1rem;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        pointer-events: none;
        max-height: calc(100vh - 2rem);
        overflow-y: auto;
        overflow-x: visible;
        width: auto;
        min-width: 320px;
        max-width: 420px;
      `,document.body.appendChild(this.container))}createToast(options){this.ensureContainer();const id=options.id||this.generateId();if(this.toastIds.has(id)){const existingToast=this.toasts.get(id);if(existingToast)return existingToast}this.toastIds.add(id);const mountPoint=document.createElement("div");if(mountPoint.dataset.toastId=id,mountPoint.style.cssText=`
      pointer-events: auto;
      margin-bottom: 0.75rem;
      transform: translateX(100%);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    `,!this.container)return;this.container.firstChild?this.container.insertBefore(mountPoint,this.container.firstChild):this.container.appendChild(mountPoint);const duration=options.duration||4e3,app=createApp(MessageToast,{...options,id,duration,onClose:()=>{this.removeToast(id)}});app.use(router),app.mount(mountPoint),requestAnimationFrame(()=>{mountPoint.style.transform="translateX(0)",mountPoint.style.opacity="1"});const instance2={id,app,close:()=>{this.removeToast(id)},mountPoint};return this.toasts.set(id,instance2),instance2}removeToast(id){const toast=this.toasts.get(id);if(!toast)return;const{mountPoint}=toast;mountPoint&&setTimeout(()=>{try{toast.app.unmount(),mountPoint.parentElement&&mountPoint.remove()}catch{}this.container&&this.container.children.length===0&&(this.container.remove(),this.container=null)},0),this.toasts.delete(id),this.toastIds.delete(id)}success(title,message,options){return this.createToast({type:"success",title,message,duration:4e3,...options})}error(title,message,options){return this.createToast({type:"error",title,message,duration:6e3,...options})}warning(title,message,options){return this.createToast({type:"warning",title,message,duration:5e3,...options})}info(title,message,options){return this.createToast({type:"info",title,message,duration:4e3,...options})}showMessage(messageData){let toastType="info";messageData.type&&(messageData.type.includes("success")||messageData.type.includes("approved")||messageData.type.includes("granted")?toastType="success":messageData.type.includes("error")||messageData.type.includes("rejected")||messageData.type.includes("alert")?toastType="error":messageData.type.includes("warning")||messageData.type.includes("quota")?toastType="warning":toastType="info");const messageId=messageData.id||`msg-${messageData.title}-${Date.now()}-${Math.random().toString(36).substr(2,5)}`;let duration=4e3;return toastType==="error"?duration=6e3:toastType==="warning"&&(duration=5e3),this.createToast({type:toastType,title:messageData.title,message:messageData.content,actionText:messageData.action_text,actionUrl:messageData.action_url,actionStyle:messageData.action_style||"primary",id:messageId,duration})}clear(){this.toasts.forEach(toast=>{toast.close()})}}const messageToast=new ToastManager;function useMessageToast(){return{success:messageToast.success.bind(messageToast),error:messageToast.error.bind(messageToast),warning:messageToast.warning.bind(messageToast),info:messageToast.info.bind(messageToast),showMessage:messageToast.showMessage.bind(messageToast),clear:messageToast.clear.bind(messageToast)}}const dialogState=ref({isVisible:!1,config:{message:"",type:"warning"},resolve:null});function showConfirmDialog(options){return new Promise(resolve=>{dialogState.value={isVisible:!0,config:{type:"warning",...options},resolve}})}function handleConfirm(inputValue){dialogState.value.resolve&&(dialogState.value.config.requireInput&&inputValue?dialogState.value.resolve(inputValue):dialogState.value.resolve(!0)),dialogState.value.isVisible=!1,dialogState.value.resolve=null}function handleCancel(){dialogState.value.resolve&&dialogState.value.resolve(!1),dialogState.value.isVisible=!1,dialogState.value.resolve=null}function useConfirmDialog(){return{dialogState,showConfirmDialog,handleConfirm,handleCancel}}const _sfc_main$1w=defineComponent({__name:"MessageDetail",props:{message:{},show:{type:Boolean}},emits:["close","updated","deleted"],setup(__props,{emit:__emit}){const props=__props,emit=__emit;useRouter();const{$t:$t2}=useTexts(),messageTypeConfig=getMessageTypeConfig($t2),priorityConfig=getPriorityConfig($t2),statusConfig=getStatusConfig($t2),dialogVisible=ref(!1);return computed(()=>messageTypeConfig[props.message.type]?.icon||"üìß"),computed(()=>messageTypeConfig[props.message.type]?.label||props.message.type),computed(()=>statusConfig[props.message.status]||statusConfig[MessageStatus.UNREAD]),computed(()=>priorityConfig[props.message.priority]||priorityConfig[MessagePriority.NORMAL]),computed(()=>props.message.meta_data&&Object.keys(props.message.meta_data).length>0),watch(()=>props.show,_newShow=>{},{immediate:!0}),watch(dialogVisible,newValue=>{newValue||emit("close")}),(_ctx,_cache)=>(resolveComponent("CyberButton"),resolveComponent("CyberDialog"),createCommentVNode("",!0))}});const MessageDetail=_export_sfc(_sfc_main$1w,[["__scopeId","data-v-0d2ce108"]]);var __defProp$3=Object.defineProperty,__defNormalProp$3=(obj,key,value)=>key in obj?__defProp$3(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$3=(obj,key,value)=>(__defNormalProp$3(obj,typeof key!="symbol"?key+"":key,value),value);class MessageModalManager{constructor(){__publicField$3(this,"currentModal",null)}showMessageDetail(message){this.currentModal&&this.closeModal();const mountPoint=document.createElement("div");document.body.appendChild(mountPoint);const app=createApp(MessageDetail,{message,show:!0,onClose:()=>{this.closeModal()},onUpdated:_updatedMessage=>{},onDeleted:_messageId=>{this.closeModal()}});return app.use(router),app.use(CyberComponentsPlugin$1),app.mount(mountPoint),this.currentModal={app,mountPoint},{close:()=>{this.closeModal()}}}closeModal(){if(!this.currentModal)return;const{app,mountPoint}=this.currentModal;app.unmount(),mountPoint.parentElement&&mountPoint.parentElement.removeChild(mountPoint),this.currentModal=null}hasOpenModal(){return this.currentModal!==null}}const messageModal=new MessageModalManager;function useMessageModal(){return{showMessageDetail:messageModal.showMessageDetail.bind(messageModal),hasOpenModal:messageModal.hasOpenModal.bind(messageModal)}}function formatMessage(message,$t2){const{type,data}=message;try{if(data.title&&data.content)return{title:String(data.title),content:String(data.content)};switch(type){case"system.maintenance":return{title:$t2("message.system.maintenance.title"),content:$t2("message.system.maintenance.content",data)};case"system.announcement":return{title:$t2("message.system.announcement.title"),content:$t2("message.system.announcement.content",data)};case"account.register":return{title:$t2("message.account.register.title"),content:$t2("message.account.register.content",data)};case"account.storage_granted":return{title:$t2("message.account.storageGranted.title"),content:$t2("message.account.storageGranted.content",data)};case"account.bandwidth_granted":return{title:$t2("message.account.bandwidthGranted.title"),content:$t2("message.account.bandwidthGranted.content",data)};case"content.review_approved":return{title:$t2("message.content.reviewApproved.title"),content:$t2("message.content.reviewApproved.content",data)};case"content.review_rejected":return{title:$t2("message.content.reviewRejected.title"),content:$t2("message.content.reviewRejected.content",data)};case"content.review_pending":return{title:$t2("message.content.reviewPending.title"),content:$t2("message.content.reviewPending.content",data)};case"storage.quota_warning":return{title:$t2("message.storage.quotaWarning.title"),content:$t2("message.storage.quotaWarning.content",data)};case"storage.quota_increased":return{title:$t2("message.storage.quotaIncreased.title"),content:$t2("message.storage.quotaIncreased.content",data)};case"storage.quota_decreased":return{title:$t2("message.storage.quotaDecreased.title"),content:$t2("message.storage.quotaDecreased.content",data)};case"file.deleted_by_admin":return{title:$t2("message.file.deletedByAdmin.title"),content:$t2("message.file.deletedByAdmin.content",data)};case"file.batch_deleted_by_admin":return{title:$t2("message.file.batchDeletedByAdmin.title"),content:$t2("message.file.batchDeletedByAdmin.content",data)};case"file.hard_deleted_by_admin":return{title:$t2("message.file.hardDeletedByAdmin.title"),content:$t2("message.file.hardDeletedByAdmin.content",data)};case"file.expiry_warning":return{title:$t2("message.file.expiryWarning.title",{count:data.file_count||1}),content:$t2("message.file.expiryWarning.content",data)};case"file.thumbnail_failed":return{title:$t2("message.file.thumbnailFailed.title"),content:$t2("message.file.thumbnailFailed.content",data)};case"security.login_alert":return{title:$t2("message.security.loginAlert.title"),content:$t2("message.security.loginAlert.content",data)};case"apikey.created":return{title:$t2("message.apikey.created.title"),content:$t2("message.apikey.created.content",data)};case"apikey.deleted":return{title:$t2("message.apikey.deleted.title"),content:$t2("message.apikey.deleted.content",data)};case"apikey.regenerated":return{title:$t2("message.apikey.regenerated.title"),content:$t2("message.apikey.regenerated.content",data)};case"apikey.disabled":return{title:$t2("message.apikey.disabled.title"),content:$t2("message.apikey.disabled.content",data)};case"apikey.enabled":return{title:$t2("message.apikey.enabled.title"),content:$t2("message.apikey.enabled.content",data)};case"random_api.created":return{title:$t2("message.randomApi.created.title"),content:$t2("message.randomApi.created.content",data)};case"random_api.deleted":return{title:$t2("message.randomApi.deleted.title"),content:$t2("message.randomApi.deleted.content",data)};case"random_api.disabled":return{title:$t2("message.randomApi.disabled.title"),content:$t2("message.randomApi.disabled.content",data)};case"random_api.enabled":return{title:$t2("message.randomApi.enabled.title"),content:$t2("message.randomApi.enabled.content",data)};case"share.expiry_warning":return{title:$t2("message.share.expiryWarning.title"),content:$t2("message.share.expiryWarning.content",data)};default:return{title:`Message: ${type}`,content:JSON.stringify(data)}}}catch{return{title:`Message: ${type}`,content:JSON.stringify(data)}}}const _hoisted_1$1n={class:"message-notification relative"},_hoisted_2$1g=["aria-expanded"],_hoisted_3$18={key:0,class:"message-badge"},_hoisted_4$14={class:"cyber-dropdown-header px-4 py-3"},_hoisted_5$_={class:"flex items-center justify-between"},_hoisted_6$T={id:"notify-title",class:"dropdown-title"},_hoisted_7$K={class:"flex items-center space-x-2"},_hoisted_8$I={class:"text-xs text-content-muted"},_hoisted_9$F={class:"cyber-dropdown-body max-h-96 overflow-y-auto","aria-labelledby":"notify-title"},_hoisted_10$C={key:0,class:"px-4 py-8 text-center"},_hoisted_11$z={class:"text-sm text-content-muted"},_hoisted_12$t={key:1,class:"empty-state flex min-h-[120px] flex-col items-center justify-center px-4 py-8 text-center"},_hoisted_13$r={class:"empty-title mb-2"},_hoisted_14$o={class:"empty-description"},_hoisted_15$n={key:2,class:"py-1"},_hoisted_16$n=["onClick"],_hoisted_17$k={class:"flex items-start space-x-3"},_hoisted_18$g={class:"flex-shrink-0"},_hoisted_19$e=["data-color"],_hoisted_20$d={class:"min-w-0 flex-1"},_hoisted_21$c={class:"mb-1 flex items-center justify-between"},_hoisted_22$b={class:"flex min-w-0 flex-1 items-center space-x-2"},_hoisted_23$8={class:"message-title truncate text-sm font-medium"},_hoisted_24$8={key:0,class:"cyber-unread-dot flex-shrink-0"},_hoisted_25$8={class:"ml-3 flex-shrink-0 text-xs text-content-disabled"},_hoisted_26$8={class:"truncate text-xs text-content-muted"},_hoisted_27$8={class:"cyber-dropdown-footer px-4 py-1"},_hoisted_28$8={class:"text-xs font-medium"},_sfc_main$1v=defineComponent({__name:"MessageNotification",props:{offsetX:{default:12},offsetY:{default:8}},setup(__props){const props=__props,router2=useRouter(),messageToast2=useMessageToast(),messageModal2=useMessageModal(),{$t:$t2}=useTexts();getMessageTypeConfig($t2);const showDropdown=ref(!1),loading2=ref(!1),unreadCount=ref(0),recentMessages=ref([]),dropdownRef=ref(),messageButtonRef=ref(),dropdownStyle=ref({});let pollTimer=null,positionTimer=null;const hasUnreadMessages=computed(()=>unreadCount.value>0),toggleDropdown=async()=>{showDropdown.value=!showDropdown.value,showDropdown.value&&(loadRecentMessages(),await nextTick(),updateDropdownPosition())},updateDropdownPosition=()=>{const iconButtonComponent=messageButtonRef.value,button=iconButtonComponent?.$el||iconButtonComponent;if(!button)return;const rect=button.getBoundingClientRect(),vw=window.innerWidth,scrollX=window.pageXOffset||document.documentElement.scrollLeft||0,scrollY=window.pageYOffset||document.documentElement.scrollTop||0,dropdownWidth=380;let left=rect.left+scrollX+rect.width/2-dropdownWidth/2+(props.offsetX||0);left<8&&(left=8),left+dropdownWidth>scrollX+vw-8&&(left=scrollX+vw-dropdownWidth-8);const top=rect.bottom+scrollY+(props.offsetY||0),arrowLeft=rect.left+scrollX+rect.width/2-left-5;dropdownStyle.value={left:`${left}px`,top:`${top}px`,width:`${dropdownWidth}px`,"--arrow-left":`${Math.max(12,Math.min(dropdownWidth-12,arrowLeft))}px`}},handleViewportChange=()=>{showDropdown.value&&(positionTimer&&window.clearTimeout(positionTimer),positionTimer=window.setTimeout(()=>updateDropdownPosition(),120))},closeDropdown=()=>{showDropdown.value=!1},loadUnreadCount=async()=>{try{const response=await getUnreadCount();unreadCount.value=response?.data?.count??0}catch{unreadCount.value=0}},loadRecentMessages=async()=>{loading2.value=!0;try{const response=await getUserMessages({page:1,page_size:50,status:MessageStatus.UNREAD});recentMessages.value=response?.data?.items||[]}finally{loading2.value=!1}},markRead=async messageId=>{try{await markMessageRead(messageId.toString()),recentMessages.value=recentMessages.value.filter(m=>m.id!==messageId),unreadCount.value=Math.max(0,unreadCount.value-1)}catch{}},markAllRead=async()=>{try{await markAllMessagesRead(),recentMessages.value=[],unreadCount.value=0}catch{}},getFormattedMessage=message=>formatMessage(message,$t2),handleMessageClick=message=>{message.status===MessageStatus.UNREAD&&markRead(message.id),closeDropdown(),messageModal2.showMessageDetail(message);const formatted=formatMessage(message,$t2);messageToast2.showMessage({title:formatted.title,content:formatted.content,type:message.type,action_url:message.action_url,action_text:message.action_text,action_style:message.action_style})},goToMessageCenter=()=>{closeDropdown(),router2.push("/messages")},getMessageIcon=type=>({"system.maintenance":"wrench","system.announcement":"bullhorn","account.register":"party-horn","account.storage_granted":"hard-drive","account.bandwidth_granted":"rocket","content.review_approved":"check-circle","content.review_rejected":"times-circle","content.review_pending":"hourglass-half","storage.quota_warning":"exclamation-triangle","storage.quota_increased":"chart-line","storage.quota_decreased":"arrow-down","file.deleted_by_admin":"trash-alt","file.batch_deleted_by_admin":"folder-minus","file.hard_deleted_by_admin":"exclamation-triangle","security.login_alert":"shield-alt","file.expiry_warning":"clock"})[type]||"envelope",getMessageColor=type=>({"system.maintenance":"warning","system.announcement":"info","account.register":"success","account.storage_granted":"brand","account.bandwidth_granted":"info","content.review_approved":"success","content.review_rejected":"error","content.review_pending":"warning","storage.quota_warning":"warning","storage.quota_increased":"success","storage.quota_decreased":"warning","file.deleted_by_admin":"error","file.batch_deleted_by_admin":"error","file.hard_deleted_by_admin":"error","security.login_alert":"error","file.expiry_warning":"warning"})[type]||"brand",handleKeydown=e=>{e.key==="Escape"&&closeDropdown()},handleDocumentClick=e=>{if(!showDropdown.value)return;const target=e.target;if(dropdownRef.value?.contains(target))return;const iconButtonComponent=messageButtonRef.value;(iconButtonComponent?.$el||iconButtonComponent)?.contains(target)||closeDropdown()};return onMounted(()=>{loadUnreadCount(),pollTimer=setInterval(loadUnreadCount,3e4),window.addEventListener("scroll",handleViewportChange,!0),window.addEventListener("resize",handleViewportChange),document.addEventListener("mousedown",handleDocumentClick,!0),document.addEventListener("keydown",handleKeydown)}),onUnmounted(()=>{pollTimer&&clearInterval(pollTimer),window.removeEventListener("scroll",handleViewportChange,!0),window.removeEventListener("resize",handleViewportChange),document.removeEventListener("mousedown",handleDocumentClick,!0),document.removeEventListener("keydown",handleKeydown)}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$1n,[createBaseVNode("button",{ref_key:"messageButtonRef",ref:messageButtonRef,class:normalizeClass(["message-button",{"has-unread":hasUnreadMessages.value}]),"aria-haspopup":"listbox","aria-expanded":String(showDropdown.value),onClick:toggleDropdown},[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-bell message-icon"},null,-1)),unreadCount.value>0?(openBlock(),createElementBlock("span",_hoisted_3$18,toDisplayString(unreadCount.value>99?"99+":unreadCount.value),1)):createCommentVNode("",!0)],10,_hoisted_2$1g),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95 translate-y-4","enter-to-class":"transform opacity-100 scale-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 scale-100 translate-y-0","leave-to-class":"transform opacity-0 scale-95 translate-y-4"},{default:withCtx(()=>[showDropdown.value?(openBlock(),createElementBlock("div",{key:0,ref_key:"dropdownRef",ref:dropdownRef,class:"cyber-dropdown z-[9999]",style:normalizeStyle(dropdownStyle.value),role:"listbox",onClick:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_4$14,[createBaseVNode("div",_hoisted_5$_,[createBaseVNode("h3",_hoisted_6$T,toDisplayString(unref($t2)("components.messageNotification.title")),1),createBaseVNode("div",_hoisted_7$K,[createBaseVNode("span",_hoisted_8$I,toDisplayString(unreadCount.value)+" "+toDisplayString(unref($t2)("components.messageNotification.unreadCount")),1),unreadCount.value>0?(openBlock(),createElementBlock("button",{key:0,class:"cyber-mark-all-btn rounded px-2 py-1 text-xs font-medium transition-all duration-200",onClick:markAllRead},toDisplayString(unref($t2)("components.messageNotification.markAllRead")),1)):createCommentVNode("",!0)])])]),createBaseVNode("div",_hoisted_9$F,[loading2.value?(openBlock(),createElementBlock("div",_hoisted_10$C,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"cyber-spinner mx-auto mb-3"},null,-1)),createBaseVNode("p",_hoisted_11$z,toDisplayString(unref($t2)("components.messageNotification.loading")),1)])):recentMessages.value.length===0?(openBlock(),createElementBlock("div",_hoisted_12$t,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"empty-icon mb-3"},[createBaseVNode("i",{class:"fas fa-bell-slash text-3xl"})],-1)),createBaseVNode("h3",_hoisted_13$r,toDisplayString(unref($t2)("components.messageNotification.emptyTitle")),1),createBaseVNode("p",_hoisted_14$o,toDisplayString(unref($t2)("components.messageNotification.emptyDescription")),1)])):(openBlock(),createElementBlock("div",_hoisted_15$n,[(openBlock(!0),createElementBlock(Fragment,null,renderList(recentMessages.value,message=>(openBlock(),createElementBlock("div",{key:message.id,class:normalizeClass(["cyber-message-item cursor-pointer transition-all duration-300",{"is-unread":message.status===unref(MessageStatus).UNREAD}]),onClick:$event=>handleMessageClick(message)},[createBaseVNode("div",_hoisted_17$k,[createBaseVNode("div",_hoisted_18$g,[createBaseVNode("div",{class:"cyber-message-type-icon","data-color":getMessageColor(message.type)},[createBaseVNode("i",{class:normalizeClass(["fas",`fa-${getMessageIcon(message.type)}`])},null,2)],8,_hoisted_19$e)]),createBaseVNode("div",_hoisted_20$d,[createBaseVNode("div",_hoisted_21$c,[createBaseVNode("div",_hoisted_22$b,[createBaseVNode("h4",_hoisted_23$8,toDisplayString(getFormattedMessage(message).title),1),message.status===unref(MessageStatus).UNREAD?(openBlock(),createElementBlock("div",_hoisted_24$8)):createCommentVNode("",!0)]),createBaseVNode("span",_hoisted_25$8,toDisplayString(unref(formatRelativeTime$1)(message.created_at,unref($t2))),1)]),createBaseVNode("p",_hoisted_26$8,toDisplayString(getFormattedMessage(message).content),1)])])],10,_hoisted_16$n))),128))]))]),createBaseVNode("div",_hoisted_27$8,[createBaseVNode("div",{class:"cyber-view-all-link group flex cursor-pointer items-center justify-center py-1 transition-all duration-300",onClick:goToMessageCenter},[createBaseVNode("span",_hoisted_28$8,toDisplayString(unref($t2)("components.messageNotification.viewAll")),1),_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-arrow-right ml-1 transform text-xs transition-transform duration-300 group-hover:translate-x-1"},null,-1))])])],4)):createCommentVNode("",!0)]),_:1})]))]))}});const MessageNotification=_export_sfc(_sfc_main$1v,[["__scopeId","data-v-8470d5c3"]]);function getPublicAnnouncementList(){return get("/announcements")}function getPublicAnnouncementDetail(id){return get(`/announcements/${id}`)}const _sfc_main$1u=defineComponent({name:"CyborgCharacter",__name:"index",props:{size:{default:"medium"},position:{default:"top-left"},coverEyes:{type:Boolean,default:!1}},setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyborg-character",[`size-${__props.size}`,`position-${__props.position}`,{"cover-eyes":__props.coverEyes}]])},[..._cache[0]||(_cache[0]=[createStaticVNode('<div class="cyborg-head" data-v-7b9f1cbd><div class="cyborg-eyes" data-v-7b9f1cbd><div class="cyborg-eye left" data-v-7b9f1cbd></div><div class="cyborg-eye right" data-v-7b9f1cbd></div></div><div class="circuit-lines" data-v-7b9f1cbd><div class="circuit line1" data-v-7b9f1cbd></div></div></div><div class="cyborg-body" data-v-7b9f1cbd><div class="cyborg-arm left-arm" data-v-7b9f1cbd><div class="arm-segment upper" data-v-7b9f1cbd></div><div class="arm-segment lower" data-v-7b9f1cbd></div><div class="arm-hand" data-v-7b9f1cbd></div></div><div class="cyborg-arm right-arm" data-v-7b9f1cbd><div class="arm-segment upper" data-v-7b9f1cbd></div><div class="arm-segment lower" data-v-7b9f1cbd></div><div class="arm-hand" data-v-7b9f1cbd></div></div><div class="power-core" data-v-7b9f1cbd></div><div class="body-panel left-panel" data-v-7b9f1cbd></div><div class="body-panel right-panel" data-v-7b9f1cbd></div></div>',2)])],2))}});const __unplugin_components_1=_export_sfc(_sfc_main$1u,[["__scopeId","data-v-7b9f1cbd"]]),_hoisted_1$1m={class:"dialog-header"},_hoisted_2$1f={class:"title-text"},_hoisted_3$17={class:"dialog-body"},_hoisted_4$13={key:0,class:"loading-container"},_hoisted_5$Z={class:"loading-text"},_hoisted_6$S={key:1,class:"announcement-content"},_hoisted_7$J={class:"meta-info"},_hoisted_8$H={class:"meta-item"},_hoisted_9$E={class:"meta-item"},_hoisted_10$B=["innerHTML"],_hoisted_11$y={class:"dialog-footer"},_sfc_main$1t=defineComponent({__name:"AnnouncementDialog",props:{modelValue:{type:Boolean},announcement:{},loading:{type:Boolean,default:!1}},emits:["update:modelValue","close","neverShowAgain","viewMore","dismissTemporarily"],setup(__props,{emit:__emit}){d.setOptions({gfm:!0,breaks:!0});const{$t:$t2}=useTexts(),props=__props,emit=__emit,visible=computed({get:()=>props.modelValue,set:value=>{emit("update:modelValue",value),value||emit("close")}}),formatDate2=dateStr=>{if(!dateStr)return"-";try{const date=new Date(dateStr);return isNaN(date.getTime())?"-":date.toLocaleDateString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return"-"}},handleClose=()=>{props.announcement&&emit("dismissTemporarily",props.announcement.id),visible.value=!1},handleNeverShowAgain=()=>{props.announcement&&emit("neverShowAgain",props.announcement.id),visible.value=!1},handleViewMore=()=>{emit("viewMore"),visible.value=!1},handleMaskClick=()=>{props.announcement&&emit("dismissTemporarily",props.announcement.id),visible.value=!1},renderedContent=computed(()=>{if(!props.announcement?.content)return"";try{const html=d.parse(props.announcement.content);return purify.sanitize(html,{ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","ul","ol","li","a","strong","em","u","s","code","pre","blockquote","img","table","thead","tbody","tr","th","td","div","span","b","i","small","mark","del","ins","sub","sup"],ALLOWED_ATTR:["href","src","alt","title","class","style","width","height","id","name"],ALLOW_DATA_ATTR:!1})}catch{return props.announcement.content}});return(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton");return openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"announcement-dialog"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:"announcement-dialog-overlay",onClick:handleMaskClick},[createBaseVNode("div",{class:"announcement-dialog-container",onClick:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"]))},[createVNode(__unplugin_components_1,{size:"small",position:"top-left"}),_cache[10]||(_cache[10]=createBaseVNode("div",{class:"corner-border top-left"},null,-1)),_cache[11]||(_cache[11]=createBaseVNode("div",{class:"corner-border top-right"},null,-1)),_cache[12]||(_cache[12]=createBaseVNode("div",{class:"corner-border bottom-left"},null,-1)),_cache[13]||(_cache[13]=createBaseVNode("div",{class:"corner-border bottom-right"},null,-1)),_cache[14]||(_cache[14]=createBaseVNode("div",{class:"corner-decoration top-left"},null,-1)),_cache[15]||(_cache[15]=createBaseVNode("div",{class:"corner-decoration top-right"},null,-1)),_cache[16]||(_cache[16]=createBaseVNode("div",{class:"corner-decoration bottom-left"},null,-1)),_cache[17]||(_cache[17]=createBaseVNode("div",{class:"corner-decoration bottom-right"},null,-1)),_cache[18]||(_cache[18]=createBaseVNode("div",{class:"scan-line"},null,-1)),_cache[19]||(_cache[19]=createBaseVNode("div",{class:"dialog-border-top"},null,-1)),_cache[20]||(_cache[20]=createBaseVNode("div",{class:"dialog-border-bottom"},null,-1)),createBaseVNode("div",_hoisted_1$1m,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"header-icon"},[createBaseVNode("i",{class:"fas fa-bullhorn"})],-1)),createBaseVNode("h2",_hoisted_2$1f,toDisplayString(__props.announcement?.title||unref($t2)("components.announcement.dialog.title")),1),createBaseVNode("button",{class:"close-button",onClick:handleClose},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])]),createBaseVNode("div",_hoisted_3$17,[__props.loading?(openBlock(),createElementBlock("div",_hoisted_4$13,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"loading-spinner"},null,-1)),createBaseVNode("p",_hoisted_5$Z,toDisplayString(unref($t2)("components.announcement.dialog.loading")),1)])):__props.announcement?(openBlock(),createElementBlock("div",_hoisted_6$S,[createBaseVNode("div",_hoisted_7$J,[createBaseVNode("div",_hoisted_8$H,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.announcement.dialog.meta.published"))+"Ôºö"+toDisplayString(formatDate2(__props.announcement.created_at)),1)]),createBaseVNode("div",_hoisted_9$E,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-edit"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.announcement.dialog.meta.updated"))+"Ôºö"+toDisplayString(formatDate2(__props.announcement.updated_at)),1)])]),_cache[6]||(_cache[6]=createBaseVNode("div",{class:"divider"},null,-1)),createBaseVNode("div",{class:"content-body markdown-body",innerHTML:renderedContent.value},null,8,_hoisted_10$B)])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_11$y,[__props.announcement?.is_pinned?(openBlock(),createBlock(_component_CyberButton,{key:0,type:"secondary",size:"small",onClick:handleNeverShowAgain},{default:withCtx(()=>[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-eye-slash mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.announcement.dialog.actions.neverShowAgain")),1)]),_:1})):(openBlock(),createBlock(_component_CyberButton,{key:1,type:"secondary",size:"small",onClick:handleViewMore},{default:withCtx(()=>[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-list mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.announcement.dialog.actions.viewMore")),1)]),_:1})),createVNode(_component_CyberButton,{type:"primary",size:"small",onClick:handleClose},{default:withCtx(()=>[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-check mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.announcement.dialog.actions.gotIt")),1)]),_:1})])])])):createCommentVNode("",!0)]),_:1})])}}});const AnnouncementDialog=_export_sfc(_sfc_main$1t,[["__scopeId","data-v-c44ea7ca"]]),_hoisted_1$1l={class:"announcement-container"},_hoisted_2$1e=["aria-label","disabled"],_hoisted_3$16={class:"announcement-list"},_hoisted_4$12={key:0,class:"loading-state"},_hoisted_5$Y={class:"text-sm text-content-muted"},_hoisted_6$R={key:1,class:"empty-state"},_hoisted_7$I={class:"empty-title"},_hoisted_8$G={class:"empty-description"},_hoisted_9$D={key:2,class:"announcements"},_hoisted_10$A=["onClick"],_hoisted_11$x={key:0,class:"pinned-badge"},_hoisted_12$s={class:"announcement-title"},_hoisted_13$q={key:1,class:"announcement-summary"},_hoisted_14$n={class:"announcement-footer"},_hoisted_15$m={class:"announcement-date"},_hoisted_16$m={class:"view-detail"},DISMISSED_ANNOUNCEMENTS_KEY="dismissed_announcements",TEMPORARY_DISMISSED_KEY="temporary_dismissed_announcements",DISMISS_DURATION=5*60*1e3,_sfc_main$1s=defineComponent({name:"AnnouncementButton",__name:"index",setup(__props){const toast=useToast(),{$t:$t2}=useTexts(),showDrawer=ref(!1),showDetailDialog=ref(!1),loading2=ref(!1),detailLoading=ref(!1),announcements=ref([]),selectedAnnouncement=ref(null),settings=ref({announcement_enabled:!0,announcement_drawer_position:"right",announcement_drawer_width:"450px",announcement_display_limit:10,announcement_auto_show_delay:3}),loadDismissedAnnouncements=()=>{try{const stored=localStorage.getItem(DISMISSED_ANNOUNCEMENTS_KEY);return stored?JSON.parse(stored):[]}catch(error2){return console.error("Failed to load dismissed announcements:",error2),[]}},saveDismissedAnnouncement=announcementId=>{try{const dismissed=loadDismissedAnnouncements();dismissed.includes(announcementId)||(dismissed.push(announcementId),localStorage.setItem(DISMISSED_ANNOUNCEMENTS_KEY,JSON.stringify(dismissed)))}catch(error2){console.error("Failed to save dismissed announcement:",error2)}},loadTemporaryDismissed=()=>{try{const stored=localStorage.getItem(TEMPORARY_DISMISSED_KEY);return stored?JSON.parse(stored):{}}catch(error2){return console.error("Failed to load temporary dismissed announcements:",error2),{}}},saveTemporaryDismissed=announcementId=>{try{const dismissed=loadTemporaryDismissed();dismissed[announcementId]=Date.now(),localStorage.setItem(TEMPORARY_DISMISSED_KEY,JSON.stringify(dismissed))}catch(error2){console.error("Failed to save temporary dismissed announcement:",error2)}},isTemporarilyDismissed=announcementId=>{const dismissed=loadTemporaryDismissed(),dismissTime=dismissed[announcementId];return dismissTime?Date.now()-dismissTime>DISMISS_DURATION?(delete dismissed[announcementId],localStorage.setItem(TEMPORARY_DISMISSED_KEY,JSON.stringify(dismissed)),!1):!0:!1},shouldAutoShow=announcement=>!(!announcement.is_pinned||loadDismissedAnnouncements().includes(announcement.id)||isTemporarilyDismissed(announcement.id)),fetchAnnouncements=async()=>{if(settings.value.announcement_enabled){loading2.value=!0;try{const result=await getPublicAnnouncementList();result.code===200&&result.data&&(announcements.value=result.data.announcements||[],result.data.config&&(settings.value={announcement_enabled:result.data.config.announcement_enabled??!0,announcement_drawer_position:result.data.config.announcement_drawer_position??"right",announcement_drawer_width:result.data.config.announcement_drawer_width??"450px",announcement_display_limit:result.data.config.announcement_display_limit??10,announcement_auto_show_delay:result.data.config.announcement_auto_show_delay??3}))}catch(error2){console.error("Failed to fetch announcements:",error2),toast.error(error2?.message||$t2("components.announcement.messages.loadListFailed"))}finally{loading2.value=!1}}},toggleDrawer=()=>{if(!settings.value.announcement_enabled){toast.info($t2("components.announcement.messages.systemDisabled"));return}showDrawer.value||fetchAnnouncements(),showDrawer.value=!showDrawer.value},viewAnnouncement=async announcement=>{showDrawer.value=!1,detailLoading.value=!0,showDetailDialog.value=!0,selectedAnnouncement.value=announcement;try{const result=await getPublicAnnouncementDetail(announcement.id);result.code===200&&result.data&&(selectedAnnouncement.value=result.data)}catch(error2){console.error("Failed to fetch announcement detail:",error2),toast.error(error2?.message||$t2("components.announcement.messages.loadDetailFailed")),showDetailDialog.value=!1}finally{detailLoading.value=!1}},closeDetailDialog=()=>{showDetailDialog.value=!1,selectedAnnouncement.value=null},handleNeverShowAgain=announcementId=>{saveDismissedAnnouncement(announcementId),toast.success($t2("components.announcement.messages.neverShowAgainSuccess"))},handleDismissTemporarily=announcementId=>{saveTemporaryDismissed(announcementId)},handleViewMore=()=>{showDrawer.value=!0},formatDate2=dateStr=>new Date(dateStr).toLocaleDateString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return onMounted(async()=>{if(!settings.value.announcement_enabled)return;await fetchAnnouncements();const pinnedToShow=announcements.value.find(shouldAutoShow);if(pinnedToShow){const delay=(settings.value.announcement_auto_show_delay||3)*1e3;setTimeout(async()=>{await viewAnnouncement(pinnedToShow)},delay)}}),(_ctx,_cache)=>{const _component_CyberDrawer=resolveComponent("CyberDrawer");return openBlock(),createElementBlock("div",_hoisted_1$1l,[createBaseVNode("button",{class:normalizeClass(["announcement-button",{disabled:!settings.value.announcement_enabled}]),"aria-label":unref($t2)("components.announcement.button.ariaLabel"),disabled:!settings.value.announcement_enabled,onClick:toggleDrawer},[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-bullhorn announcement-icon"},null,-1)])],10,_hoisted_2$1e),createVNode(_component_CyberDrawer,{modelValue:showDrawer.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>showDrawer.value=$event),title:unref($t2)("components.announcement.drawer.title"),width:settings.value.announcement_drawer_width,position:settings.value.announcement_drawer_position},{"title-icon":withCtx(()=>[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fas fa-bullhorn text-brand-500"},null,-1)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_3$16,[loading2.value?(openBlock(),createElementBlock("div",_hoisted_4$12,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"spinner"},null,-1)),createBaseVNode("p",_hoisted_5$Y,toDisplayString(unref($t2)("components.announcement.status.loading")),1)])):announcements.value.length===0?(openBlock(),createElementBlock("div",_hoisted_6$R,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-inbox empty-icon"},null,-1)),createBaseVNode("h3",_hoisted_7$I,toDisplayString(unref($t2)("components.announcement.empty.title")),1),createBaseVNode("p",_hoisted_8$G,toDisplayString(unref($t2)("components.announcement.empty.description")),1)])):(openBlock(),createElementBlock("div",_hoisted_9$D,[(openBlock(!0),createElementBlock(Fragment,null,renderList(announcements.value,announcement=>(openBlock(),createElementBlock("div",{key:announcement.id,class:normalizeClass(["announcement-card",{pinned:announcement.is_pinned}]),onClick:$event=>viewAnnouncement(announcement)},[announcement.is_pinned?(openBlock(),createElementBlock("div",_hoisted_11$x,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-thumbtack"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.announcement.list.pinned")),1)])):createCommentVNode("",!0),createBaseVNode("h3",_hoisted_12$s,toDisplayString(announcement.title),1),announcement.summary?(openBlock(),createElementBlock("p",_hoisted_13$q,toDisplayString(announcement.summary),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_14$n,[createBaseVNode("span",_hoisted_15$m,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createTextVNode(" "+toDisplayString(formatDate2(announcement.created_at)),1)]),createBaseVNode("span",_hoisted_16$m,[createTextVNode(toDisplayString(unref($t2)("components.announcement.list.viewDetail"))+" ",1),_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-chevron-right"},null,-1))])])],10,_hoisted_10$A))),128))]))])]),_:1},8,["modelValue","title","width","position"]),createVNode(AnnouncementDialog,{modelValue:showDetailDialog.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>showDetailDialog.value=$event),announcement:selectedAnnouncement.value,loading:detailLoading.value,onClose:closeDetailDialog,onNeverShowAgain:handleNeverShowAgain,onDismissTemporarily:handleDismissTemporarily,onViewMore:handleViewMore},null,8,["modelValue","announcement","loading"])])}}});const AnnouncementButton=_export_sfc(_sfc_main$1s,[["__scopeId","data-v-275cf599"]]);function useLocale(){const textThemeStore=useTextThemeStore(),{$t:$t2}=useTexts(),currentLocale=computed(()=>textThemeStore.currentLocale),isInitializing=computed(()=>textThemeStore.isInitializing);function setLocale(locale){textThemeStore.setLocale(locale)}const LOCALE_CONFIGS=computed(()=>[{label:$t2("locale.zhCN.label"),value:"zh-CN",description:$t2("locale.zhCN.description"),emoji:"üá®üá≥",nativeName:"ÁÆÄ‰Ωì‰∏≠Êñá"},{label:$t2("locale.enUS.label"),value:"en-US",description:$t2("locale.enUS.description"),emoji:"üá∫üá∏",nativeName:"English"},{label:$t2("locale.jaJP.label"),value:"ja-JP",description:$t2("locale.jaJP.description"),emoji:"üáØüáµ",nativeName:"Êó•Êú¨Ë™û"}]);function getLocaleLabel(locale){return LOCALE_CONFIGS.value.find(l=>l.value===locale)?.label||locale}function getLocaleDescription(locale){return LOCALE_CONFIGS.value.find(l=>l.value===locale)?.description||""}function getLocaleIcon(locale){return LOCALE_CONFIGS.value.find(l=>l.value===locale)?.emoji||"üåê"}function getLocaleNativeName(locale){return LOCALE_CONFIGS.value.find(l=>l.value===locale)?.nativeName||locale}function getLocaleEmoji(locale){return LOCALE_CONFIGS.value.find(l=>l.value===locale)?.emoji||"üåê"}const allLocales=computed(()=>LOCALE_CONFIGS.value.map(l=>l.value)),localeOptions=LOCALE_CONFIGS,currentLocaleInfo=computed(()=>{const locale=currentLocale.value;return LOCALE_CONFIGS.value.find(l=>l.value===locale)||LOCALE_CONFIGS.value[0]});return{currentLocale,isInitializing,setLocale,getLocaleLabel,getLocaleDescription,getLocaleIcon,getLocaleNativeName,getLocaleEmoji,localeOptions,currentLocaleInfo,allLocales}}const _hoisted_1$1k={class:"locale-switch"},_hoisted_2$1d={key:0,class:"locale-text"},_hoisted_3$15={class:"dropdown-header"},_hoisted_4$11={class:"header-title"},_hoisted_5$X={class:"locale-options"},_hoisted_6$Q=["onClick"],_hoisted_7$H={class:"option-icon"},_hoisted_8$F={class:"option-content"},_hoisted_9$C={class:"option-label"},_hoisted_10$z={class:"option-description"},_hoisted_11$w={key:0,class:"option-check"},_sfc_main$1r=defineComponent({name:"LocaleSwitch",__name:"index",props:{size:{default:"small"},showDropdown:{type:Boolean,default:!0},showText:{type:Boolean,default:!1},placement:{default:"bottom"},align:{default:"right"}},setup(__props){const{$t:$t2}=useTexts(),props=__props,{currentLocale,setLocale,localeOptions,currentLocaleInfo}=useLocale(),dropdownOpen=ref(!1),dropdownRef=ref(),buttonRef=ref(),dropdownStyle=ref({}),updateDropdownPosition=()=>{if(!buttonRef.value)return;const rect=buttonRef.value.getBoundingClientRect(),style={};props.placement==="top"?style.bottom=`${window.innerHeight-rect.top+8}px`:style.top=`${rect.bottom+8}px`,props.align==="left"?style.left=`${rect.left}px`:style.right=`${window.innerWidth-rect.right}px`,dropdownStyle.value=style},toggleDropdown=()=>{props.showDropdown&&(dropdownOpen.value=!dropdownOpen.value,dropdownOpen.value&&updateDropdownPosition())},selectLocale=locale=>{setLocale(locale),dropdownOpen.value=!1};return onClickOutside(dropdownRef,event=>{buttonRef.value?.contains(event.target)||(dropdownOpen.value=!1)},{ignore:[buttonRef]}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$1k,[createBaseVNode("button",{ref_key:"buttonRef",ref:buttonRef,class:normalizeClass(["locale-switch-btn",[`locale-switch-btn--${__props.size}`,{"locale-switch-btn--active":dropdownOpen.value}]]),onClick:toggleDropdown},[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-language locale-icon"},null,-1)),__props.showText?(openBlock(),createElementBlock("span",_hoisted_2$1d,toDisplayString(unref(currentLocaleInfo).nativeName),1)):createCommentVNode("",!0)],2),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"locale-dropdown"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"dropdownRef",ref:dropdownRef,class:"locale-dropdown",style:normalizeStyle(dropdownStyle.value)},[createBaseVNode("div",_hoisted_3$15,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-globe header-icon"},null,-1)),createBaseVNode("span",_hoisted_4$11,toDisplayString(unref($t2)("locale.selectLanguage")),1)]),createBaseVNode("div",_hoisted_5$X,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(localeOptions),option=>(openBlock(),createElementBlock("button",{key:option.value,class:normalizeClass(["locale-option",{active:unref(currentLocale)===option.value}]),onClick:$event=>selectLocale(option.value)},[createBaseVNode("div",_hoisted_7$H,toDisplayString(option.emoji),1),createBaseVNode("div",_hoisted_8$F,[createBaseVNode("div",_hoisted_9$C,toDisplayString(option.nativeName),1),createBaseVNode("div",_hoisted_10$z,toDisplayString(option.description),1)]),unref(currentLocale)===option.value?(openBlock(),createElementBlock("div",_hoisted_11$w,[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-check-circle"},null,-1)])])):createCommentVNode("",!0)],10,_hoisted_6$Q))),128))])],4),[[vShow,dropdownOpen.value&&__props.showDropdown]])]),_:1})]))]))}});const LocaleSwitch=_export_sfc(_sfc_main$1r,[["__scopeId","data-v-3739ddf5"]]),_hoisted_1$1j={class:"navbar-actions"},_hoisted_2$1c={key:0,class:"auth-section desktop-only"},_hoisted_3$14={class:"announcement-button-wrapper"},_hoisted_4$10={key:0,class:"social-links-unauth"},_hoisted_5$W={class:"btn-text"},_hoisted_6$P={key:1,class:"user-terminal desktop-only"},_hoisted_7$G={class:"message-notification-wrapper"},_hoisted_8$E={class:"announcement-button-wrapper"},_hoisted_9$B={key:1,class:"social-links-top"},_hoisted_10$y={class:"user-info-line"},_hoisted_11$v={class:"user-details"},_hoisted_12$r={class:"user-name"},_hoisted_13$p={class:"compact-header"},_hoisted_14$m={class:"user-info"},_hoisted_15$l={class:"user-text"},_hoisted_16$l={class:"user-name"},_hoisted_17$j={class:"compact-content"},_hoisted_18$f={class:"item-text"},_hoisted_19$d={class:"function-grid"},_hoisted_20$c={class:"bottom-actions"},_hoisted_21$b={class:"item-text"},_hoisted_22$a={class:"item-text"},_sfc_main$1q=defineComponent({name:"UserTerminal",__name:"UserTerminal",props:{mobileMenuOpen:{type:Boolean}},emits:["login","toggleMobileMenu"],setup(__props,{emit:__emit}){const emit=__emit,authStore=useAuthStore(),layoutStore=useLayoutStore(),{$t:$t2}=useTexts(),toast=useToast(),router2=useRouter(),{socialLinks,layoutSettings,loadSettings}=useAppearanceSettings(),userMenuOpen=ref(!1),userMenuRef=ref(null),terminalDisplayRef=ref(null),communityDialogRef=ref(),qqGroupDialogRef=ref();onClickOutside(userMenuRef,event=>{terminalDisplayRef.value?.contains(event.target)||userMenuOpen.value&&(userMenuOpen.value=!1)});const userName=computed(()=>authStore.userInfo?.username||""),isAdmin=computed(()=>authStore.isAdmin),toggleUserMenu=()=>{userMenuOpen.value=!userMenuOpen.value},closeUserMenu=()=>{userMenuOpen.value=!1},handleLogout=()=>{authStore.logout(),userMenuOpen.value=!1,toast.info($t2("components.navbar.user.logoutSuccess")),router2.push("/")},toggleMobileMenu=()=>{emit("toggleMobileMenu")},openGitHub=()=>{window.open(socialLinks.value.github.url,"_blank")},openOfficialSite=()=>{window.open(socialLinks.value.official.url,"_blank")},showCommunityDialog=()=>{communityDialogRef.value?.show()},showQQGroupDialog=()=>{qqGroupDialogRef.value?.show()};return onMounted(async()=>{await loadSettings()}),(_ctx,_cache)=>{const _component_CyberThemeToggle=resolveComponent("CyberThemeToggle"),_component_CyberIconButton=resolveComponent("CyberIconButton"),_component_CyberLayoutToggleButton=resolveComponent("CyberLayoutToggleButton"),_component_router_link=resolveComponent("router-link"),_component_CyberCommunityDialog=resolveComponent("CyberCommunityDialog");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$1j,[unref(authStore).isLoggedIn?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_2$1c,[createBaseVNode("div",_hoisted_3$14,[createVNode(AnnouncementButton)]),createVNode(LocaleSwitch,{size:"small"}),createVNode(_component_CyberThemeToggle,{size:"small"}),unref(layoutStore).isTopLayout?(openBlock(),createElementBlock("div",_hoisted_4$10,[unref(socialLinks).official.show?(openBlock(),createBlock(_component_CyberIconButton,{key:0,type:"cyber",size:"small",tooltip:unref($t2)("components.navbar.social.visitWebsite"),"tooltip-placement":"bottom",onClick:openOfficialSite},{default:withCtx(()=>[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-globe"},null,-1)])]),_:1},8,["tooltip"])):createCommentVNode("",!0),unref(socialLinks).github.show?(openBlock(),createBlock(_component_CyberIconButton,{key:1,type:"cyber",size:"small",onClick:openGitHub},{default:withCtx(()=>[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fab fa-github"},null,-1)])]),_:1})):createCommentVNode("",!0),unref(socialLinks).wechat.show&&unref(socialLinks).wechat.hasConfig?(openBlock(),createBlock(_component_CyberIconButton,{key:2,type:"cyber",size:"small",onClick:showCommunityDialog},{default:withCtx(()=>[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fab fa-weixin"},null,-1)])]),_:1})):createCommentVNode("",!0),unref(socialLinks).qq.show&&unref(socialLinks).qq.hasConfig?(openBlock(),createBlock(_component_CyberIconButton,{key:3,type:"cyber",size:"small",onClick:showQQGroupDialog},{default:withCtx(()=>[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fab fa-qq"},null,-1)])]),_:1})):createCommentVNode("",!0)])):createCommentVNode("",!0),createBaseVNode("button",{class:"cyber-login-btn",onClick:_cache[0]||(_cache[0]=$event=>emit("login"))},[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-plug login-icon"},null,-1)),createBaseVNode("span",_hoisted_5$W,toDisplayString(unref($t2)("components.navbar.user.login")),1)])])),unref(authStore).isLoggedIn?(openBlock(),createElementBlock("div",_hoisted_6$P,[createBaseVNode("div",_hoisted_7$G,[createVNode(MessageNotification)]),createBaseVNode("div",_hoisted_8$E,[createVNode(AnnouncementButton)]),createVNode(LocaleSwitch,{size:"small"}),createVNode(_component_CyberThemeToggle,{size:"small"}),unref(layoutStore).isTopLayout&&unref(layoutSettings).multiLayoutEnabled?(openBlock(),createBlock(_component_CyberLayoutToggleButton,{key:0,size:"sm"})):createCommentVNode("",!0),unref(layoutStore).isTopLayout?(openBlock(),createElementBlock("div",_hoisted_9$B,[unref(socialLinks).official.show?(openBlock(),createBlock(_component_CyberIconButton,{key:0,type:"cyber",size:"small",tooltip:unref($t2)("components.navbar.social.visitWebsite"),"tooltip-placement":"bottom",onClick:openOfficialSite},{default:withCtx(()=>[..._cache[6]||(_cache[6]=[createBaseVNode("i",{class:"fas fa-globe"},null,-1)])]),_:1},8,["tooltip"])):createCommentVNode("",!0),unref(socialLinks).github.show?(openBlock(),createBlock(_component_CyberIconButton,{key:1,type:"cyber",size:"small",onClick:openGitHub},{default:withCtx(()=>[..._cache[7]||(_cache[7]=[createBaseVNode("i",{class:"fab fa-github"},null,-1)])]),_:1})):createCommentVNode("",!0),unref(socialLinks).wechat.show&&unref(socialLinks).wechat.hasConfig?(openBlock(),createBlock(_component_CyberIconButton,{key:2,type:"cyber",size:"small",onClick:showCommunityDialog},{default:withCtx(()=>[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fab fa-weixin"},null,-1)])]),_:1})):createCommentVNode("",!0),unref(socialLinks).qq.show&&unref(socialLinks).qq.hasConfig?(openBlock(),createBlock(_component_CyberIconButton,{key:3,type:"cyber",size:"small",onClick:showQQGroupDialog},{default:withCtx(()=>[..._cache[9]||(_cache[9]=[createBaseVNode("i",{class:"fab fa-qq"},null,-1)])]),_:1})):createCommentVNode("",!0)])):createCommentVNode("",!0),createBaseVNode("div",{ref_key:"terminalDisplayRef",ref:terminalDisplayRef,class:"terminal-display",onClick:toggleUserMenu},[createBaseVNode("div",_hoisted_10$y,[createVNode(UserAvatar,{"avatar-url":unref(authStore).userAvatar,username:userName.value,size:"sm",class:"user-avatar-small"},null,8,["avatar-url","username"]),createBaseVNode("div",_hoisted_11$v,[createBaseVNode("span",_hoisted_12$r,toDisplayString(userName.value),1),createBaseVNode("span",{class:normalizeClass(["user-role",{"admin-role":isAdmin.value}])},toDisplayString(isAdmin.value?unref($t2)("components.navbar.user.roles.admin"):unref($t2)("components.navbar.user.roles.user")),3)]),createBaseVNode("i",{class:normalizeClass(["fas fa-chevron-down terminal-chevron",{rotated:userMenuOpen.value}])},null,2)])],512),createVNode(Transition,{name:"terminal-menu"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"userMenuRef",ref:userMenuRef,class:"terminal-dropdown"},[createBaseVNode("div",_hoisted_13$p,[createBaseVNode("div",_hoisted_14$m,[createVNode(UserAvatar,{"avatar-url":unref(authStore).userAvatar,username:userName.value,size:"sm",class:"header-avatar"},null,8,["avatar-url","username"]),createBaseVNode("div",_hoisted_15$l,[createBaseVNode("span",_hoisted_16$l,toDisplayString(userName.value),1),createBaseVNode("span",{class:normalizeClass(["user-badge",{admin:isAdmin.value}])},toDisplayString(isAdmin.value?unref($t2)("components.navbar.user.roles.admin"):unref($t2)("components.navbar.user.roles.user")),3)])]),createBaseVNode("button",{class:"close-btn",onClick:closeUserMenu},[..._cache[10]||(_cache[10]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])]),createBaseVNode("div",_hoisted_17$j,[isAdmin.value?(openBlock(),createBlock(_component_router_link,{key:0,to:"/admin",class:"compact-item admin-item",onClick:closeUserMenu},{default:withCtx(()=>[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-crown item-icon admin-icon"},null,-1)),createBaseVNode("span",_hoisted_18$f,toDisplayString(unref($t2)("components.navbar.navigation.admin")),1),_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-chevron-right arrow"},null,-1))]),_:1})):createCommentVNode("",!0),createBaseVNode("div",_hoisted_19$d,[createVNode(_component_router_link,{to:"/dashboard",class:"grid-item",onClick:closeUserMenu},{default:withCtx(()=>[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-chart-pie item-icon dashboard"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.dashboard")),1)]),_:1}),createVNode(_component_router_link,{to:"/resource",class:"grid-item",onClick:closeUserMenu},{default:withCtx(()=>[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-images item-icon images"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.myWorks")),1)]),_:1}),createVNode(_component_router_link,{to:"/folders",class:"grid-item",onClick:closeUserMenu},{default:withCtx(()=>[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-folder item-icon folders"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.folders")),1)]),_:1}),createVNode(_component_router_link,{to:"/shares",class:"grid-item",onClick:closeUserMenu},{default:withCtx(()=>[_cache[16]||(_cache[16]=createBaseVNode("i",{class:"fas fa-share-alt item-icon shares"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.shares")),1)]),_:1})]),createBaseVNode("div",_hoisted_20$c,[createVNode(_component_router_link,{to:"/settings",class:"compact-item settings-item",onClick:closeUserMenu},{default:withCtx(()=>[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-cog item-icon"},null,-1)),createBaseVNode("span",_hoisted_21$b,toDisplayString(unref($t2)("components.navbar.user.settings")),1),_cache[18]||(_cache[18]=createBaseVNode("i",{class:"fas fa-chevron-right arrow"},null,-1))]),_:1}),createBaseVNode("button",{class:"compact-item logout-item",onClick:handleLogout},[_cache[19]||(_cache[19]=createBaseVNode("i",{class:"fas fa-sign-out-alt item-icon"},null,-1)),createBaseVNode("span",_hoisted_22$a,toDisplayString(unref($t2)("components.navbar.user.exit")),1)])])])],512),[[vShow,userMenuOpen.value]])]),_:1})])):createCommentVNode("",!0),createBaseVNode("button",{class:"mobile-menu-btn mobile-only",onClick:toggleMobileMenu},[createBaseVNode("div",{class:normalizeClass(["hamburger",{active:__props.mobileMenuOpen}])},[..._cache[20]||(_cache[20]=[createBaseVNode("span",null,null,-1),createBaseVNode("span",null,null,-1),createBaseVNode("span",null,null,-1)])],2)])]),unref(layoutStore).isTopLayout&&unref(socialLinks).wechat.show&&unref(socialLinks).wechat.hasConfig?(openBlock(),createBlock(_component_CyberCommunityDialog,{key:0,type:"wechat","qr-image":unref(socialLinks).wechat.qrImage,"contact-info":unref(socialLinks).wechat.account,ref_key:"communityDialogRef",ref:communityDialogRef},null,8,["qr-image","contact-info"])):createCommentVNode("",!0),unref(layoutStore).isTopLayout&&unref(socialLinks).qq.show&&unref(socialLinks).qq.hasConfig?(openBlock(),createBlock(_component_CyberCommunityDialog,{key:1,type:"qq","qr-image":unref(socialLinks).qq.qrImage,"contact-info":unref(socialLinks).qq.groupNumber,ref_key:"qqGroupDialogRef",ref:qqGroupDialogRef},null,8,["qr-image","contact-info"])):createCommentVNode("",!0)],64)}}});const UserTerminal=_export_sfc(_sfc_main$1q,[["__scopeId","data-v-e3091532"]]),_hoisted_1$1i={class:"mobile-menu-header"},_hoisted_2$1b={class:"mobile-brand"},_hoisted_3$13={class:"brand-icon"},_hoisted_4$$=["src","alt"],_hoisted_5$V={class:"brand-text"},_hoisted_6$O={class:"brand-title"},_hoisted_7$F={class:"brand-pixel"},_hoisted_8$D={class:"brand-punk"},_hoisted_9$A={class:"mobile-menu-content"},_hoisted_10$x={class:"mobile-nav-section"},_hoisted_11$u={key:0,class:"mobile-user-section"},_hoisted_12$q={class:"mobile-user-info"},_hoisted_13$o={class:"mobile-user-details"},_hoisted_14$l={class:"mobile-user-name"},_hoisted_15$k={class:"mobile-user-role"},_hoisted_16$k={class:"mobile-user-actions"},_hoisted_17$i={key:1,class:"mobile-login-section"},_sfc_main$1p=defineComponent({name:"MobileMenu",__name:"MobileMenu",props:{isOpen:{type:Boolean}},emits:["close","login"],setup(__props,{emit:__emit}){const emit=__emit,authStore=useAuthStore(),{$t:$t2}=useTexts(),toast=useToast(),router2=useRouter(),route=useRoute(),{appInfo,brand}=useConfig(),userName=computed(()=>authStore.userInfo?.username||""),isAdmin=computed(()=>authStore.isAdmin),isRouteActive=path=>path==="/"?route.path==="/":route.path.startsWith(path),closeMobileMenu=()=>{emit("close")},handleLogin=()=>{emit("login"),closeMobileMenu()},handleLogout=()=>{authStore.logout(),closeMobileMenu(),toast.info($t2("components.navbar.user.logoutSuccess")),router2.push("/")};return(_ctx,_cache)=>{const _component_router_link=resolveComponent("router-link");return openBlock(),createBlock(Transition,{name:"mobile-menu"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{class:"mobile-menu-overlay",onClick:closeMobileMenu},[createBaseVNode("div",{class:"mobile-menu",onClick:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_1$1i,[createBaseVNode("div",_hoisted_2$1b,[createBaseVNode("div",_hoisted_3$13,[createBaseVNode("img",{src:unref(brand).logo,alt:unref(appInfo).name,class:"brand-img-logo"},null,8,_hoisted_4$$)]),createBaseVNode("div",_hoisted_5$V,[createBaseVNode("h2",_hoisted_6$O,[createBaseVNode("span",_hoisted_7$F,toDisplayString(unref(brand).pixel),1),createBaseVNode("span",_hoisted_8$D,toDisplayString(unref(brand).punk),1)])])]),createBaseVNode("button",{class:"mobile-close-btn",onClick:closeMobileMenu},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])]),createBaseVNode("div",_hoisted_9$A,[createBaseVNode("div",_hoisted_10$x,[createVNode(_component_router_link,{to:"/",class:normalizeClass(["mobile-nav-item",{active:isRouteActive("/")}]),onClick:closeMobileMenu},{default:withCtx(()=>[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"mobile-nav-icon fas fa-home"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.navigation.home")),1)]),_:1},8,["class"]),createVNode(_component_router_link,{to:"/upload",class:normalizeClass(["mobile-nav-item mobile-upload",{active:isRouteActive("/upload")}]),onClick:closeMobileMenu},{default:withCtx(()=>[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"mobile-nav-icon fas fa-upload"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.navigation.upload")),1)]),_:1},8,["class"]),createVNode(_component_router_link,{to:"/explore",class:normalizeClass(["mobile-nav-item",{active:isRouteActive("/explore")}]),onClick:closeMobileMenu},{default:withCtx(()=>[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"mobile-nav-icon fas fa-images"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.navigation.explore")),1)]),_:1},8,["class"]),createVNode(_component_router_link,{to:"/random",class:normalizeClass(["mobile-nav-item",{active:isRouteActive("/random")}]),onClick:closeMobileMenu},{default:withCtx(()=>[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"mobile-nav-icon fas fa-random"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.navigation.random")),1)]),_:1},8,["class"]),createBaseVNode("a",{href:"/docs",target:"_blank",class:"mobile-nav-item",onClick:closeMobileMenu},[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"mobile-nav-icon fas fa-code"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.navigation.apiDocs")),1)]),isAdmin.value?(openBlock(),createBlock(_component_router_link,{key:0,to:"/admin",class:normalizeClass(["mobile-nav-item mobile-admin",{active:isRouteActive("/admin")}]),onClick:closeMobileMenu},{default:withCtx(()=>[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"mobile-nav-icon fas fa-cog"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.navigation.admin")),1)]),_:1},8,["class"])):createCommentVNode("",!0)]),unref(authStore).isLoggedIn?(openBlock(),createElementBlock("div",_hoisted_11$u,[createBaseVNode("div",_hoisted_12$q,[createVNode(UserAvatar,{"avatar-url":unref(authStore).userAvatar,username:userName.value,size:"lg"},null,8,["avatar-url","username"]),createBaseVNode("div",_hoisted_13$o,[createBaseVNode("p",_hoisted_14$l,toDisplayString(userName.value),1),createBaseVNode("p",_hoisted_15$k,toDisplayString(isAdmin.value?unref($t2)("components.navbar.user.roles.admin"):unref($t2)("components.navbar.user.roles.user")),1)])]),createBaseVNode("div",_hoisted_16$k,[createVNode(_component_router_link,{to:"/dashboard",class:"mobile-nav-item",onClick:closeMobileMenu},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.dashboard")),1)]),_:1}),createVNode(_component_router_link,{to:"/my-files",class:"mobile-nav-item",onClick:closeMobileMenu},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.myWorks")),1)]),_:1}),createVNode(_component_router_link,{to:"/settings",class:"mobile-nav-item",onClick:closeMobileMenu},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.settings")),1)]),_:1}),createBaseVNode("button",{class:"mobile-nav-item mobile-logout",onClick:handleLogout},[createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.logout")),1)])])])):(openBlock(),createElementBlock("div",_hoisted_17$i,[createBaseVNode("button",{class:"mobile-login-btn",onClick:handleLogin},[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-plug login-icon"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.navbar.user.login")),1)])]))])])],512),[[vShow,__props.isOpen]])]),_:1})}}});const MobileMenu=_export_sfc(_sfc_main$1p,[["__scopeId","data-v-cebd92f1"]]),_hoisted_1$1h={class:"navbar-wrapper"},_hoisted_2$1a={class:"navbar-container"},_hoisted_3$12={key:0,class:"scan-line"},_sfc_main$1o=defineComponent({name:"Navbar",__name:"index",emits:["login","toggleMobileMenu"],setup(__props,{emit:__emit}){const emit=__emit,route=useRoute(),{isLight}=useTheme(),mobileMenuOpen=ref(!1),scrollY=ref(0),isScrolled=computed(()=>route.path==="/"?!1:isLight.value?!0:scrollY.value>20),handleScroll=event=>{const target=event.target;scrollY.value=target.scrollTop};onMounted(()=>{const scrollContainer=document.querySelector(".main-content");scrollContainer&&scrollContainer.addEventListener("scroll",handleScroll)}),onUnmounted(()=>{const scrollContainer=document.querySelector(".main-content");scrollContainer&&scrollContainer.removeEventListener("scroll",handleScroll)});const toggleMobileMenu=()=>{mobileMenuOpen.value=!mobileMenuOpen.value};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$1h,[createBaseVNode("nav",{class:normalizeClass(["cyber-navbar",{scrolled:isScrolled.value}])},[createBaseVNode("div",_hoisted_2$1a,[createVNode(_sfc_main$1A),createVNode(DesktopNav),createVNode(UserTerminal,{"mobile-menu-open":mobileMenuOpen.value,onLogin:_cache[0]||(_cache[0]=$event=>emit("login")),onToggleMobileMenu:toggleMobileMenu},null,8,["mobile-menu-open"])]),isScrolled.value?(openBlock(),createElementBlock("div",_hoisted_3$12)):createCommentVNode("",!0)],2),createVNode(MobileMenu,{"is-open":mobileMenuOpen.value,onClose:toggleMobileMenu,onLogin:_cache[1]||(_cache[1]=$event=>emit("login"))},null,8,["is-open"])]))}});const Navbar=_export_sfc(_sfc_main$1o,[["__scopeId","data-v-dce46fbd"]]),_hoisted_1$1g=["disabled"],_hoisted_2$19={key:0,class:"spinner"},_hoisted_3$11={key:0,class:"spinner inline-spinner"},_hoisted_4$_={key:1,class:"icon-wrap left-icon"},_hoisted_5$U={key:2,class:"button-content"},_hoisted_6$N={key:3,class:"button-content"},_hoisted_7$E={key:2,class:"icon-wrap right-icon"},_sfc_main$1n=defineComponent({name:"CyberButton",__name:"index",props:{type:{default:"primary"},size:{default:"medium"},icon:{default:""},rightIcon:{default:""},loading:{type:Boolean,default:!1},loadingMode:{default:"inline"},disabled:{type:Boolean,default:!1},block:{type:Boolean,default:!1},customClass:{default:""}},emits:["click","mouseover","mouseleave"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,buttonClasses=computed(()=>["cyber-btn",`cyber-btn--${props.type}`,`cyber-btn--${props.size}`,{"cyber-btn--loading":props.loading,"cyber-btn--disabled":props.disabled,"cyber-btn--block":props.block,"cyber-btn--has-icon":props.icon||props.rightIcon,"cyber-btn--replace-mode":props.loading&&props.loadingMode==="replace"},props.customClass]),handleClick=event=>{props.loading||props.disabled||emit("click",event)},onMouseover=event=>{emit("mouseover",event)},onMouseleave=event=>{emit("mouseleave",event)};return(_ctx,_cache)=>(openBlock(),createElementBlock("button",{class:normalizeClass(buttonClasses.value),disabled:__props.disabled||__props.loading,onClick:handleClick,onMouseover,onMouseleave},[__props.loading&&__props.loadingMode==="replace"?(openBlock(),createElementBlock("div",_hoisted_2$19)):(openBlock(),createElementBlock(Fragment,{key:1},[__props.loading&&__props.loadingMode==="inline"?(openBlock(),createElementBlock("div",_hoisted_3$11)):createCommentVNode("",!0),!__props.loading&&(__props.icon||_ctx.$slots.icon)?(openBlock(),createElementBlock("span",_hoisted_4$_,[renderSlot(_ctx.$slots,"icon",{},()=>[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(["fas",`fa-${__props.icon}`])},null,2)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0),__props.loadingMode==="replace"||!__props.loading?(openBlock(),createElementBlock("span",_hoisted_5$U,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])):createCommentVNode("",!0),__props.loadingMode==="inline"&&__props.loading?(openBlock(),createElementBlock("span",_hoisted_6$N,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])):createCommentVNode("",!0)],64)),__props.rightIcon||_ctx.$slots.rightIcon?(openBlock(),createElementBlock("span",_hoisted_7$E,[renderSlot(_ctx.$slots,"rightIcon",{},()=>[__props.rightIcon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(["fas",`fa-${__props.rightIcon}`])},null,2)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0)],42,_hoisted_1$1g))}});const __unplugin_components_0$4=_export_sfc(_sfc_main$1n,[["__scopeId","data-v-db56aad0"]]),_hoisted_1$1f={class:"dialog-header"},_hoisted_2$18={class:"dialog-title"},_hoisted_3$10={key:0},_hoisted_4$Z={key:1,class:"dialog-footer"},_sfc_main$1m=defineComponent({name:"CyberDialog",inheritAttrs:!1,__name:"index",props:{modelValue:{type:Boolean,default:!1},title:{default:""},width:{default:"420px"},height:{default:"auto"},maxWidth:{default:"90vw"},maxHeight:{default:"90vh"},showDefaultFooter:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},noPadding:{type:Boolean,default:!1},noScroll:{type:Boolean,default:!1},showFooter:{type:Boolean,default:!1},cancelText:{default:""},confirmText:{default:""},loading:{type:Boolean,default:!1},closeOnEsc:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0},hideBorder:{type:Boolean,default:!1},fullscreen:{type:Boolean}},emits:["update:modelValue","confirm","cancel","close"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,dialogTitle=()=>props.title||$t2("dialog.title"),dialogCancelText=()=>props.cancelText||$t2("actions.cancel"),dialogConfirmText=()=>props.confirmText||$t2("actions.confirm"),handleOverlayClick=()=>{props.closeOnClickOverlay&&closeDialog()},lockBodyScroll=()=>{const y=window.scrollY||window.pageYOffset;document.body.style.position="fixed",document.body.style.top=`-${y}px`,document.body.style.width="100%"},unlockBodyScroll=()=>{const scrollY=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(scrollY||"0")*-1)},handleKeyDown=event=>{event.key==="Escape"&&props.closeOnEsc&&closeDialog(),event.key==="Enter"&&props.showDefaultFooter&&confirmDialog()};watch(()=>props.modelValue,val=>{val?lockBodyScroll():unlockBodyScroll()},{immediate:!0}),onMounted(()=>{props.closeOnEsc&&document.addEventListener("keydown",handleKeyDown),props.modelValue&&lockBodyScroll()}),onUnmounted(()=>{props.closeOnEsc&&document.removeEventListener("keydown",handleKeyDown),unlockBodyScroll()});const closeDialog=()=>{emit("update:modelValue",!1),emit("close"),emit("cancel")},confirmDialog=()=>{emit("confirm")};return(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton");return openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-dialog"},{default:withCtx(()=>[__props.modelValue?(openBlock(),createElementBlock("div",{key:0,class:"dialog-overlay",onClick:withModifiers(handleOverlayClick,["self"])},[createBaseVNode("div",mergeProps({class:"dialog-container cyber-panel",style:{width:__props.width,height:__props.height,maxWidth:__props.maxWidth,maxHeight:__props.maxHeight,border:__props.hideBorder?"none":"1px solid var(--color-border-default)"}},_ctx.$attrs),[createBaseVNode("div",_hoisted_1$1f,[renderSlot(_ctx.$slots,"header",{},()=>[createBaseVNode("h3",_hoisted_2$18,toDisplayString(dialogTitle()),1)],!0),__props.showCloseButton?(openBlock(),createElementBlock("button",{key:0,class:"dialog-close-btn",onClick:closeDialog},[..._cache[0]||(_cache[0]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",{class:normalizeClass(["dialog-content",{"no-padding":__props.noPadding,"no-scroll":__props.noScroll}])},[renderSlot(_ctx.$slots,"default",{},void 0,!0)],2),_ctx.$slots.footer||__props.showFooter?(openBlock(),createElementBlock("div",_hoisted_3$10,[renderSlot(_ctx.$slots,"footer",{},void 0,!0)])):__props.showDefaultFooter?(openBlock(),createElementBlock("div",_hoisted_4$Z,[createVNode(_component_CyberButton,{type:"outlined",onClick:closeDialog},{default:withCtx(()=>[createTextVNode(toDisplayString(dialogCancelText()),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",loading:__props.loading,onClick:confirmDialog},{default:withCtx(()=>[createTextVNode(toDisplayString(dialogConfirmText()),1)]),_:1},8,["loading"])])):createCommentVNode("",!0)],16)])):createCommentVNode("",!0)]),_:3})])}}});const __unplugin_components_3=_export_sfc(_sfc_main$1m,[["__scopeId","data-v-0d567ada"]]),_hoisted_1$1e={key:0,class:"cyber-input__prepend"},_hoisted_2$17={class:"cyber-input__inner"},_hoisted_3$$={key:0,class:"cyber-input__prefix"},_hoisted_4$Y=["id","value","placeholder","disabled","readonly","rows","maxlength","name"],_hoisted_5$T=["id","value","type","placeholder","disabled","readonly","maxlength","name","autocomplete"],_hoisted_6$M={key:3,class:"cyber-input__suffix"},_hoisted_7$D={key:4,class:"cyber-input__unit"},_hoisted_8$C={key:5,class:"cyber-input__password-toggle"},_hoisted_9$z={key:1,class:"cyber-input__append"},_hoisted_10$w={key:0,class:"cyber-input__error-message"},_sfc_main$1l=defineComponent({name:"CyberInput",inheritAttrs:!1,__name:"index",props:{modelValue:{default:""},type:{default:"text"},placeholder:{default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},maxlength:{},autocomplete:{default:"off"},name:{default:""},rows:{default:3},error:{type:Boolean,default:!1},errorMessage:{default:""},prefixIcon:{default:""},suffixIcon:{default:""},inputId:{default:""},width:{default:void 0},height:{default:void 0},no3d:{type:Boolean,default:!1}},emits:["update:modelValue","input","change","focus","blur","keydown","keyup","enter","clear"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,emit=__emit,inputRef=ref(null),focused=ref(!1),showPassword=ref(!1),slots=useSlots(),attrs=useAttrs(),filteredAttrs=computed(()=>{const filtered={...attrs};return delete filtered.class,delete filtered.style,delete filtered.size,filtered}),hasUnitSlot=computed(()=>!!slots.unit),wrapperStyle=computed(()=>{const style={};return props.width&&(style.width=props.width),props.height&&(style.height=props.height,style.minHeight=props.height),style}),inputType=computed(()=>props.type==="password"?showPassword.value?"text":"password":props.type==="textarea"?"text":props.type),togglePasswordVisibility=()=>{showPassword.value=!showPassword.value},onInput=e=>{const target=e.target,{value}=target;if(props.type==="number")if(value==="")emit("update:modelValue","");else{const numberValue=parseFloat(value);isNaN(numberValue)||emit("update:modelValue",numberValue)}else emit("update:modelValue",value);emit("input",e)},onChange=e=>{emit("change",e)},onFocus=e=>{focused.value=!0,emit("focus",e)},onBlur=e=>{focused.value=!1,emit("blur",e)},onKeyup=e=>{e.key==="Enter"&&emit("enter",e),emit("keyup",e)},onKeydown=e=>{emit("keydown",e)},onClear=()=>{emit("update:modelValue",""),emit("clear"),inputRef.value?.focus()},focus=()=>{inputRef.value?.focus()};return __expose({focus,blur:()=>{inputRef.value?.blur()},select:()=>{inputRef.value?.select()},inputRef}),onMounted(()=>{props.autofocus&&!props.disabled&&focus()}),(_ctx,_cache)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["cyber-input-wrapper",[{"cyber-input--disabled":__props.disabled,"cyber-input--error":__props.error===!0||!!__props.errorMessage,"cyber-input--with-prepend":_ctx.$slots.prepend,"cyber-input--with-prefix":_ctx.$slots.prefix||__props.prefixIcon,"cyber-input--with-suffix":_ctx.$slots.suffix||__props.suffixIcon||__props.clearable,"cyber-input--with-append":_ctx.$slots.append,"cyber-input--with-unit":hasUnitSlot.value,"cyber-input--focused":focused.value,"cyber-input--no3d":__props.no3d}]]),style:normalizeStyle(wrapperStyle.value)},[_ctx.$slots.prepend?(openBlock(),createElementBlock("div",_hoisted_1$1e,[renderSlot(_ctx.$slots,"prepend",{},void 0,!0)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_2$17,[_ctx.$slots.prefix||__props.prefixIcon?(openBlock(),createElementBlock("div",_hoisted_3$$,[renderSlot(_ctx.$slots,"prefix",{},()=>[__props.prefixIcon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(`fas fa-${__props.prefixIcon}`)},null,2)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0),__props.type==="textarea"?(openBlock(),createElementBlock("textarea",mergeProps({key:1,id:__props.inputId||void 0,ref_key:"inputRef",ref:inputRef,value:__props.modelValue,class:["cyber-textarea",{"has-error":__props.error===!0||!!__props.errorMessage}],placeholder:__props.placeholder,disabled:__props.disabled,readonly:__props.readonly,rows:__props.rows,maxlength:__props.maxlength,name:__props.name},filteredAttrs.value,{onInput,onChange,onFocus,onBlur,onKeyup,onKeydown}),null,16,_hoisted_4$Y)):(openBlock(),createElementBlock("input",mergeProps({key:2,id:__props.inputId||void 0,ref_key:"inputRef",ref:inputRef,value:__props.modelValue,type:inputType.value,class:["cyber-input",{"has-error":__props.error||!!__props.errorMessage}],placeholder:__props.placeholder,disabled:__props.disabled,readonly:__props.readonly,maxlength:__props.maxlength,name:__props.name,autocomplete:__props.autocomplete},filteredAttrs.value,{onInput,onChange,onFocus,onBlur,onKeyup,onKeydown}),null,16,_hoisted_5$T)),_ctx.$slots.suffix||__props.suffixIcon||__props.clearable?(openBlock(),createElementBlock("div",_hoisted_6$M,[__props.clearable&&__props.modelValue&&!__props.disabled?(openBlock(),createElementBlock("i",{key:0,class:"cyber-input__clear fas fa-times-circle",onClick:withModifiers(onClear,["stop"])})):createCommentVNode("",!0),renderSlot(_ctx.$slots,"suffix",{},()=>[__props.suffixIcon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(`fas fa-${__props.suffixIcon}`)},null,2)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0),_ctx.$slots.unit?(openBlock(),createElementBlock("div",_hoisted_7$D,[renderSlot(_ctx.$slots,"unit",{},void 0,!0)])):createCommentVNode("",!0),__props.type==="password"?(openBlock(),createElementBlock("div",_hoisted_8$C,[createBaseVNode("i",{class:normalizeClass(`fas fa-${showPassword.value?"eye-slash":"eye"}`),onClick:withModifiers(togglePasswordVisibility,["stop"])},null,2)])):createCommentVNode("",!0)]),_ctx.$slots.append?(openBlock(),createElementBlock("div",_hoisted_9$z,[renderSlot(_ctx.$slots,"append",{},void 0,!0)])):createCommentVNode("",!0)],6),__props.errorMessage?(openBlock(),createElementBlock("div",_hoisted_10$w,toDisplayString(__props.errorMessage),1)):createCommentVNode("",!0)],64))}});const __unplugin_components_2=_export_sfc(_sfc_main$1l,[["__scopeId","data-v-779ec5bf"]]),_hoisted_1$1d={class:"cyber-popconfirm"},_hoisted_2$16={key:0,class:"cyber-popconfirm__arrow"},_hoisted_3$_={class:"cyber-popconfirm__content"},_hoisted_4$X={class:"cyber-popconfirm__header"},_hoisted_5$S={class:"cyber-popconfirm__title"},_hoisted_6$L={key:0,class:"cyber-popconfirm__description"},_hoisted_7$C={key:1,class:"cyber-popconfirm__custom-content"},_hoisted_8$B={class:"cyber-popconfirm__buttons"},_sfc_main$1k=defineComponent({__name:"index",props:{title:{default:""},description:{default:""},placement:{default:"top"},trigger:{default:"click"},visible:{type:Boolean,default:!1},showArrow:{type:Boolean,default:!0},icon:{default:"question-circle"},type:{default:"primary"},cancelText:{default:""},confirmText:{default:""},confirmLoading:{type:Boolean,default:!1},hideAfterConfirm:{type:Boolean,default:!0},zIndex:{default:Z_INDEX$1.DROPDOWN},width:{default:"auto"},offset:{default:10}},emits:["update:visible","cancel","confirm","show","hide"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,{$t:$t2}=useTexts(),emit=__emit,isVisible=ref(props.visible),triggerRef2=ref(null),popupRef=ref(null),triggerBounding=useElementBounding(triggerRef2),popupStyle=computed(()=>({width:typeof props.width=="number"?`${props.width}px`:props.width,zIndex:props.zIndex})),showOnHover=computed(()=>props.trigger==="hover");watch(()=>props.visible,val=>{val!==isVisible.value&&(isVisible.value=val,val&&nextTick(()=>updatePosition()))}),watch(isVisible,val=>{emit("update:visible",val),val&&nextTick(()=>updatePosition())});let resizeObserver=null;const setupResizeObserver=()=>{triggerRef2.value&&"ResizeObserver"in window&&(resizeObserver=new ResizeObserver(()=>{isVisible.value&&updatePosition()}),resizeObserver.observe(triggerRef2.value))},show=async()=>{isVisible.value=!0,emit("show"),nextTick(()=>updatePosition())},hide=()=>{isVisible.value=!1,emit("hide")},updatePosition=()=>{if(!popupRef.value||!triggerRef2.value||!document.body.contains(triggerRef2.value)){isVisible.value&&hide();return}triggerBounding.update();const popupRect=popupRef.value.getBoundingClientRect(),{placement,offset}=props;let left=0,top=0;switch(placement){case"top":left=triggerBounding.left.value+(triggerBounding.width.value-popupRect.width)/2,top=triggerBounding.top.value-popupRect.height-offset;break;case"top-start":left=triggerBounding.left.value,top=triggerBounding.top.value-popupRect.height-offset;break;case"top-end":left=triggerBounding.right.value-popupRect.width,top=triggerBounding.top.value-popupRect.height-offset;break;case"bottom":left=triggerBounding.left.value+(triggerBounding.width.value-popupRect.width)/2,top=triggerBounding.bottom.value+offset;break;case"bottom-start":left=triggerBounding.left.value,top=triggerBounding.bottom.value+offset;break;case"bottom-end":left=triggerBounding.right.value-popupRect.width,top=triggerBounding.bottom.value+offset;break;case"left":left=triggerBounding.left.value-popupRect.width-offset,top=triggerBounding.top.value+(triggerBounding.height.value-popupRect.height)/2;break;case"right":left=triggerBounding.right.value+offset,top=triggerBounding.top.value+(triggerBounding.height.value-popupRect.height)/2;break}left=Math.max(10,Math.min(left,window.innerWidth-popupRect.width-10)),top=Math.max(10,Math.min(top,window.innerHeight-popupRect.height-10)),popupRef.value&&(popupRef.value.style.left=`${left}px`,popupRef.value.style.top=`${top}px`)},debouncedUpdatePosition=((fn,delay)=>{let timer=null;return function(){timer&&window.clearTimeout(timer),timer=window.setTimeout(()=>{fn()},delay)}})(updatePosition,50),handleTriggerClick=e=>{props.trigger==="click"&&(e.stopPropagation(),e.preventDefault(),isVisible.value?hide():show())},handleCancel2=()=>{hide(),emit("cancel")},handleConfirm2=()=>{emit("confirm"),props.hideAfterConfirm&&hide()};onClickOutside(popupRef,event=>{isVisible.value&&triggerRef2.value&&!triggerRef2.value.contains(event.target)&&hide()},{ignore:[],capture:!0,detectIframe:!0}),useEventListener(window,"resize",()=>{isVisible.value&&debouncedUpdatePosition()}),useEventListener(window,"scroll",()=>{isVisible.value&&debouncedUpdatePosition()},{capture:!0});let mutationObserver=null;const setupMutationObserver=()=>{if(!triggerRef2.value)return;let listContainer=triggerRef2.value.parentElement;for(;listContainer&&!["UL","OL","DIV"].includes(listContainer.tagName);)listContainer=listContainer.parentElement;listContainer&&(mutationObserver=new MutationObserver(()=>{isVisible.value&&debouncedUpdatePosition()}),mutationObserver.observe(listContainer,{childList:!0,subtree:!1,attributes:!1}))};return onMounted(()=>{isVisible.value&&nextTick(()=>updatePosition()),setupResizeObserver(),setupMutationObserver()}),onBeforeUnmount(()=>{resizeObserver&&(resizeObserver.disconnect(),resizeObserver=null),mutationObserver&&(mutationObserver.disconnect(),mutationObserver=null)}),__expose({show,hide,updatePosition}),(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton");return openBlock(),createElementBlock("div",_hoisted_1$1d,[createBaseVNode("div",{ref_key:"triggerRef",ref:triggerRef2,class:"cyber-popconfirm__trigger",onClick:handleTriggerClick,onMouseenter:_cache[0]||(_cache[0]=$event=>showOnHover.value&&show()),onMouseleave:_cache[1]||(_cache[1]=$event=>showOnHover.value&&hide())},[renderSlot(_ctx.$slots,"reference",{},void 0,!0)],544),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-popconfirm-fade"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"popupRef",ref:popupRef,class:normalizeClass(["cyber-popconfirm__popup",[`cyber-popconfirm__popup--${__props.placement}`,{"cyber-popconfirm__popup--with-arrow":__props.showArrow}]]),style:normalizeStyle(popupStyle.value)},[__props.showArrow?(openBlock(),createElementBlock("div",_hoisted_2$16)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_3$_,[createBaseVNode("div",_hoisted_4$X,[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(["cyber-popconfirm__icon",[`fas fa-${__props.icon}`,`cyber-popconfirm__icon--${__props.type}`]])},null,2)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_5$S,toDisplayString(__props.title||unref($t2)("popconfirm.title")),1)]),__props.description?(openBlock(),createElementBlock("div",_hoisted_6$L,toDisplayString(__props.description),1)):createCommentVNode("",!0),_ctx.$slots.content?(openBlock(),createElementBlock("div",_hoisted_7$C,[renderSlot(_ctx.$slots,"content",{},void 0,!0)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_8$B,[createVNode(_component_CyberButton,{type:"secondary",size:"small",onClick:handleCancel2},{default:withCtx(()=>[createTextVNode(toDisplayString(__props.cancelText||unref($t2)("actions.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:__props.type==="warning"?"danger":__props.type,loading:__props.confirmLoading,size:"small",onClick:handleConfirm2},{default:withCtx(()=>[createTextVNode(toDisplayString(__props.confirmText||unref($t2)("popconfirm.confirm")),1)]),_:1},8,["type","loading"])])])],6),[[vShow,isVisible.value]])]),_:3})]))])}}});const Popconfirm=_export_sfc(_sfc_main$1k,[["__scopeId","data-v-83abd253"]]),useBreadcrumbStore=defineStore("breadcrumb",()=>{const items=ref([]);function setItems(newItems){items.value=newItems}function clear(){items.value=[]}return{items,setItems,clear}}),_hoisted_1$1c=["aria-label"],_hoisted_2$15={class:"breadcrumb-list"},_hoisted_3$Z=["onClick"],_hoisted_4$W={key:1,class:"breadcrumb-current"},_hoisted_5$R={key:2,class:"breadcrumb-separator"},_sfc_main$1j=defineComponent({__name:"index",props:{items:{default:()=>[]},autoGenerate:{type:Boolean,default:!0},maxItems:{default:6},startVisible:{default:1},endVisible:{default:2}},setup(__props){const{$t:$t2}=useTexts(),props=__props,route=useRoute(),router2=useRouter(),breadcrumbStore=useBreadcrumbStore(),normalizeItems=items=>items.map((item,_index)=>"name"in item&&"id"in item?{label:item.name,path:item.id?`/folders/${item.id}`:"/folders"}:item),routeNameMap=computed(()=>({dashboard:$t2("components.breadcrumb.routes.dashboard"),folders:$t2("components.breadcrumb.routes.folders"),explore:$t2("components.breadcrumb.routes.explore"),"category-manage":$t2("components.breadcrumb.routes.categoryManage"),"tag-manage":$t2("components.breadcrumb.routes.tagManage"),automation:$t2("components.breadcrumb.routes.automation"),shares:$t2("components.breadcrumb.routes.shares"),settings:$t2("components.breadcrumb.routes.settings")})),breadcrumbItems=computed(()=>{if(props.items.length>0){const normalized=normalizeItems(props.items);return normalized.map((item,index2)=>({...item,path:index2===normalized.length-1?void 0:item.path}))}if(!props.autoGenerate)return[];const items=[{label:$t2("components.breadcrumb.home"),path:"/dashboard"}];if((route.name==="folders"||route.name==="foldersWithPath")&&breadcrumbStore.items.length>0){items.push({label:$t2("components.breadcrumb.routes.folders"),path:"/folders"});for(let i=0;i<breadcrumbStore.items.length;i++){const item=breadcrumbStore.items[i];i!==0&&(i===breadcrumbStore.items.length-1?items.push({label:item.name}):items.push({label:item.name,path:item.path}))}return items}const pathSegments=route.path.split("/").filter(Boolean);let currentPath="";return pathSegments.forEach((segment,index2)=>{currentPath+=`/${segment}`;const label=routeNameMap.value[segment]||segment;index2===pathSegments.length-1?items.push({label}):items.push({label,path:currentPath})}),items}),handleClick=item=>{item.path&&router2.push(item.path)};return(_ctx,_cache)=>(openBlock(),createElementBlock("nav",{class:"breadcrumb-nav","aria-label":unref($t2)("components.breadcrumb.ariaLabel")},[createBaseVNode("ol",_hoisted_2$15,[(openBlock(!0),createElementBlock(Fragment,null,renderList(breadcrumbItems.value,(item,index2)=>(openBlock(),createElementBlock("li",{key:index2,class:"breadcrumb-item"},[item.path?(openBlock(),createElementBlock("button",{key:0,class:"breadcrumb-link",onClick:$event=>handleClick(item)},[createBaseVNode("span",null,toDisplayString(item.label),1)],8,_hoisted_3$Z)):(openBlock(),createElementBlock("span",_hoisted_4$W,[createBaseVNode("span",null,toDisplayString(item.label),1)])),index2<breadcrumbItems.value.length-1?(openBlock(),createElementBlock("span",_hoisted_5$R," / ")):createCommentVNode("",!0)]))),128))])],8,_hoisted_1$1c))}});const Breadcrumb=_export_sfc(_sfc_main$1j,[["__scopeId","data-v-ba243ec9"]]),_hoisted_1$1b={class:"loading-container"},_hoisted_2$14=["data-text"],_sfc_main$1i=defineComponent({name:"CyberLoading",__name:"index",props:{visible:{type:Boolean,default:!1},fullScreen:{type:Boolean,default:!1},text:{default:""},background:{default:"var(--color-overlay-heavy)"},textColor:{default:"var(--color-brand-500)"}},setup(__props){const props=__props,{$t:$t2}=useTexts(),displayText=computed(()=>props.text||$t2("status.loading"));return(_ctx,_cache)=>__props.visible?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["cyber-loading",[{"full-screen":__props.fullScreen}]]),style:normalizeStyle({background:__props.fullScreen?__props.background:"transparent"})},[createBaseVNode("div",_hoisted_1$1b,[_cache[0]||(_cache[0]=createStaticVNode('<div class="loading-animation" data-v-c6ce50d8><div class="hexagon" data-v-c6ce50d8><div class="hex-inner" data-v-c6ce50d8></div></div><div class="glitch-circles" data-v-c6ce50d8><div class="circle circle-1" data-v-c6ce50d8></div><div class="circle circle-2" data-v-c6ce50d8></div><div class="circle circle-3" data-v-c6ce50d8></div></div><div class="scan-line" data-v-c6ce50d8></div></div><div class="fallback-spinner" aria-hidden="true" data-v-c6ce50d8><i class="fas fa-circle-notch fa-spin" data-v-c6ce50d8></i></div>',2)),displayText.value?(openBlock(),createElementBlock("div",{key:0,class:"loading-text",style:normalizeStyle({color:__props.textColor})},[createBaseVNode("span",{class:"text-glitch","data-text":displayText.value},toDisplayString(displayText.value),9,_hoisted_2$14)],4)):createCommentVNode("",!0)])],6)):createCommentVNode("",!0)}});const Loading=_export_sfc(_sfc_main$1i,[["__scopeId","data-v-c6ce50d8"]]),_sfc_main$1h=defineComponent({name:"CyberFolderTreeItem",props:{folder:{type:Object,required:!0},level:{type:Number,default:0},selectedId:{type:String,default:""},borderColor:{type:String,default:"var(--color-brand-500)"},isExpanded:{type:Boolean,default:!1},expandedFolders:{type:Set,default:()=>new Set},cachedChildren:{type:Array,default:()=>[]},getFolderChildren:{type:Function,required:!0}},emits:["select","toggle","children-loaded","subfolder-request-start","subfolder-request-end"],setup(props,{emit}){const isLoading2=ref(!1),isExpanded=computed(()=>props.isExpanded),children=computed(()=>props.cachedChildren),hasChildren=computed(()=>props.folder.has_children!==!1),toggleExpand=async e=>{e.stopPropagation();const newExpandedState=!isExpanded.value;if(newExpandedState&&children.value.length===0&&!isLoading2.value){isLoading2.value=!0,emit("subfolder-request-start");try{const result=await getFolderList(props.folder.id);if(result.success){const processedFolders=(result.data||[]).map(folder=>({...folder,fullPath:`${props.folder.fullPath} / ${folder.name}`}));emit("children-loaded",props.folder.id,processedFolders)}else console.error("Failed to fetch subfolders:",result.message)}catch(error2){console.error("Failed to fetch subfolders:",error2)}finally{isLoading2.value=!1,emit("subfolder-request-end")}}emit("toggle",props.folder.id,newExpandedState)};return{isLoading:isLoading2,children,hasChildren,toggleExpand,handleToggleClick:e=>{hasChildren.value&&toggleExpand(e)},selectFolderItem:()=>{emit("select",props.folder)}}}});const _hoisted_1$1a={class:"cyber-folder-tree-item__content"},_hoisted_2$13={key:0,class:"fas fa-spinner fa-spin cyber-folder-tree-item__toggle-icon"},_hoisted_3$Y={key:1,class:"fas fa-chevron-down cyber-folder-tree-item__toggle-icon cyber-folder-tree-item__toggle-icon--expanded"},_hoisted_4$V={key:2,class:"fas fa-chevron-right cyber-folder-tree-item__toggle-icon"},_hoisted_5$Q={class:"cyber-folder-tree-item__icon"},_hoisted_6$K={class:"cyber-folder-tree-item__name"};function _sfc_render(_ctx,_cache,$props,$setup,$data,$options){const _component_cyber_folder_tree_item=resolveComponent("cyber-folder-tree-item");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["cyber-folder-tree-item",{"cyber-folder-tree-item--selected":_ctx.selectedId===_ctx.folder.id}]),style:normalizeStyle({paddingLeft:`${_ctx.level*16+8}px`}),onClick:_cache[1]||(_cache[1]=withModifiers((...args)=>_ctx.selectFolderItem&&_ctx.selectFolderItem(...args),["stop"]))},[createBaseVNode("div",_hoisted_1$1a,[createBaseVNode("div",{class:normalizeClass(["cyber-folder-tree-item__toggle",{"cyber-folder-tree-item__toggle--has-children":_ctx.hasChildren}]),onClick:_cache[0]||(_cache[0]=withModifiers((...args)=>_ctx.handleToggleClick&&_ctx.handleToggleClick(...args),["stop"]))},[_ctx.hasChildren&&_ctx.isLoading?(openBlock(),createElementBlock("i",_hoisted_2$13)):_ctx.hasChildren&&_ctx.isExpanded?(openBlock(),createElementBlock("i",_hoisted_3$Y)):_ctx.hasChildren?(openBlock(),createElementBlock("i",_hoisted_4$V)):createCommentVNode("",!0)],2),createBaseVNode("div",_hoisted_5$Q,[createBaseVNode("i",{class:"fas fa-folder",style:normalizeStyle({color:_ctx.borderColor})},null,4)]),createBaseVNode("span",_hoisted_6$K,toDisplayString(_ctx.folder.name),1)])],6),createVNode(Transition,{name:"cyber-folder-tree-item-expand"},{default:withCtx(()=>[_ctx.isExpanded?(openBlock(),createElementBlock("div",{key:0,class:"cyber-folder-tree-item__children",style:normalizeStyle({"--guide-color":`${_ctx.borderColor}40`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(_ctx.children,child=>(openBlock(),createBlock(_component_cyber_folder_tree_item,{key:child.id,folder:child,level:_ctx.level+1,"selected-id":_ctx.selectedId,"border-color":_ctx.borderColor,"is-expanded":_ctx.expandedFolders.has(child.id),"expanded-folders":_ctx.expandedFolders,"cached-children":_ctx.getFolderChildren(child.id),"get-folder-children":_ctx.getFolderChildren,onSelect:_cache[2]||(_cache[2]=$event=>_ctx.$emit("select",$event)),onToggle:_cache[3]||(_cache[3]=(folderId,isExpanded)=>_ctx.$emit("toggle",folderId,isExpanded)),onChildrenLoaded:_cache[4]||(_cache[4]=(folderId,children)=>_ctx.$emit("children-loaded",folderId,children)),onSubfolderRequestStart:_cache[5]||(_cache[5]=$event=>_ctx.$emit("subfolder-request-start")),onSubfolderRequestEnd:_cache[6]||(_cache[6]=$event=>_ctx.$emit("subfolder-request-end"))},null,8,["folder","level","selected-id","border-color","is-expanded","expanded-folders","cached-children","get-folder-children"]))),128))],4)):createCommentVNode("",!0)]),_:1})],64)}const FolderTreeItem=_export_sfc(_sfc_main$1h,[["render",_sfc_render],["__scopeId","data-v-b59df59a"]]);function useFolderPath(){const getFolderPath=async folderId=>{try{const pathChainResult=await getFolderPathChain(folderId);if(pathChainResult.success)return pathChainResult.data.path_chain.map(chain=>({id:chain.id,name:chain.name,parent_id:chain.parent_id,created_at:""}))}catch(error2){console.warn("[useFolderPath] Path API failed, using legacy method:",error2)}return await getFolderPathLegacy(folderId)},getBatchFolderPaths=async folderIds=>{try{const batchResult=await getBatchFolderPathChains(folderIds);if(batchResult.success){const result2={};return batchResult.data.forEach(pathChain=>{result2[pathChain.folder_id]=pathChain.path_chain.map(chain=>({id:chain.id,name:chain.name,parent_id:chain.parent_id,created_at:""}))}),result2}}catch(error2){console.warn("[useFolderPath] Batch path chain API failed, falling back to individual requests:",error2)}const result={};for(const folderId of folderIds)try{result[folderId]=await getFolderPath(folderId)}catch(error2){console.error(`[useFolderPath] Failed to get path for folder ${folderId}:`,error2)}return result},getFolderPathString=async folderId=>{try{const pathChainResult=await getFolderPathChain(folderId);if(pathChainResult.success)return pathChainResult.data.full_path}catch(error2){console.warn("[useFolderPath] Path string API failed, using fallback:",error2)}return(await getFolderPath(folderId)).map(folder=>folder.name).join(" / ")},getFolderPathLegacy=async folderId=>{const path=[];let currentId=folderId;for(;currentId;)try{const result=await getFolderDetail(currentId);if(result.success)path.unshift(result.data),currentId=result.data.parent_id||"";else break}catch(error2){console.error("[useFolderPath] Legacy method failed:",error2);break}return path};return{getFolderPath,getBatchFolderPaths,getFolderPathString}}const _hoisted_1$19={class:"cyber-folder-tree__display"},_hoisted_2$12=["title"],_hoisted_3$X={class:"cyber-folder-tree__search"},_hoisted_4$U={class:"cyber-folder-tree__search-wrapper"},_hoisted_5$P=["placeholder"],_hoisted_6$J={class:"cyber-folder-tree__list"},_hoisted_7$B={key:0,class:"cyber-folder-tree__loading"},_hoisted_8$A={key:1,class:"cyber-folder-tree__empty"},_hoisted_9$y={key:2,class:"cyber-folder-tree__items"},_hoisted_10$v={class:"cyber-folder-tree__item-content"},_hoisted_11$t={class:"cyber-folder-tree__item-name"},_hoisted_12$p=["onClick"],_hoisted_13$n={class:"cyber-folder-tree__item-content"},_hoisted_14$k={class:"cyber-folder-tree__item-icon"},_hoisted_15$j={class:"cyber-folder-tree__item-info"},_hoisted_16$j={class:"cyber-folder-tree__item-name"},_hoisted_17$h=["title"],_sfc_main$1g=defineComponent({name:"CyberFolderTree",__name:"index",props:{modelValue:{default:""},borderColor:{default:""},presetPath:{default:""},maxPathLength:{default:50},width:{default:""},height:{default:"30px"},dropdownZIndex:{default:0}},emits:["update:modelValue","folderSelected"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),authStore=useAuthStore(),{getFolderPathString}=useFolderPath(),state=ref({isOpen:!1,isLoading:!1,isRequestingSubfolders:!1,selectedId:props.modelValue||"",selectedPath:"",searchQuery:""}),folders=shallowRef({topLevel:[],all:[],searchResults:[]}),expandedFolders=ref(new Set),foldersChildrenCache=ref(new Map),dropdownRef=ref(null),searchInputRef=ref(null),{update:updateBounding,top,left,width,bottom}=useElementBounding(dropdownRef,{windowScroll:!0}),{height:windowHeight}=useWindowSize(),wrapperStyle=computed(()=>props.width?{width:props.width}:{}),triggerStyle=computed(()=>props.height?{height:props.height}:{}),isDropdownAbove=computed(()=>windowHeight.value-bottom.value<330),dropdownStyle=computed(()=>{const baseStyle={position:"fixed",left:`${left.value}px`,width:`${width.value}px`,zIndex:props.dropdownZIndex||Z_INDEX$1.DROPDOWN};return isDropdownAbove.value?{...baseStyle,bottom:`${windowHeight.value-top.value}px`}:{...baseStyle,top:`${bottom.value}px`}}),effectiveBorderColor=computed(()=>props.borderColor||"var(--color-brand-500)"),displayPath=computed(()=>{if(props.presetPath)return props.presetPath;if(!state.value.selectedPath)return $t2("components.folderTree.selectFolder");const path=state.value.selectedPath;if(path.length<=props.maxPathLength)return path;const parts=path.split(" / ");if(parts.length<=1)return`${path.substring(0,props.maxPathLength-3)}...`;const firstPart=parts[0],lastPart=parts[parts.length-1],truncated=`${firstPart} / ... / ${lastPart}`;if(truncated.length<=props.maxPathLength)return truncated;const maxLastPartLength=props.maxPathLength-firstPart.length-7;if(maxLastPartLength>0){const shortLastPart=lastPart.length>maxLastPartLength?`${lastPart.substring(0,maxLastPartLength-3)}...`:lastPart;return`${firstPart} / ... / ${shortLastPart}`}return`${firstPart.substring(0,props.maxPathLength-13)}... / ...`}),filteredFolders=computed(()=>state.value.searchQuery.trim()?folders.value.searchResults:folders.value.topLevel),createDefaultFolder=()=>({id:"",name:$t2("components.folderTree.rootDirectory"),fullPath:"/",children:[]}),buildFolderPaths=(folderList,parentPath="")=>folderList.map(folder=>({...folder,fullPath:parentPath?`${parentPath} / ${folder.name}`:folder.name})),updatePosition=()=>{state.value.isOpen&&updateBounding()},toggleDropdown=()=>{state.value.isOpen=!state.value.isOpen,state.value.isOpen&&nextTick(()=>{searchInputRef.value?.focus(),updateBounding()})},closeDropdown=()=>{state.value.isOpen=!1},selectFolder=folder=>{state.value.selectedId=folder.id,state.value.selectedPath=folder.fullPath||folder.name,emit("update:modelValue",folder.id),emit("folderSelected",{id:folder.id,name:folder.name,path:folder.fullPath||folder.name}),closeDropdown(),setTimeout(()=>{state.value.searchQuery="",folders.value.searchResults=[]},200)},loadFolders=async()=>{try{state.value.isLoading=!0;const result=await getFolderList();if(result.success&&Array.isArray(result.data)){const processedFolders=buildFolderPaths(result.data);folders.value={topLevel:processedFolders,all:[...processedFolders],searchResults:[]},state.value.selectedId&&await loadSelectedFolderPath()}else{const defaultFolder=createDefaultFolder();folders.value={topLevel:[defaultFolder],all:[defaultFolder],searchResults:[]}}}catch(error2){console.error("[FolderTree] Failed to load folders:",error2);const defaultFolder=createDefaultFolder();folders.value={topLevel:[defaultFolder],all:[defaultFolder],searchResults:[]}}finally{state.value.isLoading=!1}},loadSelectedFolderPath=async()=>{if(state.value.selectedId){if(props.presetPath){state.value.selectedPath=props.presetPath;return}try{state.value.selectedPath=await getFolderPathString(state.value.selectedId)}catch(error2){console.error("[FolderTree] Failed to load folder path:",error2)}}},debouncedSearch=useDebounceFn(async()=>{const keyword=state.value.searchQuery.trim();if(!keyword){folders.value.searchResults=[];return}if(!authStore.isAuthenticated){folders.value.searchResults=[];return}try{const response=await searchFolders(keyword);response.success&&response.data?folders.value.searchResults=response.data.map(folder=>({...folder,fullPath:folder.description||folder.name})):folders.value.searchResults=[]}catch(error2){console.error("[FolderTree] Search folders failed:",error2),folders.value.searchResults=[]}},300),handleFolderToggle=(folderId,isExpanded)=>{isExpanded?expandedFolders.value.add(folderId):expandedFolders.value.delete(folderId)},handleChildrenLoaded=(folderId,children)=>{foldersChildrenCache.value.set(folderId,children),folders.value.all=[...folders.value.all,...children]},getFolderChildren=folderId=>foldersChildrenCache.value.get(folderId)||[];return useEventListener(window,"scroll",updatePosition,{passive:!0}),useEventListener(window,"resize",updatePosition,{passive:!0}),onClickOutside(dropdownRef,event=>{const isClickInDropdown=event.target.closest(".cyber-folder-tree__dropdown")!==null;state.value.isOpen&&!state.value.isRequestingSubfolders&&!isClickInDropdown&&closeDropdown()}),watch(()=>props.modelValue,newValue=>{newValue!==state.value.selectedId&&(state.value.selectedId=newValue,loadSelectedFolderPath())}),watch(()=>props.presetPath,newPath=>{newPath&&state.value.selectedId&&(state.value.selectedPath=newPath)}),watch(()=>state.value.searchQuery,debouncedSearch),watch(()=>state.value.isOpen,isOpen=>{isOpen&&nextTick(updateBounding)}),onMounted(async()=>{await loadFolders()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-folder-tree",{"cyber-folder-tree--open":state.value.isOpen}]),style:normalizeStyle(wrapperStyle.value),ref_key:"dropdownRef",ref:dropdownRef},[createBaseVNode("div",{class:normalizeClass(["cyber-folder-tree__trigger",{"cyber-folder-tree__trigger--active":state.value.isOpen}]),style:normalizeStyle([triggerStyle.value,{"--border-color":effectiveBorderColor.value}]),onClick:toggleDropdown},[createBaseVNode("div",_hoisted_1$19,[createBaseVNode("i",{class:"fas fa-folder cyber-folder-tree__icon",style:normalizeStyle({color:effectiveBorderColor.value})},null,4),createBaseVNode("span",{class:normalizeClass(["cyber-folder-tree__text",{"cyber-folder-tree__text--placeholder":!state.value.selectedPath}]),title:state.value.selectedPath||displayPath.value},toDisplayString(displayPath.value),11,_hoisted_2$12)]),createBaseVNode("i",{class:normalizeClass(["fas fa-chevron-down cyber-folder-tree__arrow",{"cyber-folder-tree__arrow--rotated":state.value.isOpen}])},null,2)],6),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-folder-tree-dropdown",onEnter:unref(updateBounding),onAfterEnter:unref(updateBounding)},{default:withCtx(()=>[state.value.isOpen?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["cyber-folder-tree__dropdown",{"cyber-folder-tree__dropdown--above":isDropdownAbove.value}]),style:normalizeStyle(dropdownStyle.value)},[createBaseVNode("div",_hoisted_3$X,[createBaseVNode("div",_hoisted_4$U,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-search cyber-folder-tree__search-icon"},null,-1)),withDirectives(createBaseVNode("input",{ref_key:"searchInputRef",ref:searchInputRef,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>state.value.searchQuery=$event),type:"text",class:"cyber-folder-tree__search-input",placeholder:unref($t2)("components.folderTree.searchPlaceholder"),onKeydown:withKeys(closeDropdown,["escape"])},null,40,_hoisted_5$P),[[vModelText,state.value.searchQuery]]),state.value.searchQuery?(openBlock(),createElementBlock("i",{key:0,class:"fas fa-times cyber-folder-tree__search-clear",onClick:_cache[1]||(_cache[1]=$event=>state.value.searchQuery="")})):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_6$J,[state.value.isLoading?(openBlock(),createElementBlock("div",_hoisted_7$B,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-spinner fa-spin"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("common.loading"))+"...",1)])):filteredFolders.value.length?(openBlock(),createElementBlock("div",_hoisted_9$y,[state.value.searchQuery.trim()?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["cyber-folder-tree__item cyber-folder-tree__item--root",{"cyber-folder-tree__item--selected":state.value.selectedId===""}]),onClick:_cache[2]||(_cache[2]=$event=>selectFolder(createDefaultFolder()))},[createBaseVNode("div",_hoisted_10$v,[_cache[7]||(_cache[7]=createBaseVNode("div",{class:"cyber-folder-tree__item-icon"},[createBaseVNode("i",{class:"fas fa-home"})],-1)),createBaseVNode("span",_hoisted_11$t,toDisplayString(unref($t2)("components.folderTree.rootDirectory")),1)])],2)),state.value.searchQuery.trim()?(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(filteredFolders.value,folder=>(openBlock(),createElementBlock("div",{key:folder.id,class:normalizeClass(["cyber-folder-tree__item cyber-folder-tree__item--search",{"cyber-folder-tree__item--selected":state.value.selectedId===folder.id}]),onClick:$event=>selectFolder(folder)},[createBaseVNode("div",_hoisted_13$n,[createBaseVNode("div",_hoisted_14$k,[createBaseVNode("i",{class:"fas fa-folder",style:normalizeStyle({color:effectiveBorderColor.value})},null,4)]),createBaseVNode("div",_hoisted_15$j,[createBaseVNode("span",_hoisted_16$j,toDisplayString(folder.name),1),createBaseVNode("span",{class:"cyber-folder-tree__item-path",title:folder.fullPath},toDisplayString(folder.fullPath),9,_hoisted_17$h)])])],10,_hoisted_12$p))),128)):(openBlock(!0),createElementBlock(Fragment,{key:2},renderList(filteredFolders.value,folder=>(openBlock(),createBlock(FolderTreeItem,{key:folder.id,folder,level:0,"selected-id":state.value.selectedId,"border-color":effectiveBorderColor.value,"is-expanded":expandedFolders.value.has(folder.id),"expanded-folders":expandedFolders.value,"cached-children":getFolderChildren(folder.id),"get-folder-children":getFolderChildren,onSelect:selectFolder,onToggle:handleFolderToggle,onChildrenLoaded:handleChildrenLoaded,onSubfolderRequestStart:_cache[3]||(_cache[3]=$event=>state.value.isRequestingSubfolders=!0),onSubfolderRequestEnd:_cache[4]||(_cache[4]=$event=>state.value.isRequestingSubfolders=!1)},null,8,["folder","selected-id","border-color","is-expanded","expanded-folders","cached-children"]))),128))])):(openBlock(),createElementBlock("div",_hoisted_8$A,[createBaseVNode("span",null,toDisplayString(state.value.searchQuery.trim()?unref($t2)("components.folderTree.noMatches"):unref($t2)("components.folderTree.noFolders")),1)]))])],6)):createCommentVNode("",!0)]),_:1},8,["onEnter","onAfterEnter"])]))],6))}});const FolderTree=_export_sfc(_sfc_main$1g,[["__scopeId","data-v-ee118029"]]),_hoisted_1$18={key:0,class:"cyber-pagination"},_hoisted_2$11={class:"pagination-container"},_hoisted_3$W={key:0,class:"page-size-section"},_hoisted_4$T={class:"size-label"},_hoisted_5$O=["onClick"],_hoisted_6$I={class:"size-label"},_hoisted_7$A={class:"page-controls"},_hoisted_8$z=["disabled","title"],_hoisted_9$x=["onClick"],_hoisted_10$u={key:1,class:"page-ellipsis"},_hoisted_11$s=["disabled","title"],_hoisted_12$o={class:"page-info"},_hoisted_13$m={key:0,class:"page-jump"},_hoisted_14$j={class:"jump-label"},_hoisted_15$i=["max","placeholder"],_hoisted_16$i={key:1,class:"total-info"},_hoisted_17$g={class:"total-text"},_hoisted_18$e={class:"total-number"},_sfc_main$1f=defineComponent({name:"CyberPagination",__name:"index",props:{currentPage:{},total:{},pageSize:{default:20},pageSizeOptions:{default:()=>[10,20,50,100]},showPageSizeSelector:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0},showTotal:{type:Boolean,default:!0},maxVisiblePages:{default:7},autoScrollToTop:{type:Boolean,default:!0},scrollTarget:{default:""}},emits:["update:currentPage","update:pageSize","page-change","page-size-change"],setup(__props,{emit:__emit}){const _props=__props,emit=__emit,{$t:$t2}=useTexts(),currentPageSize=ref(_props.pageSize),sizeDropdownVisible=ref(!1),jumpPageValue=ref(""),selectorRef=ref(),optionsRef=ref(),popupLeft=ref(0),popupTop=ref(0),popupWidth=ref(0),popupPlacement=ref("down"),popupStyle=computed(()=>({position:"fixed",left:`${popupLeft.value}px`,top:`${popupTop.value}px`,width:`${popupWidth.value}px`,zIndex:9999})),totalPages=computed(()=>Math.ceil(_props.total/currentPageSize.value)),visiblePages=computed(()=>{const current=_props.currentPage,total=totalPages.value,maxVisible=_props.maxVisiblePages;if(total<=maxVisible)return Array.from({length:total},(_,i)=>i+1);const pages=[],halfVisible=Math.floor(maxVisible/2);pages.push(1);let start=Math.max(2,current-halfVisible),end=Math.min(total-1,current+halfVisible);end-start+1<maxVisible-2&&(start===2?end=Math.min(total-1,start+maxVisible-3):start=Math.max(2,end-maxVisible+3)),start>2&&pages.push("...");for(let i=start;i<=end;i++)pages.push(i);return end<total-1&&pages.push("..."),total>1&&pages.push(total),pages}),scrollToTop=()=>{_props.autoScrollToTop&&nextTick(()=>{let targetElement=null;_props.scrollTarget&&(targetElement=document.querySelector(_props.scrollTarget)),targetElement?targetElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}):window.scrollTo({top:0,behavior:"smooth"})})},goToPage=page=>{page>=1&&page<=totalPages.value&&page!==_props.currentPage&&(emit("update:currentPage",page),emit("page-change",page),scrollToTop())},computePopupPosition=async(preOpen=!1)=>{preOpen||await nextTick();const trigger=selectorRef.value;if(!trigger)return;const rect=trigger.getBoundingClientRect(),estimatedHeight=preOpen?160:optionsRef.value?.offsetHeight||160,spaceBelow=window.innerHeight-rect.bottom,spaceAbove=rect.top,openUp=spaceBelow<estimatedHeight+8&&spaceAbove>spaceBelow;popupPlacement.value=openUp?"up":"down",popupLeft.value=Math.round(rect.left),popupWidth.value=Math.round(rect.width),popupTop.value=Math.round(openUp?rect.top-estimatedHeight-4:rect.bottom+4)},openSizeDropdown=async()=>{await computePopupPosition(!0),sizeDropdownVisible.value=!0,await computePopupPosition(!1)},toggleSizeDropdown=async()=>{sizeDropdownVisible.value?sizeDropdownVisible.value=!1:await openSizeDropdown()},selectPageSize=size=>{currentPageSize.value=size,sizeDropdownVisible.value=!1,emit("update:pageSize",size),emit("page-size-change",size);const newTotalPages=Math.ceil(_props.total/size);_props.currentPage>newTotalPages?goToPage(newTotalPages):scrollToTop()},handleJump=()=>{const page=parseInt(jumpPageValue.value);page>=1&&page<=totalPages.value&&(goToPage(page),jumpPageValue.value="")},handleClickOutside=event=>{const target=event.target,insideTrigger=selectorRef.value?.contains(target),insidePopup=optionsRef.value?.contains(target);!insideTrigger&&!insidePopup&&(sizeDropdownVisible.value=!1)},handleWindowUpdate=()=>{sizeDropdownVisible.value&&computePopupPosition()};return onMounted(()=>{document.addEventListener("click",handleClickOutside),window.addEventListener("resize",handleWindowUpdate,{passive:!0}),window.addEventListener("scroll",handleWindowUpdate,{passive:!0})}),onUnmounted(()=>{document.removeEventListener("click",handleClickOutside),window.removeEventListener("resize",handleWindowUpdate),window.removeEventListener("scroll",handleWindowUpdate)}),watch(()=>_props.pageSize,newSize=>{currentPageSize.value=newSize}),(_ctx,_cache)=>totalPages.value>0?(openBlock(),createElementBlock("div",_hoisted_1$18,[createBaseVNode("div",_hoisted_2$11,[_props.showPageSizeSelector?(openBlock(),createElementBlock("div",_hoisted_3$W,[createBaseVNode("span",_hoisted_4$T,toDisplayString(unref($t2)("components.pagination.perPage")),1),createBaseVNode("div",{ref_key:"selectorRef",ref:selectorRef,class:"size-selector"},[createBaseVNode("div",{class:normalizeClass(["size-current",{active:sizeDropdownVisible.value}]),onClick:toggleSizeDropdown},[createBaseVNode("span",null,toDisplayString(currentPageSize.value),1),createBaseVNode("i",{class:normalizeClass(["fas fa-angle-down",{rotate:sizeDropdownVisible.value}])},null,2)],2),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"fade-slide"},{default:withCtx(()=>[sizeDropdownVisible.value?(openBlock(),createElementBlock("div",{key:0,ref_key:"optionsRef",ref:optionsRef,class:"size-options-popup",style:normalizeStyle(popupStyle.value),onMousedown:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"]))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(_props.pageSizeOptions,size=>(openBlock(),createElementBlock("div",{key:size,class:normalizeClass(["size-option",{selected:size===currentPageSize.value}]),onClick:$event=>selectPageSize(size)},toDisplayString(size),11,_hoisted_5$O))),128))],36)):createCommentVNode("",!0)]),_:1})]))],512),createBaseVNode("span",_hoisted_6$I,toDisplayString(unref($t2)("components.pagination.items")),1)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_7$A,[createBaseVNode("button",{class:"page-btn prev-btn",disabled:_props.currentPage===1,title:unref($t2)("components.pagination.prevPage"),onClick:_cache[1]||(_cache[1]=$event=>goToPage(_props.currentPage-1))},[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-chevron-left"},null,-1)])],8,_hoisted_8$z),(openBlock(!0),createElementBlock(Fragment,null,renderList(visiblePages.value,page=>(openBlock(),createElementBlock(Fragment,{key:page},[page!=="..."?(openBlock(),createElementBlock("button",{key:0,class:normalizeClass(["page-btn number-btn",{active:page===_props.currentPage}]),onClick:$event=>goToPage(page)},toDisplayString(page),11,_hoisted_9$x)):(openBlock(),createElementBlock("span",_hoisted_10$u,"‚Ä¢‚Ä¢‚Ä¢"))],64))),128)),createBaseVNode("button",{class:"page-btn next-btn",disabled:_props.currentPage===totalPages.value,title:unref($t2)("components.pagination.nextPage"),onClick:_cache[2]||(_cache[2]=$event=>goToPage(_props.currentPage+1))},[..._cache[5]||(_cache[5]=[createBaseVNode("i",{class:"fas fa-chevron-right"},null,-1)])],8,_hoisted_11$s)]),createBaseVNode("div",_hoisted_12$o,[_props.showQuickJumper&&totalPages.value>5?(openBlock(),createElementBlock("div",_hoisted_13$m,[createBaseVNode("span",_hoisted_14$j,toDisplayString(unref($t2)("components.pagination.jumpTo")),1),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>jumpPageValue.value=$event),type:"number",min:1,max:totalPages.value,class:"jump-input",placeholder:unref($t2)("components.pagination.page"),onKeyup:withKeys(handleJump,["enter"]),onBlur:handleJump},null,40,_hoisted_15$i),[[vModelText,jumpPageValue.value]])])):createCommentVNode("",!0),_props.showTotal?(openBlock(),createElementBlock("div",_hoisted_16$i,[createBaseVNode("span",_hoisted_17$g,[createTextVNode(toDisplayString(unref($t2)("components.pagination.total"))+" ",1),createBaseVNode("em",_hoisted_18$e,toDisplayString(_props.total.toLocaleString()),1),createTextVNode(" "+toDisplayString(unref($t2)("components.pagination.items")),1)])])):createCommentVNode("",!0)])])])):createCommentVNode("",!0)}});const Pagination=_export_sfc(_sfc_main$1f,[["__scopeId","data-v-c8ebbc58"]]),_imports_0="/logo.png",_hoisted_1$17={class:"logo-container"},_hoisted_2$10={class:"logo-icon"},_hoisted_3$V=["alt"],_hoisted_4$S={key:0,class:"logo-text"},_hoisted_5$N={class:"cyber"},_hoisted_6$H={key:0,class:"punk"},_sfc_main$1e=defineComponent({name:"CyberLogo",__name:"index",props:{iconOnly:{type:Boolean,default:!1}},setup(__props){const settingsStore=useSettingsStore(),logoTextParts=computed(()=>{const siteName=settingsStore.siteName;if(siteName.includes(" ")){const parts=siteName.split(" ",2);return{first:parts[0],second:parts[1]||""}}const match=siteName.match(/^([A-Z][a-z]+)([A-Z][a-z]+)$/);return match?{first:match[1],second:match[2]}:{first:siteName,second:""}});return(_ctx,_cache)=>{const _component_router_link=resolveComponent("router-link");return openBlock(),createBlock(_component_router_link,{to:"/",class:"logo-link"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$17,[createBaseVNode("div",_hoisted_2$10,[createBaseVNode("img",{src:_imports_0,alt:`${unref(settingsStore).siteName} Logo`,class:"logo-image"},null,8,_hoisted_3$V)]),__props.iconOnly?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_4$S,[createBaseVNode("span",_hoisted_5$N,toDisplayString(logoTextParts.value.first),1),logoTextParts.value.second?(openBlock(),createElementBlock("span",_hoisted_6$H,toDisplayString(logoTextParts.value.second),1)):createCommentVNode("",!0)]))])]),_:1})}}});const Logo=_export_sfc(_sfc_main$1e,[["__scopeId","data-v-13ec3b33"]]),_hoisted_1$16=["checked","disabled"],_hoisted_2$$={class:"cyber-radio-label"},_sfc_main$1d=defineComponent({name:"CyberRadio",__name:"index",props:{modelValue:{type:[String,Number,Boolean]},value:{type:[String,Number,Boolean]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,handleChange=()=>{props.disabled||emit("update:modelValue",props.value)};return(_ctx,_cache)=>(openBlock(),createElementBlock("label",{class:normalizeClass(["cyber-radio-wrapper",{"is-disabled":props.disabled}])},[createBaseVNode("input",{type:"radio",class:"cyber-radio-input",checked:props.modelValue===props.value,disabled:props.disabled,onChange:handleChange},null,40,_hoisted_1$16),_cache[0]||(_cache[0]=createBaseVNode("span",{class:"cyber-radio"},[createBaseVNode("span",{class:"cyber-radio-inner"})],-1)),createBaseVNode("span",_hoisted_2$$,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])],2))}});const Radio=_export_sfc(_sfc_main$1d,[["__scopeId","data-v-4175ee39"]]),_sfc_main$1c=defineComponent({name:"CyberRadioGroup",__name:"RadioGroup",props:{modelValue:{type:[String,Number,Boolean]},options:{},disabled:{type:Boolean,default:!1},layout:{default:"horizontal"}},emits:["update:modelValue"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,localValue=computed({get:()=>props.modelValue,set:value=>emit("update:modelValue",value)});return(_ctx,_cache)=>{const _component_CyberRadio=resolveComponent("CyberRadio");return openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-radio-group",[`layout-${props.layout}`]])},[(openBlock(!0),createElementBlock(Fragment,null,renderList(props.options,option=>(openBlock(),createBlock(_component_CyberRadio,{key:option.value,modelValue:localValue.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localValue.value=$event),value:option.value,disabled:props.disabled},{default:withCtx(()=>[createTextVNode(toDisplayString(option.label),1)]),_:2},1032,["modelValue","value","disabled"]))),128))],2)}}});const RadioGroup=_export_sfc(_sfc_main$1c,[["__scopeId","data-v-920d548f"]]),_hoisted_1$15={class:"flex items-center"},_hoisted_2$_=["min","max","step","disabled"],_hoisted_3$U={key:0,class:"cyber-slider-value"},_hoisted_4$R={key:0,class:"cyber-slider-description"},_sfc_main$1b=defineComponent({name:"CyberSlider",__name:"index",props:{modelValue:{},min:{default:0},max:{default:100},step:{default:1},disabled:{type:Boolean,default:!1},description:{default:""},showValue:{type:Boolean,default:!1},width:{default:"100%"}},emits:["update:modelValue"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,localValue=computed({get:()=>props.modelValue,set:value=>emit("update:modelValue",parseFloat(value))});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"cyber-slider-wrapper",style:normalizeStyle({width:props.width})},[createBaseVNode("div",_hoisted_1$15,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localValue.value=$event),type:"range",min:__props.min,max:__props.max,step:__props.step,disabled:__props.disabled,class:"cyber-slider"},null,8,_hoisted_2$_),[[vModelText,localValue.value]]),__props.showValue?(openBlock(),createElementBlock("span",_hoisted_3$U,toDisplayString(localValue.value),1)):createCommentVNode("",!0)]),__props.description?(openBlock(),createElementBlock("p",_hoisted_4$R,toDisplayString(__props.description),1)):createCommentVNode("",!0)],4))}});const Slider=_export_sfc(_sfc_main$1b,[["__scopeId","data-v-247c86f4"]]),FILE_TYPES={IMAGE:"image",VIDEO:"video",DOCUMENT:"document",ARCHIVE:"archive",AUDIO:"audio",OTHER:"other"},getFileTypeNames=$t2=>({image:$t2("constants.fileTypes.image"),video:$t2("constants.fileTypes.video"),document:$t2("constants.fileTypes.document"),archive:$t2("constants.fileTypes.archive"),audio:$t2("constants.fileTypes.audio"),other:$t2("constants.fileTypes.other")}),FILE_TYPE_ICONS={image:"fas fa-image",video:"fas fa-video",document:"fas fa-file-alt",archive:"fas fa-file-archive",audio:"fas fa-file-audio",other:"fas fa-file"},FILE_TYPE_COLORS={image:"blue",video:"purple",document:"green",archive:"orange",audio:"pink",other:"gray"},FILE_TYPE_CLASSES={image:"file-type-image",video:"file-type-video",document:"file-type-document",archive:"file-type-archive",audio:"file-type-audio",other:"file-type-other"},SUPPORTED_FILE_FORMATS={image:["jpg","jpeg","png","gif","webp","svg","bmp","ico"],video:["mp4","avi","mov","wmv","flv","mkv","webm","m4v"],document:["pdf","doc","docx","txt","rtf","odt","xls","xlsx","ppt","pptx"],archive:["zip","rar","7z","tar","gz","bz2","xz"],audio:["mp3","wav","flac","aac","ogg","m4a","wma"]};Object.values(SUPPORTED_FILE_FORMATS).flat();const FILE_SIZE_LIMITS={image:50*1024*1024,video:500*1024*1024,document:100*1024*1024,archive:200*1024*1024,audio:100*1024*1024,other:50*1024*1024};function getFileTypeInfo(fileType,$t2){return{name:getFileTypeNames($t2)[fileType],icon:FILE_TYPE_ICONS[fileType],color:FILE_TYPE_COLORS[fileType],className:FILE_TYPE_CLASSES[fileType],sizeLimit:FILE_SIZE_LIMITS[fileType],supportedFormats:SUPPORTED_FILE_FORMATS[fileType]||[]}}const _hoisted_1$14={class:"cyber-file-placeholder"},_hoisted_2$Z={class:"cyber-file-error"},_hoisted_3$T={class:"cyber-file-error-text"},_hoisted_4$Q=["src","alt"],_hoisted_5$M={key:1,class:"cyber-file-icon-display"},_hoisted_6$G={class:"cyber-file-icon-wrapper"},_hoisted_7$z={class:"cyber-file-type-name"},_hoisted_8$y={key:0,class:"cyber-file-name"},_hoisted_9$w={key:2,class:"cyber-image-nsfw-overlay"},_hoisted_10$t={class:"cyber-image-nsfw-text"},_hoisted_11$r={key:3,class:"cyber-image-overlay"},_hoisted_12$n={key:4,class:"cyber-file-dimensions"},_hoisted_13$l={class:"cyber-file-dimension-text"},_sfc_main$1a=defineComponent({name:"CyberFile",__name:"index",props:{fileType:{},src:{},alt:{default:""},width:{default:""},height:{default:""},fitMode:{default:"cover"},rounded:{type:Boolean,default:!1},borderRadius:{default:"4px"},loadingText:{},errorText:{default:""},showLoadingText:{type:Boolean},className:{default:""},placeholder:{default:""},retryCount:{default:0},retryInterval:{default:2e3},maintainAspectRatio:{type:Boolean,default:!0},showDimensions:{type:Boolean,default:!1},backgroundColor:{default:"var(--color-background-900)"},backgroundPattern:{default:"cyber"},isNsfw:{type:Boolean,default:!1}},emits:["load","error","loading","dimensions","view-nsfw"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,loadError=ref(!1),fileRef=ref(null),retryAttempts=ref(0),fileInfo=ref({width:0,height:0,aspectRatio:1}),showNsfwContent=ref(!1),fileTypeInfo=computed(()=>{const type=props.fileType||FILE_TYPES.IMAGE;return getFileTypeInfo(type,$t2)}),isImageFile=computed(()=>!props.fileType||props.fileType===FILE_TYPES.IMAGE),fileTypeClasses=computed(()=>["cyber-file",fileTypeInfo.value.className,`file-${fileTypeInfo.value.color}`]),displayErrorText=computed(()=>props.errorText||$t2("utils.file.loadFailed")),viewNsfwImage=()=>{showNsfwContent.value=!0,emit("view-nsfw")},getFileStyle=()=>{const style={objectFit:props.fitMode};return props.maintainAspectRatio&&fileInfo.value.aspectRatio&&props.fitMode==="contain"&&(style.maxWidth="100%",style.maxHeight="100%",style.width="auto",style.height="auto"),style},handleImageLoaded=()=>{if(fileRef.value){const{naturalWidth,naturalHeight}=fileRef.value;fileInfo.value={width:naturalWidth,height:naturalHeight,aspectRatio:naturalWidth/naturalHeight},emit("dimensions",naturalWidth,naturalHeight)}loadError.value=!1,emit("load")},handleImageError=()=>{if(retryAttempts.value<props.retryCount){retryAttempts.value++,setTimeout(()=>{if(fileRef.value){const timestamp=Date.now(),separator=props.src.includes("?")?"&":"?";fileRef.value.src=`${props.src}${separator}_retry=${timestamp}`}},props.retryInterval);return}loadError.value=!0,emit("error")},preloadImage=src=>{loadError.value=!1,retryAttempts.value=0,src||(loadError.value=!0)};watch(()=>props.src,newSrc=>{newSrc&&preloadImage(newSrc)}),onMounted(()=>{props.src&&preloadImage(props.src)});const getContainerStyle=computed(()=>({width:props.width,height:props.height,borderRadius:props.borderRadius}));return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-file-container",[fileTypeClasses.value,`cyber-file-${__props.fitMode}`,{"cyber-file-rounded":__props.rounded},{"cyber-file-maintain-ratio":__props.maintainAspectRatio},{[`cyber-file-bg-${__props.backgroundPattern}`]:__props.maintainAspectRatio&&__props.backgroundPattern!=="none"},__props.className]]),style:normalizeStyle(getContainerStyle.value)},[withDirectives(createBaseVNode("div",_hoisted_1$14,[createBaseVNode("div",_hoisted_2$Z,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-exclamation-triangle text-error-500"},null,-1)),createBaseVNode("span",_hoisted_3$T,toDisplayString(displayErrorText.value),1)])],512),[[vShow,loadError.value]]),isImageFile.value&&!loadError.value&&(!__props.isNsfw||showNsfwContent.value)?(openBlock(),createElementBlock("img",{key:0,ref_key:"fileRef",ref:fileRef,src:__props.src,alt:__props.alt,style:normalizeStyle(getFileStyle()),onLoad:handleImageLoaded,onError:handleImageError},null,44,_hoisted_4$Q)):!isImageFile.value&&!loadError.value?(openBlock(),createElementBlock("div",_hoisted_5$M,[createBaseVNode("div",_hoisted_6$G,[createBaseVNode("i",{class:normalizeClass([fileTypeInfo.value.icon,"cyber-file-type-icon"])},null,2),createBaseVNode("span",_hoisted_7$z,toDisplayString(fileTypeInfo.value.name),1)]),__props.alt?(openBlock(),createElementBlock("div",_hoisted_8$y,toDisplayString(__props.alt),1)):createCommentVNode("",!0)])):createCommentVNode("",!0),__props.isNsfw&&!showNsfwContent.value&&!loadError.value?(openBlock(),createElementBlock("div",_hoisted_9$w,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-eye-slash cyber-image-nsfw-icon"},null,-1)),createBaseVNode("p",_hoisted_10$t,toDisplayString(unref($t2)("utils.file.nsfwWarning")),1),createBaseVNode("button",{class:"cyber-image-nsfw-button",onClick:viewNsfwImage},[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-eye cyber-image-nsfw-button-icon"},null,-1)),createTextVNode(toDisplayString(unref($t2)("actions.view")),1)])])):createCommentVNode("",!0),_ctx.$slots.overlay?(openBlock(),createElementBlock("div",_hoisted_11$r,[renderSlot(_ctx.$slots,"overlay",{},void 0,!0)])):createCommentVNode("",!0),__props.showDimensions&&fileInfo.value.width&&!loadError.value&&isImageFile.value?(openBlock(),createElementBlock("div",_hoisted_12$n,[createBaseVNode("span",_hoisted_13$l,toDisplayString(fileInfo.value.width)+" √ó "+toDisplayString(fileInfo.value.height),1)])):createCommentVNode("",!0)],6))}});const File=_export_sfc(_sfc_main$1a,[["__scopeId","data-v-c6f3d3cd"]]),_hoisted_1$13={class:"preview-area flex h-full flex-col"},_hoisted_2$Y={class:"image-wrapper relative h-[340px] flex-shrink-0 overflow-hidden rounded-lg border border-default"},_hoisted_3$S={class:"image-info-card absolute bottom-2 left-2 right-2 rounded px-3 py-2"},_hoisted_4$P={class:"flex justify-between text-xs text-content"},_hoisted_5$L={class:"mt-1 text-xs text-content-muted"},_hoisted_6$F={key:0,class:"tags-section mt-2"},_hoisted_7$y={class:"section-title-compact flex items-center"},_hoisted_8$x={class:"tags-container tags-scroll-area mt-1 flex flex-wrap content-start gap-1.5"},_sfc_main$19=defineComponent({name:"FilePreview",__name:"FilePreview",props:{fileInfo:{}},setup(__props){const{$t:$t2}=useTexts(),formatFileSize2=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`};return(_ctx,_cache)=>{const _component_CyberTag=resolveComponent("CyberTag");return openBlock(),createElementBlock("div",_hoisted_1$13,[createBaseVNode("div",_hoisted_2$Y,[createVNode(unref(File),{src:__props.fileInfo.full_url||__props.fileInfo.url,alt:__props.fileInfo.display_name||__props.fileInfo.original_name,"fit-mode":"contain","maintain-aspect-ratio":!0,class:"h-full w-full"},null,8,["src","alt"]),createBaseVNode("div",_hoisted_3$S,[createBaseVNode("div",_hoisted_4$P,[createBaseVNode("span",null,toDisplayString(__props.fileInfo.width)+" √ó "+toDisplayString(__props.fileInfo.height),1),createBaseVNode("span",null,toDisplayString(formatFileSize2(__props.fileInfo.size)),1)]),createBaseVNode("div",_hoisted_5$L,toDisplayString(__props.fileInfo.format?.toUpperCase()||"UNKNOWN")+" ¬∑ "+toDisplayString(__props.fileInfo.ai_info?.resolution||unref($t2)("components.fileDetailModal.basicInfo.unknownResolution")),1)])]),__props.fileInfo.ai_info?.tags?.length?(openBlock(),createElementBlock("div",_hoisted_6$F,[createBaseVNode("h3",_hoisted_7$y,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-tags mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.ai.tags")),1)]),createBaseVNode("div",_hoisted_8$x,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.fileInfo.ai_info.tags,(tag,index2)=>(openBlock(),createBlock(_component_CyberTag,{key:index2,variant:"primary",size:"small",truncate:""},{default:withCtx(()=>[createTextVNode(toDisplayString(tag),1)]),_:2},1024))),128))])])):createCommentVNode("",!0)])}}});const FilePreview=_export_sfc(_sfc_main$19,[["__scopeId","data-v-ef6121ef"]]),VisibilityLabelMap={public:"public",private:"private",protected:"protected",link:"link"},_hoisted_1$12={class:"basic-info-area"},_hoisted_2$X={class:"info-section h-full"},_hoisted_3$R={class:"section-title-compact flex items-center"},_hoisted_4$O={class:"info-grid-compact mt-1 space-y-1"},_hoisted_5$K={class:"info-item-compact"},_hoisted_6$E={class:"info-label-compact"},_hoisted_7$x={class:"info-value-compact font-mono text-xs"},_hoisted_8$w={class:"info-item-compact"},_hoisted_9$v={class:"info-label-compact"},_hoisted_10$s=["title"],_hoisted_11$q={class:"info-item-compact"},_hoisted_12$m={class:"info-label-compact"},_hoisted_13$k={class:"info-item-compact"},_hoisted_14$i={class:"info-label-compact"},_hoisted_15$h={class:"info-value-compact"},_hoisted_16$h={class:"info-item-compact"},_hoisted_17$f={class:"info-label-compact"},_hoisted_18$d={class:"info-value-compact"},_hoisted_19$c={class:"info-item-compact"},_hoisted_20$b={class:"info-label-compact"},_hoisted_21$a={class:"info-item-compact"},_hoisted_22$9={class:"info-label-compact"},_hoisted_23$7=["title"],_hoisted_24$7={class:"info-item-compact"},_hoisted_25$7={class:"info-label-compact"},_hoisted_26$7={class:"info-value-compact text-xs"},_hoisted_27$7={key:0,class:"info-item-compact"},_hoisted_28$7={class:"info-label-compact"},_hoisted_29$5={class:"info-value-compact break-all font-mono text-xs"},_hoisted_30$5={key:1,class:"info-item-compact"},_hoisted_31$5={class:"info-label-compact"},_hoisted_32$5={class:"info-value-compact"},_hoisted_33$5={key:2,class:"info-item-compact"},_hoisted_34$5={class:"info-label-compact"},_hoisted_35$4={class:"flex flex-wrap items-center gap-1"},_sfc_main$18=defineComponent({name:"BasicInfo",__name:"BasicInfo",props:{fileInfo:{}},setup(__props){const{$t:$t2}=useTexts(),formatFileSize2=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},formatDateTime=dateString=>new Date(dateString).toLocaleString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),translateVisibility=visibility=>$t2(`components.fileDetailModal.visibility.${visibility}`)||VisibilityLabelMap[visibility]||visibility;return(_ctx,_cache)=>{const _component_CyberTag=resolveComponent("CyberTag");return openBlock(),createElementBlock("div",_hoisted_1$12,[createBaseVNode("div",_hoisted_2$X,[createBaseVNode("h3",_hoisted_3$R,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-info-circle mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.title")),1)]),createBaseVNode("div",_hoisted_4$O,[createBaseVNode("div",_hoisted_5$K,[createBaseVNode("span",_hoisted_6$E,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.fileId")),1),createBaseVNode("span",_hoisted_7$x,toDisplayString(__props.fileInfo.id),1)]),createBaseVNode("div",_hoisted_8$w,[createBaseVNode("span",_hoisted_9$v,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.originalName")),1),createBaseVNode("span",{class:"info-value-compact truncate",title:__props.fileInfo.original_name},toDisplayString(__props.fileInfo.original_name),9,_hoisted_10$s)]),createBaseVNode("div",_hoisted_11$q,[createBaseVNode("span",_hoisted_12$m,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.fileFormat")),1),createVNode(_component_CyberTag,{variant:"primary",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(__props.fileInfo.format.toUpperCase()),1)]),_:1})]),createBaseVNode("div",_hoisted_13$k,[createBaseVNode("span",_hoisted_14$i,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.fileSize")),1),createBaseVNode("span",_hoisted_15$h,toDisplayString(formatFileSize2(__props.fileInfo.size)),1)]),createBaseVNode("div",_hoisted_16$h,[createBaseVNode("span",_hoisted_17$f,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.imageDimensions")),1),createBaseVNode("span",_hoisted_18$d,toDisplayString(__props.fileInfo.width)+" √ó "+toDisplayString(__props.fileInfo.height),1)]),createBaseVNode("div",_hoisted_19$c,[createBaseVNode("span",_hoisted_20$b,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.visibility")),1),createVNode(_component_CyberTag,{variant:"success",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(translateVisibility(__props.fileInfo.access_level)),1)]),_:1})]),createBaseVNode("div",_hoisted_21$a,[createBaseVNode("span",_hoisted_22$9,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.uploader")),1),createBaseVNode("span",{class:"info-value-compact truncate",title:__props.fileInfo.user_name},toDisplayString(__props.fileInfo.user_name),9,_hoisted_23$7)]),createBaseVNode("div",_hoisted_24$7,[createBaseVNode("span",_hoisted_25$7,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.uploadTime")),1),createBaseVNode("span",_hoisted_26$7,toDisplayString(formatDateTime(__props.fileInfo.created_at)),1)]),__props.fileInfo.md5_hash?(openBlock(),createElementBlock("div",_hoisted_27$7,[createBaseVNode("span",_hoisted_28$7,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.fileHash")),1),createBaseVNode("span",_hoisted_29$5,toDisplayString(__props.fileInfo.md5_hash.substring(0,16))+"...",1)])):createCommentVNode("",!0),__props.fileInfo.views!==void 0?(openBlock(),createElementBlock("div",_hoisted_30$5,[createBaseVNode("span",_hoisted_31$5,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.viewCount")),1),createBaseVNode("span",_hoisted_32$5,toDisplayString(__props.fileInfo.views)+" "+toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.times")),1)])):createCommentVNode("",!0),__props.fileInfo.is_duplicate||__props.fileInfo.is_recommended||__props.fileInfo.ai_info?.is_nsfw?(openBlock(),createElementBlock("div",_hoisted_33$5,[createBaseVNode("span",_hoisted_34$5,toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.status")),1),createBaseVNode("div",_hoisted_35$4,[__props.fileInfo.is_duplicate?(openBlock(),createBlock(_component_CyberTag,{key:0,variant:"warning",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.statusLabels.duplicate")),1)]),_:1})):createCommentVNode("",!0),__props.fileInfo.is_recommended?(openBlock(),createBlock(_component_CyberTag,{key:1,variant:"primary",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.statusLabels.recommended")),1)]),_:1})):createCommentVNode("",!0),__props.fileInfo.ai_info?.is_nsfw?(openBlock(),createBlock(_component_CyberTag,{key:2,variant:"error",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.statusLabels.nsfw")),1)]),_:1})):createCommentVNode("",!0)])])):createCommentVNode("",!0)])])])}}});const BasicInfo=_export_sfc(_sfc_main$18,[["__scopeId","data-v-79ebc2c4"]]),_hoisted_1$11={key:0,class:"ai-info-area"},_hoisted_2$W={class:"info-section h-full"},_hoisted_3$Q={class:"section-title-compact flex items-center"},_hoisted_4$N={class:"info-grid-compact mt-1 space-y-1"},_hoisted_5$J={class:"info-item-compact"},_hoisted_6$D={class:"info-label-compact"},_hoisted_7$w={class:"flex items-center"},_hoisted_8$v={class:"font-mono text-xs"},_hoisted_9$u={class:"info-item-compact"},_hoisted_10$r={class:"info-label-compact"},_hoisted_11$p={class:"info-value-compact"},_hoisted_12$l={key:0,class:"info-item-compact"},_hoisted_13$j={class:"info-label-compact"},_hoisted_14$h={class:"info-value-compact"},_hoisted_15$g={class:"info-item-compact"},_hoisted_16$g={class:"info-label-compact"},_hoisted_17$e={class:"info-value-compact"},_hoisted_18$c={key:1,class:"info-item-compact"},_hoisted_19$b={class:"info-label-compact"},_hoisted_20$a={class:"flex flex-wrap gap-1"},_hoisted_21$9=["title"],_hoisted_22$8={key:2,class:"info-item-compact"},_hoisted_23$6={class:"info-label-compact"},_hoisted_24$6={class:"info-value-compact"},_hoisted_25$6={key:3,class:"info-item-compact"},_hoisted_26$6={class:"info-label-compact"},_hoisted_27$6={class:"info-value-compact"},_hoisted_28$6={class:"mt-3 border-t border-subtle pt-3"},_hoisted_29$4={class:"mb-1 flex items-center text-sm font-semibold text-content"},_hoisted_30$4={class:"space-y-1"},_hoisted_31$4={class:"info-item-compact"},_hoisted_32$4={class:"info-label-compact"},_hoisted_33$4={class:"info-item-compact"},_hoisted_34$4={class:"info-label-compact"},_hoisted_35$3={class:"flex-1"},_hoisted_36$3={class:"mb-1 flex items-center justify-between"},_hoisted_37$3={class:"text-xs text-content"},_hoisted_38$3={class:"relative h-2 overflow-hidden rounded-full bg-background-700"},_sfc_main$17=defineComponent({name:"VisualAnalysis",__name:"VisualAnalysis",props:{fileInfo:{}},setup(__props){const{$t:$t2}=useTexts();return(_ctx,_cache)=>{const _component_CyberTag=resolveComponent("CyberTag");return __props.fileInfo.ai_info?(openBlock(),createElementBlock("div",_hoisted_1$11,[createBaseVNode("div",_hoisted_2$W,[createBaseVNode("h3",_hoisted_3$Q,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-eye mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.title")),1)]),createBaseVNode("div",_hoisted_4$N,[createBaseVNode("div",_hoisted_5$J,[createBaseVNode("span",_hoisted_6$D,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.dominantColor")),1),createBaseVNode("div",_hoisted_7$w,[createBaseVNode("div",{class:"mr-2 h-4 w-4 rounded border border-default",style:normalizeStyle({backgroundColor:__props.fileInfo.ai_info.dominant_color})},null,4),createBaseVNode("span",_hoisted_8$v,toDisplayString(__props.fileInfo.ai_info.dominant_color),1)])]),createBaseVNode("div",_hoisted_9$u,[createBaseVNode("span",_hoisted_10$r,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.imageDimensions")),1),createBaseVNode("span",_hoisted_11$p,toDisplayString(__props.fileInfo.width)+" √ó "+toDisplayString(__props.fileInfo.height),1)]),__props.fileInfo.ai_info.aspect_ratio?(openBlock(),createElementBlock("div",_hoisted_12$l,[createBaseVNode("span",_hoisted_13$j,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.aspectRatio")),1),createBaseVNode("span",_hoisted_14$h,toDisplayString(__props.fileInfo.ai_info.aspect_ratio.toFixed(2)),1)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_15$g,[createBaseVNode("span",_hoisted_16$g,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.resolution")),1),createBaseVNode("span",_hoisted_17$e,toDisplayString(__props.fileInfo.ai_info.resolution),1)]),__props.fileInfo.ai_info.color_palette?.length?(openBlock(),createElementBlock("div",_hoisted_18$c,[createBaseVNode("span",_hoisted_19$b,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.colorPalette")),1),createBaseVNode("div",_hoisted_20$a,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.fileInfo.ai_info.color_palette,(color,index2)=>(openBlock(),createElementBlock("div",{key:index2,class:"h-3 w-3 rounded border border-default",style:normalizeStyle({backgroundColor:color}),title:color},null,12,_hoisted_21$9))),128))])])):createCommentVNode("",!0),__props.fileInfo.ai_info.composition?(openBlock(),createElementBlock("div",_hoisted_22$8,[createBaseVNode("span",_hoisted_23$6,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.composition")),1),createBaseVNode("span",_hoisted_24$6,toDisplayString(__props.fileInfo.ai_info.composition),1)])):createCommentVNode("",!0),__props.fileInfo.ai_info.objects_count?(openBlock(),createElementBlock("div",_hoisted_25$6,[createBaseVNode("span",_hoisted_26$6,toDisplayString(unref($t2)("components.fileDetailModal.visualAnalysis.objectsCount")),1),createBaseVNode("span",_hoisted_27$6,toDisplayString(__props.fileInfo.ai_info.objects_count)+" "+toDisplayString(unref($t2)("components.fileDetailModal.basicInfo.count")),1)])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_28$6,[createBaseVNode("h4",_hoisted_29$4,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-shield-alt mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.contentSafety.title")),1)]),createBaseVNode("div",_hoisted_30$4,[createBaseVNode("div",_hoisted_31$4,[createBaseVNode("span",_hoisted_32$4,toDisplayString(unref($t2)("components.fileDetailModal.contentSafety.nsfwStatus")),1),createVNode(_component_CyberTag,{variant:__props.fileInfo.ai_info.is_nsfw?"error":"success",size:"small"},{default:withCtx(()=>[createTextVNode(toDisplayString(__props.fileInfo.ai_info.is_nsfw?unref($t2)("components.fileDetailModal.contentSafety.inappropriate"):unref($t2)("components.fileDetailModal.contentSafety.safe")),1)]),_:1},8,["variant"])]),createBaseVNode("div",_hoisted_33$4,[createBaseVNode("span",_hoisted_34$4,toDisplayString(unref($t2)("components.fileDetailModal.contentSafety.nsfwScore")),1),createBaseVNode("div",_hoisted_35$3,[createBaseVNode("div",_hoisted_36$3,[createBaseVNode("span",_hoisted_37$3,toDisplayString((__props.fileInfo.ai_info.nsfw_score*100).toFixed(1))+"%",1),createBaseVNode("span",{class:normalizeClass(["text-xs",__props.fileInfo.ai_info.nsfw_score>.5?"text-status-error-text":__props.fileInfo.ai_info.nsfw_score>.3?"text-badge-warning-text":"text-status-success-text"])},toDisplayString(__props.fileInfo.ai_info.nsfw_score>.5?unref($t2)("components.fileDetailModal.contentSafety.high"):__props.fileInfo.ai_info.nsfw_score>.3?unref($t2)("components.fileDetailModal.contentSafety.medium"):unref($t2)("components.fileDetailModal.contentSafety.low")),3)]),createBaseVNode("div",_hoisted_38$3,[createBaseVNode("div",{class:normalizeClass(["h-full rounded-full transition-all",__props.fileInfo.ai_info.nsfw_score>.5?"bg-status-error-border":__props.fileInfo.ai_info.nsfw_score>.3?"bg-badge-warning-border":"bg-status-success-border"]),style:normalizeStyle({width:`${__props.fileInfo.ai_info.nsfw_score*100}%`})},null,6)])])])])])])])):createCommentVNode("",!0)}}});const VisualAnalysis=_export_sfc(_sfc_main$17,[["__scopeId","data-v-5554c5a2"]]),_hoisted_1$10={key:0,class:"description-section"},_hoisted_2$V={class:"info-section"},_hoisted_3$P={class:"section-title-compact mb-2 flex items-center"},_hoisted_4$M={class:"description-content rounded-lg border border-subtle bg-background-300 p-3"},_hoisted_5$I={class:"text-sm leading-relaxed text-content"},_sfc_main$16=defineComponent({name:"AIDescription",__name:"AIDescription",props:{fileInfo:{}},setup(__props){const{$t:$t2}=useTexts();return(_ctx,_cache)=>__props.fileInfo.ai_info?.description?(openBlock(),createElementBlock("div",_hoisted_1$10,[createBaseVNode("div",_hoisted_2$V,[createBaseVNode("h3",_hoisted_3$P,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-comment-alt mr-2"},null,-1)),createTextVNode(toDisplayString(unref($t2)("components.fileDetailModal.ai.description")),1)]),createBaseVNode("div",_hoisted_4$M,[createBaseVNode("p",_hoisted_5$I,toDisplayString(__props.fileInfo.ai_info.description),1)])])])):createCommentVNode("",!0)}});const AIDescription=_export_sfc(_sfc_main$16,[["__scopeId","data-v-40c949fa"]]),_hoisted_1$$={key:0,class:"file-detail-content"},_hoisted_2$U={class:"main-info-grid"},_hoisted_3$O={class:"preview-section"},_hoisted_4$L={class:"info-section-wrapper"},_hoisted_5$H={class:"analysis-section"},_hoisted_6$C={class:"ai-description-wrapper"},_sfc_main$15=defineComponent({name:"FileDetailModal",__name:"index",props:{modelValue:{type:Boolean},fileInfo:{},isAdmin:{type:Boolean,default:!1}},emits:["update:modelValue","delete","recommend"],setup(__props){const{$t:$t2}=useTexts(),props=__props,fileInfo=computed(()=>props.fileInfo),getDialogTitle=()=>{const baseTitle=$t2("components.fileDetailModal.title"),fileName=fileInfo.value?.display_name||fileInfo.value?.original_name||$t2("components.fileDetailModal.untitled");return`${baseTitle} - ${fileName}`};return(_ctx,_cache)=>{const _component_CyberDialog=resolveComponent("CyberDialog");return openBlock(),createBlock(_component_CyberDialog,{"model-value":__props.modelValue,title:getDialogTitle(),width:"80vw","max-width":"1400px","max-height":"90vh","show-default-footer":!1,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>_ctx.$emit("update:modelValue",$event))},{default:withCtx(()=>[fileInfo.value?(openBlock(),createElementBlock("div",_hoisted_1$$,[createBaseVNode("div",_hoisted_2$U,[createBaseVNode("div",_hoisted_3$O,[createVNode(FilePreview,{"file-info":fileInfo.value},null,8,["file-info"])]),createBaseVNode("div",_hoisted_4$L,[createVNode(BasicInfo,{"file-info":fileInfo.value},null,8,["file-info"])]),createBaseVNode("div",_hoisted_5$H,[createVNode(VisualAnalysis,{"file-info":fileInfo.value},null,8,["file-info"])])]),createBaseVNode("div",_hoisted_6$C,[createVNode(AIDescription,{"file-info":fileInfo.value},null,8,["file-info"])])])):createCommentVNode("",!0)]),_:1},8,["model-value","title"])}}});const FileDetailModal=_export_sfc(_sfc_main$15,[["__scopeId","data-v-caf7f161"]]),_hoisted_1$_={class:"cyber-tooltip__content"},_sfc_main$14=defineComponent({name:"CyberTooltip",__name:"index",props:{content:{},placement:{default:"top"},trigger:{default:"hover"},disabled:{type:Boolean,default:!1},offset:{default:8},showDelay:{default:0},hideDelay:{default:200},theme:{default:"dark"},maxWidth:{default:"300px"}},setup(__props,{expose:__expose}){const props=__props,visible=ref(!1),trigger=ref(),tooltip=ref(),tooltipStyle=ref({}),arrowStyle=ref({});let showTimer=null,hideTimer=null;const clearTimers=()=>{showTimer&&(clearTimeout(showTimer),showTimer=null),hideTimer&&(clearTimeout(hideTimer),hideTimer=null)},show=()=>{props.disabled||(clearTimers(),showTimer=window.setTimeout(()=>{visible.value=!0,nextTick(()=>{updatePosition()})},props.showDelay))},hide=()=>{clearTimers(),hideTimer=window.setTimeout(()=>{visible.value=!1},props.hideDelay)},handleMouseEnter=()=>{props.trigger==="hover"&&show()},handleMouseLeave=()=>{props.trigger==="hover"&&hide()},handleClick=()=>{props.trigger==="click"&&(visible.value=!visible.value,visible.value&&nextTick(()=>{updatePosition()}))},handleTooltipMouseEnter=()=>{props.trigger==="hover"&&clearTimers()},handleTooltipMouseLeave=()=>{props.trigger==="hover"&&hide()},updatePosition=()=>{if(!trigger.value||!tooltip.value)return;const triggerRect=trigger.value.getBoundingClientRect(),tooltipEl=tooltip.value,tempStyle={position:"fixed",visibility:"hidden",display:"block",top:"0px",left:"0px",maxWidth:typeof props.maxWidth=="number"?`${props.maxWidth}px`:props.maxWidth};Object.assign(tooltipEl.style,tempStyle);const{offsetWidth:tooltipWidth,offsetHeight:tooltipHeight}=tooltipEl;let left=0,top=0;const{placement}=props;let offsetX=0,offsetY=0;switch(Array.isArray(props.offset)?(offsetX=props.offset[0]||0,offsetY=props.offset[1]||0):offsetY=props.offset||8,placement){case"top":case"top-start":case"top-end":top=triggerRect.top-tooltipHeight-offsetY,placement==="top-start"?left=triggerRect.left+offsetX:placement==="top-end"?left=triggerRect.right-tooltipWidth+offsetX:left=triggerRect.left+triggerRect.width/2-tooltipWidth/2+offsetX;break;case"bottom":case"bottom-start":case"bottom-end":top=triggerRect.bottom+offsetY,placement==="bottom-start"?left=triggerRect.left+offsetX:placement==="bottom-end"?left=triggerRect.right-tooltipWidth+offsetX:left=triggerRect.left+triggerRect.width/2-tooltipWidth/2+offsetX;break;case"left":left=triggerRect.left-tooltipWidth-offsetY,top=triggerRect.top+triggerRect.height/2-tooltipHeight/2+offsetX;break;case"right":left=triggerRect.right+offsetY,top=triggerRect.top+triggerRect.height/2-tooltipHeight/2+offsetX;break}const viewportWidth=window.innerWidth,viewportHeight=window.innerHeight;if(left<10?left=10:left+tooltipWidth>viewportWidth-10&&(left=viewportWidth-tooltipWidth-10),top<10?top=10:top+tooltipHeight>viewportHeight-10&&(top=viewportHeight-tooltipHeight-10),tooltipStyle.value={position:"fixed",left:`${left}px`,top:`${top}px`,maxWidth:typeof props.maxWidth=="number"?`${props.maxWidth}px`:props.maxWidth,zIndex:99999,visibility:"visible",display:"block"},arrowStyle.value={},placement==="top"||placement==="bottom"){const arrowLeft=triggerRect.left+triggerRect.width/2-left-4,minLeft=8,maxLeft=tooltipWidth-16,clampedLeft=Math.max(minLeft,Math.min(maxLeft,arrowLeft));arrowStyle.value={left:`${clampedLeft}px`}}else if(placement==="left"||placement==="right"){const arrowTop=triggerRect.top+triggerRect.height/2-top-4,minTop=8,maxTop=tooltipHeight-16,clampedTop=Math.max(minTop,Math.min(maxTop,arrowTop));arrowStyle.value={top:`${clampedTop}px`}}},handleResize=()=>{visible.value&&updatePosition()},handleScroll=()=>{visible.value&&updatePosition()},handleClickOutside=event=>{if(props.trigger==="click"&&visible.value){const target=event.target;!trigger.value?.contains(target)&&!tooltip.value?.contains(target)&&(visible.value=!1)}};return onBeforeUnmount(()=>{clearTimers(),window.removeEventListener("resize",handleResize),window.removeEventListener("scroll",handleScroll,!0),document.removeEventListener("click",handleClickOutside,!0)}),window.addEventListener("resize",handleResize),window.addEventListener("scroll",handleScroll,!0),document.addEventListener("click",handleClickOutside,!0),__expose({show,hide,updatePosition}),(_ctx,_cache)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{ref_key:"trigger",ref:trigger,onMouseenter:handleMouseEnter,onMouseleave:handleMouseLeave,onClick:handleClick},[renderSlot(_ctx.$slots,"default",{},void 0,!0)],544),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-tooltip-fade"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,ref_key:"tooltip",ref:tooltip,class:normalizeClass(["cyber-tooltip",[`cyber-tooltip--${__props.placement}`,{"cyber-tooltip--dark":__props.theme==="dark"}]]),style:normalizeStyle(tooltipStyle.value),onMouseenter:handleTooltipMouseEnter,onMouseleave:handleTooltipMouseLeave},[createBaseVNode("div",{class:normalizeClass(["cyber-tooltip__arrow",`cyber-tooltip__arrow--${__props.placement}`]),style:normalizeStyle(arrowStyle.value)},null,6),createBaseVNode("div",_hoisted_1$_,[renderSlot(_ctx.$slots,"content",{},()=>[createTextVNode(toDisplayString(__props.content),1)],!0)])],38)):createCommentVNode("",!0)]),_:3})]))],64))}});const CyberTooltip=_export_sfc(_sfc_main$14,[["__scopeId","data-v-a2aebe5b"]]),_hoisted_1$Z={key:1,class:"cyber-date-range-input"},_hoisted_2$T={class:"range-separator"},_hoisted_3$N={class:"cyber-date-picker__header"},_hoisted_4$K=["title"],_hoisted_5$G=["title"],_hoisted_6$B=["title"],_hoisted_7$v=["title"],_hoisted_8$u={key:0,class:"cyber-date-picker__year-month-panel"},_hoisted_9$t={class:"year-month-grid"},_hoisted_10$q=["onClick"],_hoisted_11$o={class:"month-grid"},_hoisted_12$k=["onClick"],_hoisted_13$i={class:"cyber-date-picker__weekdays"},_hoisted_14$g={class:"cyber-date-picker__days"},_hoisted_15$f=["onClick"],_hoisted_16$f={key:1,class:"cyber-date-picker__footer"},_hoisted_17$d=["disabled"],_sfc_main$13=defineComponent({name:"CyberDatePicker",__name:"index",props:{modelValue:{default:void 0},type:{default:"date"},size:{default:"medium"},placeholder:{default:void 0},startPlaceholder:{default:void 0},endPlaceholder:{default:void 0},rangeSeparator:{default:void 0},disabled:{type:Boolean,default:!1},format:{default:"YYYY-MM-DD"},disabledDate:{type:Function,default:()=>!1}},emits:["update:modelValue","change"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,datepickerRef=ref(null),pickerVisible=ref(!1),showYearMonthPanel=ref(!1),currentDate=ref(new Date),panelPosition=ref({top:0,left:0}),isRange=computed(()=>props.type==="daterange"),rangeStartDate=ref(null),rangeEndDate=ref(null),rangeSelecting=ref(!1),currentYear=ref(currentDate.value.getFullYear()),currentMonth=ref(currentDate.value.getMonth()),initSelectedDate=()=>{props.modelValue&&(isRange.value&&Array.isArray(props.modelValue)?(rangeStartDate.value=props.modelValue[0],rangeEndDate.value=props.modelValue[1],rangeStartDate.value&&(currentYear.value=rangeStartDate.value.getFullYear(),currentMonth.value=rangeStartDate.value.getMonth())):!isRange.value&&!Array.isArray(props.modelValue)&&(currentDate.value=props.modelValue,currentYear.value=currentDate.value.getFullYear(),currentMonth.value=currentDate.value.getMonth()))};watch(()=>props.modelValue,()=>{initSelectedDate()},{deep:!0,immediate:!0});const weekdayNames=computed(()=>$t2("components.datePicker.weekdays")),monthNames=computed(()=>$t2("components.datePicker.months")),yearMonthLabel=computed(()=>$t2("components.datePicker.yearMonth").replace("{year}",String(currentYear.value)).replace("{month}",String(currentMonth.value+1))),yearList=computed(()=>{const years=[],baseYear=currentYear.value;for(let i=baseYear-5;i<=baseYear+5;i++)years.push(i);return years}),formatDate2=date=>{if(!date)return"";const year=date.getFullYear(),month=(date.getMonth()+1).toString().padStart(2,"0"),day=date.getDate().toString().padStart(2,"0");return`${year}-${month}-${day}`},formattedDate=computed(()=>!isRange.value&&props.modelValue&&!Array.isArray(props.modelValue)?formatDate2(props.modelValue):""),formattedStartDate=computed(()=>isRange.value&&rangeStartDate.value?formatDate2(rangeStartDate.value):isRange.value&&Array.isArray(props.modelValue)&&props.modelValue[0]?formatDate2(props.modelValue[0]):""),formattedEndDate=computed(()=>isRange.value&&rangeEndDate.value?formatDate2(rangeEndDate.value):isRange.value&&Array.isArray(props.modelValue)&&props.modelValue[1]?formatDate2(props.modelValue[1]):""),isValidRange=computed(()=>isRange.value&&rangeStartDate.value&&rangeEndDate.value),days=computed(()=>{const daysArray=[],firstDay=new Date(currentYear.value,currentMonth.value,1),lastDay=new Date(currentYear.value,currentMonth.value+1,0),firstDayWeekday=firstDay.getDay(),prevMonthLastDate=new Date(currentYear.value,currentMonth.value,0).getDate();for(let i=0;i<firstDayWeekday;i++){const date=prevMonthLastDate-firstDayWeekday+i+1,fullDate=new Date(currentYear.value,currentMonth.value-1,date);daysArray.push({date,fullDate,isPrevMonth:!0,isNextMonth:!1,isToday:isSameDate(fullDate,new Date),isDisabled:props.disabledDate(fullDate),isSelected:isSameDate(fullDate,currentDate.value),isRangeStart:isRangeStartDate(fullDate),isRangeEnd:isRangeEndDate(fullDate),isInRange:isDateInRange(fullDate)})}for(let i=1;i<=lastDay.getDate();i++){const fullDate=new Date(currentYear.value,currentMonth.value,i);daysArray.push({date:i,fullDate,isPrevMonth:!1,isNextMonth:!1,isToday:isSameDate(fullDate,new Date),isDisabled:props.disabledDate(fullDate),isSelected:isSameDate(fullDate,currentDate.value),isRangeStart:isRangeStartDate(fullDate),isRangeEnd:isRangeEndDate(fullDate),isInRange:isDateInRange(fullDate)})}const nextMonthDays=42-daysArray.length;for(let i=1;i<=nextMonthDays;i++){const fullDate=new Date(currentYear.value,currentMonth.value+1,i);daysArray.push({date:i,fullDate,isPrevMonth:!1,isNextMonth:!0,isToday:isSameDate(fullDate,new Date),isDisabled:props.disabledDate(fullDate),isSelected:isSameDate(fullDate,currentDate.value),isRangeStart:isRangeStartDate(fullDate),isRangeEnd:isRangeEndDate(fullDate),isInRange:isDateInRange(fullDate)})}return daysArray});function isSameDate(date1,date2){return!date1||!date2?!1:date1.getFullYear()===date2.getFullYear()&&date1.getMonth()===date2.getMonth()&&date1.getDate()===date2.getDate()}function isRangeStartDate(date){return isRange.value&&isSameDate(date,rangeStartDate.value)}function isRangeEndDate(date){return isRange.value&&isSameDate(date,rangeEndDate.value)}function isDateInRange(date){if(!isRange.value||!rangeStartDate.value||!rangeEndDate.value)return!1;const time=date.getTime();return time>rangeStartDate.value.getTime()&&time<rangeEndDate.value.getTime()}const togglePicker=()=>{props.disabled||(pickerVisible.value=!pickerVisible.value,pickerVisible.value&&(updatePanelPosition(),showYearMonthPanel.value=!1))},updatePanelPosition=()=>{if(!datepickerRef.value)return;const rect=datepickerRef.value.getBoundingClientRect();panelPosition.value={top:rect.bottom+window.scrollY+5,left:rect.left+window.scrollX}},prevMonth=()=>{currentMonth.value===0?(currentYear.value--,currentMonth.value=11):currentMonth.value--},nextMonth=()=>{currentMonth.value===11?(currentYear.value++,currentMonth.value=0):currentMonth.value++},prevYear=()=>{currentYear.value--},nextYear=()=>{currentYear.value++},selectYear=year=>{currentYear.value=year,showYearMonthPanel.value=!1},selectMonth=month=>{currentMonth.value=month,showYearMonthPanel.value=!1},selectDate=day=>{if(!day.isDisabled)if(isRange.value)if(!rangeSelecting.value||!rangeStartDate.value)rangeStartDate.value=new Date(day.fullDate),rangeEndDate.value=null,rangeSelecting.value=!0;else{const startTime=rangeStartDate.value.getTime();day.fullDate.getTime()<startTime?(rangeEndDate.value=new Date(rangeStartDate.value),rangeStartDate.value=new Date(day.fullDate)):rangeEndDate.value=new Date(day.fullDate),rangeSelecting.value=!1}else currentDate.value=new Date(day.fullDate),emitSelectedValue(),pickerVisible.value=!1},confirmSelection=()=>{isRange.value&&rangeStartDate.value&&rangeEndDate.value&&(emitSelectedValue(),pickerVisible.value=!1)},clearSelection=()=>{isRange.value?(rangeStartDate.value=null,rangeEndDate.value=null,rangeSelecting.value=!1,emit("update:modelValue",[null,null]),emit("change",[null,null])):(currentDate.value=new Date,emit("update:modelValue",null),emit("change",null))},emitSelectedValue=()=>{if(isRange.value){if(rangeStartDate.value&&rangeEndDate.value){const value=[new Date(rangeStartDate.value),new Date(rangeEndDate.value)];emit("update:modelValue",value),emit("change",value)}}else emit("update:modelValue",new Date(currentDate.value)),emit("change",new Date(currentDate.value))},closeOnClickOutside=e=>{if(pickerVisible.value&&datepickerRef.value){const target=e.target;if(datepickerRef.value.contains(target))return;const panel=document.querySelector(".cyber-date-picker__panel");if(panel&&panel.contains(target))return;pickerVisible.value=!1,showYearMonthPanel.value=!1,isRange.value&&rangeSelecting.value&&(rangeSelecting.value=!1)}};return onMounted(()=>{initSelectedDate(),window.addEventListener("resize",updatePanelPosition),document.addEventListener("click",closeOnClickOutside)}),onBeforeUnmount(()=>{window.removeEventListener("resize",updatePanelPosition),document.removeEventListener("click",closeOnClickOutside)}),(_ctx,_cache)=>{const _component_CyberInput=resolveComponent("CyberInput");return openBlock(),createElementBlock("div",{ref_key:"datepickerRef",ref:datepickerRef,class:normalizeClass(["cyber-date-picker",[`cyber-date-picker--${__props.size}`,{"cyber-date-picker--disabled":__props.disabled,"cyber-date-picker--range":isRange.value,"cyber-date-picker--focused":pickerVisible.value}]])},[createBaseVNode("div",{class:normalizeClass(["cyber-date-picker__trigger",{disabled:__props.disabled}]),onClick:togglePicker},[isRange.value?(openBlock(),createElementBlock("div",_hoisted_1$Z,[createVNode(_component_CyberInput,{"model-value":formattedStartDate.value,placeholder:__props.startPlaceholder||unref($t2)("components.datePicker.startDate"),disabled:__props.disabled,size:__props.size,readonly:"",class:"range-start-input"},{suffix:withCtx(()=>[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)])]),_:1},8,["model-value","placeholder","disabled","size"]),createBaseVNode("span",_hoisted_2$T,toDisplayString(__props.rangeSeparator||unref($t2)("components.datePicker.to")),1),createVNode(_component_CyberInput,{"model-value":formattedEndDate.value,placeholder:__props.endPlaceholder||unref($t2)("components.datePicker.endDate"),disabled:__props.disabled,size:__props.size,readonly:"",class:"range-end-input"},{suffix:withCtx(()=>[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)])]),_:1},8,["model-value","placeholder","disabled","size"])])):(openBlock(),createBlock(_component_CyberInput,{key:0,"model-value":formattedDate.value,placeholder:__props.placeholder||unref($t2)("components.datePicker.selectDate"),disabled:__props.disabled,size:__props.size,readonly:""},{suffix:withCtx(()=>[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)])]),_:1},8,["model-value","placeholder","disabled","size"]))],2),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-datepicker-fade"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{class:"cyber-date-picker__panel",style:normalizeStyle([{left:panelPosition.value.left+"px"},{top:panelPosition.value.top+"px"},{zIndex:2e3}]),onClick:_cache[1]||(_cache[1]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_3$N,[createBaseVNode("button",{class:"header-btn prev-year-btn",title:unref($t2)("components.datePicker.prevYear"),onClick:withModifiers(prevYear,["stop"])},[..._cache[5]||(_cache[5]=[createBaseVNode("i",{class:"fas fa-angle-double-left"},null,-1)])],8,_hoisted_4$K),createBaseVNode("button",{class:"header-btn prev-month-btn",title:unref($t2)("components.datePicker.prevMonth"),onClick:withModifiers(prevMonth,["stop"])},[..._cache[6]||(_cache[6]=[createBaseVNode("i",{class:"fas fa-angle-left"},null,-1)])],8,_hoisted_5$G),createBaseVNode("div",{class:"current-date",onClick:_cache[0]||(_cache[0]=withModifiers($event=>showYearMonthPanel.value=!showYearMonthPanel.value,["stop"]))},[createTextVNode(toDisplayString(yearMonthLabel.value)+" ",1),createBaseVNode("i",{class:normalizeClass(["fas ml-1",[showYearMonthPanel.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)]),createBaseVNode("button",{class:"header-btn next-month-btn",title:unref($t2)("components.datePicker.nextMonth"),onClick:withModifiers(nextMonth,["stop"])},[..._cache[7]||(_cache[7]=[createBaseVNode("i",{class:"fas fa-angle-right"},null,-1)])],8,_hoisted_6$B),createBaseVNode("button",{class:"header-btn next-year-btn",title:unref($t2)("components.datePicker.nextYear"),onClick:withModifiers(nextYear,["stop"])},[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fas fa-angle-double-right"},null,-1)])],8,_hoisted_7$v)]),showYearMonthPanel.value?(openBlock(),createElementBlock("div",_hoisted_8$u,[createBaseVNode("div",_hoisted_9$t,[(openBlock(!0),createElementBlock(Fragment,null,renderList(yearList.value,year=>(openBlock(),createElementBlock("button",{key:"year-"+year,class:normalizeClass(["year-btn",{current:year===currentYear.value}]),onClick:withModifiers($event=>selectYear(year),["stop"])},toDisplayString(year),11,_hoisted_10$q))),128))]),createBaseVNode("div",_hoisted_11$o,[(openBlock(!0),createElementBlock(Fragment,null,renderList(monthNames.value,(month,index2)=>(openBlock(),createElementBlock("button",{key:"month-"+index2,class:normalizeClass(["month-btn",{current:index2===currentMonth.value}]),onClick:withModifiers($event=>selectMonth(index2),["stop"])},toDisplayString(month),11,_hoisted_12$k))),128))])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_13$i,[(openBlock(!0),createElementBlock(Fragment,null,renderList(weekdayNames.value,weekday=>(openBlock(),createElementBlock("div",{key:weekday,class:"weekday-cell"},toDisplayString(weekday),1))),128))]),createBaseVNode("div",_hoisted_14$g,[(openBlock(!0),createElementBlock(Fragment,null,renderList(days.value,(day,index2)=>(openBlock(),createElementBlock("div",{key:index2,class:normalizeClass(["day-cell",{"prev-month":day.isPrevMonth,"next-month":day.isNextMonth,today:day.isToday,selected:day.isSelected,"range-start":day.isRangeStart,"range-end":day.isRangeEnd,"in-range":day.isInRange,disabled:day.isDisabled}]),onClick:withModifiers($event=>selectDate(day),["stop"])},toDisplayString(day.date),11,_hoisted_15$f))),128))]),isRange.value?(openBlock(),createElementBlock("div",_hoisted_16$f,[createBaseVNode("button",{class:"footer-btn clear-btn",onClick:withModifiers(clearSelection,["stop"])},toDisplayString(unref($t2)("components.datePicker.clear")),1),createBaseVNode("button",{class:"footer-btn confirm-btn",disabled:!isValidRange.value,onClick:withModifiers(confirmSelection,["stop"])},toDisplayString(unref($t2)("components.datePicker.confirm")),9,_hoisted_17$d)])):createCommentVNode("",!0)],4),[[vShow,pickerVisible.value]])]),_:1})]))],2)}}});const DatePicker=_export_sfc(_sfc_main$13,[["__scopeId","data-v-d9f09fff"]]),_hoisted_1$Y={class:"cyber-checkbox__input"},_hoisted_2$S=["checked","disabled","name"],_hoisted_3$M={class:"cyber-checkbox__inner"},_hoisted_4$J={key:0,class:"cyber-checkbox__check fas fa-check"},_hoisted_5$F={key:1,class:"cyber-checkbox__indeterminate fas fa-minus"},_hoisted_6$A={key:0,class:"cyber-checkbox__label"},_sfc_main$12=defineComponent({name:"CyberCheckbox",__name:"index",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},label:{type:[String,Number,Boolean]},name:{},indeterminate:{type:Boolean,default:!1},size:{default:"medium"}},emits:["update:modelValue","change"],setup(__props,{emit:__emit}){const emit=__emit,handleChange=e=>{const value=e.target.checked;emit("update:modelValue",value),emit("change",value)};return(_ctx,_cache)=>(openBlock(),createElementBlock("label",{class:normalizeClass(["cyber-checkbox",{"cyber-checkbox--disabled":__props.disabled,"cyber-checkbox--checked":__props.modelValue,"cyber-checkbox--indeterminate":__props.indeterminate,[`cyber-checkbox--${__props.size}`]:__props.size}])},[createBaseVNode("span",_hoisted_1$Y,[createBaseVNode("input",{type:"checkbox",checked:__props.modelValue,disabled:__props.disabled,name:__props.name,onChange:handleChange},null,40,_hoisted_2$S),createBaseVNode("span",_hoisted_3$M,[__props.modelValue&&!__props.indeterminate?(openBlock(),createElementBlock("i",_hoisted_4$J)):createCommentVNode("",!0),__props.indeterminate?(openBlock(),createElementBlock("i",_hoisted_5$F)):createCommentVNode("",!0)])]),_ctx.$slots.default?(openBlock(),createElementBlock("span",_hoisted_6$A,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])):createCommentVNode("",!0)],2))}});const Checkbox=_export_sfc(_sfc_main$12,[["__scopeId","data-v-402f7551"]]),_hoisted_1$X={class:"mobile-navigation"},_hoisted_2$R={key:0,class:"nav-header"},_hoisted_3$L={class:"nav-title"},_hoisted_4$I={key:0,class:"nav-badge"},_hoisted_5$E={key:1,class:"nav-paths"},_hoisted_6$z={class:"path-name"},_hoisted_7$u=["onClick"],_hoisted_8$t={class:"path-content"},_hoisted_9$s={class:"path-name"},_hoisted_10$p={key:2,class:"nav-actions"},_sfc_main$11=defineComponent({__name:"index",props:{items:{default:()=>[]},title:{default:""},hasPassword:{type:Boolean,default:!1},showNavigation:{type:Boolean,default:!0}},emits:["click"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),pathsContainer=ref(null),handleClick=folder=>{emit("click",folder)},scrollToEnd=()=>{if(pathsContainer.value){const container=pathsContainer.value;setTimeout(()=>{container.scrollLeft=container.scrollWidth},0)}};return onMounted(()=>{scrollToEnd()}),watch(()=>props.items?.length,()=>{scrollToEnd()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$X,[__props.title?(openBlock(),createElementBlock("div",_hoisted_2$R,[createBaseVNode("div",_hoisted_3$L,toDisplayString(__props.title),1),__props.hasPassword?(openBlock(),createElementBlock("div",_hoisted_4$I,[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-lock"},null,-1)])])):createCommentVNode("",!0)])):createCommentVNode("",!0),__props.showNavigation?(openBlock(),createElementBlock("div",_hoisted_5$E,[createBaseVNode("div",{class:normalizeClass(["nav-home-item",{active:!__props.items||__props.items.length===0}]),onClick:_cache[0]||(_cache[0]=$event=>handleClick(null))},[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-home"},null,-1)),createBaseVNode("span",_hoisted_6$z,toDisplayString(unref($t2)("navigation.home")),1)],2),createBaseVNode("div",{ref_key:"pathsContainer",ref:pathsContainer,class:"nav-path-items-container"},[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.items,(item,index2)=>(openBlock(),createElementBlock("div",{key:index2,class:normalizeClass(["nav-path-item",{active:index2===__props.items.length-1}]),onClick:$event=>handleClick(item)},[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"path-arrow"},[createBaseVNode("i",{class:"fas fa-chevron-right"})],-1)),createBaseVNode("div",_hoisted_8$t,[createBaseVNode("span",_hoisted_9$s,toDisplayString(item.name),1)])],10,_hoisted_7$u))),128))],512)])):createCommentVNode("",!0),_ctx.$slots.actions?(openBlock(),createElementBlock("div",_hoisted_10$p,[renderSlot(_ctx.$slots,"actions",{},void 0,!0)])):createCommentVNode("",!0)]))}});const MobileNavigation=_export_sfc(_sfc_main$11,[["__scopeId","data-v-93152fc2"]]);function formatText(template,params){let result=template;return Object.keys(params).forEach(key=>{result=result.replace(new RegExp(`\\{${key}\\}`,"g"),String(params[key]))}),result}function formatDate(dateString,format="YYYY-MM-DD HH:mm:ss"){if(!dateString)return"";const date=new Date(dateString);if(isNaN(date.getTime()))return"Invalid date";const year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate(),hours=date.getHours(),minutes=date.getMinutes(),seconds=date.getSeconds(),formatMap={YYYY:year,MM:padZero(month),DD:padZero(day),HH:padZero(hours),mm:padZero(minutes),ss:padZero(seconds),M:month,D:day,H:hours,m:minutes,s:seconds};let result=format;for(const[key,value]of Object.entries(formatMap))result=result.replace(key,String(value));return result}function formatSize(bytes,decimals=2){if(bytes===0)return"0 Bytes";const k=1024,sizes=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(decimals))} ${sizes[i]}`}const formatFileSize=formatSize;function padZero(num){return num<10?`0${num}`:`${num}`}function handleBooleanParam(params,key){if(params[key]===!1||params[key]===void 0&&key in params){const newParams={...params};return delete newParams[key],newParams}return params}function handleBooleanParams(params,keys){let newParams={...params};for(const key of keys)newParams=handleBooleanParam(newParams,key);return newParams}function processParams(params,options={}){const{booleanFields=[],removeEmpty=!0,removeUndefined=!0,removeNull=!1}=options;let processedParams={...params};return booleanFields.length>0&&(processedParams=handleBooleanParams(processedParams,booleanFields)),Object.keys(processedParams).forEach(key=>{const value=processedParams[key];(removeUndefined&&value===void 0||removeNull&&value===null||removeEmpty&&value==="")&&delete processedParams[key]}),processedParams}function formatRelativeTime(dateString){const now=new Date,date=new Date(dateString),diffInMs=now.getTime()-date.getTime(),diffInMinutes=Math.floor(diffInMs/(1e3*60)),diffInHours=Math.floor(diffInMs/(1e3*60*60)),diffInDays=Math.floor(diffInMs/(1e3*60*60*24)),store=useTextThemeStore();return diffInMinutes<1?store.getText("utils.formatting.time.justNow"):diffInMinutes<60?formatText(store.getText("utils.formatting.time.minutesAgo"),{minutes:diffInMinutes}):diffInHours<24?formatText(store.getText("utils.formatting.time.hoursAgo"),{hours:diffInHours}):diffInDays<30?formatText(store.getText("utils.formatting.time.daysAgo"),{days:diffInDays}):date.toLocaleDateString(getCurrentLocale())}const _hoisted_1$W={class:"folder-info"},_hoisted_2$Q=["title"],_hoisted_3$K={class:"folder-meta"},_hoisted_4$H={key:0,class:"folder-count"},_hoisted_5$D={key:1,class:"folder-date"},_sfc_main$10=defineComponent({__name:"index",props:{folder:{}},emits:["click"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),formatDate$1=dateString=>dateString?formatDate(dateString):"",getItemCount=computed(()=>{const folderCount=props.folder.folder_count||0,fileCount=props.folder.file_count||0;if(folderCount===0&&fileCount===0&&props.folder.folder_count===void 0&&props.folder.file_count===void 0)return"";const parts=[];return folderCount>0&&parts.push(`${folderCount} ${$t2("shareFolder.folders")}`),fileCount>0&&parts.push(`${fileCount} ${$t2("shareFolder.images")}`),parts.length>0?parts.join("Ôºå"):$t2("shareFolder.emptyFolder")});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"share-folder-card",onClick:_cache[0]||(_cache[0]=$event=>emit("click",__props.folder))},[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"folder-icon"},[createBaseVNode("div",{class:"icon-inner"},[createBaseVNode("i",{class:"fas fa-folder"})])],-1)),createBaseVNode("div",_hoisted_1$W,[createBaseVNode("div",{class:"folder-name",title:__props.folder.name},toDisplayString(__props.folder.name),9,_hoisted_2$Q),createBaseVNode("div",_hoisted_3$K,[getItemCount.value?(openBlock(),createElementBlock("span",_hoisted_4$H,toDisplayString(getItemCount.value),1)):createCommentVNode("",!0),__props.folder.created_at?(openBlock(),createElementBlock("span",_hoisted_5$D,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)),createTextVNode(" "+toDisplayString(formatDate$1(__props.folder.created_at)),1)])):createCommentVNode("",!0)])])]))}});const ShareFolder=_export_sfc(_sfc_main$10,[["__scopeId","data-v-da3e3682"]]),_hoisted_1$V={class:"cyber-ring-outer"},_hoisted_2$P={class:"cyber-ring-main"},_hoisted_3$J={viewBox:"0 0 86 86",class:"progress-svg"},_hoisted_4$G={class:"ring-center"},_hoisted_5$C={key:0,class:"center-content"},_hoisted_6$y={class:"percent-line"},_hoisted_7$t={class:"percent-display"},_hoisted_8$s={class:"speed-display"},_hoisted_9$r={key:0,class:"queue-display"},_hoisted_10$o={key:1,class:"center-content success"},_hoisted_11$n={class:"status-text"},_hoisted_12$j={key:0,class:"queue-display"},_hoisted_13$h={key:2,class:"center-content error"},_hoisted_14$f={class:"status-text"},_hoisted_15$e={key:0,class:"queue-display"},_hoisted_16$e={key:3,class:"center-content preparing"},_hoisted_17$c={class:"status-text"},_hoisted_18$b={key:0,class:"queue-display"},_hoisted_19$a={key:0,class:"file-tooltip"},_hoisted_20$9={class:"tooltip-content"},_hoisted_21$8={class:"file-name"},_hoisted_22$7={class:"file-progress"},_sfc_main$$=defineComponent({__name:"index",props:{options:{default:()=>({fileId:"",position:{side:"right",y:"50%"},autoClose:!0,closeDelay:3e3,queueSize:0})}},emits:["complete","close"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,toast=useToast(),{$t:$t2}=useTexts(),visible=ref(!0),status=ref("preparing"),progress=ref(0),loaded=ref(0),total=ref(0),fileName=ref(props.options.fileName||""),showFileInfo=ref(!1),downloadStartTime=ref(0),isDragging=ref(!1),dragOffset=ref({x:0,y:0}),currentPosition=ref({x:0,y:0}),dragStartTime=ref(0),queueSize=ref(props.options.queueSize||0);let downloadController=null,autoCloseTimer=null;const getSavedPosition=()=>StorageUtil.get("cyber-downloader-position"),savePosition=(x,y)=>{StorageUtil.set("cyber-downloader-position",{x,y})},initializePosition=()=>{const savedPos=getSavedPosition(),pos=props.options.position||{},{innerWidth:windowWidth,innerHeight:windowHeight}=window,elementSize=120;let x,y;savedPos&&savedPos.x!==0&&savedPos.y!==0?savedPos.x>=0&&savedPos.y>=0&&savedPos.x+elementSize<=windowWidth&&savedPos.y+elementSize<=windowHeight?(x=savedPos.x,y=savedPos.y):(x=windowWidth-elementSize-30,y=(windowHeight-elementSize)/2):(x=pos.side==="left"?30:pos.side==="center"?(windowWidth-elementSize)/2:windowWidth-elementSize-30,y=(windowHeight-elementSize)/2,pos.y&&(y=typeof pos.y=="string"&&pos.y.includes("%")?(windowHeight-elementSize)*(parseInt(pos.y)/100):typeof pos.y=="string"?parseInt(pos.y):pos.y),pos.x&&(x=typeof pos.x=="string"?parseInt(pos.x):pos.x)),currentPosition.value.x=Math.max(0,Math.min(x,windowWidth-elementSize)),currentPosition.value.y=Math.max(0,Math.min(y,windowHeight-elementSize))},floatStyle=computed(()=>({position:"fixed",zIndex:1e4,pointerEvents:"auto",userSelect:"none",cursor:isDragging.value?"grabbing":"grab",left:`${currentPosition.value.x}px`,top:`${currentPosition.value.y}px`,transform:"none"})),progressStyle=computed(()=>{const circumference=2*Math.PI*36;return{strokeDasharray:circumference,strokeDashoffset:circumference-progress.value/100*circumference,transition:"stroke-dashoffset 0.3s ease",filter:"url(#glow)"}}),formatBytes=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(1))} ${sizes[i]}`},formatSpeed=()=>{if(downloadStartTime.value===0||loaded.value===0)return"";const elapsed=(Date.now()-downloadStartTime.value)/1e3;return`${formatBytes(loaded.value/elapsed)}/s`},startDownload=async()=>{try{status.value="downloading",downloadStartTime.value=Date.now(),downloadController=new AbortController;let downloadResult;if(props.options.shareKey?downloadResult=await downloadSharedFile(props.options.fileId,props.options.shareKey,props.options.accessToken,{quality:props.options.quality,format:props.options.format},progressInfo=>{progress.value=progressInfo.percent,loaded.value=progressInfo.loaded,total.value=progressInfo.total}):downloadResult=await downloadFile(props.options.fileId,{quality:props.options.quality,format:props.options.format},progressInfo=>{progress.value=progressInfo.percent,loaded.value=progressInfo.loaded,total.value=progressInfo.total}),downloadController?.signal.aborted)return;let downloadFileName=downloadResult.filename||fileName.value||`file_${props.options.fileId}`;downloadFileName.includes(".")||(downloadFileName+=".jpg");const url=URL.createObjectURL(downloadResult.blob),link=document.createElement("a");link.href=url,link.download=downloadFileName,document.body.appendChild(link),link.click(),document.body.removeChild(link),URL.revokeObjectURL(url),status.value="success",toast.success($t2("components.downloader.completed")),emit("complete",!0),props.options.autoClose&&scheduleAutoClose()}catch(error2){if(downloadController?.signal.aborted)return;toast.error(error2.message),console.error($t2("components.downloader.downloadFailed"),error2),status.value="error",emit("complete",!1),scheduleAutoClose(5e3)}},handleMouseDown=e=>{clearAutoCloseTimer(),dragStartTime.value=Date.now();const rect=e.currentTarget.getBoundingClientRect();dragOffset.value={x:e.clientX-rect.left,y:e.clientY-rect.top},currentPosition.value={x:rect.left,y:rect.top},isDragging.value=!0,document.addEventListener("mousemove",handleMouseMove,{passive:!1}),document.addEventListener("mouseup",handleMouseUp,{passive:!1}),e.preventDefault(),e.stopPropagation()},handleMouseMove=e=>{if(!isDragging.value)return;const elementSize=120,maxX=window.innerWidth-elementSize,maxY=window.innerHeight-elementSize;currentPosition.value.x=Math.max(0,Math.min(e.clientX-dragOffset.value.x,maxX)),currentPosition.value.y=Math.max(0,Math.min(e.clientY-dragOffset.value.y,maxY)),e.preventDefault()},handleMouseUp=e=>{if(isDragging.value){if(isDragging.value=!1,savePosition(currentPosition.value.x,currentPosition.value.y),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),(status.value==="success"||status.value==="error")&&props.options.autoClose){const delay=status.value==="success"?3e3:5e3;scheduleAutoClose(delay)}e.preventDefault(),e.stopPropagation()}},handleMouseEnter=()=>showFileInfo.value=!0,handleMouseLeave=()=>showFileInfo.value=!1,close=()=>{clearAutoCloseTimer(),downloadController?.abort(),visible.value=!1,emit("close")};let unsubscribeQueueChange=null;const scheduleAutoClose=(delay=3e3)=>{clearAutoCloseTimer(),isDragging.value||(autoCloseTimer=window.setTimeout(()=>{close()},delay))},clearAutoCloseTimer=()=>{autoCloseTimer&&(clearTimeout(autoCloseTimer),autoCloseTimer=null)};return onMounted(()=>{initializePosition(),queueSize.value=props.options.queueSize||0,unsubscribeQueueChange=onQueueChange(newSize=>{queueSize.value=newSize}),startDownload()}),onUnmounted(()=>{clearAutoCloseTimer(),downloadController?.abort(),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),unsubscribeQueueChange&&unsubscribeQueueChange()}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-float"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:"cyber-downloader-float",style:normalizeStyle(floatStyle.value),onMousedown:handleMouseDown,onMouseenter:handleMouseEnter,onMouseleave:handleMouseLeave},[createBaseVNode("div",_hoisted_1$V,[createBaseVNode("div",_hoisted_2$P,[(openBlock(),createElementBlock("svg",_hoisted_3$J,[_cache[0]||(_cache[0]=createBaseVNode("circle",{cx:"43",cy:"43",r:"36",stroke:"var(--color-border-subtle)","stroke-width":"3",fill:"none",class:"ring-bg"},null,-1)),createBaseVNode("circle",{cx:"43",cy:"43",r:"36",stroke:"url(#cyberGradient)","stroke-width":"3",fill:"none","stroke-linecap":"round",class:"ring-progress",style:normalizeStyle(progressStyle.value)},null,4),_cache[1]||(_cache[1]=createBaseVNode("defs",null,[createBaseVNode("linearGradient",{id:"cyberGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[createBaseVNode("stop",{offset:"0%",style:{"stop-color":"var(--color-brand-500)","stop-opacity":"1"}}),createBaseVNode("stop",{offset:"50%",style:{"stop-color":"var(--color-error-500)","stop-opacity":"1"}}),createBaseVNode("stop",{offset:"100%",style:{"stop-color":"var(--color-brand-300)","stop-opacity":"1"}})]),createBaseVNode("filter",{id:"glow"},[createBaseVNode("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),createBaseVNode("feMerge",null,[createBaseVNode("feMergeNode",{in:"coloredBlur"}),createBaseVNode("feMergeNode",{in:"SourceGraphic"})])])],-1))])),createBaseVNode("div",_hoisted_4$G,[status.value==="downloading"?(openBlock(),createElementBlock("div",_hoisted_5$C,[createBaseVNode("div",_hoisted_6$y,[createBaseVNode("span",_hoisted_7$t,toDisplayString(Math.round(progress.value)),1),_cache[2]||(_cache[2]=createBaseVNode("span",{class:"percent-symbol"},"%",-1))]),createBaseVNode("div",_hoisted_8$s,toDisplayString(formatSpeed()),1),queueSize.value>0?(openBlock(),createElementBlock("div",_hoisted_9$r,toDisplayString(unref($t2)("components.downloader.queueRemaining").replace("{count}",queueSize.value.toString())),1)):createCommentVNode("",!0)])):status.value==="success"?(openBlock(),createElementBlock("div",_hoisted_10$o,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"status-icon"},"‚úì",-1)),createBaseVNode("div",_hoisted_11$n,toDisplayString(unref($t2)("components.downloader.completed")),1),queueSize.value>0?(openBlock(),createElementBlock("div",_hoisted_12$j,toDisplayString(unref($t2)("components.downloader.queueRemaining").replace("{count}",queueSize.value.toString())),1)):createCommentVNode("",!0)])):status.value==="error"?(openBlock(),createElementBlock("div",_hoisted_13$h,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"status-icon"},"‚úó",-1)),createBaseVNode("div",_hoisted_14$f,toDisplayString(unref($t2)("components.downloader.failed")),1),queueSize.value>0?(openBlock(),createElementBlock("div",_hoisted_15$e,toDisplayString(unref($t2)("components.downloader.queueRemaining").replace("{count}",queueSize.value.toString())),1)):createCommentVNode("",!0)])):(openBlock(),createElementBlock("div",_hoisted_16$e,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"loading-dots"},[createBaseVNode("span"),createBaseVNode("span"),createBaseVNode("span")],-1)),createBaseVNode("div",_hoisted_17$c,toDisplayString(unref($t2)("components.downloader.preparing")),1),queueSize.value>0?(openBlock(),createElementBlock("div",_hoisted_18$b,toDisplayString(unref($t2)("components.downloader.queueRemaining").replace("{count}",queueSize.value.toString())),1)):createCommentVNode("",!0)]))])]),createBaseVNode("div",{class:normalizeClass(["pulse-ring",{active:status.value==="downloading"}])},null,2)]),showFileInfo.value?(openBlock(),createElementBlock("div",_hoisted_19$a,[createBaseVNode("div",_hoisted_20$9,[createBaseVNode("div",_hoisted_21$8,toDisplayString(fileName.value||unref($t2)("components.downloader.downloading")),1),createBaseVNode("div",_hoisted_22$7,toDisplayString(formatBytes(loaded.value))+" / "+toDisplayString(formatBytes(total.value)),1)])])):createCommentVNode("",!0)],36)):createCommentVNode("",!0)]),_:1})]))}});const DownloaderFloat=_export_sfc(_sfc_main$$,[["__scopeId","data-v-6dbbb95b"]]),activeDownloaders=new Set;let currentDownloader=null;const downloadQueue=[];let isProcessingQueue=!1;const queueChangeCallbacks=[];function onQueueChange(callback){return queueChangeCallbacks.push(callback),callback(downloadQueue.length),()=>{const index2=queueChangeCallbacks.indexOf(callback);index2>-1&&queueChangeCallbacks.splice(index2,1)}}function notifyQueueChange(){queueChangeCallbacks.forEach(callback=>{try{callback(downloadQueue.length)}catch(error2){console.error("Queue change callback error:",error2)}})}function createDownloaderInstance(options,queueSize){return new Promise(resolve=>{const container=document.createElement("div");document.body.appendChild(container);const app=createApp(DownloaderFloat,{options:{...options,queueSize},onComplete:success=>{resolve(success),processNextInQueue()},onClose:()=>{setTimeout(()=>destroyDownloader(instance2),300),currentDownloader=null}});app.mount(container);const instance2={app,container,close:()=>destroyDownloader(instance2)};activeDownloaders.add(instance2),currentDownloader=instance2})}function processNextInQueue(){if(downloadQueue.length===0){isProcessingQueue=!1,notifyQueueChange();return}const nextItem=downloadQueue.shift();if(!nextItem){isProcessingQueue=!1;return}notifyQueueChange(),createDownloaderInstance(nextItem.options,downloadQueue.length).then(nextItem.resolve)}function createDownloader(options){return new Promise(resolve=>{!currentDownloader&&!isProcessingQueue?(isProcessingQueue=!0,createDownloaderInstance(options,downloadQueue.length).then(resolve)):(downloadQueue.push({options,resolve}),showQueueToast(downloadQueue.length),notifyQueueChange())})}function showQueueToast(queueLength){Promise.all([__vitePreload(()=>Promise.resolve().then(()=>useToast$1),void 0),__vitePreload(()=>Promise.resolve().then(()=>useTexts$1),void 0)]).then(([{useToast:useToast2},{useTexts:useTexts2}])=>{const toast=useToast2(),{$t:$t2}=useTexts2();toast.info($t2("components.downloader.queueAdded").replace("{count}",queueLength.toString()))}).catch(()=>{})}function destroyDownloader(instance2){try{instance2.app.unmount(),instance2.container.parentNode?.removeChild(instance2.container),activeDownloaders.delete(instance2)}catch(error2){console.error("Downloader instance destroy failed:",error2)}}function downloadFileQuick(fileId,fileName){return createDownloader({fileId,fileName,quality:"original",position:{side:"right",y:"50%"},autoClose:!0,closeDelay:3e3})}function downloadSharedFileQuick(fileId,shareKey,accessToken,fileName){return createDownloader({fileId,shareKey,accessToken,fileName,quality:"original",position:{side:"right",y:"50%"},autoClose:!0,closeDelay:3e3})}function downloadFileWithPosition(fileId,position,options){return createDownloader({fileId,position,quality:"original",autoClose:!0,closeDelay:3e3,...options})}function closeAllDownloaders(){activeDownloaders.forEach(instance2=>instance2.close()),activeDownloaders.clear(),downloadQueue.length=0,currentDownloader=null,isProcessingQueue=!1}function getActiveDownloadersCount(){return activeDownloaders.size}function getQueueSize(){return downloadQueue.length}function clearDownloaderPosition(){StorageUtil.remove("cyber-downloader-position")}function getDownloaderPosition(){return StorageUtil.get("cyber-downloader-position")}const Downloader={create:createDownloader,quick:downloadFileQuick,quickShared:downloadSharedFileQuick,withPosition:downloadFileWithPosition,closeAll:closeAllDownloaders,getActiveCount:getActiveDownloadersCount,getQueueSize,clearPosition:clearDownloaderPosition,getPosition:getDownloaderPosition};typeof window<"u"&&(window.CyberDownloader=Downloader);const _hoisted_1$U={key:0,class:"loading-indicator"},_hoisted_2$O=["src","alt"],_hoisted_3$I={class:"image-overlay"},_hoisted_4$F={class:"overlay-content"},_hoisted_5$B={class:"action-buttons"},_hoisted_6$x={class:"image-info-tags"},_hoisted_7$s={key:0,class:"info-tag"},_hoisted_8$r={key:1,class:"info-tag"},_hoisted_9$q={key:2,class:"info-tag"},_hoisted_10$n={key:2,class:"image-info-tags bottom-tags"},_hoisted_11$m={class:"info-tag dimension-tag"},_hoisted_12$i={class:"image-info"},_hoisted_13$g=["title"],_hoisted_14$e={class:"image-meta"},_hoisted_15$d={key:0,class:"image-size"},_hoisted_16$d={key:1,class:"image-date"},_hoisted_17$b={key:0,class:"image-tags"},_hoisted_18$a={class:"tags-container"},_hoisted_19$9=["title"],maxTagsToShow=2,_sfc_main$_=defineComponent({name:"CyberShareFile",__name:"index",props:{file:{},selectable:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},shareKey:{},accessToken:{default:""}},emits:["click","select"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,texts=useTexts(),isLoading2=ref(!0),loadError=ref(!1),showAllTags=ref(!1);let loadingTimeout=null;const handleImageLoadStart=()=>{setLoadingTimeout()},handleImageLoaded=()=>{loadingTimeout&&(clearTimeout(loadingTimeout),loadingTimeout=null),isLoading2.value=!1,loadError.value=!1},handleImageError=()=>{loadingTimeout&&(clearTimeout(loadingTimeout),loadingTimeout=null),isLoading2.value=!1,loadError.value=!0},setLoadingTimeout=()=>{loadingTimeout&&clearTimeout(loadingTimeout),loadingTimeout=setTimeout(()=>{isLoading2.value=!1,loadError.value=!0},2e4)},displayedTags=computed(()=>!props.file.tags||props.file.tags.length===0?[]:showAllTags.value?props.file.tags:props.file.tags.slice(0,maxTagsToShow)),showMoreTags=computed(()=>props.file.tags&&props.file.tags.length>maxTagsToShow&&!showAllTags.value),toggleShowAllTags=e=>{e.stopPropagation(),showAllTags.value=!showAllTags.value},getFileUrl=file=>{const url=file.full_thumb_url||file.thumb_url||file.full_url||file.url||"";return url},handleClick=()=>{props.selectable?emit("select",props.file.id):emit("click",props.file)},handleSelectClick=()=>{emit("select",props.file.id)},handleDownload=async e=>{e.stopPropagation();try{const fileName=props.file.display_name||props.file.original_name||`file_${props.file.id}`;await downloadSharedFileQuick(props.file.id,props.shareKey,props.accessToken,fileName)}catch{window.toast&&window.toast.error(texts.share.image.downloadError)}};return onMounted(()=>{getFileUrl(props.file)?isLoading2.value=!0:(isLoading2.value=!1,loadError.value=!0)}),onUnmounted(()=>{loadingTimeout&&(clearTimeout(loadingTimeout),loadingTimeout=null)}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["share-image-card",{"is-selectable":props.selectable,"is-selected":props.selected}]),onClick:handleClick},[createBaseVNode("div",{class:normalizeClass(["image-preview",{"is-loading":isLoading2.value}])},[isLoading2.value?(openBlock(),createElementBlock("div",_hoisted_1$U,[..._cache[0]||(_cache[0]=[createBaseVNode("div",{class:"loading-spinner"},[createBaseVNode("i",{class:"fas fa-spin fa-circle-notch"})],-1)])])):createCommentVNode("",!0),createBaseVNode("img",{src:getFileUrl(props.file),alt:props.file.display_name||unref(texts).share.image.alt,loading:"lazy",style:normalizeStyle({visibility:isLoading2.value?"hidden":"visible"}),onLoad:handleImageLoaded,onError:handleImageError,onLoadstart:handleImageLoadStart},null,44,_hoisted_2$O),createBaseVNode("div",_hoisted_3$I,[createBaseVNode("div",_hoisted_4$F,[createBaseVNode("div",_hoisted_5$B,[createBaseVNode("button",{class:"action-button download-button",onClick:withModifiers(handleDownload,["stop"])},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-download"},null,-1)])])])])]),props.selectable?(openBlock(),createElementBlock("div",{key:1,class:"selection-indicator",onClick:withModifiers(handleSelectClick,["stop"])},[createBaseVNode("i",{class:normalizeClass(props.selected?"fas fa-check-circle":"far fa-circle")},null,2)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_6$x,[props.file.resolution?(openBlock(),createElementBlock("span",_hoisted_7$s,toDisplayString(props.file.resolution),1)):createCommentVNode("",!0),props.file.format?(openBlock(),createElementBlock("span",_hoisted_8$r,toDisplayString(props.file.format.toUpperCase()),1)):createCommentVNode("",!0),props.file.size_formatted?(openBlock(),createElementBlock("span",_hoisted_9$q,toDisplayString(unref(formatSize)(props.file.size)),1)):createCommentVNode("",!0)]),props.file.width&&props.file.height?(openBlock(),createElementBlock("div",_hoisted_10$n,[createBaseVNode("span",_hoisted_11$m,toDisplayString(props.file.width)+" √ó "+toDisplayString(props.file.height),1)])):createCommentVNode("",!0)],2),createBaseVNode("div",_hoisted_12$i,[createBaseVNode("div",{class:"image-name",title:props.file.display_name||props.file.original_name},toDisplayString(props.file.display_name||props.file.original_name),9,_hoisted_13$g),createBaseVNode("div",_hoisted_14$e,[props.file.size?(openBlock(),createElementBlock("span",_hoisted_15$d,toDisplayString(unref(formatSize)(props.file.size)),1)):createCommentVNode("",!0),props.file.created_at?(openBlock(),createElementBlock("span",_hoisted_16$d,toDisplayString(unref(formatDate)(props.file.created_at)),1)):createCommentVNode("",!0)]),props.file.tags&&props.file.tags.length>0?(openBlock(),createElementBlock("div",_hoisted_17$b,[createBaseVNode("div",_hoisted_18$a,[(openBlock(!0),createElementBlock(Fragment,null,renderList(displayedTags.value,tag=>(openBlock(),createElementBlock("span",{key:tag.id,class:"image-tag",title:tag.name},toDisplayString(tag.name),9,_hoisted_19$9))),128)),showMoreTags.value?(openBlock(),createElementBlock("span",{key:0,class:"more-tags",onClick:withModifiers(toggleShowAllTags,["stop"])}," +"+toDisplayString(props.file.tags.length-maxTagsToShow),1)):createCommentVNode("",!0)])])):createCommentVNode("",!0)])],2))}});const ShareFile=_export_sfc(_sfc_main$_,[["__scopeId","data-v-70388f30"]]);function debounce(fn,delay){let timer=null;return function(...args){timer!==null&&clearTimeout(timer),timer=window.setTimeout(()=>{fn.apply(this,args),timer=null},delay)}}const _hoisted_1$T=["src","alt"],_hoisted_2$N={key:1,class:"image-loading"},_hoisted_3$H={class:"image-info-tags"},_hoisted_4$E={key:0,class:"info-tag"},_hoisted_5$A={key:1,class:"info-tag"},_hoisted_6$w={key:2,class:"info-tag"},_hoisted_7$r={key:2,class:"image-info-tags bottom-tags"},_hoisted_8$q={class:"info-tag dimension-tag"},_hoisted_9$p={key:3,class:"selection-indicator"},_hoisted_10$m={key:4,class:"duplicate-indicator"},_hoisted_11$l={key:5,class:"image-error"},_hoisted_12$h={class:"image-info"},_hoisted_13$f=["title"],_hoisted_14$d={class:"image-meta"},_hoisted_15$c={class:"image-date"},_hoisted_16$c={class:"image-size"},_hoisted_17$a={key:0,class:"image-tags"},_hoisted_18$9={class:"tags-container"},_hoisted_19$8=["title"],_hoisted_20$8=["title"],_sfc_main$Z=defineComponent({__name:"WaterfallItem",props:{item:{},selectable:{type:Boolean},selectedIds:{},columnWidth:{},gap:{}},emits:["image-click","image-load","image-error","toggle-tags"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),maxTagsToShow2=LAYOUT.WATERFALL.MAX_TAGS_TO_SHOW,getItemStyle=item=>({marginBottom:`${props.gap}px`,opacity:item.visible?1:0,transition:"opacity 0.3s ease"}),getFileContainerStyle=item=>{const style={position:"relative",borderRadius:"8px",overflow:"hidden",background:"rgba(var(--color-background-800-rgb), 0.5)",border:"1px solid var(--color-border-subtle)",transition:"all 0.25s ease",cursor:"pointer",width:"100%"};if(!item.loaded&&item.width&&item.height){const aspectRatio=item.width/item.height,effectiveColumnWidth=Math.max(props.columnWidth*1.2,180),calculatedHeight=Math.round(effectiveColumnWidth/aspectRatio);style.minHeight=`${Math.max(calculatedHeight,100)}px`,style.background="rgba(var(--color-background-800-rgb), 0.7)"}else item.loaded||(style.minHeight="200px",style.background="rgba(var(--color-background-800-rgb), 0.7)");return style},getImageSrc=item=>item.full_thumb_url||item.thumb_url||item.full_url||item.url||"",isSelected=id=>props.selectedIds.includes(id),handleImageClick=item=>{emit("image-click",item)},handleImageLoad=item=>{emit("image-load",item)},handleImageError=item=>{emit("image-error",item)},handleToggleTags=id=>{emit("toggle-tags",id)},getTagName=tag=>typeof tag=="string"?tag:typeof tag=="object"&&tag!==null?tag.name||tag.toString():String(tag),getTagKey=tag=>typeof tag=="object"&&tag!==null&&tag.id?tag.id:getTagName(tag);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"waterfall-item",style:normalizeStyle(getItemStyle(__props.item))},[createBaseVNode("div",{class:normalizeClass(["waterfall-image-container",{"is-selectable":__props.selectable,"is-selected":isSelected(__props.item.id)}]),style:normalizeStyle(getFileContainerStyle(__props.item)),onClick:_cache[2]||(_cache[2]=$event=>handleImageClick(__props.item))},[__props.item.visible?(openBlock(),createElementBlock("img",{key:0,class:"waterfall-image",src:getImageSrc(__props.item),alt:__props.item.name||"Image",onLoad:_cache[0]||(_cache[0]=$event=>handleImageLoad(__props.item)),onError:_cache[1]||(_cache[1]=$event=>handleImageError(__props.item)),loading:"lazy"},null,40,_hoisted_1$T)):createCommentVNode("",!0),!__props.item.loaded&&__props.item.visible?(openBlock(),createElementBlock("div",_hoisted_2$N,[..._cache[5]||(_cache[5]=[createBaseVNode("div",{class:"loading-spinner"},null,-1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_3$H,[__props.item.resolution?(openBlock(),createElementBlock("span",_hoisted_4$E,toDisplayString(__props.item.resolution),1)):createCommentVNode("",!0),__props.item.format?(openBlock(),createElementBlock("span",_hoisted_5$A,toDisplayString(__props.item.format.toUpperCase()),1)):createCommentVNode("",!0),__props.item.size?(openBlock(),createElementBlock("span",_hoisted_6$w,toDisplayString(unref(formatSize)(__props.item.size)),1)):createCommentVNode("",!0)]),__props.item.width&&__props.item.height?(openBlock(),createElementBlock("div",_hoisted_7$r,[createBaseVNode("span",_hoisted_8$q,toDisplayString(__props.item.width)+" √ó "+toDisplayString(__props.item.height),1)])):createCommentVNode("",!0),__props.selectable?(openBlock(),createElementBlock("div",_hoisted_9$p,[createBaseVNode("i",{class:normalizeClass(isSelected(__props.item.id)?"fas fa-check-circle":"far fa-circle")},null,2)])):createCommentVNode("",!0),__props.item.is_duplicate?(openBlock(),createElementBlock("div",_hoisted_10$m,[..._cache[6]||(_cache[6]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])):createCommentVNode("",!0),__props.item.hasError?(openBlock(),createElementBlock("div",_hoisted_11$l,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-exclamation-triangle"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("waterfallLayout.loadFailed")),1)])):createCommentVNode("",!0)],6),createBaseVNode("div",_hoisted_12$h,[createBaseVNode("div",{class:"image-name",title:__props.item.name},toDisplayString(__props.item.name),9,_hoisted_13$f),createBaseVNode("div",_hoisted_14$d,[createBaseVNode("span",_hoisted_15$c,toDisplayString(unref(formatDate)(__props.item.created_at)),1),createBaseVNode("span",_hoisted_16$c,toDisplayString(__props.item.width)+"x"+toDisplayString(__props.item.height),1)]),__props.item.tags&&__props.item.tags.length>0?(openBlock(),createElementBlock("div",_hoisted_17$a,[createBaseVNode("div",_hoisted_18$9,[__props.item.showAllTags?(openBlock(),createElementBlock(Fragment,{key:1},[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.item.tags,tag=>(openBlock(),createElementBlock("span",{key:getTagKey(tag),class:"image-tag",title:getTagName(tag)},toDisplayString(getTagName(tag)),9,_hoisted_20$8))),128)),createBaseVNode("span",{class:"more-tags",onClick:_cache[4]||(_cache[4]=withModifiers($event=>handleToggleTags(__props.item.id),["stop"]))},toDisplayString(unref($t2)("waterfallLayout.collapse")),1)],64)):(openBlock(),createElementBlock(Fragment,{key:0},[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.item.tags.slice(0,unref(maxTagsToShow2)),tag=>(openBlock(),createElementBlock("span",{key:getTagKey(tag),class:"image-tag",title:getTagName(tag)},toDisplayString(getTagName(tag)),9,_hoisted_19$8))),128)),__props.item.tags.length>unref(maxTagsToShow2)?(openBlock(),createElementBlock("span",{key:0,class:"more-tags",onClick:_cache[3]||(_cache[3]=withModifiers($event=>handleToggleTags(__props.item.id),["stop"]))}," +"+toDisplayString(__props.item.tags.length-unref(maxTagsToShow2)),1)):createCommentVNode("",!0)],64))])])):createCommentVNode("",!0)])],4))}});const WaterfallItem=_export_sfc(_sfc_main$Z,[["__scopeId","data-v-c7207857"]]),_sfc_main$Y=defineComponent({__name:"index",props:{items:{default:()=>[]},columnCount:{default:LAYOUT.WATERFALL.DEFAULT_COLUMNS},columnWidth:{default:LAYOUT.WATERFALL.DEFAULT_COLUMN_WIDTH},selectable:{type:Boolean,default:!1},selectedIds:{default:()=>[]},lazyLoad:{type:Boolean,default:!0},initialLoadCount:{default:LAYOUT.WATERFALL.INITIAL_LOAD_COUNT},gap:{default:LAYOUT.WATERFALL.DEFAULT_GAP},shareKey:{},accessToken:{}},emits:["image-click","select","image-load"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,containerRef=ref(null),columns=ref([]),columnHeights=ref([]),loadedItems=reactive(new Set),expandedTags=reactive(new Set),currentVisibleCount=ref(props.initialLoadCount),initColumns=()=>{columns.value=Array.from({length:props.columnCount},()=>[]),columnHeights.value=Array.from({length:props.columnCount},()=>0)},calculateLayout=()=>{initColumns();const effectiveColumnWidth=Math.max(props.columnWidth*1.2,180);props.items.forEach((item,index2)=>{const processedItem={...item,loaded:loadedItems.has(item.id),visible:index2<currentVisibleCount.value||loadedItems.has(item.id),showAllTags:expandedTags.has(item.id)},minHeightIndex=columnHeights.value.indexOf(Math.min(...columnHeights.value));if(columns.value[minHeightIndex].push(processedItem),processedItem.width&&processedItem.height){const aspectRatio=processedItem.width/processedItem.height,calculatedHeight=effectiveColumnWidth/aspectRatio+LAYOUT.WATERFALL.INFO_AREA_HEIGHT;columnHeights.value[minHeightIndex]+=calculatedHeight}else columnHeights.value[minHeightIndex]+=LAYOUT.WATERFALL.DEFAULT_IMAGE_HEIGHT})},handleResize=()=>{const width=window.innerWidth;(Math.floor(width/LAYOUT.WATERFALL.DEFAULT_COLUMN_WIDTH)||1)!==columns.value.length&&calculateLayout()},handleImageLoad=item=>{loadedItems.add(item.id),item.loaded=!0,emit("image-load",item)},handleImageError=item=>{item.hasError=!0},handleImageClick=item=>{props.selectable?emit("select",item.id):emit("image-click",item)},handleToggleTags=id=>{expandedTags.has(id)?expandedTags.delete(id):expandedTags.add(id),calculateLayout()},checkLoadMore=()=>{if(!props.lazyLoad||currentVisibleCount.value>=props.items.length)return;const container=containerRef.value;if(!container)return;const containerBottom=container.getBoundingClientRect().bottom,windowHeight=window.innerHeight,threshold=windowHeight*2;if(containerBottom-windowHeight<threshold){const loadIncrement=Math.min(LAYOUT.WATERFALL.MIN_LOAD_COUNT,props.items.length-currentVisibleCount.value);currentVisibleCount.value=Math.min(currentVisibleCount.value+loadIncrement,props.items.length),calculateLayout()}},handleScroll=debounce(()=>{checkLoadMore()},TIMING.SCROLL.DEBOUNCE_TIME);return watch(()=>props.items,calculateLayout,{deep:!0}),watch(()=>props.columnCount,calculateLayout),onMounted(()=>{calculateLayout(),window.addEventListener("resize",handleResize),props.lazyLoad&&window.addEventListener("scroll",handleScroll),nextTick(()=>checkLoadMore())}),onBeforeUnmount(()=>{window.removeEventListener("resize",handleResize),props.lazyLoad&&window.removeEventListener("scroll",handleScroll)}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{ref_key:"containerRef",ref:containerRef,class:"waterfall-layout",style:normalizeStyle({gap:`${__props.gap/2}px`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(columns.value,(column,colIndex)=>(openBlock(),createElementBlock("div",{key:colIndex,class:"waterfall-column",style:normalizeStyle({width:`${100/__props.columnCount}%`,padding:`0 ${__props.gap/4}px`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(column,item=>(openBlock(),createBlock(WaterfallItem,{key:item.id,item,selectable:__props.selectable,"selected-ids":__props.selectedIds,"column-width":__props.columnWidth,gap:__props.gap,onImageClick:handleImageClick,onImageLoad:handleImageLoad,onImageError:handleImageError,onToggleTags:handleToggleTags},null,8,["item","selectable","selected-ids","column-width","gap"]))),128))],4))),128))],4))}});const WaterfallLayout=_export_sfc(_sfc_main$Y,[["__scopeId","data-v-a5fe29c7"]]);function useFileNavigation(files,initialIndex=0){const currentIndex=ref(initialIndex),totalFiles=computed(()=>files.value.length),hasMultipleFiles=computed(()=>totalFiles.value>1),hasPreviousFile=computed(()=>currentIndex.value>0),hasNextFile=computed(()=>currentIndex.value<totalFiles.value-1),currentFile=computed(()=>files.value[currentIndex.value]||null),fileUrl=computed(()=>currentFile.value?.full_url||""),showPreviousFile=()=>hasPreviousFile.value?(currentIndex.value--,!0):!1,showNextFile=()=>hasNextFile.value?(currentIndex.value++,!0):!1;return{currentIndex,totalFiles,hasMultipleFiles,hasPreviousFile,hasNextFile,currentFile,fileUrl,showPreviousFile,showNextFile,goToFile:index2=>index2>=0&&index2<totalFiles.value?(currentIndex.value=index2,!0):!1,handleKeyboardNavigation:key=>{switch(key){case"ArrowLeft":return showPreviousFile();case"ArrowRight":return showNextFile();default:return!1}}}}function useFileViewer(initialFile=null){const $t2=getCurrentInstance()?.appContext.config.globalProperties.$t,isLoading2=ref(!0),hasError=ref(!1),isFirstView=ref(!0),isAllContentVisible=ref(!1),isImmersiveMode=ref(!1),isFullscreen=ref(!1),isFillMode=ref(!1),isHorizontalFile=ref(!0),showModeIndicator=ref(!1),showZoomIndicator=ref(!1),isControlsHidden=ref(!1),loadingProgress=ref(0),loadingText=ref($t2?.("loading").value||"Loading..."),controlsTimer=ref(null),shouldUseFillMode=computed(()=>isFillMode.value),toggleControls=()=>{isFirstView.value?(isFirstView.value=!1,isAllContentVisible.value=!0):isAllContentVisible.value=!isAllContentVisible.value},toggleFullscreen=async()=>{document.fullscreenElement?(await document.exitFullscreen(),isFullscreen.value=!1):(await document.documentElement.requestFullscreen(),isFullscreen.value=!0)},toggleFitMode=()=>{isFillMode.value=!isFillMode.value,showModeIndicatorTemporary()},showModeIndicatorTemporary=()=>{showModeIndicator.value=!0,setTimeout(()=>{showModeIndicator.value=!1},1500)},showZoomIndicatorTemporary=()=>{showZoomIndicator.value=!0,setTimeout(()=>{showZoomIndicator.value=!1},1e3)},resetControlsTimer=()=>{controlsTimer.value&&clearTimeout(controlsTimer.value),controlsTimer.value=setTimeout(()=>{isControlsHidden.value=!0},3e3)};let abortController=null,progressInterval=null;const startRealImageLoading=async imageUrl=>{loadingProgress.value=0,loadingText.value=$t2?.("loading").value||"Loading...",abortController&&abortController.abort(),abortController=new AbortController;try{const response=await fetch(imageUrl,{signal:abortController.signal});if(!response.ok)throw new Error(`HTTP error! status: ${response.status}`);const contentLength=response.headers.get("content-length");if(!contentLength)return loadingText.value=$t2?.("processing").value||"Processing...",startLoadingProgressSimulation(),response.blob();const total=parseInt(contentLength,10);let loaded=0;const reader=response.body?.getReader();if(!reader)return startLoadingProgressSimulation(),response.blob();loadingText.value=$t2?.("processing").value||"Processing...";const chunks=[];let done=!1;for(;!done;){const result=await reader.read();if(done=result.done,done){loadingProgress.value=100,loadingText.value=$t2?.("completed").value||"Completed";break}const value=result.value;chunks.push(value),loaded+=value.length;const progress=Math.round(loaded/total*100);loadingProgress.value=Math.min(progress,99);const loadedKB=Math.round(loaded/1024),totalKB=Math.round(total/1024);loadingText.value=`${$t2?.("processing").value||"Processing"} ${loadedKB}KB / ${totalKB}KB`}return new Blob(chunks)}catch(error2){return error2.name==="AbortError"||(console.warn("Failed to get real progress, falling back to simulation:",error2),startLoadingProgressSimulation()),null}},startLoadingProgressSimulation=()=>{loadingProgress.value=0,loadingText.value=$t2?.("loading").value||"Loading...",progressInterval=setInterval(()=>{loadingProgress.value<90&&(loadingProgress.value+=Math.random()*20,loadingProgress.value>90&&(loadingProgress.value=90))},200)},stopLoadingProgressSimulation=()=>{progressInterval&&(clearInterval(progressInterval),progressInterval=null)},handleFileLoad=fileRef=>{stopLoadingProgressSimulation(),loadingProgress.value=100,loadingText.value=$t2?.("completed").value||"Completed",setTimeout(()=>{if(isLoading2.value=!1,hasError.value=!1,fileRef){const{naturalWidth}=fileRef,{naturalHeight}=fileRef,aspectRatio=naturalWidth/naturalHeight;isHorizontalFile.value=aspectRatio>1.2,analyzeFileBrightness(fileRef)}},300)},analyzeFileBrightness=fileRef=>{try{const fileUrl=fileRef.src,currentOrigin=window.location.origin;if(new URL(fileUrl).origin!==currentOrigin){document.documentElement.style.setProperty("--viewer-is-light","0"),document.documentElement.style.setProperty("--text-shadow-intensity","1"),document.documentElement.style.setProperty("--border-opacity","0.3");return}const canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");if(!ctx)return;const sampleSize=50;canvas.width=sampleSize,canvas.height=sampleSize,ctx.drawImage(fileRef,0,0,sampleSize,sampleSize);const imageData=ctx.getImageData(0,0,sampleSize,sampleSize),{data}=imageData;let totalBrightness=0;const pixelCount=data.length/4;for(let i=0;i<data.length;i+=4){const brightness=data[i]*.299+data[i+1]*.587+data[i+2]*.114;totalBrightness+=brightness}const isLightFile=totalBrightness/pixelCount>128;document.documentElement.style.setProperty("--viewer-is-light",isLightFile?"1":"0"),document.documentElement.style.setProperty("--text-shadow-intensity",isLightFile?"3":"1"),document.documentElement.style.setProperty("--border-opacity",isLightFile?"0.7":"0.3")}catch{document.documentElement.style.setProperty("--viewer-is-light","0"),document.documentElement.style.setProperty("--text-shadow-intensity","1"),document.documentElement.style.setProperty("--border-opacity","0.3")}},handleFileError=()=>{loadingProgress.value=0,loadingText.value=$t2?.("error").value||"Error",isLoading2.value=!1,hasError.value=!0},retryLoading=()=>{isLoading2.value=!0,hasError.value=!1,startLoadingProgressSimulation()},handleFullscreenChange=()=>{isFullscreen.value=!!document.fullscreenElement};return initialFile&&startLoadingProgressSimulation(),{isLoading:isLoading2,hasError,isFirstView,isAllContentVisible,isImmersiveMode,isFullscreen,isFillMode,isHorizontalFile,showModeIndicator,showZoomIndicator,isControlsHidden,loadingProgress,loadingText,shouldUseFillMode,toggleControls,toggleFullscreen,toggleFitMode,showModeIndicatorTemporary,showZoomIndicatorTemporary,resetControlsTimer,handleFileLoad,handleFileError,retryLoading,startRealImageLoading,startLoadingProgressSimulation,stopLoadingProgressSimulation,handleFullscreenChange}}function useKeyboardShortcuts(isVisible,handlers){const handleKeyDown=e=>{if(!isVisible.value)return;const target=e.target;if(!(target.tagName==="INPUT"||target.tagName==="TEXTAREA"||target.isContentEditable))switch(e.key===" "&&e.preventDefault(),e.key){case"Escape":handlers.onEscape?.();break;case" ":handlers.onSpace?.();break;case"ArrowLeft":handlers.onArrowLeft?.();break;case"ArrowRight":handlers.onArrowRight?.();break;case"+":case"=":handlers.onPlus?.();break;case"-":handlers.onMinus?.();break;case"r":case"R":handlers.onR?.();break;case"l":case"L":handlers.onL?.();break;case"f":case"F":handlers.onF?.();break;case"0":handlers.onReset?.();break}},updateEventListener=visible=>{visible?document.addEventListener("keydown",handleKeyDown):document.removeEventListener("keydown",handleKeyDown)};return watch(isVisible,newVal=>{updateEventListener(newVal)}),onMounted(()=>{isVisible.value&&document.addEventListener("keydown",handleKeyDown)}),onUnmounted(()=>{document.removeEventListener("keydown",handleKeyDown)}),{handleKeyDown}}const _hoisted_1$S={class:"nav-title"},_hoisted_2$M={class:"image-info"},_hoisted_3$G={key:0,class:"image-tags-header"},_hoisted_4$D=["onClick"],_hoisted_5$z={class:"nav-actions"},_hoisted_6$v=["title"],_hoisted_7$q=["title"],_hoisted_8$p=["title"],_hoisted_9$o=["title"],_sfc_main$X=defineComponent({__name:"NavigationBar",props:{isVisible:{type:Boolean},currentFile:{},isFullscreen:{type:Boolean},hasAIInfo:{type:Boolean,default:!1},isLightBackground:{type:Boolean,default:!1}},emits:["toggle-fullscreen","download","close","tag-click","find-similar"],setup(__props){const{$t:$t2}=useTexts();return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["navigation-bar",{"is-hidden":!__props.isVisible,"is-light-bg":__props.isLightBackground}])},[createBaseVNode("div",_hoisted_1$S,[createBaseVNode("span",{class:normalizeClass(["image-name",{"is-light-bg":__props.isLightBackground}])},toDisplayString(__props.currentFile?.display_name||unref($t2)("components.navigationBar.filePreview")),3),createBaseVNode("div",_hoisted_2$M,[__props.currentFile?.resolution?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(["resolution-tag",{"is-light-bg":__props.isLightBackground}])},toDisplayString(__props.currentFile.resolution),3)):createCommentVNode("",!0),createBaseVNode("span",{class:normalizeClass(["dimension-tag",{"is-light-bg":__props.isLightBackground}])},toDisplayString(__props.currentFile?.width||0)+" √ó "+toDisplayString(__props.currentFile?.height||0),3),__props.currentFile?.size_formatted?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(["size-tag",{"is-light-bg":__props.isLightBackground}])},toDisplayString(__props.currentFile.size_formatted),3)):createCommentVNode("",!0),__props.currentFile?.format?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass(["format-tag",{"is-light-bg":__props.isLightBackground}])},toDisplayString(__props.currentFile.format.toUpperCase()),3)):createCommentVNode("",!0)]),__props.currentFile?.tags&&__props.currentFile.tags.length>0?(openBlock(),createElementBlock("div",_hoisted_3$G,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.currentFile.tags,tag=>(openBlock(),createElementBlock("div",{key:tag.id,class:normalizeClass(["tag",{"is-light-bg":__props.isLightBackground}]),onClick:withModifiers($event=>_ctx.$emit("tag-click",tag),["stop"])},toDisplayString(tag.name),11,_hoisted_4$D))),128))])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_5$z,[__props.hasAIInfo?(openBlock(),createElementBlock("button",{key:0,class:"action-btn tooltip-btn similar-btn-icon",title:unref($t2)("components.navigationBar.findSimilar"),onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("find-similar"))},[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-layer-group"},null,-1)])],8,_hoisted_6$v)):createCommentVNode("",!0),createBaseVNode("button",{class:"action-btn tooltip-btn",title:unref($t2)("components.navigationBar.fullscreenToggle"),onClick:_cache[1]||(_cache[1]=$event=>_ctx.$emit("toggle-fullscreen"))},[createBaseVNode("i",{class:normalizeClass(__props.isFullscreen?"fas fa-compress":"fas fa-expand")},null,2)],8,_hoisted_7$q),createBaseVNode("button",{class:"action-btn tooltip-btn",title:unref($t2)("components.navigationBar.download"),onClick:_cache[2]||(_cache[2]=$event=>_ctx.$emit("download"))},[..._cache[5]||(_cache[5]=[createBaseVNode("i",{class:"fas fa-download"},null,-1)])],8,_hoisted_8$p),createBaseVNode("button",{class:"action-btn tooltip-btn",title:unref($t2)("components.navigationBar.close"),onClick:_cache[3]||(_cache[3]=$event=>_ctx.$emit("close"))},[..._cache[6]||(_cache[6]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])],8,_hoisted_9$o)])],2))}});const NavigationBar=_export_sfc(_sfc_main$X,[["__scopeId","data-v-269f4fc9"]]);function useFileTransform(onScaleChange){const scale=ref(1),rotation=ref(0),translateX=ref(0),translateY=ref(0),isDragging=ref(!1),imageStyle=computed(()=>{const safeScale=isNaN(scale.value)?1:scale.value,safeRotation=isNaN(rotation.value)?0:rotation.value,safeTranslateX=isNaN(translateX.value)?0:translateX.value,safeTranslateY=isNaN(translateY.value)?0:translateY.value;return{transform:`translate(${safeTranslateX}px, ${safeTranslateY}px) scale(${safeScale}) rotate(${safeRotation}deg)`,transformOrigin:"center center",transition:isDragging.value?"none":"transform 0.3s ease"}}),containerStyle=computed(()=>({cursor:isDragging.value?"grabbing":"grab"})),zoomIn=(amount=.25)=>{const newScale=scale.value+amount;scale.value=Math.min(newScale,5)},zoomOut=(amount=.25)=>{const newScale=scale.value-amount;scale.value=Math.max(newScale,.1)},rotateLeft=()=>{rotation.value-=90},rotateRight=()=>{rotation.value+=90},resetTransform=()=>{scale.value=1,rotation.value=0,translateX.value=0,translateY.value=0};let startX=0,startY=0,startTranslateX=0,startTranslateY=0;const handleMouseDown=e=>{e.button===0&&(isDragging.value=!0,startX=e.clientX,startY=e.clientY,startTranslateX=translateX.value,startTranslateY=translateY.value,document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp))},handleMouseMove=e=>{if(!isDragging.value)return;const deltaX=e.clientX-startX,deltaY=e.clientY-startY;translateX.value=startTranslateX+deltaX,translateY.value=startTranslateY+deltaY},handleMouseUp=()=>{isDragging.value=!1,document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)};let touchStartX=0,touchStartY=0,touchStartTranslateX=0,touchStartTranslateY=0;return{scale,rotation,translateX,translateY,isDragging,imageStyle,containerStyle,zoomIn,zoomOut,rotateLeft,rotateRight,resetTransform,handleMouseDown,handleMouseMove,handleMouseUp,handleTouchStart:e=>{if(e.touches.length===1){const touch=e.touches[0];touchStartX=touch.clientX,touchStartY=touch.clientY,touchStartTranslateX=translateX.value,touchStartTranslateY=translateY.value}},handleTouchMove:e=>{if(e.touches.length===1){const touch=e.touches[0],deltaX=touch.clientX-touchStartX,deltaY=touch.clientY-touchStartY;translateX.value=touchStartTranslateX+deltaX,translateY.value=touchStartTranslateY+deltaY}},handleTouchEnd:()=>{},handleWheel:e=>{e.preventDefault();const delta=e.deltaY>0?-.1:.1,newScale=scale.value+delta;scale.value=Math.max(.1,Math.min(5,newScale)),onScaleChange&&onScaleChange(scale.value)}}}const _hoisted_1$R=["disabled","title"],_hoisted_2$L=["disabled","title"],_hoisted_3$F=["src","alt"],_hoisted_4$C={key:0,class:"error-container"},_hoisted_5$y={key:2,class:"mode-indicator"},_hoisted_6$u={key:3,class:"zoom-indicator"},_sfc_main$W=defineComponent({__name:"FileCanvas",props:{currentFile:{},fileUrl:{},isLoading:{type:Boolean},hasError:{type:Boolean},showSideNav:{type:Boolean},hasMultipleFiles:{type:Boolean},hasPreviousFile:{type:Boolean},hasNextFile:{type:Boolean},shouldUseFillMode:{type:Boolean},showModeIndicator:{type:Boolean},showZoomIndicator:{type:Boolean},isLightBackground:{type:Boolean}},emits:["canvas-click","prev-image","next-image","reset-transform","retry-loading","image-load","image-error","scale-change"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,{$t:$t2}=useTexts(),emit=__emit,canvasRef=ref(),imageRef=ref(),{scale,rotation,translateX,translateY,imageStyle,containerStyle,handleMouseDown,handleMouseUp,handleTouchStart,handleTouchMove,handleTouchEnd,handleWheel}=useFileTransform(newScale=>{emit("scale-change",newScale)}),computedImageStyle=computed(()=>{const baseStyle=imageStyle.value;return props.shouldUseFillMode&&scale.value===1&&rotation.value===0&&translateX.value===0&&translateY.value===0?{...baseStyle,width:"100vw",height:"100vh",objectFit:"cover",maxWidth:"none",maxHeight:"none"}:{...baseStyle,width:"auto",height:"auto",objectFit:"contain",maxWidth:"100%",maxHeight:"100%"}}),handleImageLoad=()=>{imageRef.value&&emit("image-load",imageRef.value)},handleImageError=()=>{emit("image-error")},handlePrevClick=e=>{e&&e.stopPropagation(),emit("prev-image")},handleNextClick=e=>{e&&e.stopPropagation(),emit("next-image")};return __expose({zoomIn:(amount=.25)=>{const newScale=scale.value+amount;scale.value=Math.min(newScale,5)},zoomOut:(amount=.25)=>{const newScale=scale.value-amount;scale.value=Math.max(newScale,.1)},rotateLeft:()=>{rotation.value-=90},rotateRight:()=>{rotation.value+=90},resetTransform:()=>{scale.value=1,rotation.value=0,translateX.value=0,translateY.value=0},getScale:()=>scale.value}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{ref_key:"canvasRef",ref:canvasRef,class:"image-canvas",onWheel:_cache[7]||(_cache[7]=(...args)=>unref(handleWheel)&&unref(handleWheel)(...args)),onClick:_cache[8]||(_cache[8]=$event=>_ctx.$emit("canvas-click"))},[__props.hasMultipleFiles?(openBlock(),createElementBlock("button",{key:0,class:normalizeClass(["side-nav-btn prev-side-btn",{"is-light-bg":props.isLightBackground}]),disabled:!__props.hasPreviousFile,title:unref($t2)("components.fileCanvas.previous"),onClick:handlePrevClick},[..._cache[9]||(_cache[9]=[createBaseVNode("div",{class:"nav-btn-bg"},null,-1),createBaseVNode("i",{class:"fas fa-chevron-left"},null,-1)])],10,_hoisted_1$R)):createCommentVNode("",!0),__props.hasMultipleFiles?(openBlock(),createElementBlock("button",{key:1,class:normalizeClass(["side-nav-btn next-side-btn",{"is-light-bg":props.isLightBackground}]),disabled:!__props.hasNextFile,title:unref($t2)("components.fileCanvas.next"),onClick:handleNextClick},[..._cache[10]||(_cache[10]=[createBaseVNode("div",{class:"nav-btn-bg"},null,-1),createBaseVNode("i",{class:"fas fa-chevron-right"},null,-1)])],10,_hoisted_2$L)):createCommentVNode("",!0),createBaseVNode("div",{class:"image-container",style:normalizeStyle(unref(containerStyle)),onMousedown:_cache[1]||(_cache[1]=(...args)=>unref(handleMouseDown)&&unref(handleMouseDown)(...args)),onMouseup:_cache[2]||(_cache[2]=(...args)=>unref(handleMouseUp)&&unref(handleMouseUp)(...args)),onDblclick:_cache[3]||(_cache[3]=$event=>_ctx.$emit("reset-transform")),onTouchstart:_cache[4]||(_cache[4]=(...args)=>unref(handleTouchStart)&&unref(handleTouchStart)(...args)),onTouchmove:_cache[5]||(_cache[5]=(...args)=>unref(handleTouchMove)&&unref(handleTouchMove)(...args)),onTouchend:_cache[6]||(_cache[6]=(...args)=>unref(handleTouchEnd)&&unref(handleTouchEnd)(...args))},[withDirectives(createBaseVNode("img",{ref_key:"imageRef",ref:imageRef,src:__props.fileUrl,alt:__props.currentFile?.display_name||unref($t2)("components.fileCanvas.file"),class:"main-image",style:normalizeStyle(computedImageStyle.value),draggable:"false",onLoad:handleImageLoad,onError:handleImageError},null,44,_hoisted_3$F),[[vShow,!__props.isLoading&&!__props.hasError]]),__props.hasError?(openBlock(),createElementBlock("div",_hoisted_4$C,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-exclamation-triangle"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.fileCanvas.loadFailed")),1),createBaseVNode("button",{class:"retry-btn",onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("retry-loading"))},toDisplayString(unref($t2)("components.fileCanvas.retry")),1)])):createCommentVNode("",!0)],36),__props.showModeIndicator?(openBlock(),createElementBlock("div",_hoisted_5$y,toDisplayString(unref($t2)(__props.shouldUseFillMode?"components.fileCanvas.fillMode":"components.fileCanvas.fitMode")),1)):createCommentVNode("",!0),__props.showZoomIndicator&&unref(scale)!==1?(openBlock(),createElementBlock("div",_hoisted_6$u,toDisplayString(Math.round((isNaN(unref(scale))?1:unref(scale))*100))+"%",1)):createCommentVNode("",!0)],544))}});const FileCanvas=_export_sfc(_sfc_main$W,[["__scopeId","data-v-dd8e687b"]]),_hoisted_1$Q={class:"custom-header"},_hoisted_2$K={class:"header-content"},_hoisted_3$E={class:"header-left"},_hoisted_4$B={class:"header-text"},_hoisted_5$x={class:"header-title"},_hoisted_6$t={class:"header-subtitle"},_hoisted_7$p={class:"header-right"},_hoisted_8$o=["title","onClick"],_hoisted_9$n={key:0,class:"header-stats"},_hoisted_10$l={class:"stat-item"},_hoisted_11$k={class:"stat-label"},_hoisted_12$g={class:"stat-value"},_hoisted_13$e={class:"stat-item"},_hoisted_14$c={class:"stat-label"},_hoisted_15$b={class:"stat-value"},_hoisted_16$b={class:"similar-images-container"},_hoisted_17$9={key:0,class:"loading-state"},_hoisted_18$8={key:1,class:"error-state"},_hoisted_19$7={key:2,class:"empty-state"},_hoisted_20$7={key:3,class:"files-list"},_hoisted_21$7=["onClick"],_hoisted_22$6={class:"similarity-badge"},_hoisted_23$5={class:"file-container"},_hoisted_24$5=["src","alt"],_hoisted_25$5={class:"file-info"},_hoisted_26$5={class:"file-name"},_hoisted_27$5={class:"file-meta"},_hoisted_28$5={class:"meta-item"},_hoisted_29$3={class:"meta-item"},_hoisted_30$3={key:0,class:"file-tags"},_hoisted_31$3={key:0,class:"tag-more"},_hoisted_32$3={class:"hover-actions"},_hoisted_33$3=["title","onClick"],_hoisted_34$3=["title","onClick"],_sfc_main$V=defineComponent({__name:"SimilarFilesDrawer",props:{modelValue:{type:Boolean},loading:{type:Boolean},error:{},similarFiles:{}},emits:["update:modelValue","retry","select","download","view"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),{modelValue,loading:loading2,error:error2,similarFiles}=toRefs(props),visible=computed({get:()=>modelValue.value,set:value=>emit("update:modelValue",value)}),maxSimilarity=computed(()=>similarFiles.value.length?Math.max(...similarFiles.value.map(file=>file.similarity||0)):0),formatFileSize2=bytes=>bytes<1024?`${bytes} B`:bytes<1024*1024?`${(bytes/1024).toFixed(1)} KB`:`${(bytes/(1024*1024)).toFixed(1)} MB`,handleFileError=event=>{const img=event.target;img.src="/placeholder-image.png"};return(_ctx,_cache)=>{const _component_CyberDrawer=resolveComponent("CyberDrawer");return openBlock(),createBlock(_component_CyberDrawer,{modelValue:visible.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>visible.value=$event),title:unref($t2)("components.similarFilesDrawer.title"),width:"420px","mask-closable":!0},{header:withCtx(({close})=>[createBaseVNode("div",_hoisted_1$Q,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"header-bg-pattern"},null,-1)),createBaseVNode("div",_hoisted_2$K,[createBaseVNode("div",_hoisted_3$E,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"header-icon-wrapper"},[createBaseVNode("i",{class:"fas fa-layer-group"}),createBaseVNode("div",{class:"icon-glow"})],-1)),createBaseVNode("div",_hoisted_4$B,[createBaseVNode("h2",_hoisted_5$x,toDisplayString(unref($t2)("components.similarFilesDrawer.title")),1),createBaseVNode("p",_hoisted_6$t,toDisplayString(unref($t2)("components.similarFilesDrawer.subtitle")),1)])]),createBaseVNode("div",_hoisted_7$p,[createBaseVNode("button",{class:"custom-close-btn",title:unref($t2)("components.similarFilesDrawer.close"),onClick:close},[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])],8,_hoisted_8$o)])]),!unref(loading2)&&!unref(error2)&&unref(similarFiles).length>0?(openBlock(),createElementBlock("div",_hoisted_9$n,[createBaseVNode("div",_hoisted_10$l,[createBaseVNode("span",_hoisted_11$k,toDisplayString(unref($t2)("components.similarFilesDrawer.stats.matchResults")),1),createBaseVNode("span",_hoisted_12$g,toDisplayString(unref(similarFiles).length),1)]),createBaseVNode("div",_hoisted_13$e,[createBaseVNode("span",_hoisted_14$c,toDisplayString(unref($t2)("components.similarFilesDrawer.stats.maxSimilarity")),1),createBaseVNode("span",_hoisted_15$b,toDisplayString(Math.round(maxSimilarity.value*100))+"%",1)])])):createCommentVNode("",!0)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_16$b,[unref(loading2)?(openBlock(),createElementBlock("div",_hoisted_17$9,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"loading-spinner"},[createBaseVNode("i",{class:"fas fa-circle-notch fa-spin"})],-1)),createBaseVNode("p",null,toDisplayString(unref($t2)("components.similarFilesDrawer.loading")),1)])):unref(error2)?(openBlock(),createElementBlock("div",_hoisted_18$8,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-exclamation-triangle"},null,-1)),createBaseVNode("p",null,toDisplayString(unref(error2).message),1),createBaseVNode("button",{class:"retry-btn",onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("retry"))},[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-redo"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.similarFilesDrawer.retry")),1)])])):unref(similarFiles).length?(openBlock(),createElementBlock("div",_hoisted_20$7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(similarFiles),file=>(openBlock(),createElementBlock("div",{key:file.id,class:"similar-file-item",onClick:$event=>_ctx.$emit("select",file)},[createBaseVNode("div",_hoisted_22$6,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-percentage"},null,-1)),createTextVNode(" "+toDisplayString(Math.round(file.similarity*100)),1)]),createBaseVNode("div",_hoisted_23$5,[createBaseVNode("img",{src:file.full_thumb_url||file.thumb_url,alt:file.display_name||file.original_name,loading:"lazy",onError:handleFileError},null,40,_hoisted_24$5)]),createBaseVNode("div",_hoisted_25$5,[createBaseVNode("p",_hoisted_26$5,toDisplayString(file.display_name||file.original_name),1),createBaseVNode("div",_hoisted_27$5,[createBaseVNode("span",_hoisted_28$5,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-expand-arrows-alt"},null,-1)),createTextVNode(" "+toDisplayString(file.width)+" √ó "+toDisplayString(file.height),1)]),createBaseVNode("span",_hoisted_29$3,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-file"},null,-1)),createTextVNode(" "+toDisplayString(formatFileSize2(file.size)),1)])]),file.ai_info?.tags?.length?(openBlock(),createElementBlock("div",_hoisted_30$3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(file.ai_info.tags.slice(0,3),(tag,idx)=>(openBlock(),createElementBlock("span",{key:idx,class:"tag-chip"},toDisplayString(tag),1))),128)),file.ai_info.tags.length>3?(openBlock(),createElementBlock("span",_hoisted_31$3," +"+toDisplayString(file.ai_info.tags.length-3),1)):createCommentVNode("",!0)])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_32$3,[createBaseVNode("button",{class:"action-btn",title:unref($t2)("components.similarFilesDrawer.actions.download"),onClick:withModifiers($event=>_ctx.$emit("download",file),["stop"])},[..._cache[12]||(_cache[12]=[createBaseVNode("i",{class:"fas fa-download"},null,-1)])],8,_hoisted_33$3),createBaseVNode("button",{class:"action-btn",title:unref($t2)("components.similarFilesDrawer.actions.view"),onClick:withModifiers($event=>_ctx.$emit("view",file),["stop"])},[..._cache[13]||(_cache[13]=[createBaseVNode("i",{class:"fas fa-eye"},null,-1)])],8,_hoisted_34$3)])],8,_hoisted_21$7))),128))])):(openBlock(),createElementBlock("div",_hoisted_19$7,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-search"},null,-1)),createBaseVNode("p",null,toDisplayString(unref($t2)("components.similarFilesDrawer.notFound")),1)]))])]),_:1},8,["modelValue","title"])}}});const SimilarFilesDrawer=_export_sfc(_sfc_main$V,[["__scopeId","data-v-5e5feac7"]]),_hoisted_1$P={key:0,class:"detail-content"},_hoisted_2$J={class:"detail-section"},_hoisted_3$D={class:"section-title"},_hoisted_4$A={class:"detail-items"},_hoisted_5$w={class:"detail-item"},_hoisted_6$s={class:"item-label"},_hoisted_7$o=["title"],_hoisted_8$n={class:"detail-item"},_hoisted_9$m={class:"item-label"},_hoisted_10$k={class:"item-value"},_hoisted_11$j={class:"detail-item"},_hoisted_12$f={class:"item-label"},_hoisted_13$d={class:"item-value"},_hoisted_14$b={class:"resolution-badge"},_hoisted_15$a={class:"detail-item"},_hoisted_16$a={class:"item-label"},_hoisted_17$8={class:"item-value"},_hoisted_18$7={class:"format-badge"},_hoisted_19$6={class:"detail-item"},_hoisted_20$6={class:"item-label"},_hoisted_21$6={class:"item-value"},_hoisted_22$5={class:"detail-item"},_hoisted_23$4={class:"item-label"},_hoisted_24$4={class:"item-value"},_hoisted_25$4={key:0,class:"detail-item"},_hoisted_26$4={class:"item-label"},_hoisted_27$4={class:"item-value"},_hoisted_28$4={key:0,class:"detail-section"},_hoisted_29$2={class:"section-title"},_hoisted_30$2={class:"detail-items"},_hoisted_31$2={key:0,class:"detail-item column"},_hoisted_32$2={class:"item-label"},_hoisted_33$2={class:"item-value description"},_hoisted_34$2={key:1,class:"detail-item column"},_hoisted_35$2={class:"item-label"},_hoisted_36$2={class:"tags-container"},_hoisted_37$2={key:2,class:"detail-item"},_hoisted_38$2={class:"item-label"},_hoisted_39$2={class:"item-value"},_hoisted_40$2={class:"color-preview"},_hoisted_41$1={class:"color-text"},_hoisted_42$1={key:3,class:"detail-item"},_hoisted_43$1={class:"item-label"},_hoisted_44$1={class:"item-value"},_hoisted_45$1={class:"resolution-badge"},_hoisted_46$1={class:"detail-item"},_hoisted_47$1={class:"item-label"},_hoisted_48={class:"item-value"},_hoisted_49={key:4,class:"detail-item"},_hoisted_50={class:"item-label"},_hoisted_51={class:"item-value"},_hoisted_52={class:"detail-section"},_hoisted_53={class:"section-title"},_hoisted_54={class:"detail-items"},_hoisted_55={class:"detail-item"},_hoisted_56={class:"item-label"},_hoisted_57=["title"],_hoisted_58={class:"detail-item"},_hoisted_59={class:"item-label"},_hoisted_60=["title"],_hoisted_61={class:"detail-item"},_hoisted_62={class:"item-label"},_hoisted_63=["title"],_hoisted_64={key:1,class:"detail-section"},_hoisted_65={class:"section-title"},_hoisted_66={class:"detail-items"},_hoisted_67={key:0,class:"detail-item"},_hoisted_68={class:"item-label"},_hoisted_69={class:"item-value"},_hoisted_70={key:1,class:"detail-item"},_hoisted_71={class:"item-label"},_hoisted_72={class:"item-value"},_hoisted_73={key:2,class:"detail-item"},_hoisted_74={class:"item-label"},_hoisted_75={class:"item-value"},_hoisted_76={key:0,class:"text-secondary"},_hoisted_77={key:3,class:"detail-item"},_hoisted_78={class:"item-label"},_hoisted_79={class:"item-value"},_hoisted_80={key:4,class:"detail-item"},_hoisted_81={class:"item-label"},_hoisted_82={class:"item-value"},_hoisted_83={key:5,class:"detail-item"},_hoisted_84={class:"item-label"},_hoisted_85={class:"item-value"},_hoisted_86={key:6,class:"detail-item"},_hoisted_87={class:"item-label"},_hoisted_88={class:"item-value"},_hoisted_89={key:7,class:"detail-item"},_hoisted_90={class:"item-label"},_hoisted_91={class:"item-value font-mono text-sm"},_hoisted_92={key:8,class:"detail-item"},_hoisted_93={class:"item-label"},_hoisted_94={class:"item-value"},_hoisted_95={key:9,class:"detail-item"},_hoisted_96={class:"item-label"},_hoisted_97={class:"item-value"},_hoisted_98={key:10,class:"detail-item"},_hoisted_99={class:"item-label"},_hoisted_100={class:"item-value"},_hoisted_101={class:"detail-section"},_hoisted_102={class:"section-title"},_hoisted_103={class:"detail-items"},_hoisted_104={class:"detail-item"},_hoisted_105={class:"item-label"},_hoisted_106={class:"item-value"},_hoisted_107={class:"detail-item"},_hoisted_108={class:"item-label"},_hoisted_109={class:"item-value"},_hoisted_110={key:1,class:"empty-state"},_sfc_main$U=defineComponent({__name:"FileDetailDrawer",props:{modelValue:{type:Boolean},file:{}},emits:["update:modelValue"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,toast=useToast(),{$t:$t2}=useTexts(),visible=computed({get:()=>props.modelValue,set:val=>emit("update:modelValue",val)}),formatDate2=dateStr=>{if(!dateStr)return"-";try{return new Date(dateStr).toLocaleString(getCurrentLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return dateStr}},copyToClipboard=(text,label)=>{navigator.clipboard.writeText(text).then(()=>{toast.success($t2("components.fileDetailDrawer.messages.copySuccess",{label}))}).catch(()=>{toast.error($t2("components.fileDetailDrawer.messages.copyFailed"))})},getAccessLevelText=level=>({public:$t2("components.fileDetailDrawer.accessLevel.public"),private:$t2("components.fileDetailDrawer.accessLevel.private"),password:$t2("components.fileDetailDrawer.accessLevel.password")})[level]||level,getStorageDurationText=duration=>({permanent:$t2("components.fileDetailDrawer.storageDuration.permanent"),temporary:$t2("components.fileDetailDrawer.storageDuration.temporary")})[duration]||duration,hasEXIFData=exif=>exif?!!(exif.make||exif.model||exif.lens_model||exif.f_number||exif.exposure_time||exif.iso||exif.focal_length||exif.gps_latitude||exif.gps_longitude||exif.date_time_original):!1,getCameraInfo=exif=>exif?exif.make&&exif.model?exif.model.toLowerCase().startsWith(exif.make.toLowerCase())?exif.model:`${exif.make} ${exif.model}`:exif.make||exif.model||"":"",copyGPS=exif=>{if(!exif.gps_latitude||!exif.gps_longitude)return;const coords=`${exif.gps_latitude.toFixed(6)}, ${exif.gps_longitude.toFixed(6)}`;copyToClipboard(coords,$t2("components.fileDetailDrawer.labels.gpsCoords"))};return(_ctx,_cache)=>{const _component_CyberDrawer=resolveComponent("CyberDrawer");return openBlock(),createBlock(_component_CyberDrawer,{modelValue:visible.value,"onUpdate:modelValue":_cache[6]||(_cache[6]=$event=>visible.value=$event),width:"420px","mask-closable":!0,"show-header":!1,"show-keyboard-tip":!1},{default:withCtx(()=>[__props.file?(openBlock(),createElementBlock("div",_hoisted_1$P,[createBaseVNode("div",_hoisted_2$J,[createBaseVNode("div",_hoisted_3$D,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-file-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.fileDetailDrawer.sections.basicInfo")),1)]),createBaseVNode("div",_hoisted_4$A,[createBaseVNode("div",_hoisted_5$w,[createBaseVNode("div",_hoisted_6$s,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.fileName")),1),createBaseVNode("div",{class:"item-value text-truncate",title:__props.file.original_name},toDisplayString(__props.file.original_name||"-"),9,_hoisted_7$o),__props.file.original_name?(openBlock(),createElementBlock("button",{key:0,class:"copy-btn",onClick:_cache[0]||(_cache[0]=$event=>copyToClipboard(__props.file.original_name,unref($t2)("components.fileDetailDrawer.labels.fileName")))},[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_8$n,[createBaseVNode("div",_hoisted_9$m,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.fileSize")),1),createBaseVNode("div",_hoisted_10$k,toDisplayString(unref(formatFileSize)(__props.file.size)),1)]),createBaseVNode("div",_hoisted_11$j,[createBaseVNode("div",_hoisted_12$f,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.resolution")),1),createBaseVNode("div",_hoisted_13$d,[createBaseVNode("span",_hoisted_14$b,toDisplayString(__props.file.width)+" √ó "+toDisplayString(__props.file.height),1)])]),createBaseVNode("div",_hoisted_15$a,[createBaseVNode("div",_hoisted_16$a,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.format")),1),createBaseVNode("div",_hoisted_17$8,[createBaseVNode("span",_hoisted_18$7,toDisplayString(__props.file.format?.toUpperCase()||"-"),1)])]),createBaseVNode("div",_hoisted_19$6,[createBaseVNode("div",_hoisted_20$6,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.accessLevel")),1),createBaseVNode("div",_hoisted_21$6,[createBaseVNode("span",{class:normalizeClass(["access-badge",__props.file.access_level])},toDisplayString(getAccessLevelText(__props.file.access_level)),3)])]),createBaseVNode("div",_hoisted_22$5,[createBaseVNode("div",_hoisted_23$4,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.storageDuration")),1),createBaseVNode("div",_hoisted_24$4,toDisplayString(getStorageDurationText(__props.file.storage_duration)),1)]),__props.file.expires_at?(openBlock(),createElementBlock("div",_hoisted_25$4,[createBaseVNode("div",_hoisted_26$4,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.expiresAt")),1),createBaseVNode("div",_hoisted_27$4,toDisplayString(formatDate2(__props.file.expires_at)),1)])):createCommentVNode("",!0)])]),__props.file.ai_info?(openBlock(),createElementBlock("div",_hoisted_28$4,[createBaseVNode("div",_hoisted_29$2,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-robot"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.fileDetailDrawer.sections.aiAnalysis")),1)]),createBaseVNode("div",_hoisted_30$2,[__props.file.ai_info.description?(openBlock(),createElementBlock("div",_hoisted_31$2,[createBaseVNode("div",_hoisted_32$2,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.description")),1),createBaseVNode("div",_hoisted_33$2,toDisplayString(__props.file.ai_info.description),1)])):createCommentVNode("",!0),__props.file.ai_info.tags&&__props.file.ai_info.tags.length?(openBlock(),createElementBlock("div",_hoisted_34$2,[createBaseVNode("div",_hoisted_35$2,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.tags")),1),createBaseVNode("div",_hoisted_36$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.file.ai_info.tags,(tag,index2)=>(openBlock(),createElementBlock("span",{key:index2,class:"tag-badge"},toDisplayString(tag),1))),128))])])):createCommentVNode("",!0),__props.file.ai_info.dominant_color?(openBlock(),createElementBlock("div",_hoisted_37$2,[createBaseVNode("div",_hoisted_38$2,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.dominantColor")),1),createBaseVNode("div",_hoisted_39$2,[createBaseVNode("div",_hoisted_40$2,[createBaseVNode("div",{class:"color-block",style:normalizeStyle({background:__props.file.ai_info.dominant_color})},null,4),createBaseVNode("span",_hoisted_41$1,toDisplayString(__props.file.ai_info.dominant_color),1)])]),createBaseVNode("button",{class:"copy-btn",onClick:_cache[1]||(_cache[1]=$event=>copyToClipboard(__props.file.ai_info.dominant_color,unref($t2)("components.fileDetailDrawer.labels.colorCode")))},[..._cache[10]||(_cache[10]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])])):createCommentVNode("",!0),__props.file.ai_info.resolution?(openBlock(),createElementBlock("div",_hoisted_42$1,[createBaseVNode("div",_hoisted_43$1,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.resolutionLevel")),1),createBaseVNode("div",_hoisted_44$1,[createBaseVNode("span",_hoisted_45$1,toDisplayString(__props.file.ai_info.resolution),1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_46$1,[createBaseVNode("div",_hoisted_47$1,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.contentSafety")),1),createBaseVNode("div",_hoisted_48,[createBaseVNode("span",{class:normalizeClass(["nsfw-badge",{safe:!__props.file.ai_info.is_nsfw,nsfw:__props.file.ai_info.is_nsfw}])},toDisplayString(__props.file.ai_info.nsfw_evaluation||unref($t2)("components.fileDetailDrawer.labels.notEvaluated")),3)])]),__props.file.ai_info.nsfw_score!==void 0?(openBlock(),createElementBlock("div",_hoisted_49,[createBaseVNode("div",_hoisted_50,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.nsfwScore")),1),createBaseVNode("div",_hoisted_51,toDisplayString((__props.file.ai_info.nsfw_score*100).toFixed(1))+"%",1)])):createCommentVNode("",!0)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_52,[createBaseVNode("div",_hoisted_53,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-link"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.fileDetailDrawer.sections.links")),1)]),createBaseVNode("div",_hoisted_54,[createBaseVNode("div",_hoisted_55,[createBaseVNode("div",_hoisted_56,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.fullUrl")),1),createBaseVNode("div",{class:"item-value text-truncate font-mono text-sm",title:__props.file.full_url},toDisplayString(__props.file.full_url||"-"),9,_hoisted_57),__props.file.full_url?(openBlock(),createElementBlock("button",{key:0,class:"copy-btn",onClick:_cache[2]||(_cache[2]=$event=>copyToClipboard(__props.file.full_url,unref($t2)("components.fileDetailDrawer.labels.fullUrl")))},[..._cache[12]||(_cache[12]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_58,[createBaseVNode("div",_hoisted_59,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.shortUrl")),1),createBaseVNode("div",{class:"item-value text-truncate font-mono text-sm",title:__props.file.short_url},toDisplayString(__props.file.short_url||"-"),9,_hoisted_60),__props.file.short_url?(openBlock(),createElementBlock("button",{key:0,class:"copy-btn",onClick:_cache[3]||(_cache[3]=$event=>copyToClipboard(__props.file.short_url,unref($t2)("components.fileDetailDrawer.labels.shortUrl")))},[..._cache[13]||(_cache[13]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_61,[createBaseVNode("div",_hoisted_62,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.thumbUrl")),1),createBaseVNode("div",{class:"item-value text-truncate font-mono text-sm",title:__props.file.full_thumb_url},toDisplayString(__props.file.full_thumb_url||"-"),9,_hoisted_63),__props.file.full_thumb_url?(openBlock(),createElementBlock("button",{key:0,class:"copy-btn",onClick:_cache[4]||(_cache[4]=$event=>copyToClipboard(__props.file.full_thumb_url,unref($t2)("components.fileDetailDrawer.labels.thumbUrl")))},[..._cache[14]||(_cache[14]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])):createCommentVNode("",!0)])])]),__props.file.exif_info&&hasEXIFData(__props.file.exif_info)?(openBlock(),createElementBlock("div",_hoisted_64,[createBaseVNode("div",_hoisted_65,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-camera"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.fileDetailDrawer.sections.shootingInfo")),1)]),createBaseVNode("div",_hoisted_66,[__props.file.exif_info.make||__props.file.exif_info.model?(openBlock(),createElementBlock("div",_hoisted_67,[createBaseVNode("div",_hoisted_68,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.camera")),1),createBaseVNode("div",_hoisted_69,toDisplayString(getCameraInfo(__props.file.exif_info)),1)])):createCommentVNode("",!0),__props.file.exif_info.lens_model?(openBlock(),createElementBlock("div",_hoisted_70,[createBaseVNode("div",_hoisted_71,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.lens")),1),createBaseVNode("div",_hoisted_72,toDisplayString(__props.file.exif_info.lens_model),1)])):createCommentVNode("",!0),__props.file.exif_info.focal_length?(openBlock(),createElementBlock("div",_hoisted_73,[createBaseVNode("div",_hoisted_74,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.focalLength")),1),createBaseVNode("div",_hoisted_75,[createTextVNode(toDisplayString(__props.file.exif_info.focal_length)+"mm ",1),__props.file.exif_info.focal_length_in_35mm?(openBlock(),createElementBlock("span",_hoisted_76," ("+toDisplayString(__props.file.exif_info.focal_length_in_35mm)+"mm "+toDisplayString(unref($t2)("components.fileDetailDrawer.labels.equivalent"))+") ",1)):createCommentVNode("",!0)])])):createCommentVNode("",!0),__props.file.exif_info.f_number?(openBlock(),createElementBlock("div",_hoisted_77,[createBaseVNode("div",_hoisted_78,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.aperture")),1),createBaseVNode("div",_hoisted_79,"f/"+toDisplayString(__props.file.exif_info.f_number.toFixed(1)),1)])):createCommentVNode("",!0),__props.file.exif_info.exposure_time?(openBlock(),createElementBlock("div",_hoisted_80,[createBaseVNode("div",_hoisted_81,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.shutterSpeed")),1),createBaseVNode("div",_hoisted_82,toDisplayString(__props.file.exif_info.exposure_time)+"s",1)])):createCommentVNode("",!0),__props.file.exif_info.iso?(openBlock(),createElementBlock("div",_hoisted_83,[createBaseVNode("div",_hoisted_84,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.iso")),1),createBaseVNode("div",_hoisted_85,"ISO "+toDisplayString(__props.file.exif_info.iso),1)])):createCommentVNode("",!0),__props.file.exif_info.date_time_original?(openBlock(),createElementBlock("div",_hoisted_86,[createBaseVNode("div",_hoisted_87,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.shootingTime")),1),createBaseVNode("div",_hoisted_88,toDisplayString(formatDate2(__props.file.exif_info.date_time_original)),1)])):createCommentVNode("",!0),__props.file.exif_info.gps_latitude&&__props.file.exif_info.gps_longitude?(openBlock(),createElementBlock("div",_hoisted_89,[createBaseVNode("div",_hoisted_90,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.gpsCoords")),1),createBaseVNode("div",_hoisted_91,toDisplayString(__props.file.exif_info.gps_latitude.toFixed(6))+", "+toDisplayString(__props.file.exif_info.gps_longitude.toFixed(6)),1),createBaseVNode("button",{class:"copy-btn",onClick:_cache[5]||(_cache[5]=$event=>copyGPS(__props.file.exif_info))},[..._cache[16]||(_cache[16]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])])])):createCommentVNode("",!0),__props.file.exif_info.gps_altitude?(openBlock(),createElementBlock("div",_hoisted_92,[createBaseVNode("div",_hoisted_93,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.altitude")),1),createBaseVNode("div",_hoisted_94,toDisplayString(__props.file.exif_info.gps_altitude.toFixed(1))+"m",1)])):createCommentVNode("",!0),__props.file.exif_info.software?(openBlock(),createElementBlock("div",_hoisted_95,[createBaseVNode("div",_hoisted_96,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.editingSoftware")),1),createBaseVNode("div",_hoisted_97,toDisplayString(__props.file.exif_info.software),1)])):createCommentVNode("",!0),__props.file.exif_info.copyright?(openBlock(),createElementBlock("div",_hoisted_98,[createBaseVNode("div",_hoisted_99,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.copyright")),1),createBaseVNode("div",_hoisted_100,toDisplayString(__props.file.exif_info.copyright),1)])):createCommentVNode("",!0)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_101,[createBaseVNode("div",_hoisted_102,[_cache[17]||(_cache[17]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.fileDetailDrawer.sections.time")),1)]),createBaseVNode("div",_hoisted_103,[createBaseVNode("div",_hoisted_104,[createBaseVNode("div",_hoisted_105,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.createdAt")),1),createBaseVNode("div",_hoisted_106,toDisplayString(formatDate2(__props.file.created_at)),1)]),createBaseVNode("div",_hoisted_107,[createBaseVNode("div",_hoisted_108,toDisplayString(unref($t2)("components.fileDetailDrawer.labels.updatedAt")),1),createBaseVNode("div",_hoisted_109,toDisplayString(formatDate2(__props.file.updated_at)),1)])])])])):(openBlock(),createElementBlock("div",_hoisted_110,[_cache[18]||(_cache[18]=createBaseVNode("i",{class:"fas fa-file-alt"},null,-1)),createBaseVNode("p",null,toDisplayString(unref($t2)("components.fileDetailDrawer.empty")),1)]))]),_:1},8,["modelValue"])}}});const FileDetailDrawer=_export_sfc(_sfc_main$U,[["__scopeId","data-v-c96a80a3"]]),_hoisted_1$O={class:"info-panel"},_hoisted_2$I={class:"tips-header"},_hoisted_3$C={class:"tips-content"},_hoisted_4$z={class:"tip-item"},_hoisted_5$v={class:"tip-item"},_hoisted_6$r={class:"tip-item"},_hoisted_7$n={class:"tip-item"},_hoisted_8$m={class:"tip-item"},_hoisted_9$l={class:"tip-item"},_hoisted_10$j={class:"description-content"},_hoisted_11$i={class:"description-text"},_sfc_main$T=defineComponent({__name:"InfoPanel",props:{currentFile:{},isVisible:{type:Boolean},showKeyboardTips:{type:Boolean},shouldUseFillMode:{type:Boolean},isLightBackground:{type:Boolean}},setup(__props){const props=__props,{$t:$t2}=useTexts(),showKeyboardTipsVisible=ref(!1);let keyboardTipsTimer=null;return watch(()=>props.isVisible,newValue=>{newValue&&props.showKeyboardTips?(showKeyboardTipsVisible.value=!0,keyboardTipsTimer&&clearTimeout(keyboardTipsTimer),keyboardTipsTimer=setTimeout(()=>{showKeyboardTipsVisible.value=!1},5e3)):(showKeyboardTipsVisible.value=!1,keyboardTipsTimer&&(clearTimeout(keyboardTipsTimer),keyboardTipsTimer=null))}),onMounted(()=>{props.isVisible&&props.showKeyboardTips&&(showKeyboardTipsVisible.value=!0,keyboardTipsTimer=setTimeout(()=>{showKeyboardTipsVisible.value=!1},5e3))}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$O,[__props.showKeyboardTips&&__props.isVisible&&showKeyboardTipsVisible.value?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["keyboard-tips",{"is-light-bg":props.isLightBackground}])},[createBaseVNode("div",_hoisted_2$I,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-keyboard"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.title")),1)]),createBaseVNode("div",_hoisted_3$C,[createBaseVNode("div",_hoisted_4$z,[_cache[1]||(_cache[1]=createBaseVNode("kbd",null,"‚Üê‚Üí",-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.switchFile")),1)]),createBaseVNode("div",_hoisted_5$v,[createBaseVNode("kbd",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.space")),1),createBaseVNode("span",null,toDisplayString(unref($t2)(__props.shouldUseFillMode?"components.infoPanel.shortcuts.fitMode":"components.infoPanel.shortcuts.fillMode")),1)]),createBaseVNode("div",_hoisted_6$r,[_cache[2]||(_cache[2]=createBaseVNode("kbd",null,"¬±",-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.zoom")),1)]),createBaseVNode("div",_hoisted_7$n,[_cache[3]||(_cache[3]=createBaseVNode("kbd",null,"R/L",-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.rotate")),1)]),createBaseVNode("div",_hoisted_8$m,[_cache[4]||(_cache[4]=createBaseVNode("kbd",null,"F",-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.fullscreen")),1)]),createBaseVNode("div",_hoisted_9$l,[_cache[5]||(_cache[5]=createBaseVNode("kbd",null,"ESC",-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.infoPanel.shortcuts.exit")),1)])])],2)):createCommentVNode("",!0),(__props.currentFile?.ai_info?.description||__props.currentFile?.description)&&__props.isVisible?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(["image-description",{"is-light-bg":props.isLightBackground}])},[createBaseVNode("div",_hoisted_10$j,[createBaseVNode("div",_hoisted_11$i,toDisplayString(__props.currentFile?.ai_info?.description||__props.currentFile.description),1)])],2)):createCommentVNode("",!0)]))}});const InfoPanel=_export_sfc(_sfc_main$T,[["__scopeId","data-v-bf18a3cd"]]),_hoisted_1$N={class:"transform-controls"},_hoisted_2$H={class:"zoom-level"},_hoisted_3$B={key:0,class:"navigation-controls"},_hoisted_4$y=["disabled"],_hoisted_5$u={class:"image-counter"},_hoisted_6$q=["disabled"],_sfc_main$S=defineComponent({__name:"ControlBar",props:{isVisible:{type:Boolean},scale:{},shouldUseFillMode:{type:Boolean},hasMultipleFiles:{type:Boolean},hasPreviousFile:{type:Boolean},hasNextFile:{type:Boolean},currentIndex:{},totalFiles:{},isLightBackground:{type:Boolean}},emits:["zoom-in","zoom-out","rotate-left","rotate-right","reset-transform","toggle-fit-mode","prev-image","next-image"],setup(__props){const props=__props,{$t:$t2}=useTexts(),tooltip=reactive({visible:!1,text:"",style:{}}),showTooltip=(event,text)=>{const rect=event.currentTarget.getBoundingClientRect();tooltip.text=text,tooltip.visible=!0;const tooltipLeft=rect.left+rect.width/2,tooltipTop=rect.top-40;tooltip.style={position:"fixed",left:`${tooltipLeft}px`,top:`${tooltipTop}px`,transform:"translateX(-50%)",zIndex:"10001"}},hideTooltip=()=>{tooltip.visible=!1};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["control-bar",{"is-hidden":!__props.isVisible,"is-light-bg":props.isLightBackground}])},[createBaseVNode("div",_hoisted_1$N,[createBaseVNode("button",{class:"control-btn tooltip-btn",onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("zoom-out")),onMouseenter:_cache[1]||(_cache[1]=$event=>showTooltip($event,unref($t2)("components.controlBar.zoomOut"))),onMouseleave:hideTooltip},[..._cache[16]||(_cache[16]=[createBaseVNode("i",{class:"fas fa-search-minus"},null,-1)])],32),createBaseVNode("div",_hoisted_2$H,toDisplayString(Math.round((isNaN(__props.scale)?1:__props.scale)*100))+"%",1),createBaseVNode("button",{class:"control-btn tooltip-btn",onClick:_cache[2]||(_cache[2]=$event=>_ctx.$emit("zoom-in")),onMouseenter:_cache[3]||(_cache[3]=$event=>showTooltip($event,unref($t2)("components.controlBar.zoomIn"))),onMouseleave:hideTooltip},[..._cache[17]||(_cache[17]=[createBaseVNode("i",{class:"fas fa-search-plus"},null,-1)])],32),createBaseVNode("button",{class:"control-btn tooltip-btn",onClick:_cache[4]||(_cache[4]=$event=>_ctx.$emit("rotate-left")),onMouseenter:_cache[5]||(_cache[5]=$event=>showTooltip($event,unref($t2)("components.controlBar.rotateLeft"))),onMouseleave:hideTooltip},[..._cache[18]||(_cache[18]=[createBaseVNode("i",{class:"fas fa-undo"},null,-1)])],32),createBaseVNode("button",{class:"control-btn tooltip-btn",onClick:_cache[6]||(_cache[6]=$event=>_ctx.$emit("rotate-right")),onMouseenter:_cache[7]||(_cache[7]=$event=>showTooltip($event,unref($t2)("components.controlBar.rotateRight"))),onMouseleave:hideTooltip},[..._cache[19]||(_cache[19]=[createBaseVNode("i",{class:"fas fa-redo"},null,-1)])],32),createBaseVNode("button",{class:"control-btn tooltip-btn",onClick:_cache[8]||(_cache[8]=$event=>_ctx.$emit("reset-transform")),onMouseenter:_cache[9]||(_cache[9]=$event=>showTooltip($event,unref($t2)("components.controlBar.reset"))),onMouseleave:hideTooltip},[..._cache[20]||(_cache[20]=[createBaseVNode("i",{class:"fas fa-expand-arrows-alt"},null,-1)])],32),createBaseVNode("button",{class:"control-btn tooltip-btn",onClick:_cache[10]||(_cache[10]=$event=>_ctx.$emit("toggle-fit-mode")),onMouseenter:_cache[11]||(_cache[11]=$event=>showTooltip($event,unref($t2)(__props.shouldUseFillMode?"components.controlBar.switchToFit":"components.controlBar.switchToFill"))),onMouseleave:hideTooltip},[createBaseVNode("i",{class:normalizeClass(__props.shouldUseFillMode?"fas fa-compress-arrows-alt":"fas fa-expand-arrows-alt")},null,2)],32)]),__props.totalFiles>1?(openBlock(),createElementBlock("div",_hoisted_3$B,[createBaseVNode("button",{class:"nav-btn prev-btn tooltip-btn",disabled:!__props.hasPreviousFile,onClick:_cache[12]||(_cache[12]=$event=>_ctx.$emit("prev-image")),onMouseenter:_cache[13]||(_cache[13]=$event=>showTooltip($event,unref($t2)("components.controlBar.previous"))),onMouseleave:hideTooltip},[..._cache[21]||(_cache[21]=[createBaseVNode("i",{class:"fas fa-chevron-left"},null,-1)])],40,_hoisted_4$y),createBaseVNode("div",_hoisted_5$u,toDisplayString(__props.currentIndex+1)+" / "+toDisplayString(__props.totalFiles),1),createBaseVNode("button",{class:"nav-btn next-btn tooltip-btn",disabled:!__props.hasNextFile,onClick:_cache[14]||(_cache[14]=$event=>_ctx.$emit("next-image")),onMouseenter:_cache[15]||(_cache[15]=$event=>showTooltip($event,unref($t2)("components.controlBar.next"))),onMouseleave:hideTooltip},[..._cache[22]||(_cache[22]=[createBaseVNode("i",{class:"fas fa-chevron-right"},null,-1)])],40,_hoisted_6$q)])):createCommentVNode("",!0),tooltip.visible?(openBlock(),createElementBlock("div",{key:1,class:"dynamic-tooltip",style:normalizeStyle(tooltip.style)},[createTextVNode(toDisplayString(tooltip.text)+" ",1),_cache[23]||(_cache[23]=createBaseVNode("div",{class:"tooltip-arrow"},null,-1))],4)):createCommentVNode("",!0)],2))}});const ControlBar=_export_sfc(_sfc_main$S,[["__scopeId","data-v-3e8932c9"]]);function searchSimilarImages(fileId){return get(`/search/vector/similar/${fileId}`,void 0,{autoShowError:!1})}function gallerySimilarImages(fileId){return get(`/search/gallery/similar/${fileId}`,void 0,{autoShowError:!1})}function userSimilarImages(fileId){return get(`/search/user/similar/${fileId}`,void 0,{autoShowError:!1})}function adminSimilarImages(fileId){return get(`/search/admin/similar/${fileId}`,void 0,{autoShowError:!1})}function userVectorSearch(data){return post("/search/user/vector/search",data)}function galleryVectorSearch(data){return post("/search/gallery/vector/search",data)}const _hoisted_1$M={key:0,class:"image-viewer-wrapper"},_hoisted_2$G={class:"viewer-container"},_hoisted_3$A={class:"fixed-actions-wrapper"},_sfc_main$R=defineComponent({__name:"index",props:{modelValue:{type:Boolean},file:{default:null},files:{default:()=>[]},initialIndex:{default:0},showSideNav:{type:Boolean,default:!1},showKeyboardTips:{type:Boolean,default:!1},controlsHideTimeout:{default:5e3},searchScope:{default:"default"}},emits:["update:modelValue","close","change","error","load","prev","next","tag-click"],setup(__props,{emit:__emit}){const props=__props,safeFiles=ref(props.files||[]);watch(()=>props.files,newFiles=>{safeFiles.value=newFiles||[]},{immediate:!0});const emit=__emit,toast=useToast(),{$t:$t2}=useTexts(),viewerContent=ref(),fileCanvasRef=ref(),{currentIndex,totalFiles,hasMultipleFiles,hasPreviousFile,hasNextFile,currentFile,fileUrl:_fileUrl,showPreviousFile,showNextFile,goToFile:_goToFile,handleKeyboardNavigation}=useFileNavigation(safeFiles,props.initialIndex),{isLoading:isLoading2,hasError,isFirstView,isAllContentVisible,isImmersiveMode,isFullscreen,isFillMode:_isFillMode,isHorizontalImage:_isHorizontalImage,showModeIndicator,showZoomIndicator,isControlsHidden:_isControlsHidden,loadingProgress,loadingText,shouldUseFillMode,toggleControls,toggleFullscreen,toggleFitMode,showModeIndicatorTemporary:_showModeIndicatorTemporary,showZoomIndicatorTemporary,resetControlsTimer,handleFileLoad:handleImageLoadInternal,handleFileError:handleImageErrorInternal,retryLoading,startRealImageLoading,startLoadingProgressSimulation,stopLoadingProgressSimulation:_stopLoadingProgressSimulation,handleFullscreenChange}=useFileViewer(props.file),visible=computed({get:()=>props.modelValue,set:value=>emit("update:modelValue",value)}),currentScale=ref(1),showSimilarDrawer=ref(!1),similarLoading=ref(!1),similarError=ref(null),similarImages=ref([]),showDetailDrawer=ref(!1),lastSimilarQueryFileId=ref(null),tempPreviewImage=ref(null),isInTempPreview=ref(!1),displayImage=computed(()=>{if(isInTempPreview.value&&tempPreviewImage.value)return tempPreviewImage.value;const current=currentFile.value,fallback=props.file;return current||fallback||null}),hasAIInfo=computed(()=>{const image=displayImage.value;return image&&image.ai_info&&image.ai_info.description}),imageBrightness=ref(.5),isLightBackground=computed(()=>imageBrightness.value>.55),detectImageBrightness=imageUrl=>{const img=new Image;img.crossOrigin="anonymous",img.onload=()=>{const canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");if(ctx){canvas.width=img.width,canvas.height=img.height,ctx.drawImage(img,0,0);try{const data=ctx.getImageData(0,0,canvas.width,canvas.height).data;let total=0,count=0;for(let i=0;i<data.length;i+=12){const r=data[i],g=data[i+1],b=data[i+2],brightness=(.299*r+.587*g+.114*b)/255;total+=brightness,count++}imageBrightness.value=total/count}catch{imageBrightness.value=.5}}},img.onerror=()=>{imageBrightness.value=.5},img.src=imageUrl};watch(()=>{const image=displayImage.value;return image?.full_url||image?.url||null},newUrl=>{newUrl&&detectImageBrightness(newUrl)},{immediate:!0});const loadImageWithProgress=async()=>{const imageUrl=displayImage.value?.full_url||displayImage.value?.url;if(imageUrl){isLoading2.value=!0,hasError.value=!1;try{const blob=await startRealImageLoading(imageUrl);blob&&URL.createObjectURL(blob)}catch(error2){logger.error("Error loading image with progress:",error2),startLoadingProgressSimulation()}}},handleClose=()=>{visible.value=!1,showSimilarDrawer.value=!1,isInTempPreview.value&&exitTempPreview(),emit("close")},handleBackdropClick=()=>{handleClose()},handleMouseMove=()=>{resetControlsTimer()},handlePreviousClick=e=>{e&&e.stopPropagation(),isInTempPreview.value&&exitTempPreview(),showPreviousFile()},handleNextClick=e=>{e&&e.stopPropagation(),isInTempPreview.value&&exitTempPreview(),showNextFile()},exitTempPreview=()=>{isInTempPreview.value=!1,tempPreviewImage.value=null,loadImage()},handleImageLoad=imageRef=>{handleImageLoadInternal(imageRef),emit("load",displayImage.value)},handleImageError=()=>{handleImageErrorInternal(),emit("error",{file:displayImage.value,event:new Event("error")})},handleDownload=()=>{const image=displayImage.value;image&&downloadFileQuick(image.id,image.display_name||"file")},handleTagClick=tag=>{emit("tag-click",tag)},zoomIn=()=>{fileCanvasRef.value&&(fileCanvasRef.value.zoomIn(),currentScale.value=fileCanvasRef.value.getScale(),showZoomIndicatorTemporary())},zoomOut=()=>{fileCanvasRef.value&&(fileCanvasRef.value.zoomOut(),currentScale.value=fileCanvasRef.value.getScale(),showZoomIndicatorTemporary())},rotateLeft=()=>{fileCanvasRef.value&&fileCanvasRef.value.rotateLeft()},rotateRight=()=>{fileCanvasRef.value&&fileCanvasRef.value.rotateRight()},resetTransform=()=>{fileCanvasRef.value&&(fileCanvasRef.value.resetTransform(),currentScale.value=1)},handleScaleChange=newScale=>{currentScale.value=newScale,showZoomIndicatorTemporary()},handleFindSimilar=async()=>{if(isInTempPreview.value){showSimilarDrawer.value=!0;return}const currentFileId=currentFile.value?.id||props.file?.id;if(currentFileId&&lastSimilarQueryFileId.value===String(currentFileId)){showSimilarDrawer.value=!0;return}showSimilarDrawer.value=!0,await findSimilarImages()},findSimilarImages=async()=>{const image=isInTempPreview.value?currentFile.value||props.file:displayImage.value;if(!image){similarError.value=new Error($t2("components.fileViewer.errors.noFileInfo"));return}lastSimilarQueryFileId.value=String(image.id),similarLoading.value=!0,similarError.value=null,similarImages.value=[];try{let result;const fileId=String(image.id);switch(props.searchScope){case"gallery":result=await gallerySimilarImages(fileId);break;case"user":result=await userSimilarImages(fileId);break;case"admin":result=await adminSimilarImages(fileId);break;default:result=await searchSimilarImages(fileId);break}result&&result.data&&result.data.items&&result.data.items.length>0?(similarImages.value=result.data.items,similarImages.value=similarImages.value.filter(item=>String(item.id)!==String(image.id)),similarImages.value.length===0&&(similarError.value=new Error($t2("components.fileViewer.errors.noSimilarFiles")))):similarError.value=new Error($t2("components.fileViewer.errors.noSimilarFiles"))}catch(error2){const errorObj=error2;errorObj.response?.status===404?similarError.value=new Error($t2("components.fileViewer.errors.noVectorData")):errorObj.code===110?similarError.value=new Error(errorObj.message||$t2("components.fileViewer.errors.vectorSearchUnavailable")):errorObj.message?similarError.value=new Error(errorObj.message):similarError.value=new Error($t2("components.fileViewer.errors.searchFailed"))}finally{similarLoading.value=!1}},viewSimilarImage=image=>{tempPreviewImage.value=image,isInTempPreview.value=!0,showSimilarDrawer.value=!1,loadImage()},downloadSimilarImage=async image=>{await downloadFileQuick(image.id,image.display_name||image.original_name||"file"),toast.success($t2("components.fileViewer.messages.downloadStarted"))};return useKeyboardShortcuts(visible,{onEscape:handleClose,onSpace:()=>{currentScale.value!==1&&resetTransform(),toggleFitMode()},onArrowLeft:()=>handleKeyboardNavigation("ArrowLeft"),onArrowRight:()=>handleKeyboardNavigation("ArrowRight"),onPlus:zoomIn,onMinus:zoomOut,onR:rotateRight,onL:rotateLeft,onF:toggleFullscreen,onReset:resetTransform}),watch(()=>props.file,(newFile,oldFile)=>{newFile&&(!oldFile||newFile.id!==oldFile.id)&&(isLoading2.value=!0,hasError.value=!1,startLoadingProgressSimulation(),resetTransform(),isInTempPreview.value&&exitTempPreview())}),watch(()=>props.files,()=>{currentIndex.value>=(props.files?.length||0)&&(currentIndex.value=Math.max(0,(props.files?.length||0)-1))}),watch(()=>props.initialIndex,newIndex=>{newIndex&&newIndex>=0&&newIndex<(props.files?.length||0)&&(currentIndex.value=newIndex)}),watch(currentIndex,newIndex=>{props.files&&props.files[newIndex]&&(emit("change",props.files[newIndex],newIndex),loadImageWithProgress())}),onMounted(()=>{document.addEventListener("fullscreenchange",handleFullscreenChange),(props.file||props.files&&props.files.length>0&&props.files[currentIndex.value])&&loadImageWithProgress()}),onUnmounted(()=>{document.removeEventListener("fullscreenchange",handleFullscreenChange)}),(_ctx,_cache)=>{const _component_CyberFileLoading=resolveComponent("CyberFileLoading"),_component_cyberTooltip=resolveComponent("cyberTooltip");return openBlock(),createElementBlock(Fragment,null,[(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-viewer-fade"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",_hoisted_1$M,[createBaseVNode("div",{class:normalizeClass(["cyber-image-viewer",{"is-immersive":unref(isImmersiveMode)}])},[createBaseVNode("div",{class:"viewer-backdrop",onClick:handleBackdropClick}),createBaseVNode("div",_hoisted_2$G,[createVNode(NavigationBar,{"is-visible":unref(isAllContentVisible),"current-file":displayImage.value,"is-fullscreen":unref(isFullscreen),"has-ai-info":hasAIInfo.value,"is-light-background":isLightBackground.value,onToggleFullscreen:unref(toggleFullscreen),onDownload:handleDownload,onClose:handleClose,onTagClick:handleTagClick,onFindSimilar:handleFindSimilar},null,8,["is-visible","current-file","is-fullscreen","has-ai-info","is-light-background","onToggleFullscreen"]),createBaseVNode("div",{ref_key:"viewerContent",ref:viewerContent,class:"viewer-content",onMousemove:handleMouseMove,onMouseleave:_cache[0]||(_cache[0]=(...args)=>unref(resetControlsTimer)&&unref(resetControlsTimer)(...args))},[unref(isLoading2)?(openBlock(),createBlock(_component_CyberFileLoading,{key:0,progress:unref(loadingProgress),"loading-text":String(unref(loadingText)),"show-data-stream":!0},null,8,["progress","loading-text"])):createCommentVNode("",!0),createVNode(FileCanvas,{ref_key:"fileCanvasRef",ref:fileCanvasRef,"current-file":displayImage.value,"file-url":displayImage.value?.full_url||"","is-loading":unref(isLoading2),"has-error":unref(hasError),"show-side-nav":unref(hasMultipleFiles),"has-multiple-files":unref(hasMultipleFiles),"has-previous-file":unref(hasPreviousFile)||isInTempPreview.value,"has-next-file":unref(hasNextFile)||isInTempPreview.value,"should-use-fill-mode":unref(shouldUseFillMode),"show-mode-indicator":unref(showModeIndicator),"show-zoom-indicator":unref(showZoomIndicator),"is-light-background":isLightBackground.value,onCanvasClick:unref(toggleControls),onPrevImage:handlePreviousClick,onNextImage:handleNextClick,onResetTransform:resetTransform,onRetryLoading:unref(retryLoading),onImageLoad:handleImageLoad,onImageError:handleImageError,onScaleChange:handleScaleChange},null,8,["current-file","file-url","is-loading","has-error","show-side-nav","has-multiple-files","has-previous-file","has-next-file","should-use-fill-mode","show-mode-indicator","show-zoom-indicator","is-light-background","onCanvasClick","onRetryLoading"]),createVNode(InfoPanel,{"current-file":displayImage.value,"is-visible":unref(isFirstView)||unref(isAllContentVisible),"show-keyboard-tips":__props.showKeyboardTips,"should-use-fill-mode":unref(shouldUseFillMode),"is-light-background":isLightBackground.value},null,8,["current-file","is-visible","show-keyboard-tips","should-use-fill-mode","is-light-background"])],544),createVNode(ControlBar,{"is-visible":unref(isAllContentVisible),scale:currentScale.value,"should-use-fill-mode":unref(shouldUseFillMode),"has-multiple-files":unref(hasMultipleFiles)||isInTempPreview.value,"has-previous-file":unref(hasPreviousFile)||isInTempPreview.value,"has-next-file":unref(hasNextFile)||isInTempPreview.value,"current-index":isInTempPreview.value?0:unref(currentIndex),"total-files":isInTempPreview.value?1:unref(totalFiles),"is-light-background":isLightBackground.value,onZoomIn:zoomIn,onZoomOut:zoomOut,onRotateLeft:rotateLeft,onRotateRight:rotateRight,onResetTransform:resetTransform,onToggleFitMode:unref(toggleFitMode),onPrevImage:handlePreviousClick,onNextImage:handleNextClick},null,8,["is-visible","scale","should-use-fill-mode","has-multiple-files","has-previous-file","has-next-file","current-index","total-files","is-light-background","onToggleFitMode"]),createBaseVNode("div",_hoisted_3$A,[createVNode(_component_cyberTooltip,{content:unref($t2)("components.fileViewer.actions.fileDetail"),placement:"top",offset:[-8,20],"show-delay":0,theme:"dark"},{default:withCtx(()=>[createBaseVNode("div",{class:"fixed-action-btn detail-btn",onClick:_cache[1]||(_cache[1]=$event=>showDetailDrawer.value=!0)},[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-info-circle"},null,-1)])])]),_:1},8,["content"]),hasAIInfo.value?(openBlock(),createBlock(_component_cyberTooltip,{key:0,content:unref($t2)("components.fileViewer.actions.similarFiles"),placement:"top",offset:[-8,20],"show-delay":0,theme:"dark"},{default:withCtx(()=>[createBaseVNode("div",{class:"fixed-action-btn similar-btn",onClick:handleFindSimilar},[..._cache[5]||(_cache[5]=[createBaseVNode("i",{class:"fas fa-layer-group"},null,-1)])])]),_:1},8,["content"])):createCommentVNode("",!0)])])],2)])):createCommentVNode("",!0)]),_:1})])),createVNode(FileDetailDrawer,{modelValue:showDetailDrawer.value,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>showDetailDrawer.value=$event),file:displayImage.value},null,8,["modelValue","file"]),createVNode(SimilarFilesDrawer,{modelValue:showSimilarDrawer.value,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>showSimilarDrawer.value=$event),loading:similarLoading.value,error:similarError.value,"similar-files":similarImages.value,onRetry:findSimilarImages,onSelect:viewSimilarImage,onDownload:downloadSimilarImage,onView:viewSimilarImage},null,8,["modelValue","loading","error","similar-files"])],64)}}});const FileViewer=_export_sfc(_sfc_main$R,[["__scopeId","data-v-ec97bdb3"]]),_sfc_main$Q=defineComponent({name:"ParticleBackground",__name:"index",props:{maxParticles:{default:100},colors:{default:()=>["var(--color-brand-500)","var(--color-brand-600)","var(--color-warning-500)","var(--color-success-500)"]},theme:{default:"default"},connectionDistance:{default:100},connectionOpacity:{default:.15},showConnections:{type:Boolean,default:!0},particleSpeed:{default:1},showGrid:{type:Boolean,default:!0}},setup(__props){const props=__props;function getCSSVariableRGB(variableName){return typeof window>"u"?"14, 165, 233":getComputedStyle(document.documentElement).getPropertyValue(variableName).trim()||"14, 165, 233"}function getCSSVariableColor(variableName){return typeof window>"u"?"rgb(14, 165, 233)":getComputedStyle(document.documentElement).getPropertyValue(variableName).trim()||"rgb(14, 165, 233)"}const particlesArray=[];let animationId=null,canvas=null,ctx=null,containerWidth=0,containerHeight=0,resolvedColors=[],brandColor="";function createParticle(){return{x:Math.random()*containerWidth,y:Math.random()*containerHeight,size:Math.random()*4+1,speedX:(Math.random()-.5)*.5*props.particleSpeed,speedY:(Math.random()-.5)*.5*props.particleSpeed,color:resolvedColors[Math.floor(Math.random()*resolvedColors.length)],alpha:Math.random()*.6+.2,direction:Math.random()*Math.PI*2}}function initParticles(){for(let i=0;i<props.maxParticles;i++)particlesArray.push(createParticle())}function updateParticles(){for(let i=0;i<particlesArray.length;i++){const p=particlesArray[i];p.x+=p.speedX,p.y+=p.speedY,p.x<0&&(p.x=containerWidth),p.x>containerWidth&&(p.x=0),p.y<0&&(p.y=containerHeight),p.y>containerHeight&&(p.y=0),Math.random()<.01&&(p.direction+=(Math.random()-.5)*.2,p.speedX=Math.cos(p.direction)*(Math.random()*.5+.1)*props.particleSpeed,p.speedY=Math.sin(p.direction)*(Math.random()*.5+.1)*props.particleSpeed)}}function drawParticles(){if(!ctx)return;ctx.clearRect(0,0,containerWidth,containerHeight);for(let i=0;i<particlesArray.length;i++){const p=particlesArray[i];ctx.beginPath(),ctx.arc(p.x,p.y,p.size,0,Math.PI*2),ctx.fillStyle=p.color,ctx.globalAlpha=p.alpha,ctx.fill()}if(props.showConnections){ctx.globalAlpha=props.theme==="docs"?props.connectionOpacity*.5:props.connectionOpacity,ctx.strokeStyle=brandColor,ctx.lineWidth=.5;for(let i=0;i<particlesArray.length;i++)for(let j=i+1;j<particlesArray.length;j++){const dx=particlesArray[i].x-particlesArray[j].x,dy=particlesArray[i].y-particlesArray[j].y;Math.sqrt(dx*dx+dy*dy)<props.connectionDistance&&(ctx.beginPath(),ctx.moveTo(particlesArray[i].x,particlesArray[i].y),ctx.lineTo(particlesArray[j].x,particlesArray[j].y),ctx.stroke())}}const gradient=ctx.createRadialGradient(containerWidth/2,containerHeight/2,0,containerWidth/2,containerHeight/2,containerWidth/1.5),cyberBlueRGB=getCSSVariableRGB("--color-brand-500-rgb"),cyberPinkRGB=getCSSVariableRGB("--color-brand-600-rgb");if(gradient.addColorStop(0,`rgba(${cyberBlueRGB}, 0)`),gradient.addColorStop(.5,props.theme==="docs"?`rgba(${cyberBlueRGB}, 0.01)`:`rgba(${cyberBlueRGB}, 0.03)`),gradient.addColorStop(1,props.theme==="docs"?`rgba(${cyberPinkRGB}, 0.02)`:`rgba(${cyberPinkRGB}, 0.05)`),ctx.globalAlpha=props.theme==="docs"?.15:.3,ctx.fillStyle=gradient,ctx.fillRect(0,0,containerWidth,containerHeight),props.showGrid){ctx.globalAlpha=props.theme==="docs"?.03:.08,ctx.strokeStyle=brandColor,ctx.lineWidth=.2;const gridSize=40;for(let x=0;x<=containerWidth;x+=gridSize)ctx.beginPath(),ctx.moveTo(x,0),ctx.lineTo(x,containerHeight),ctx.stroke();for(let y=0;y<=containerHeight;y+=gridSize)ctx.beginPath(),ctx.moveTo(0,y),ctx.lineTo(containerWidth,y),ctx.stroke()}}function animate(){updateParticles(),drawParticles(),animationId=requestAnimationFrame(animate)}function handleResize(){const container=document.getElementById("particle-background");!container||!canvas||(containerWidth=container.offsetWidth,containerHeight=container.offsetHeight,canvas.width=containerWidth,canvas.height=containerHeight)}function initCanvas(){const container=document.getElementById("particle-background");container&&(resolvedColors=props.colors.map(color=>{if(color.startsWith("var(")){const varName=color.match(/var\((--[^)]+)\)/)?.[1];return varName?getCSSVariableColor(varName):color}return color}),brandColor=getCSSVariableColor("--color-brand-500"),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),ctx&&(containerWidth=container.offsetWidth,containerHeight=container.offsetHeight,canvas.width=containerWidth,canvas.height=containerHeight,container.appendChild(canvas),initParticles(),animate(),window.addEventListener("resize",handleResize)))}return onMounted(()=>{setTimeout(initCanvas,100)}),onUnmounted(()=>{animationId!==null&&cancelAnimationFrame(animationId),window.removeEventListener("resize",handleResize),particlesArray.length=0}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["particle-background",{"docs-theme":__props.theme==="docs"}])},[..._cache[0]||(_cache[0]=[createBaseVNode("div",{id:"particle-background",class:"particle-container"},null,-1)])],2))}});const ParticleBackground=_export_sfc(_sfc_main$Q,[["__scopeId","data-v-0dbacc7e"]]),_sfc_main$P=defineComponent({name:"CyberBackground",__name:"index",props:{pattern:{default:"cyber"},backgroundColor:{default:"rgba(var(--color-background-900-rgb), 0.7)"},className:{default:""}},setup(__props){const props=__props,backgroundStyle=computed(()=>({backgroundColor:props.backgroundColor})),backgroundClass=computed(()=>["cyber-background",`cyber-bg-${props.pattern}`,props.className]);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(backgroundClass.value),style:normalizeStyle(backgroundStyle.value)},[renderSlot(_ctx.$slots,"default",{},void 0,!0)],6))}});const CyberBackground=_export_sfc(_sfc_main$P,[["__scopeId","data-v-a418cfb6"]]),_hoisted_1$L={key:0,class:"drawer-header"},_hoisted_2$F={key:1,class:"drawer-header flex items-center justify-between px-5 py-4"},_hoisted_3$z={class:"drawer-title flex items-center gap-2 text-lg font-semibold text-content"},_hoisted_4$x=["title"],_hoisted_5$t={class:"drawer-content flex-1 overflow-y-auto"},_hoisted_6$p={key:1,class:"border-t border-default"},_hoisted_7$m={key:2,class:"drawer-keyboard-tip"},_hoisted_8$l={class:"flex items-center justify-center text-xs"},_sfc_main$O=defineComponent({name:"CyberDrawer",__name:"index",props:{modelValue:{type:Boolean},title:{},width:{default:"600px"},position:{default:"right"},maskClosable:{type:Boolean,default:!0},escClosable:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showKeyboardTip:{type:Boolean,default:!0}},emits:["update:modelValue","close"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),visible=computed({get:()=>props.modelValue,set:value=>{emit("update:modelValue",value)}}),sizeStyle=computed(()=>({width:typeof props.width=="number"?`${props.width}px`:props.width,maxWidth:"min(90vw, 800px)",minWidth:"min(400px, 90vw)"})),positionClass=computed(()=>props.position==="left"?"drawer-left":"drawer-right"),handleClose=()=>{visible.value=!1,emit("close")},handleMaskClick=()=>{props.maskClosable&&handleClose()},handleKeydown=event=>{visible.value&&props.escClosable&&event.key==="Escape"&&(event.preventDefault(),handleClose())};return watch(visible,newVisible=>{newVisible&&props.escClosable?document.addEventListener("keydown",handleKeydown):document.removeEventListener("keydown",handleKeydown)},{immediate:!0}),onUnmounted(()=>{document.removeEventListener("keydown",handleKeydown)}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"drawer"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:"drawer-wrapper fixed inset-0 flex",onClick:handleMaskClick},[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"drawer-mask absolute inset-0 bg-overlay-heavy backdrop-blur-sm"},null,-1)),createBaseVNode("div",{style:normalizeStyle(sizeStyle.value),class:normalizeClass([["drawer-panel",positionClass.value],"relative flex h-full flex-col overflow-hidden"]),onClick:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"]))},[props.showHeader?(openBlock(),createElementBlock(Fragment,{key:0},[_ctx.$slots.header?(openBlock(),createElementBlock("div",_hoisted_1$L,[renderSlot(_ctx.$slots,"header",{close:handleClose},void 0,!0)])):(openBlock(),createElementBlock("div",_hoisted_2$F,[createBaseVNode("h2",_hoisted_3$z,[renderSlot(_ctx.$slots,"title-icon",{},void 0,!0),createTextVNode(" "+toDisplayString(__props.title),1)]),createBaseVNode("button",{class:"close-btn",title:props.escClosable?unref($t2)("components.drawer.closeWithEsc"):unref($t2)("components.drawer.close"),onClick:handleClose},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])],8,_hoisted_4$x)]))],64)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_5$t,[renderSlot(_ctx.$slots,"default",{},void 0,!0)]),_ctx.$slots.footer?(openBlock(),createElementBlock("div",_hoisted_6$p,[renderSlot(_ctx.$slots,"footer",{},void 0,!0)])):props.escClosable&&props.showKeyboardTip?(openBlock(),createElementBlock("div",_hoisted_7$m,[createBaseVNode("div",_hoisted_8$l,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-keyboard mr-2"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.drawer.keyboardHint",{key:"ESC"})),1)])])):createCommentVNode("",!0)],6)])):createCommentVNode("",!0)]),_:3})]))}});const Drawer=_export_sfc(_sfc_main$O,[["__scopeId","data-v-95fff74c"]]),_hoisted_1$K={key:0,class:"cyber-table-loading"},_hoisted_2$E={class:"loading-content"},_hoisted_3$y={class:"loading-text"},_hoisted_4$w={class:"cyber-table-element"},_hoisted_5$s={class:"cyber-table-thead"},_hoisted_6$o={class:"cyber-table-header-row"},_hoisted_7$l=["onClick"],_hoisted_8$k={class:"cyber-table-th-content"},_hoisted_9$k={key:0,class:"sort-indicator"},_hoisted_10$i={key:0,class:"fas fa-sort"},_hoisted_11$h={key:1,class:"fas fa-sort-up"},_hoisted_12$e={key:2,class:"fas fa-sort-down"},_hoisted_13$c={class:"cyber-table-tbody"},_hoisted_14$a={class:"p-2"},_hoisted_15$9=["onClick"],_hoisted_16$9={key:2,class:"cyber-table-empty"},_hoisted_17$7=["colspan"],_hoisted_18$6={class:"empty-content"},_hoisted_19$5={class:"default-empty"},_hoisted_20$5={class:"empty-text"},_hoisted_21$5={key:1,class:"cyber-table-pagination"},_sfc_main$N=defineComponent({name:"CyberTable",__name:"index",props:{data:{},columns:{},loading:{type:Boolean,default:!1},loadingText:{default:""},skeleton:{type:Boolean,default:!1},skeletonRows:{default:5},rowKey:{type:[String,Function],default:"id"},selectable:{type:Boolean,default:!1},selectedRowKeys:{default:()=>[]},pagination:{type:[Object,Boolean]},bordered:{type:Boolean,default:!0},striped:{type:Boolean,default:!0},hoverable:{type:Boolean,default:!0},size:{default:"medium"},maxHeight:{},emptyText:{default:""},sortBy:{},sortOrder:{}},emits:["update:selectedRowKeys","row-click","row-select","select-all","sort-change","page-change","page-size-change"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,emit=__emit,tableContainer=ref(),sorting=ref([]),rowSelection=ref({}),{$t:$t2}=useTexts(),slots=useSlots(),resolvedLoadingText=computed(()=>props.loadingText||$t2("table.loading")),resolvedEmptyText=computed(()=>props.emptyText||$t2("table.noData")),tableClasses=computed(()=>[`cyber-table-${props.size}`,{"cyber-table-bordered":props.bordered,"cyber-table-striped":props.striped,"cyber-table-hoverable":props.hoverable,"cyber-table-loading":props.loading}]),wrapperStyle=computed(()=>({maxHeight:typeof props.maxHeight=="number"?`${props.maxHeight}px`:props.maxHeight})),columns=computed(()=>{const cols=[];return props.selectable&&cols.push({id:"select",size:50,minSize:50,maxSize:50,header:({table:table2})=>h("div",{class:"flex items-center justify-center h-full"},[h(Checkbox,{modelValue:table2.getIsAllRowsSelected(),indeterminate:table2.getIsSomeRowsSelected()&&!table2.getIsAllRowsSelected(),onChange:value=>{table2.getToggleAllRowsSelectedHandler()({target:{checked:value}})}})]),cell:({row})=>h("div",{class:"flex items-center justify-center h-full"},[h(Checkbox,{modelValue:row.getIsSelected(),disabled:!row.getCanSelect(),onChange:value=>{row.getToggleSelectedHandler()({target:{checked:value}})}})]),meta:{align:"center"}}),props.columns.forEach(column=>{const col={id:column.key,accessorKey:column.dataIndex||column.key,header:column.title,size:typeof column.width=="number"?column.width:150,minSize:typeof column.width=="number"?column.width:column.minWidth||50,maxSize:typeof column.width=="number"?column.width:column.maxWidth||1e3,enableSorting:column.sortable??!1,enableResizing:!1,meta:{align:column.align||"left",className:column.ellipsis?"ellipsis":void 0}};column.slot?col.cell=({getValue,row})=>{const slotFn=slots[column.slot];return typeof slotFn=="function"?h("div",{class:"w-full"},slotFn({value:getValue(),record:row.original,index:row.index})):h("span",String(getValue()))}:column.render&&(col.cell=({getValue,row})=>column.render(getValue(),row.original,row.index)),cols.push(col)}),cols}),table=useVueTable({get data(){return props.data},get columns(){return columns.value},state:{get sorting(){return sorting.value},get rowSelection(){return rowSelection.value}},onSortingChange:updater=>{const newSorting=typeof updater=="function"?updater(sorting.value):updater;if(sorting.value=newSorting,newSorting.length>0){const{id,desc}=newSorting[0];emit("sort-change",id,desc?"desc":"asc")}else emit("sort-change","",null)},onRowSelectionChange:updater=>{const newSelection=typeof updater=="function"?updater(rowSelection.value):updater;rowSelection.value=newSelection;const selectedRowKeys=Object.keys(newSelection).filter(key=>newSelection[key]).map(key=>{const rowData=props.data[Number(key)];return typeof props.rowKey=="string"?rowData[props.rowKey]:props.rowKey(rowData)});emit("update:selectedRowKeys",selectedRowKeys)},getCoreRowModel:getCoreRowModel(),getSortedRowModel:getSortedRowModel(),getFilteredRowModel:getFilteredRowModel(),getPaginationRowModel:getPaginationRowModel(),enableRowSelection:props.selectable,enableSorting:!0,enableFiltering:!0}),handleRowClick=(record,index2)=>{emit("row-click",record,index2)},handlePageChange=page=>{emit("page-change",page)},handlePageSizeChange=size=>{emit("page-size-change",size)};return watch(()=>props.selectedRowKeys,newKeys=>{const newSelection={};newKeys.forEach(key=>{const index2=props.data.findIndex(item=>typeof props.rowKey=="string"?item[props.rowKey]===key:props.rowKey(item)===key);index2!==-1&&(newSelection[index2]=!0)}),rowSelection.value=newSelection},{immediate:!0}),__expose({scrollTo:options=>{tableContainer.value&&tableContainer.value.scrollTo(options)},clearSelection:()=>{rowSelection.value={},emit("update:selectedRowKeys",[])},toggleRowSelection:(row,selected)=>{const index2=props.data.findIndex(item=>typeof props.rowKey=="string"?item[props.rowKey]===(typeof props.rowKey=="string"?row[props.rowKey]:props.rowKey(row)):props.rowKey(item)===props.rowKey(row));if(index2!==-1){const newSelection={...rowSelection.value};selected!==void 0?newSelection[index2]=selected:newSelection[index2]=!newSelection[index2],rowSelection.value=newSelection}}}),(_ctx,_cache)=>{const _component_CyberPagination=resolveComponent("CyberPagination");return openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-table",tableClasses.value])},[createBaseVNode("div",{class:"cyber-table-wrapper",style:normalizeStyle(wrapperStyle.value)},[__props.loading?(openBlock(),createElementBlock("div",_hoisted_1$K,[createBaseVNode("div",_hoisted_2$E,[_cache[0]||(_cache[0]=createBaseVNode("div",{class:"cyber-loading-spinner"},null,-1)),createBaseVNode("p",_hoisted_3$y,toDisplayString(resolvedLoadingText.value),1)])])):createCommentVNode("",!0),createBaseVNode("div",{ref_key:"tableContainer",ref:tableContainer,class:"cyber-table-container"},[createBaseVNode("table",_hoisted_4$w,[createBaseVNode("thead",_hoisted_5$s,[createBaseVNode("tr",_hoisted_6$o,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(table).getFlatHeaders(),header=>(openBlock(),createElementBlock("th",{key:header.id,class:normalizeClass(["cyber-table-th",[{sortable:header.column.getCanSort(),sorted:header.column.getIsSorted(),"sort-asc":header.column.getIsSorted()==="asc","sort-desc":header.column.getIsSorted()==="desc"}]]),style:normalizeStyle({width:`${header.getSize()}px`,minWidth:`${header.getSize()}px`,maxWidth:`${header.getSize()}px`,textAlign:header.column.columnDef.meta?.align||"left"}),onClick:$event=>header.column.getCanSort()?header.column.getToggleSortingHandler()?.():void 0},[createBaseVNode("div",_hoisted_8$k,[createVNode(unref(FlexRender),{render:header.column.columnDef.header,props:header.getContext()},null,8,["render","props"]),header.column.getCanSort()?(openBlock(),createElementBlock("div",_hoisted_9$k,[header.column.getIsSorted()?header.column.getIsSorted()==="asc"?(openBlock(),createElementBlock("i",_hoisted_11$h)):header.column.getIsSorted()==="desc"?(openBlock(),createElementBlock("i",_hoisted_12$e)):createCommentVNode("",!0):(openBlock(),createElementBlock("i",_hoisted_10$i))])):createCommentVNode("",!0)])],14,_hoisted_7$l))),128))])]),createBaseVNode("tbody",_hoisted_13$c,[__props.loading&&__props.skeleton?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(__props.skeletonRows,rowIndex=>(openBlock(),createElementBlock("tr",{key:`skeleton-${rowIndex}`,class:"cyber-table-row"},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(table).getFlatHeaders(),header=>(openBlock(),createElementBlock("td",{key:header.id,class:"cyber-table-td",style:normalizeStyle({width:`${header.getSize()}px`,minWidth:`${header.getSize()}px`,maxWidth:`${header.getSize()}px`})},[createBaseVNode("div",_hoisted_14$a,[createBaseVNode("div",{class:"skeleton h-4 rounded",style:normalizeStyle({width:`${60+Math.random()*30}%`})},null,4)])],4))),128))]))),128)):unref(table).getRowModel().rows.length>0?(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(unref(table).getRowModel().rows,row=>(openBlock(),createElementBlock("tr",{key:row.id,class:normalizeClass(["cyber-table-row",[{selected:row.getIsSelected(),clickable:!!_ctx.$attrs.onRowClick}]]),onClick:$event=>handleRowClick(row.original,row.index)},[(openBlock(!0),createElementBlock(Fragment,null,renderList(row.getVisibleCells(),cell=>(openBlock(),createElementBlock("td",{key:cell.id,class:normalizeClass(["cyber-table-td",[cell.column.columnDef.meta?.className]]),style:normalizeStyle({width:`${cell.column.getSize()}px`,minWidth:`${cell.column.getSize()}px`,maxWidth:`${cell.column.getSize()}px`,textAlign:cell.column.columnDef.meta?.align||"left"})},[createVNode(unref(FlexRender),{render:cell.column.columnDef.cell,props:cell.getContext()},null,8,["render","props"])],6))),128))],10,_hoisted_15$9))),128)):(openBlock(),createElementBlock("tr",_hoisted_16$9,[createBaseVNode("td",{colspan:unref(table).getAllColumns().length,class:"cyber-table-empty-cell"},[createBaseVNode("div",_hoisted_18$6,[renderSlot(_ctx.$slots,"empty",{},()=>[createBaseVNode("div",_hoisted_19$5,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-inbox empty-icon"},null,-1)),createBaseVNode("p",_hoisted_20$5,toDisplayString(resolvedEmptyText.value),1)])],!0)])],8,_hoisted_17$7)]))])])],512),__props.pagination&&__props.pagination.total>0?(openBlock(),createElementBlock("div",_hoisted_21$5,[createVNode(_component_CyberPagination,{total:__props.pagination.total,size:__props.pagination.pageSize,"current-page":__props.pagination.current,"show-page-size-selector":__props.pagination.showSizeChanger,"show-quick-jumper":__props.pagination.showQuickJumper,"page-size-options":__props.pagination.pageSizeOptions,"onUpdate:currentPage":handlePageChange,"onUpdate:size":handlePageSizeChange},null,8,["total","size","current-page","show-page-size-selector","show-quick-jumper","page-size-options"])])):createCommentVNode("",!0)],4)],2)}}});const CyberTable=_export_sfc(_sfc_main$N,[["__scopeId","data-v-88ecf4e2"]]);CyberTable.install=app=>{app.component("CyberTable",CyberTable),app.component("CyberDataTable",CyberTable)};const _hoisted_1$J={class:"cyber-image-loading"},_hoisted_2$D={class:"loading-container"},_hoisted_3$x={class:"loading-spinner"},_hoisted_4$v={class:"spinner-outer"},_hoisted_5$r={class:"spinner-dots"},_hoisted_6$n={class:"progress-ring",viewBox:"0 0 120 120"},_hoisted_7$k={class:"loading-info"},_hoisted_8$j={class:"loading-text"},_hoisted_9$j={class:"loading-progress"},_hoisted_10$h={class:"progress-bar"},_hoisted_11$g={class:"progress-percentage"},_hoisted_12$d={class:"data-stream"},_sfc_main$M=defineComponent({name:"CyberFileLoading",__name:"index",props:{progress:{default:0},loadingText:{default:void 0},showDataStream:{type:Boolean,default:!0}},setup(__props){const{$t:$t2}=useTexts(),props=__props,progressOffset=computed(()=>{const circumference=2*Math.PI*54;return circumference-props.progress/100*circumference}),dataStreams=ref([["L","O","A","D","I","N","G",".",".","."],["0","1","0","1","1","0","0","1","0","1"],[">",">",">","I","M","A","G","E","<","<"],["#","#","#","D","A","T","A","#","#","#"]]),simulatedProgress=ref(0);let progressInterval=null;onMounted(()=>{props.progress===0&&(progressInterval=setInterval(()=>{simulatedProgress.value<90&&(simulatedProgress.value+=Math.random()*10)},200))}),onUnmounted(()=>{progressInterval&&clearInterval(progressInterval)});const progress=computed(()=>props.progress>0?props.progress:simulatedProgress.value),displayLoadingText=computed(()=>props.loadingText||$t2("fileLoading.loading"));return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$J,[createBaseVNode("div",_hoisted_2$D,[createBaseVNode("div",_hoisted_3$x,[createBaseVNode("div",_hoisted_4$v,[_cache[0]||(_cache[0]=createBaseVNode("div",{class:"spinner-inner"},null,-1)),createBaseVNode("div",_hoisted_5$r,[(openBlock(),createElementBlock(Fragment,null,renderList(8,(dot,index2)=>createBaseVNode("div",{key:index2,class:"dot",style:normalizeStyle({"--delay":index2*.1+"s"})},null,4)),64))])]),(openBlock(),createElementBlock("svg",_hoisted_6$n,[_cache[1]||(_cache[1]=createBaseVNode("circle",{class:"progress-ring-background",cx:"60",cy:"60",r:"54"},null,-1)),createBaseVNode("circle",{class:"progress-ring-progress",cx:"60",cy:"60",r:"54",style:normalizeStyle({strokeDashoffset:progressOffset.value})},null,4)]))]),createBaseVNode("div",_hoisted_7$k,[createBaseVNode("div",_hoisted_8$j,toDisplayString(displayLoadingText.value),1),createBaseVNode("div",_hoisted_9$j,[createBaseVNode("div",_hoisted_10$h,[createBaseVNode("div",{class:"progress-fill",style:normalizeStyle({width:progress.value+"%"})},null,4),_cache[2]||(_cache[2]=createBaseVNode("div",{class:"progress-glow"},null,-1))]),createBaseVNode("div",_hoisted_11$g,toDisplayString(Math.round(progress.value))+"%",1)]),createBaseVNode("div",_hoisted_12$d,[(openBlock(!0),createElementBlock(Fragment,null,renderList(dataStreams.value,(stream,index2)=>(openBlock(),createElementBlock("div",{key:index2,class:"stream-line",style:normalizeStyle({"--stream-delay":index2*.3+"s"})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(stream,(char,charIndex)=>(openBlock(),createElementBlock("span",{key:charIndex},toDisplayString(char),1))),128))],4))),128))])])])]))}});const CyberFileLoading=_export_sfc(_sfc_main$M,[["__scopeId","data-v-33168926"]]),_hoisted_1$I={class:"resumable-uploads"},_hoisted_2$C={key:0,class:"empty-state py-8 text-center"},_hoisted_3$w={class:"text-brand-500"},_hoisted_4$u={class:"mt-2 text-sm text-content-muted"},_hoisted_5$q={key:1,class:"space-y-3"},_hoisted_6$m=["onClick"],_hoisted_7$j={class:"flex items-center justify-between"},_hoisted_8$i={class:"flex items-center space-x-3"},_hoisted_9$i={class:"file-info"},_hoisted_10$g={class:"font-medium text-content"},_hoisted_11$f={class:"flex items-center space-x-4 text-sm text-content-muted"},_hoisted_12$c={class:"text-xs text-content-muted"},_hoisted_13$b={class:"mt-3 h-2 w-full rounded-full bg-background-500"},_hoisted_14$9={key:2,class:"mt-6 flex items-center justify-between"},_hoisted_15$8={class:"flex space-x-2"},_hoisted_16$8={class:"flex space-x-2"},_hoisted_17$6=["disabled"],_hoisted_18$5={class:"flex justify-end space-x-3"},_sfc_main$L=defineComponent({__name:"index",props:{modelValue:{type:Boolean}},emits:["update:modelValue","resume"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),dialogVisible=computed({get:()=>props.modelValue,set:value=>emit("update:modelValue",value)}),resumableSessions=ref([]),selectedSessions=ref(new Set),loadResumableSessions=()=>{resumableSessions.value=UploadStorageManager.getResumableSessions(),selectedSessions.value.clear()};watch(()=>props.modelValue,visible=>{visible&&loadResumableSessions()});const toggleSession=sessionId=>{selectedSessions.value.has(sessionId)?selectedSessions.value.delete(sessionId):selectedSessions.value.add(sessionId)},selectAll=()=>{resumableSessions.value.forEach(session=>{selectedSessions.value.add(session.id)})},clearSelection=()=>{selectedSessions.value.clear()},handleResumeSelected=()=>{const selected=resumableSessions.value.filter(session=>selectedSessions.value.has(session.id));selected.length>0&&(emit("resume",selected),dialogVisible.value=!1)},handleDeleteSelected=()=>{selectedSessions.value.forEach(sessionId=>{UploadStorageManager.removeSession(sessionId)}),loadResumableSessions()},handleClose=()=>{dialogVisible.value=!1},formatFileSize2=bytes=>{if(bytes===0)return"0 B";const k=1024,sizes=["B","KB","MB","GB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(2))} ${sizes[i]}`},formatTime=timestamp=>{const diff=Date.now()-timestamp;return diff<6e4?$t2("resumableUploads.relativeTime.justNow"):diff<36e5?$t2("resumableUploads.relativeTime.minutesAgo").replace("{count}",String(Math.floor(diff/6e4))):diff<864e5?$t2("resumableUploads.relativeTime.hoursAgo").replace("{count}",String(Math.floor(diff/36e5))):$t2("resumableUploads.relativeTime.daysAgo").replace("{count}",String(Math.floor(diff/864e5)))};return(_ctx,_cache)=>{const _component_cyberCheckbox=resolveComponent("cyberCheckbox"),_component_CyberButton=resolveComponent("CyberButton"),_component_CyberDialog=resolveComponent("CyberDialog");return openBlock(),createBlock(_component_CyberDialog,{modelValue:dialogVisible.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>dialogVisible.value=$event),title:unref($t2)("resumableUploads.title"),width:"600px",onConfirm:handleResumeSelected,onClose:handleClose},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_18$5,[createVNode(_component_CyberButton,{variant:"secondary",onClick:handleClose},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t2)("resumableUploads.footer.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",disabled:selectedSessions.value.size===0,onClick:handleResumeSelected},{default:withCtx(()=>[createTextVNode(toDisplayString(unref($t2)("resumableUploads.footer.resume"))+" ("+toDisplayString(selectedSessions.value.size)+") ",1)]),_:1},8,["disabled"])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$I,[resumableSessions.value.length===0?(openBlock(),createElementBlock("div",_hoisted_2$C,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-cloud-upload-alt mb-4 text-4xl text-brand-400 opacity-40"},null,-1)),createBaseVNode("p",_hoisted_3$w,toDisplayString(unref($t2)("resumableUploads.empty.title")),1),createBaseVNode("p",_hoisted_4$u,toDisplayString(unref($t2)("resumableUploads.empty.subtitle")),1)])):(openBlock(),createElementBlock("div",_hoisted_5$q,[(openBlock(!0),createElementBlock(Fragment,null,renderList(resumableSessions.value,session=>(openBlock(),createElementBlock("div",{key:session.id,class:normalizeClass(["upload-session rounded-lg border border-default bg-background-200 p-4 transition-all",{"border-transparent ring-2 ring-brand-300":selectedSessions.value.has(session.id)}]),onClick:$event=>toggleSession(session.id)},[createBaseVNode("div",_hoisted_7$j,[createBaseVNode("div",_hoisted_8$i,[createVNode(_component_cyberCheckbox,{"model-value":selectedSessions.value.has(session.id),"onUpdate:modelValue":$event=>toggleSession(session.id)},null,8,["model-value","onUpdate:modelValue"]),createBaseVNode("div",_hoisted_9$i,[createBaseVNode("h4",_hoisted_10$g,toDisplayString(session.fileName),1),createBaseVNode("div",_hoisted_11$f,[createBaseVNode("span",null,toDisplayString(formatFileSize2(session.fileSize)),1),createBaseVNode("span",null,toDisplayString(session.uploadedChunks.length)+"/"+toDisplayString(session.totalChunks)+" "+toDisplayString(unref($t2)("resumableUploads.labels.chunks")),1),createBaseVNode("span",null,toDisplayString(Math.round(session.uploadedChunks.length/session.totalChunks*100))+"%",1)])])]),createBaseVNode("div",_hoisted_12$c,toDisplayString(formatTime(session.lastActivity)),1)]),createBaseVNode("div",_hoisted_13$b,[createBaseVNode("div",{class:"h-2 rounded-full bg-brand-500 transition-all duration-300",style:normalizeStyle({width:Math.round(session.uploadedChunks.length/session.totalChunks*100)+"%"})},null,4)])],10,_hoisted_6$m))),128))])),resumableSessions.value.length>0?(openBlock(),createElementBlock("div",_hoisted_14$9,[createBaseVNode("div",_hoisted_15$8,[createBaseVNode("button",{class:"rounded bg-brand-100 px-3 py-1 text-sm text-brand-500 transition-colors hover:bg-brand-200",onClick:withModifiers(selectAll,["stop","prevent"])},toDisplayString(unref($t2)("resumableUploads.actions.selectAll")),1),createBaseVNode("button",{class:"rounded bg-background-400 px-3 py-1 text-sm text-content transition-colors hover:bg-background-300",onClick:withModifiers(clearSelection,["stop","prevent"])},toDisplayString(unref($t2)("resumableUploads.actions.clearSelection")),1)]),createBaseVNode("div",_hoisted_16$8,[createBaseVNode("button",{disabled:selectedSessions.value.size===0,class:"rounded bg-error-100 px-3 py-1 text-sm text-error-500 transition-colors hover:bg-error-200 disabled:opacity-50",onClick:withModifiers(handleDeleteSelected,["stop","prevent"])},toDisplayString(unref($t2)("resumableUploads.actions.deleteSelected"))+" ("+toDisplayString(selectedSessions.value.size)+") ",9,_hoisted_17$6)])])):createCommentVNode("",!0)])]),_:1},8,["modelValue","title"])}}});const CyberResumableUploads=_export_sfc(_sfc_main$L,[["__scopeId","data-v-1c7d8676"]]),_hoisted_1$H={class:"badge-text"},_sfc_main$K=defineComponent({name:"Badge",__name:"index",props:{text:{default:""},color:{default:""},icon:{default:""},position:{default:"top-right"},variant:{},inline:{type:Boolean,default:!1}},setup(__props){const props=__props,positionClass=computed(()=>{if(props.inline)return"";switch(props.position){case"top-left":return"pos-top-left";case"top-right":return"pos-top-right";case"bottom-left":return"pos-bottom-left";case"bottom-right":return"pos-bottom-right";default:return"pos-top-right"}}),badgeStyle=computed(()=>props.variant?{}:{backgroundColor:props.color});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-badge",[positionClass.value,props.variant?`variant-${props.variant}`:"variant-default",__props.inline?"inline":""]]),style:normalizeStyle(badgeStyle.value)},[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([__props.icon,"mr-1"])},null,2)):createCommentVNode("",!0),createBaseVNode("span",_hoisted_1$H,toDisplayString(__props.text),1)],6))}});const Badge=_export_sfc(_sfc_main$K,[["__scopeId","data-v-109317c9"]]),_hoisted_1$G={class:"confirm-dialog-content"},_hoisted_2$B={key:0,class:"confirm-icon"},_hoisted_3$v={class:"confirm-text"},_hoisted_4$t={class:"confirm-message"},_hoisted_5$p=["innerHTML"],_hoisted_6$l={key:1},_hoisted_7$i={key:0,class:"confirm-input-section"},_hoisted_8$h={class:"input-label"},_hoisted_9$h={key:0,class:"input-error"},_hoisted_10$f={class:"confirm-dialog-footer"},_sfc_main$J=defineComponent({name:"CyberConfirmDialog",__name:"index",props:{modelValue:{type:Boolean},title:{default:""},message:{},type:{default:"warning"},width:{default:"500px"},confirmText:{default:""},cancelText:{default:""},loading:{type:Boolean,default:!1},closable:{type:Boolean,default:!0},requireInput:{type:Boolean,default:!1},inputLabel:{default:""},inputPlaceholder:{default:""},expectedInput:{default:void 0}},emits:["update:modelValue","confirm","cancel"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,inputValue=ref(""),isVisible=computed({get:()=>props.modelValue,set:value=>emit("update:modelValue",value)}),confirmButtonType=computed(()=>{switch(props.type){case"danger":return"danger";case"warning":return"warning";case"success":return"success";default:return"primary"}}),dialogTitle=computed(()=>props.title||$t2("confirmDialog.title")),dialogConfirmText=computed(()=>props.confirmText||$t2("actions.confirm")),dialogCancelText=computed(()=>props.cancelText||$t2("actions.cancel")),dialogInputLabel=computed(()=>props.inputLabel||$t2("confirmDialog.inputLabel")),dialogInputPlaceholder=computed(()=>props.inputPlaceholder||$t2("confirmDialog.inputPlaceholder")),getIconClass=type=>{const iconMap={warning:"fas fa-exclamation-triangle",danger:"fas fa-exclamation-circle",info:"fas fa-info-circle",success:"fas fa-check-circle"};return iconMap[type]||iconMap.warning},getIconColor=type=>{const colorMap={warning:"var(--color-warning-500)",danger:"var(--color-error-500)",info:"var(--color-brand-500)",success:"var(--color-success-500)"};return colorMap[type]||colorMap.warning},formatMessage2=msg=>msg.replace(/\n/g,"<br>"),handleConfirm2=()=>{props.requireInput?emit("confirm",inputValue.value):emit("confirm")},handleCancel2=()=>{inputValue.value="",emit("cancel")};return watch(()=>props.modelValue,newVal=>{newVal&&(inputValue.value="")}),(_ctx,_cache)=>{const _component_CyberInput=resolveComponent("CyberInput"),_component_CyberButton=resolveComponent("CyberButton"),_component_CyberDialog=resolveComponent("CyberDialog");return openBlock(),createBlock(_component_CyberDialog,{modelValue:isVisible.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>isVisible.value=$event),title:dialogTitle.value,width:__props.width,closable:__props.closable,onClose:handleCancel2},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_10$f,[createVNode(_component_CyberButton,{type:"secondary",disabled:__props.loading,onClick:handleCancel2},{default:withCtx(()=>[createTextVNode(toDisplayString(dialogCancelText.value),1)]),_:1},8,["disabled"]),createVNode(_component_CyberButton,{type:confirmButtonType.value,loading:__props.loading,disabled:__props.requireInput&&(!inputValue.value||__props.expectedInput&&inputValue.value!==__props.expectedInput),onClick:handleConfirm2},{default:withCtx(()=>[createTextVNode(toDisplayString(dialogConfirmText.value),1)]),_:1},8,["type","loading","disabled"])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$G,[__props.type?(openBlock(),createElementBlock("div",_hoisted_2$B,[createBaseVNode("i",{class:normalizeClass(getIconClass(__props.type)),style:normalizeStyle({color:getIconColor(__props.type)})},null,6)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_3$v,[createBaseVNode("div",_hoisted_4$t,[typeof __props.message=="string"?(openBlock(),createElementBlock("div",{key:0,innerHTML:formatMessage2(__props.message)},null,8,_hoisted_5$p)):(openBlock(),createElementBlock("div",_hoisted_6$l,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.message,(line,index2)=>(openBlock(),createElementBlock("div",{key:index2,class:"message-line"},toDisplayString(line),1))),128))]))]),__props.requireInput?(openBlock(),createElementBlock("div",_hoisted_7$i,[createBaseVNode("div",_hoisted_8$h,toDisplayString(dialogInputLabel.value),1),createVNode(_component_CyberInput,{modelValue:inputValue.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>inputValue.value=$event),placeholder:dialogInputPlaceholder.value,class:"confirm-input"},null,8,["modelValue","placeholder"]),inputValue.value&&inputValue.value!==__props.expectedInput&&__props.expectedInput?(openBlock(),createElementBlock("div",_hoisted_9$h,toDisplayString(unref($t2)("confirmDialog.inputError")),1)):createCommentVNode("",!0)])):createCommentVNode("",!0)])])]),_:1},8,["modelValue","title","width","closable"])}}});const CyberConfirmDialog=_export_sfc(_sfc_main$J,[["__scopeId","data-v-f3ff66ae"]]),_hoisted_1$F=["disabled"],_hoisted_2$A={key:0,class:"fas fa-spinner fa-spin"},_hoisted_3$u=["disabled"],_hoisted_4$s={key:0,class:"fas fa-spinner fa-spin"},_sfc_main$I=defineComponent({name:"CyberIconButton",__name:"index",props:{type:{default:"default"},size:{default:"medium"},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},tooltip:{},tooltipPlacement:{default:"top"}},emits:["click"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,emit=__emit,buttonRef=ref(),handleClick=event=>{props.disabled||props.loading||emit("click",event)};return __expose({$el:buttonRef}),(_ctx,_cache)=>{const _component_CyberTooltip=resolveComponent("CyberTooltip");return __props.tooltip?(openBlock(),createBlock(_component_CyberTooltip,{key:0,content:__props.tooltip,placement:__props.tooltipPlacement},{default:withCtx(()=>[createBaseVNode("button",{ref_key:"buttonRef",ref:buttonRef,class:normalizeClass(["icon-button",[`icon-button--${__props.type}`,`icon-button--${__props.size}`,{"icon-button--loading":__props.loading,"icon-button--disabled":__props.disabled}]]),disabled:__props.disabled||__props.loading,onClick:handleClick},[__props.loading?(openBlock(),createElementBlock("i",_hoisted_2$A)):renderSlot(_ctx.$slots,"default",{key:1},void 0,!0)],10,_hoisted_1$F)]),_:3},8,["content","placement"])):(openBlock(),createElementBlock("button",{key:1,ref_key:"buttonRef",ref:buttonRef,class:normalizeClass(["icon-button",[`icon-button--${__props.type}`,`icon-button--${__props.size}`,{"icon-button--loading":__props.loading,"icon-button--disabled":__props.disabled}]]),disabled:__props.disabled||__props.loading,onClick:handleClick},[__props.loading?(openBlock(),createElementBlock("i",_hoisted_4$s)):renderSlot(_ctx.$slots,"default",{key:1},void 0,!0)],10,_hoisted_3$u))}}});const CyberIconButton=_export_sfc(_sfc_main$I,[["__scopeId","data-v-6f7e5968"]]),_hoisted_1$E={class:"cyber-icon-picker"},_hoisted_2$z={key:0,class:"icon-panel"},_hoisted_3$t={class:"icon-grid"},_hoisted_4$r=["title","onClick"],_hoisted_5$o={class:"option-text"},_sfc_main$H=defineComponent({name:"CyberIconPicker",__name:"index",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1},options:{default:void 0}},emits:["update:modelValue"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),showPicker=ref(!1),tIcon=key=>$t2(`components.iconPicker.${key}`),iconOptions=computed(()=>[{value:"fas fa-star",label:tIcon("star")},{value:"fas fa-bell",label:tIcon("bell")},{value:"fas fa-bullhorn",label:tIcon("bullhorn")},{value:"fas fa-info-circle",label:tIcon("infoCircle")},{value:"fas fa-exclamation-circle",label:tIcon("exclamationCircle")},{value:"fas fa-question-circle",label:tIcon("questionCircle")},{value:"fas fa-check-circle",label:tIcon("checkCircle")},{value:"fas fa-times-circle",label:tIcon("timesCircle")},{value:"fas fa-fire",label:tIcon("fire")},{value:"fas fa-bolt",label:tIcon("bolt")},{value:"fas fa-gem",label:tIcon("gem")},{value:"fas fa-crown",label:tIcon("crown")},{value:"fas fa-heart",label:tIcon("heart")},{value:"fas fa-diamond",label:tIcon("diamond")},{value:"fas fa-snowflake",label:tIcon("snowflake")},{value:"fas fa-sun",label:tIcon("sun")},{value:"fas fa-moon",label:tIcon("moon")},{value:"fas fa-cloud",label:tIcon("cloud")},{value:"fas fa-gift",label:tIcon("gift")},{value:"fas fa-trophy",label:tIcon("trophy")},{value:"fas fa-medal",label:tIcon("medal")},{value:"fas fa-flag",label:tIcon("flag")},{value:"fas fa-key",label:tIcon("key")},{value:"fas fa-lock",label:tIcon("lock")},{value:"fas fa-shield-alt",label:tIcon("shieldAlt")},{value:"fas fa-bookmark",label:tIcon("bookmark")},{value:"fas fa-rocket",label:tIcon("rocket")},{value:"fas fa-magic",label:tIcon("magic")},{value:"fas fa-atom",label:tIcon("atom")},{value:"fas fa-cpu",label:tIcon("cpu")},{value:"fas fa-robot",label:tIcon("robot")},{value:"fas fa-satellite",label:tIcon("satellite")},{value:"fas fa-microchip",label:tIcon("microchip")},{value:"fas fa-wifi",label:tIcon("wifi")},{value:"fas fa-play",label:tIcon("play")},{value:"fas fa-pause",label:tIcon("pause")},{value:"fas fa-stop",label:tIcon("stop")},{value:"fas fa-upload",label:tIcon("upload")},{value:"fas fa-download",label:tIcon("download")},{value:"fas fa-share",label:tIcon("share")},{value:"fas fa-sync",label:tIcon("sync")},{value:"fas fa-power-off",label:tIcon("powerOff")},{value:"fas fa-smile",label:tIcon("smile")},{value:"fas fa-laugh",label:tIcon("laugh")},{value:"fas fa-angry",label:tIcon("angry")},{value:"fas fa-surprise",label:tIcon("surprise")},{value:"fas fa-thumbs-up",label:tIcon("thumbsUp")},{value:"fas fa-thumbs-down",label:tIcon("thumbsDown")}]),currentIconOptions=computed(()=>props.options||iconOptions.value),togglePicker=()=>{props.disabled||(showPicker.value=!showPicker.value)},selectIcon=iconValue=>{emit("update:modelValue",iconValue),showPicker.value=!1},hasSelectedIcon=computed(()=>!!props.modelValue),getIconName=iconValue=>iconValue?currentIconOptions.value.find(opt=>opt.value===iconValue)?.label||tIcon("custom"):tIcon("selectPlaceholder"),handleClickOutside=event=>{event.target.closest(".cyber-icon-picker")||(showPicker.value=!1)};return onMounted(()=>{document.addEventListener("click",handleClickOutside)}),onUnmounted(()=>{document.removeEventListener("click",handleClickOutside)}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$E,[createBaseVNode("div",{class:normalizeClass(["selected-icon",{focused:showPicker.value}]),onClick:togglePicker},[hasSelectedIcon.value?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([__props.modelValue,"icon-preview"])},null,2)):createCommentVNode("",!0),createBaseVNode("span",{class:normalizeClass(["icon-text",{"placeholder-text":!hasSelectedIcon.value}])},toDisplayString(getIconName(__props.modelValue)),3),createBaseVNode("i",{class:normalizeClass(["fas fa-chevron-down dropdown-arrow",{open:showPicker.value}])},null,2)],2),showPicker.value?(openBlock(),createElementBlock("div",_hoisted_2$z,[createBaseVNode("div",_hoisted_3$t,[(openBlock(!0),createElementBlock(Fragment,null,renderList(currentIconOptions.value,icon=>(openBlock(),createElementBlock("div",{key:icon.value,class:normalizeClass(["icon-option",{active:__props.modelValue===icon.value}]),title:icon.label,onClick:$event=>selectIcon(icon.value)},[createBaseVNode("i",{class:normalizeClass([icon.value,"option-icon"])},null,2),createBaseVNode("span",_hoisted_5$o,toDisplayString(icon.label),1)],10,_hoisted_4$r))),128))])])):createCommentVNode("",!0)]))}});const IconPicker=_export_sfc(_sfc_main$H,[["__scopeId","data-v-88a30fc6"]]),_hoisted_1$D={class:"copyright-container"},_hoisted_2$y={class:"copyright-content"},_hoisted_3$s={class:"desktop-layout"},_hoisted_4$q={class:"copyright-info"},_hoisted_5$n={class:"copyright-text"},_hoisted_6$k={class:"copyright-basic"},_hoisted_7$h={class:"icp-info"},_hoisted_8$g={href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener",class:"icp-link"},_hoisted_9$g={class:"custom-text"},_hoisted_10$e={class:"contact-info"},_hoisted_11$e=["href"],_hoisted_12$b={class:"status-indicators"},_hoisted_13$a={class:"status-item online"},_hoisted_14$8={class:"status-item secure"},_hoisted_15$7={class:"mobile-layout"},_hoisted_16$7={class:"mobile-content"},_hoisted_17$5={class:"copyright-text-mobile"},_hoisted_18$4={key:0,class:"info-divider-mobile"},_hoisted_19$4={key:1,class:"icp-info-mobile"},_hoisted_20$4={href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener",class:"icp-link-mobile"},_hoisted_21$4={key:2,class:"info-divider-mobile"},_hoisted_22$4={key:3,class:"custom-text-mobile"},_hoisted_23$3={key:4,class:"info-divider-mobile"},_hoisted_24$3={key:5,class:"contact-info-mobile"},_hoisted_25$3=["href"],_hoisted_26$3={class:"status-indicators-mobile"},_hoisted_27$3={class:"status-item online"},_hoisted_28$3={class:"status-item secure"},_sfc_main$G=defineComponent({name:"Copyright",__name:"index",props:{theme:{default:"dark"}},setup(__props){const{$t:$t2}=useTexts(),settingsStore=useSettingsStore(),props=__props,currentYear=computed(()=>new Date().getFullYear()),handleEmailClick=event=>{const target=event.target,email=settingsStore.contactEmail;if(!email){event.preventDefault();return}try{(!target.href||target.href==="")&&(event.preventDefault(),window.location.href=`mailto:${email}`)}catch{}};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["copyright-section",{dark:props.theme==="dark",transparent:props.theme==="transparent"}])},[createBaseVNode("div",_hoisted_1$D,[createBaseVNode("div",_hoisted_2$y,[createBaseVNode("div",_hoisted_3$s,[createBaseVNode("div",_hoisted_4$q,[createBaseVNode("div",_hoisted_5$n,[createBaseVNode("span",_hoisted_6$k,toDisplayString(unref(settingsStore).copyrightText||`¬© ${currentYear.value} ${unref(settingsStore).siteName||"PixelPunk"}. ${unref($t2)("components.copyright.allRightsReserved")}`),1),unref(settingsStore).icpNumber?(openBlock(),createElementBlock(Fragment,{key:0},[_cache[1]||(_cache[1]=createBaseVNode("span",{class:"info-divider"},"|",-1)),createBaseVNode("span",_hoisted_7$h,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-shield-alt"},null,-1)),createBaseVNode("a",_hoisted_8$g,toDisplayString(unref(settingsStore).icpNumber),1)])],64)):createCommentVNode("",!0),unref(settingsStore).footerCustomText?(openBlock(),createElementBlock(Fragment,{key:1},[_cache[2]||(_cache[2]=createBaseVNode("span",{class:"info-divider"},"|",-1)),createBaseVNode("span",_hoisted_9$g,toDisplayString(unref(settingsStore).footerCustomText),1)],64)):createCommentVNode("",!0),unref(settingsStore).contactEmail?(openBlock(),createElementBlock(Fragment,{key:2},[_cache[4]||(_cache[4]=createBaseVNode("span",{class:"info-divider"},"|",-1)),createBaseVNode("span",_hoisted_10$e,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-envelope"},null,-1)),createBaseVNode("a",{href:`mailto:${unref(settingsStore).contactEmail}`,class:"contact-link",onClick:handleEmailClick,rel:"noopener noreferrer"},toDisplayString(unref(settingsStore).contactEmail),9,_hoisted_11$e)])],64)):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_12$b,[createBaseVNode("div",_hoisted_13$a,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"status-dot"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.copyright.systemOnline")),1)]),createBaseVNode("div",_hoisted_14$8,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-shield-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.copyright.secureRunning")),1)])])]),createBaseVNode("div",_hoisted_15$7,[createBaseVNode("div",_hoisted_16$7,[createBaseVNode("div",_hoisted_17$5,[createBaseVNode("p",null,[createTextVNode(toDisplayString(unref(settingsStore).copyrightText||`¬© ${currentYear.value} ${unref(settingsStore).siteName||"PixelPunk"}. ${unref($t2)("components.copyright.allRightsReserved")}`)+" ",1),unref(settingsStore).icpNumber?(openBlock(),createElementBlock("span",_hoisted_18$4,"|")):createCommentVNode("",!0),unref(settingsStore).icpNumber?(openBlock(),createElementBlock("span",_hoisted_19$4,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-shield-alt"},null,-1)),createBaseVNode("a",_hoisted_20$4,toDisplayString(unref(settingsStore).icpNumber),1)])):createCommentVNode("",!0),unref(settingsStore).footerCustomText?(openBlock(),createElementBlock("span",_hoisted_21$4,"|")):createCommentVNode("",!0),unref(settingsStore).footerCustomText?(openBlock(),createElementBlock("span",_hoisted_22$4,toDisplayString(unref(settingsStore).footerCustomText),1)):createCommentVNode("",!0),unref(settingsStore).contactEmail?(openBlock(),createElementBlock("span",_hoisted_23$3,"|")):createCommentVNode("",!0),unref(settingsStore).contactEmail?(openBlock(),createElementBlock("span",_hoisted_24$3,[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-envelope"},null,-1)),createBaseVNode("a",{href:`mailto:${unref(settingsStore).contactEmail}`,class:"contact-link-mobile",onClick:handleEmailClick,rel:"noopener noreferrer"},toDisplayString(unref(settingsStore).contactEmail),9,_hoisted_25$3)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_26$3,[createBaseVNode("div",_hoisted_27$3,[_cache[9]||(_cache[9]=createBaseVNode("div",{class:"status-dot"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.copyright.online")),1)]),createBaseVNode("div",_hoisted_28$3,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-shield-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.copyright.secure")),1)])])])])])]),_cache[11]||(_cache[11]=createBaseVNode("div",{class:"copyright-decoration"},null,-1))],2))}});const Copyright=_export_sfc(_sfc_main$G,[["__scopeId","data-v-21047b7c"]]),_hoisted_1$C={class:"community-content"},_hoisted_2$x={key:0,class:"qr-code-container"},_hoisted_3$r=["src","alt"],_hoisted_4$p={key:1,class:"group-number-only"},_hoisted_5$m={class:"group-info"},_hoisted_6$j={class:"group-label"},_hoisted_7$g={class:"large-group-number"},_hoisted_8$f={class:"join-hint"},_hoisted_9$f={key:2,class:"description"},_hoisted_10$d={key:0,class:"main-title"},_hoisted_11$d={key:1,class:"subtitle"},_sfc_main$F=defineComponent({name:"CommunityDialog",__name:"index",props:{type:{default:"wechat"},qrImage:{default:""},contactInfo:{default:""}},setup(__props,{expose:__expose}){const{$t:$t2}=useTexts(),props=__props,notificationDialogRef=ref(),dialogConfig=computed(()=>{if(props.type==="qq"){const hasQrImage=!!props.qrImage,hasGroupNumber=!!props.contactInfo;return{title:$t2("components.communityDialog.qq.title"),imageUrl:props.qrImage,imageAlt:$t2("components.communityDialog.qq.qrCodeAlt"),mainTitle:hasQrImage?$t2("components.communityDialog.qq.scanToJoin"):"",subtitle:hasQrImage&&props.contactInfo?$t2("components.communityDialog.qq.groupNumber",{number:props.contactInfo}):"",groupNumber:hasGroupNumber&&!hasQrImage?props.contactInfo:"",showImage:hasQrImage,showGroupNumberOnly:hasGroupNumber&&!hasQrImage}}else{const hasQrImage=!!props.qrImage;return{title:$t2("components.communityDialog.wechat.title"),imageUrl:props.qrImage,imageAlt:$t2("components.communityDialog.wechat.qrCodeAlt"),mainTitle:$t2(hasQrImage?"components.communityDialog.wechat.scanToJoin":"components.communityDialog.wechat.groupInfo"),subtitle:props.contactInfo?$t2("components.communityDialog.wechat.addContact",{contact:props.contactInfo}):"",showImage:hasQrImage}}});return __expose({show:()=>{notificationDialogRef.value?.show()},hide:()=>{notificationDialogRef.value?.hide()}}),(_ctx,_cache)=>{const _component_CyberNotificationDialog=resolveComponent("CyberNotificationDialog");return openBlock(),createBlock(_component_CyberNotificationDialog,{ref_key:"notificationDialogRef",ref:notificationDialogRef,title:dialogConfig.value.title,width:320},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$C,[dialogConfig.value.showImage?(openBlock(),createElementBlock("div",_hoisted_2$x,[createBaseVNode("img",{src:dialogConfig.value.imageUrl,alt:dialogConfig.value.imageAlt,class:"qr-code",onError:_cache[0]||(_cache[0]=$event=>$event.target.style.display="none")},null,40,_hoisted_3$r)])):createCommentVNode("",!0),dialogConfig.value.showGroupNumberOnly?(openBlock(),createElementBlock("div",_hoisted_4$p,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"qq-icon"},[createBaseVNode("i",{class:"fab fa-qq"})],-1)),createBaseVNode("div",_hoisted_5$m,[createBaseVNode("div",_hoisted_6$j,toDisplayString(unref($t2)("components.communityDialog.qq.groupNumberLabel")),1),createBaseVNode("div",_hoisted_7$g,toDisplayString(dialogConfig.value.groupNumber),1),createBaseVNode("div",_hoisted_8$f,toDisplayString(unref($t2)("components.communityDialog.qq.joinHint")),1)])])):(openBlock(),createElementBlock("div",_hoisted_9$f,[dialogConfig.value.mainTitle?(openBlock(),createElementBlock("h4",_hoisted_10$d,toDisplayString(dialogConfig.value.mainTitle),1)):createCommentVNode("",!0),dialogConfig.value.subtitle?(openBlock(),createElementBlock("p",_hoisted_11$d,toDisplayString(dialogConfig.value.subtitle),1)):createCommentVNode("",!0)]))])]),_:1},8,["title"])}}});const CommunityDialog=_export_sfc(_sfc_main$F,[["__scopeId","data-v-3db53f26"]]),_hoisted_1$B={class:"notification-dialog-header"},_hoisted_2$w={class:"notification-dialog-title"},_hoisted_3$q={class:"notification-dialog-content"},_sfc_main$E=defineComponent({name:"CyberNotificationDialog",__name:"index",props:{title:{},width:{default:360},showCloseButton:{type:Boolean,default:!0}},setup(__props,{expose:__expose}){const visible=ref(!1),show=()=>{visible.value=!0},hide=()=>{visible.value=!1},handleClose=()=>{hide()};return __expose({show,hide}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:"notification-dialog-overlay",onClick:handleClose},[createVNode(Transition,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95 translate-y-4","enter-to-class":"opacity-100 scale-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 scale-100 translate-y-0","leave-to-class":"opacity-0 scale-95 translate-y-4"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:"notification-dialog",style:normalizeStyle({width:typeof __props.width=="number"?`${__props.width}px`:__props.width}),onClick:_cache[0]||(_cache[0]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_1$B,[createBaseVNode("h3",_hoisted_2$w,toDisplayString(__props.title),1),__props.showCloseButton?(openBlock(),createElementBlock("button",{key:0,class:"notification-dialog-close",onClick:handleClose},[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_3$q,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])],4)):createCommentVNode("",!0)]),_:3})])):createCommentVNode("",!0)]),_:3})]))}});const NotificationDialog=_export_sfc(_sfc_main$E,[["__scopeId","data-v-2b161d2d"]]),_hoisted_1$A={class:"badge-text"},_sfc_main$D=defineComponent({name:"DuplicateBadge",__name:"index",props:{text:{default:""},color:{default:""},icon:{default:"fas fa-clone"},position:{default:"top-left"}},setup(__props){const{$t:$t2}=useTexts(),props=__props,displayText=computed(()=>props.text||$t2("duplicateBadge.duplicate")),positionClass=computed(()=>{switch(props.position){case"top-left":return"pos-top-left";case"top-right":return"pos-top-right";case"bottom-left":return"pos-bottom-left";case"bottom-right":return"pos-bottom-right";default:return"pos-top-left"}}),badgeStyle=computed(()=>({backgroundColor:props.color||"rgba(var(--color-brand-500-rgb), 0.9)"}));return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["duplicate-badge",positionClass.value]),style:normalizeStyle(badgeStyle.value)},[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([__props.icon,"mr-1"])},null,2)):createCommentVNode("",!0),createBaseVNode("span",_hoisted_1$A,toDisplayString(displayText.value),1)],6))}});const __unplugin_components_0$3=_export_sfc(_sfc_main$D,[["__scopeId","data-v-69e4a7a0"]]);function useDrag(initialPosition,onPositionChange){const isDragging=ref(!1),hasDragged=ref(!1),position=ref(initialPosition||{x:window.innerWidth-100,y:window.innerHeight-100}),dragOffset=ref({x:0,y:0}),floatStyle=computed(()=>({left:`${position.value.x}px`,top:`${position.value.y}px`,cursor:isDragging.value?"grabbing":"grab"})),savePosition=()=>{StorageUtil.set("upload-float-position",position.value),onPositionChange?.()},loadPosition=()=>{const saved=StorageUtil.get("upload-float-position"),elementSize=80,margin=20;if(saved){const windowWidth=window.innerWidth,windowHeight=window.innerHeight,maxX=windowWidth-elementSize-margin,maxY=windowHeight-elementSize-margin;let{x,y}=saved;(x<margin||x>maxX||y<margin||y>maxY)&&(x=maxX,y=maxY),position.value={x:Math.max(margin,Math.min(x,maxX)),y:Math.max(margin,Math.min(y,maxY))}}else{const maxX=window.innerWidth-elementSize-margin,maxY=window.innerHeight-elementSize-margin;position.value={x:maxX,y:maxY}}savePosition()},handleMouseDown=e=>{isDragging.value=!0,hasDragged.value=!1,dragOffset.value={x:e.clientX-position.value.x,y:e.clientY-position.value.y},document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),e.preventDefault()},handleMouseMove=e=>{if(!isDragging.value)return;hasDragged.value=!0;const newX=e.clientX-dragOffset.value.x,newY=e.clientY-dragOffset.value.y,maxX=window.innerWidth-80,maxY=window.innerHeight-80;position.value={x:Math.max(0,Math.min(newX,maxX)),y:Math.max(0,Math.min(newY,maxY))},savePosition()},handleMouseUp=e=>(isDragging.value=!1,document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),e.preventDefault(),!hasDragged.value),handleResize=()=>{const maxX=window.innerWidth-80-20,maxY=window.innerHeight-80-20;let needsUpdate=!1;position.value.x<20?(position.value.x=20,needsUpdate=!0):position.value.x>maxX&&(position.value.x=maxX,needsUpdate=!0),position.value.y<20?(position.value.y=20,needsUpdate=!0):position.value.y>maxY&&(position.value.y=maxY,needsUpdate=!0),needsUpdate&&savePosition()};return onMounted(()=>{loadPosition(),window.addEventListener("resize",handleResize),setTimeout(()=>{handleResize()},100)}),onUnmounted(()=>{window.removeEventListener("resize",handleResize),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}),{isDragging,hasDragged,position,floatStyle,handleMouseDown,handleMouseUp,loadPosition,savePosition}}const _hoisted_1$z={class:"progress-ring-wrapper"},_hoisted_2$v={viewBox:"0 0 86 86",class:"progress-svg"},_sfc_main$C=defineComponent({name:"ProgressRing",__name:"ProgressRing",props:{progress:{default:0},active:{type:Boolean,default:!1}},setup(__props){const props=__props,progressStyle=computed(()=>{const circumference=2*Math.PI*36,offset=circumference-props.progress/100*circumference;return{strokeDasharray:`${circumference}`,strokeDashoffset:`${offset}`,transition:"stroke-dashoffset 0.3s ease"}});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$z,[(openBlock(),createElementBlock("svg",_hoisted_2$v,[_cache[0]||(_cache[0]=createBaseVNode("circle",{cx:"43",cy:"43",r:"36",stroke:"rgba(100, 116, 139, 0.4)","stroke-width":"3",fill:"none",class:"ring-bg"},null,-1)),createBaseVNode("circle",{cx:"43",cy:"43",r:"36",stroke:"url(#uploadGradient)","stroke-width":"3",fill:"none","stroke-linecap":"round",class:"ring-progress",style:normalizeStyle(progressStyle.value)},null,4),_cache[1]||(_cache[1]=createStaticVNode('<defs data-v-2e13fd3e><linearGradient id="uploadGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-2e13fd3e><stop offset="0%" style="stop-color:var(--color-brand-400);stop-opacity:1;" data-v-2e13fd3e></stop><stop offset="50%" style="stop-color:var(--color-brand-500);stop-opacity:1;" data-v-2e13fd3e></stop><stop offset="100%" style="stop-color:var(--color-brand-600);stop-opacity:1;" data-v-2e13fd3e></stop></linearGradient><filter id="glow" data-v-2e13fd3e><feGaussianBlur stdDeviation="2.5" result="coloredBlur" data-v-2e13fd3e></feGaussianBlur><feMerge data-v-2e13fd3e><feMergeNode in="coloredBlur" data-v-2e13fd3e></feMergeNode><feMergeNode in="SourceGraphic" data-v-2e13fd3e></feMergeNode></feMerge></filter></defs>',1))])),createBaseVNode("div",{class:normalizeClass(["pulse-ring",{active:__props.active}])},null,2)]))}});const ProgressRing=_export_sfc(_sfc_main$C,[["__scopeId","data-v-2e13fd3e"]]),_hoisted_1$y={class:"ring-center"},_hoisted_2$u={key:0,class:"center-content"},_hoisted_3$p={class:"percent-line"},_hoisted_4$o={class:"percent-display"},_hoisted_5$l={key:0,class:"queue-display"},_hoisted_6$i={key:1,class:"center-content success"},_hoisted_7$f={key:0,class:"queue-display"},_hoisted_8$e={key:2,class:"center-content error"},_hoisted_9$e={key:0,class:"queue-display"},_hoisted_10$c={key:3,class:"center-content paused"},_hoisted_11$c={key:0,class:"queue-display"},_hoisted_12$a={key:4,class:"center-content preparing"},_hoisted_13$9={key:0,class:"queue-display"},_sfc_main$B=defineComponent({name:"CenterContent",__name:"CenterContent",props:{status:{},progress:{},queueSize:{}},setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$y,[__props.status==="uploading"?(openBlock(),createElementBlock("div",_hoisted_2$u,[createBaseVNode("div",_hoisted_3$p,[createBaseVNode("span",_hoisted_4$o,toDisplayString(Math.round(__props.progress)),1),_cache[0]||(_cache[0]=createBaseVNode("span",{class:"percent-symbol"},"%",-1))]),__props.queueSize>0?(openBlock(),createElementBlock("div",_hoisted_5$l,toDisplayString(__props.queueSize),1)):createCommentVNode("",!0)])):__props.status==="success"?(openBlock(),createElementBlock("div",_hoisted_6$i,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"status-icon"},"‚úì",-1)),__props.queueSize>0?(openBlock(),createElementBlock("div",_hoisted_7$f,toDisplayString(__props.queueSize),1)):createCommentVNode("",!0)])):__props.status==="error"?(openBlock(),createElementBlock("div",_hoisted_8$e,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"status-icon"},"‚úó",-1)),__props.queueSize>0?(openBlock(),createElementBlock("div",_hoisted_9$e,toDisplayString(__props.queueSize),1)):createCommentVNode("",!0)])):__props.status==="paused"?(openBlock(),createElementBlock("div",_hoisted_10$c,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"status-icon"},"‚ùö‚ùö",-1)),__props.queueSize>0?(openBlock(),createElementBlock("div",_hoisted_11$c,toDisplayString(__props.queueSize),1)):createCommentVNode("",!0)])):(openBlock(),createElementBlock("div",_hoisted_12$a,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"loading-dots"},[createBaseVNode("span"),createBaseVNode("span"),createBaseVNode("span")],-1)),__props.queueSize>0?(openBlock(),createElementBlock("div",_hoisted_13$9,toDisplayString(__props.queueSize),1)):createCommentVNode("",!0)]))]))}});const CenterContent=_export_sfc(_sfc_main$B,[["__scopeId","data-v-70907606"]]),_hoisted_1$x={key:0,class:"file-tooltip"},_hoisted_2$t={class:"tooltip-content"},_hoisted_3$o={class:"file-name"},_hoisted_4$n={class:"file-stats"},_hoisted_5$k={class:"stat-item"},_hoisted_6$h={class:"stat-item"},_hoisted_7$e={class:"stat-item"},_sfc_main$A=defineComponent({name:"FileTooltip",__name:"FileTooltip",props:{fileName:{},statistics:{},visible:{type:Boolean}},setup(__props){return(_ctx,_cache)=>__props.visible&&__props.fileName?(openBlock(),createElementBlock("div",_hoisted_1$x,[createBaseVNode("div",_hoisted_2$t,[createBaseVNode("div",_hoisted_3$o,toDisplayString(__props.fileName),1),createBaseVNode("div",_hoisted_4$n,[createBaseVNode("span",_hoisted_5$k,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-cloud-upload-alt"},null,-1)),createTextVNode(" "+toDisplayString(__props.statistics.uploading),1)]),createBaseVNode("span",_hoisted_6$h,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createTextVNode(" "+toDisplayString(__props.statistics.pending),1)]),createBaseVNode("span",_hoisted_7$e,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-check"},null,-1)),createTextVNode(" "+toDisplayString(__props.statistics.completed),1)])])])])):createCommentVNode("",!0)}});const FileTooltip=_export_sfc(_sfc_main$A,[["__scopeId","data-v-9e527e82"]]),_hoisted_1$w={class:"cyber-ring-outer"},_hoisted_2$s={class:"cyber-ring-main"},_sfc_main$z=defineComponent({name:"GlobalUploadFloat",__name:"index",props:{initialPosition:{},hideOnRoutes:{default:()=>["/upload","/dashboard"]},draggable:{type:Boolean,default:!0},showFileInfo:{type:Boolean,default:!0}},emits:["open-drawer"],setup(__props,{expose:__expose,emit:__emit}){const props=__props,emit=__emit,uploadStore=useUploadStore(),route=useRoute(),{statistics:statistics2,globalProgress:globalProgress2,allUploads:allUploads2}=storeToRefs(uploadStore),isHidden=ref(!1),showFileInfo=ref(!1),{floatStyle,handleMouseDown,handleMouseUp}=useDrag(props.initialPosition),visible=computed(()=>{const hasUnfinishedTasks=statistics2.value.pending>0||statistics2.value.uploading>0||statistics2.value.failed>0,shouldHideOnCurrentRoute=props.hideOnRoutes?.some(hiddenRoute=>route.path.startsWith(hiddenRoute));return hasUnfinishedTasks&&!isHidden.value&&!shouldHideOnCurrentRoute}),status=computed(()=>statistics2.value.failed>0&&statistics2.value.uploading===0?"error":statistics2.value.uploading>0?"uploading":statistics2.value.completed===statistics2.value.total&&statistics2.value.total>0?"success":(statistics2.value.pending>0,"preparing")),queueSize=computed(()=>statistics2.value.pending+statistics2.value.uploading+statistics2.value.failed),currentFileName=computed(()=>{const uploadingFiles=allUploads2.value.filter(f=>f.status==="uploading");if(uploadingFiles.length>0)return uploadingFiles[0].file.name;const preparingFiles=allUploads2.value.filter(f=>f.status==="preparing");return preparingFiles.length>0?preparingFiles[0].file.name:null}),handleMouseDownWrapper=e=>{handleMouseDown(e)},handleMouseUpWrapper=e=>{handleMouseUp(e)&&emit("open-drawer")},handleMouseEnter=()=>{showFileInfo.value=!0},handleMouseLeave=()=>{showFileInfo.value=!1};return __expose({hide:()=>{isHidden.value=!0},show:()=>{isHidden.value=!1}}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"cyber-float"},{default:withCtx(()=>[visible.value?(openBlock(),createElementBlock("div",{key:0,class:"cyber-uploader-float",style:normalizeStyle(unref(floatStyle)),onMousedown:handleMouseDownWrapper,onMouseup:handleMouseUpWrapper,onMouseenter:handleMouseEnter,onMouseleave:handleMouseLeave},[createBaseVNode("div",_hoisted_1$w,[createBaseVNode("div",_hoisted_2$s,[createVNode(ProgressRing,{progress:unref(globalProgress2),active:status.value==="uploading"},null,8,["progress","active"]),createVNode(CenterContent,{status:status.value,progress:unref(globalProgress2),"queue-size":queueSize.value},null,8,["status","progress","queue-size"])])]),createVNode(FileTooltip,{"file-name":currentFileName.value,statistics:unref(statistics2),visible:showFileInfo.value},null,8,["file-name","statistics","visible"])],36)):createCommentVNode("",!0)]),_:1})]))}});const GlobalUploadFloat=_export_sfc(_sfc_main$z,[["__scopeId","data-v-3c8aebb3"]]),_hoisted_1$v={class:"upload-drawer-container"},_hoisted_2$r={class:"upload-stats"},_hoisted_3$n={class:"stat-item"},_hoisted_4$m={class:"stat-value"},_hoisted_5$j={class:"stat-label"},_hoisted_6$g={class:"stat-item"},_hoisted_7$d={class:"stat-value"},_hoisted_8$d={class:"stat-label"},_hoisted_9$d={class:"stat-item"},_hoisted_10$b={class:"stat-value"},_hoisted_11$b={class:"stat-label"},_hoisted_12$9={key:0,class:"stat-item error"},_hoisted_13$8={class:"stat-value"},_hoisted_14$7={class:"stat-label"},_hoisted_15$6={key:0,class:"batch-actions"},_hoisted_16$6=["title"],_hoisted_17$4=["title"],_hoisted_18$3=["title","disabled"],_hoisted_19$3=["title"],_hoisted_20$3={key:1,class:"upload-list"},_hoisted_21$3={class:"file-preview"},_hoisted_22$3=["src"],_hoisted_23$2={key:1,class:"preview-placeholder"},_hoisted_24$2={class:"file-info"},_hoisted_25$2=["title"],_hoisted_26$2={class:"file-meta"},_hoisted_27$2={class:"file-size"},_hoisted_28$2={key:0,class:"file-type"},_hoisted_29$1={key:0,class:"progress-bar"},_hoisted_30$1={class:"progress-track"},_hoisted_31$1={class:"progress-text"},_hoisted_32$1={class:"status-info"},_hoisted_33$1={key:0,class:"status-text uploading"},_hoisted_34$1={key:0,class:"speed"},_hoisted_35$1={key:1,class:"status-text success"},_hoisted_36$1={key:2,class:"status-text error"},_hoisted_37$1={key:3,class:"status-text paused"},_hoisted_38$1={key:4,class:"status-text pending"},_hoisted_39$1={key:5,class:"status-text preparing"},_hoisted_40$1={class:"file-actions"},_hoisted_41=["title","onClick"],_hoisted_42=["title","onClick"],_hoisted_43=["title","onClick"],_hoisted_44=["title","onClick"],_hoisted_45=["title","onClick"],_hoisted_46={key:2,class:"empty-state"},_hoisted_47={class:"drawer-footer"},_sfc_main$y=defineComponent({name:"GlobalUploadDrawer",__name:"index",emits:["close"],setup(__props,{emit:__emit}){const emit=__emit,uploadStore=useUploadStore(),toast=useToast(),router2=useRouter(),{$t:$t2}=useTexts(),{allUploads:allUploads2,statistics:statistics2}=storeToRefs(uploadStore),hasUploadingOrPending=computed(()=>statistics2.value.uploading>0||statistics2.value.pending>0),hasPaused=computed(()=>allUploads2.value.some(item=>item.status==="paused")),formatFileSize2=size=>size<1024?`${size} B`:size<1024*1024?`${(size/1024).toFixed(1)} KB`:size<1024*1024*1024?`${(size/(1024*1024)).toFixed(1)} MB`:`${(size/(1024*1024*1024)).toFixed(2)} GB`,formatSpeed=speed=>speed>1024?`${(speed/1024).toFixed(1)} MB/s`:`${speed.toFixed(0)} KB/s`,pauseUpload2=id=>{uploadStore.pauseUpload(id)},resumeUpload2=id=>{uploadStore.resumeUpload(id)},retryUpload2=id=>{uploadStore.retryUpload(id)},removeUpload=id=>{uploadStore.removeUploadItem(id)},pauseAll=()=>{uploadStore.pauseUpload(),toast.success($t2("globalUploadDrawer.messages.pausedAll"))},resumeAll=()=>{allUploads2.value.filter(item=>item.status==="paused").forEach(item=>uploadStore.resumeUpload(item.id)),toast.success($t2("globalUploadDrawer.messages.resumedAll"))},clearCompleted=()=>{const completed=allUploads2.value.filter(item=>item.status==="completed");completed.forEach(item=>uploadStore.removeUploadItem(item.id)),toast.success($t2("globalUploadDrawer.messages.clearedCompleted",{count:completed.length}))},clearAll=()=>{uploadStore.clearQueue(),toast.success($t2("globalUploadDrawer.messages.clearedAll"))},copyUrl=async url=>{try{await navigator.clipboard.writeText(url),toast.success($t2("globalUploadDrawer.messages.linkCopied"))}catch{toast.error($t2("globalUploadDrawer.messages.copyFailed"))}},handlePreviewError=e=>{const img=e.target;img.style.display="none"},goToUploadPage=()=>{emit("close"),router2.push("/upload")};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$v,[createBaseVNode("div",_hoisted_2$r,[createBaseVNode("div",_hoisted_3$n,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-cloud-upload-alt"},null,-1)),createBaseVNode("div",_hoisted_4$m,toDisplayString(unref(statistics2).uploading),1),createBaseVNode("div",_hoisted_5$j,toDisplayString(unref($t2)("globalUploadDrawer.stats.uploading")),1)]),createBaseVNode("div",_hoisted_6$g,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createBaseVNode("div",_hoisted_7$d,toDisplayString(unref(statistics2).pending),1),createBaseVNode("div",_hoisted_8$d,toDisplayString(unref($t2)("globalUploadDrawer.stats.pending")),1)]),createBaseVNode("div",_hoisted_9$d,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-check-circle"},null,-1)),createBaseVNode("div",_hoisted_10$b,toDisplayString(unref(statistics2).completed),1),createBaseVNode("div",_hoisted_11$b,toDisplayString(unref($t2)("globalUploadDrawer.stats.completed")),1)]),unref(statistics2).failed>0?(openBlock(),createElementBlock("div",_hoisted_12$9,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-exclamation-circle"},null,-1)),createBaseVNode("div",_hoisted_13$8,toDisplayString(unref(statistics2).failed),1),createBaseVNode("div",_hoisted_14$7,toDisplayString(unref($t2)("globalUploadDrawer.stats.failed")),1)])):createCommentVNode("",!0)]),unref(allUploads2).length>0?(openBlock(),createElementBlock("div",_hoisted_15$6,[hasUploadingOrPending.value?(openBlock(),createElementBlock("button",{key:0,class:"action-btn pause",title:unref($t2)("globalUploadDrawer.batchActions.pauseAll"),onClick:pauseAll},[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-pause"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("globalUploadDrawer.batchActions.pauseAll")),1)],8,_hoisted_16$6)):createCommentVNode("",!0),hasPaused.value?(openBlock(),createElementBlock("button",{key:1,class:"action-btn resume",title:unref($t2)("globalUploadDrawer.batchActions.resumeAll"),onClick:resumeAll},[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-play"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("globalUploadDrawer.batchActions.resumeAll")),1)],8,_hoisted_17$4)):createCommentVNode("",!0),createBaseVNode("button",{class:"action-btn clear",title:unref($t2)("globalUploadDrawer.batchActions.clearCompleted"),disabled:unref(statistics2).completed===0,onClick:clearCompleted},[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-broom"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("globalUploadDrawer.batchActions.clearCompleted")),1)],8,_hoisted_18$3),createBaseVNode("button",{class:"action-btn danger",title:unref($t2)("globalUploadDrawer.batchActions.clearAll"),onClick:clearAll},[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-trash"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("globalUploadDrawer.batchActions.clearAll")),1)],8,_hoisted_19$3)])):createCommentVNode("",!0),unref(allUploads2).length>0?(openBlock(),createElementBlock("div",_hoisted_20$3,[createVNode(TransitionGroup,{name:"list-item"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(allUploads2),item=>(openBlock(),createElementBlock("div",{key:item.id,class:normalizeClass(["upload-item",[`status-${item.status}`]])},[createBaseVNode("div",_hoisted_21$3,[item.preview?(openBlock(),createElementBlock("img",{key:0,src:item.preview,alt:"",class:"preview-img",onError:handlePreviewError},null,40,_hoisted_22$3)):(openBlock(),createElementBlock("div",_hoisted_23$2,[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fas fa-file-image"},null,-1)])]))]),createBaseVNode("div",_hoisted_24$2,[createBaseVNode("div",{class:"file-name",title:item.file.name},toDisplayString(item.file.name),9,_hoisted_25$2),createBaseVNode("div",_hoisted_26$2,[createBaseVNode("span",_hoisted_27$2,toDisplayString(formatFileSize2(item.file.size)),1),item.type==="chunked"?(openBlock(),createElementBlock("span",_hoisted_28$2,[_cache[9]||(_cache[9]=createBaseVNode("i",{class:"fas fa-puzzle-piece"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("globalUploadDrawer.misc.chunkedUpload")),1)])):createCommentVNode("",!0)]),item.status==="uploading"||item.status==="preparing"?(openBlock(),createElementBlock("div",_hoisted_29$1,[createBaseVNode("div",_hoisted_30$1,[createBaseVNode("div",{class:"progress-fill",style:normalizeStyle({width:`${item.progress}%`})},null,4)]),createBaseVNode("span",_hoisted_31$1,toDisplayString(item.progress)+"%",1)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_32$1,[item.status==="uploading"?(openBlock(),createElementBlock("span",_hoisted_33$1,[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-spinner fa-spin"},null,-1)),createTextVNode(" "+toDisplayString(item.statusMessage||unref($t2)("globalUploadDrawer.statusMessages.uploading"))+" ",1),item.speed>0?(openBlock(),createElementBlock("span",_hoisted_34$1,toDisplayString(formatSpeed(item.speed)),1)):createCommentVNode("",!0)])):item.status==="completed"?(openBlock(),createElementBlock("span",_hoisted_35$1,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-check"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("globalUploadDrawer.statusMessages.completed")),1)])):item.status==="failed"?(openBlock(),createElementBlock("span",_hoisted_36$1,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-times"},null,-1)),createTextVNode(" "+toDisplayString(item.error||unref($t2)("globalUploadDrawer.statusMessages.failed")),1)])):item.status==="paused"?(openBlock(),createElementBlock("span",_hoisted_37$1,[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-pause"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("globalUploadDrawer.statusMessages.paused")),1)])):item.status==="pending"?(openBlock(),createElementBlock("span",_hoisted_38$1,[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("globalUploadDrawer.statusMessages.pending")),1)])):(openBlock(),createElementBlock("span",_hoisted_39$1,[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-hourglass-half"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("globalUploadDrawer.statusMessages.preparing")),1)]))])]),createBaseVNode("div",_hoisted_40$1,[item.status==="uploading"?(openBlock(),createElementBlock("button",{key:0,class:"btn-action pause",title:unref($t2)("globalUploadDrawer.actions.pause"),onClick:$event=>pauseUpload2(item.id)},[..._cache[16]||(_cache[16]=[createBaseVNode("i",{class:"fas fa-pause"},null,-1)])],8,_hoisted_41)):item.status==="paused"?(openBlock(),createElementBlock("button",{key:1,class:"btn-action resume",title:unref($t2)("globalUploadDrawer.actions.resume"),onClick:$event=>resumeUpload2(item.id)},[..._cache[17]||(_cache[17]=[createBaseVNode("i",{class:"fas fa-play"},null,-1)])],8,_hoisted_42)):item.status==="failed"?(openBlock(),createElementBlock("button",{key:2,class:"btn-action retry",title:unref($t2)("globalUploadDrawer.actions.retry"),onClick:$event=>retryUpload2(item.id)},[..._cache[18]||(_cache[18]=[createBaseVNode("i",{class:"fas fa-redo"},null,-1)])],8,_hoisted_43)):createCommentVNode("",!0),item.status==="completed"&&item.result?.full_url?(openBlock(),createElementBlock("button",{key:3,class:"btn-action copy",title:unref($t2)("globalUploadDrawer.actions.copyLink"),onClick:$event=>copyUrl(item.result.full_url)},[..._cache[19]||(_cache[19]=[createBaseVNode("i",{class:"fas fa-copy"},null,-1)])],8,_hoisted_44)):createCommentVNode("",!0),createBaseVNode("button",{class:"btn-action remove",title:unref($t2)("globalUploadDrawer.actions.remove"),onClick:$event=>removeUpload(item.id)},[..._cache[20]||(_cache[20]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])],8,_hoisted_45)])],2))),128))]),_:1})])):(openBlock(),createElementBlock("div",_hoisted_46,[_cache[21]||(_cache[21]=createBaseVNode("i",{class:"fas fa-cloud-upload-alt"},null,-1)),createBaseVNode("p",null,toDisplayString(unref($t2)("globalUploadDrawer.misc.noTasks")),1),createBaseVNode("a",{class:"go-upload",onClick:goToUploadPage},toDisplayString(unref($t2)("globalUploadDrawer.misc.goToUpload")),1)])),createBaseVNode("div",_hoisted_47,[createBaseVNode("a",{class:"footer-link",onClick:goToUploadPage},[createBaseVNode("span",null,toDisplayString(unref($t2)("globalUploadDrawer.misc.viewFullPage")),1),_cache[22]||(_cache[22]=createBaseVNode("i",{class:"fas fa-arrow-right"},null,-1))])])]))}});const GlobalUploadDrawer=_export_sfc(_sfc_main$y,[["__scopeId","data-v-dbabdf63"]]),DURATION_REGEX=/^(\d+)([mhd])$/i;function validateDuration(duration,isGuest=!1){if(!duration||duration.trim()==="")return"empty";if(duration=duration.trim().toLowerCase(),duration==="permanent")return isGuest?"guestNoPermanent":null;const match=duration.match(DURATION_REGEX);if(!match)return"invalidFormat";const[,valueStr,unit]=match,value=parseInt(valueStr);if(value<=0)return"mustBePositive";switch(unit){case"m":if(value<1)return"minutesMin";if(value>1440*365)return"minutesMax";break;case"h":if(value>24*365)return"hoursMax";if(isGuest&&value>24*30)return"guestHoursMax";break;case"d":if(value>365)return"daysMax";if(isGuest&&value>30)return"guestDaysMax";break}return null}function formatDuration(duration,translateFn){if(!duration)return"";if(duration=duration.trim().toLowerCase(),duration==="permanent")return translateFn?translateFn("components.multiSelector.duration.permanent"):"Permanent";const match=duration.match(DURATION_REGEX);if(!match)return duration;const[,valueStr,unit]=match,value=parseInt(valueStr);if(translateFn)switch(unit){case"m":return`${value}${translateFn("components.multiSelector.duration.minute")}`;case"h":return`${value}${translateFn("components.multiSelector.duration.hour")}`;case"d":return`${value}${translateFn("components.multiSelector.duration.day")}`;default:return duration}else switch(unit){case"m":return`${value}m`;case"h":return`${value}h`;case"d":return`${value}d`;default:return duration}}function normalizeDuration(duration){if(!duration)return"";if(duration=duration.trim().toLowerCase(),duration==="permanent")return"permanent";const match=duration.match(DURATION_REGEX);if(!match)return duration;const[,valueStr,unit]=match;return`${valueStr}${unit.toLowerCase()}`}function isDurationExists(duration,existingDurations){const normalized=normalizeDuration(duration);return existingDurations.some(existing=>normalizeDuration(existing)===normalized)}function getDurationIcon(duration){if(!duration)return"fas fa-tag";if(duration=duration.trim().toLowerCase(),duration==="permanent")return"fas fa-infinity";const match=duration.match(DURATION_REGEX);if(!match)return"fas fa-tag";const[,,unit]=match;switch(unit){case"m":return"fas fa-clock";case"h":return"fas fa-hourglass-half";case"d":return"fas fa-calendar-day";default:return"fas fa-tag"}}function compareDurations(a,b){if(a==="permanent"&&b!=="permanent")return 1;if(b==="permanent"&&a!=="permanent")return-1;if(a==="permanent"&&b==="permanent")return 0;const getSeconds=duration=>{const match=duration.match(DURATION_REGEX);if(!match)return 0;const[,valueStr,unit]=match,value=parseInt(valueStr);switch(unit){case"m":return value*60;case"h":return value*3600;case"d":return value*86400;default:return 0}};return getSeconds(a)-getSeconds(b)}const _hoisted_1$u={class:"multi-selector"},_hoisted_2$q={class:"flex flex-wrap gap-1.5"},_hoisted_3$m=["id","value","disabled"],_hoisted_4$l=["for"],_hoisted_5$i={key:0,class:"flex-shrink-0"},_hoisted_6$f={class:"leading-tight"},_hoisted_7$c={key:1,class:"ml-1 flex-shrink-0"},_hoisted_8$c=["title","onClick"],_hoisted_9$c={key:0,class:"relative"},_hoisted_10$a={class:"leading-tight"},_hoisted_11$a=["placeholder"],_hoisted_12$8=["title"],_hoisted_13$7=["title"],_hoisted_14$6={key:0,class:"mt-1 text-xs text-error-500"},_hoisted_15$5={key:1,class:"mt-1 text-xs text-content-muted"},_hoisted_16$5={key:0,class:"text-error-500"},_sfc_main$x=defineComponent({name:"MultiSelector",__name:"index",props:{modelValue:{default:()=>[]},inputIdPrefix:{default:"selector"},disabled:{type:Boolean,default:!1},options:{default:()=>[]},forcedValue:{default:null},size:{default:"md"},showIcons:{type:Boolean,default:!0},rounded:{default:"sm"},defaultIcon:{default:"fas fa-clock"},forcedIcon:{default:"fas fa-infinity"},editable:{type:Boolean,default:!1},addText:{default:""},maxOptions:{default:10},isGuest:{type:Boolean,default:!1},validateFn:{}},emits:["update:modelValue","add-option","remove-option","validation-error"],setup(__props,{emit:__emit}){const props=__props,{$t:$t2}=useTexts(),emit=__emit,isAddingOption=ref(!1),inputValue=ref(""),inputError=ref(""),inputErrorCode=ref(""),displayAddText=computed(()=>props.addText||$t2("components.multiSelector.addOption")),hasPermanentOption=computed(()=>(props.modelValue||[]).includes("permanent")),placeholderText=computed(()=>props.isGuest||hasPermanentOption.value?$t2("components.multiSelector.placeholders.basic"):$t2("components.multiSelector.placeholders.withPermanent")),inputErrorText=computed(()=>inputErrorCode.value?["empty","guestNoPermanent","invalidFormat","mustBePositive","minutesMin","minutesMax","hoursMax","guestHoursMax","daysMax","guestDaysMax","exists"].includes(inputErrorCode.value)?$t2(`components.multiSelector.errors.${inputErrorCode.value}`):inputErrorCode.value:""),selectedValues=computed({get:()=>props.modelValue,set:value=>emit("update:modelValue",value)}),sizeClasses={sm:"text-sm px-2.5 py-1",md:"text-sm px-3 py-1.5",lg:"text-base px-4 py-2"},roundedClasses={none:"rounded-none",sm:"rounded",md:"rounded-md",lg:"rounded-lg"},displayOptions=computed(()=>props.options&&props.options.length>0?[...props.options].sort((a,b)=>compareDurations(a.value,b.value)):props.modelValue&&props.modelValue.length>0?props.modelValue.map(value=>({value,label:formatDuration(value,$t2),icon:getDurationIcon(value)})).sort((a,b)=>compareDurations(a.value,b.value)):[{value:"1h",label:formatDuration("1h",$t2),icon:"fas fa-clock text-xs"},{value:"3d",label:formatDuration("3d",$t2),icon:"fas fa-calendar-day text-xs"},{value:"7d",label:formatDuration("7d",$t2),icon:"fas fa-calendar-week text-xs"},{value:"30d",label:formatDuration("30d",$t2),icon:"fas fa-calendar-alt text-xs"},{value:"permanent",label:formatDuration("permanent",$t2),icon:"fas fa-infinity text-xs"}].sort((a,b)=>compareDurations(a.value,b.value))),inputRef=ref(),canAddMore=computed(()=>displayOptions.value.length<props.maxOptions),startAddingOption=()=>{isAddingOption.value=!0,inputValue.value="",inputError.value="",inputErrorCode.value="",nextTick(()=>{inputRef.value?.focus()})},cancelAddingOption=()=>{isAddingOption.value=!1,inputValue.value="",inputError.value="",inputErrorCode.value=""},confirmAddOption=()=>{const value=inputValue.value.trim();if(!value){inputErrorCode.value="empty",inputError.value=inputErrorText.value;return}const error2=(props.validateFn||validateDuration)(value,props.isGuest);if(error2){inputErrorCode.value=error2,inputError.value=inputErrorText.value,emit("validation-error",inputError.value);return}const normalizedValue=normalizeDuration(value);if(isDurationExists(normalizedValue,props.modelValue||[])){inputErrorCode.value="exists",inputError.value=inputErrorText.value;return}const newOption={value:normalizedValue,label:formatDuration(normalizedValue,$t2),icon:getDurationIcon(normalizedValue)},sortedValues=[...props.modelValue||[],normalizedValue].sort((a,b)=>compareDurations(a,b));emit("update:modelValue",sortedValues),emit("add-option",newOption),cancelAddingOption()},removeOption=value=>{const newValues=(props.modelValue||[]).filter(v=>v!==value);emit("update:modelValue",newValues),emit("remove-option",value)};return watch(()=>props.forcedValue,forcedValue=>{forcedValue&&(selectedValues.value?.includes(forcedValue)||emit("update:modelValue",[...selectedValues.value||[],forcedValue]))},{immediate:!0}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$u,[createBaseVNode("div",_hoisted_2$q,[(openBlock(!0),createElementBlock(Fragment,null,renderList(displayOptions.value,option=>(openBlock(),createElementBlock("div",{key:option.value,class:"group relative"},[withDirectives(createBaseVNode("input",{id:`${__props.inputIdPrefix}-${option.value}`,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>selectedValues.value=$event),type:"checkbox",value:option.value,disabled:__props.disabled||__props.forcedValue&&option.value===__props.forcedValue,class:"sr-only"},null,8,_hoisted_3$m),[[vModelCheckbox,selectedValues.value]]),createBaseVNode("label",{for:`${__props.inputIdPrefix}-${option.value}`,class:normalizeClass(["relative inline-flex cursor-pointer select-none items-center gap-1 px-2 py-0.5 text-xs font-medium transition-all",[selectedValues.value?.includes(option.value)||__props.forcedValue&&option.value===__props.forcedValue?"bg-brand-primary text-content shadow-sm":"bg-hover-bg text-content-muted hover:bg-background-600",__props.disabled||__props.forcedValue&&option.value===__props.forcedValue?"cursor-not-allowed opacity-60":"",sizeClasses[__props.size],roundedClasses[__props.rounded]]])},[__props.showIcons!==!1?(openBlock(),createElementBlock("span",_hoisted_5$i,[renderSlot(_ctx.$slots,`icon-${option.value}`,{option},()=>[option.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass(["text-sm",[option.icon]])},null,2)):__props.forcedValue&&option.value===__props.forcedValue?(openBlock(),createElementBlock("i",{key:1,class:normalizeClass(["text-sm text-error-500",[__props.forcedIcon]])},null,2)):(openBlock(),createElementBlock("i",{key:2,class:normalizeClass(["text-brand-primary text-sm",[unref(getDurationIcon)(option.value)]])},null,2))],!0)])):createCommentVNode("",!0),createBaseVNode("span",_hoisted_6$f,toDisplayString(option.label||unref(formatDuration)(option.value,unref($t2))),1),__props.forcedValue&&option.value===__props.forcedValue?(openBlock(),createElementBlock("span",_hoisted_7$c,[..._cache[4]||(_cache[4]=[createBaseVNode("i",{class:"fas fa-lock text-sm text-warning-500"},null,-1)])])):createCommentVNode("",!0),__props.editable&&!__props.disabled&&!(__props.forcedValue&&option.value===__props.forcedValue)?(openBlock(),createElementBlock("button",{key:2,class:"bg-error-500/90 absolute -right-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full text-content opacity-0 shadow-lg transition-all duration-300 hover:scale-110 hover:bg-error-600 group-hover:opacity-100",title:unref($t2)("components.multiSelector.deleteOption"),onClick:withModifiers($event=>removeOption(option.value),["prevent"])},[..._cache[5]||(_cache[5]=[createBaseVNode("i",{class:"fas fa-times text-xs",style:{"line-height":"1",margin:"0",padding:"0",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},null,-1)])],8,_hoisted_8$c)):createCommentVNode("",!0)],10,_hoisted_4$l)]))),128)),__props.editable&&!__props.disabled&&canAddMore.value?(openBlock(),createElementBlock("div",_hoisted_9$c,[isAddingOption.value?(openBlock(),createElementBlock("div",{key:1,class:"inline-flex items-center gap-1",onClick:_cache[3]||(_cache[3]=withModifiers(()=>{},["stop"]))},[withDirectives(createBaseVNode("input",{ref_key:"inputRef",ref:inputRef,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>inputValue.value=$event),placeholder:placeholderText.value,class:normalizeClass(["border border-input-border bg-input-bg px-2 py-0.5 text-xs text-input-text placeholder-placeholder focus:border-input-border-focus focus:outline-none",[sizeClasses[__props.size],roundedClasses[__props.rounded]]]),onKeyup:[withKeys(confirmAddOption,["enter"]),withKeys(cancelAddingOption,["escape"])],onBlur:confirmAddOption,onClick:_cache[2]||(_cache[2]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_11$a),[[vModelText,inputValue.value]]),createBaseVNode("button",{class:"bg-brand-primary rounded px-1.5 py-0.5 text-xs text-content transition-colors hover:bg-brand-600",title:unref($t2)("components.multiSelector.confirmAdd"),onClick:withModifiers(confirmAddOption,["stop"])},[..._cache[7]||(_cache[7]=[createBaseVNode("i",{class:"fas fa-check"},null,-1)])],8,_hoisted_12$8),createBaseVNode("button",{class:"rounded bg-hover-bg px-1.5 py-0.5 text-xs text-content transition-colors hover:bg-background-600",title:unref($t2)("components.multiSelector.cancel"),onClick:withModifiers(cancelAddingOption,["stop"])},[..._cache[8]||(_cache[8]=[createBaseVNode("i",{class:"fas fa-times"},null,-1)])],8,_hoisted_13$7)])):(openBlock(),createElementBlock("button",{key:0,class:normalizeClass(["hover:border-brand-primary hover:text-brand-primary inline-flex cursor-pointer select-none items-center gap-1 border-2 border-dashed border-subtle px-2 py-0.5 text-xs font-medium text-content-muted transition-all",[sizeClasses[__props.size],roundedClasses[__props.rounded]]]),onClick:startAddingOption},[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-plus text-sm"},null,-1)),createBaseVNode("span",_hoisted_10$a,toDisplayString(displayAddText.value),1)],2))])):createCommentVNode("",!0)]),inputErrorText.value?(openBlock(),createElementBlock("div",_hoisted_14$6,toDisplayString(inputErrorText.value),1)):createCommentVNode("",!0),__props.editable&&!__props.disabled?(openBlock(),createElementBlock("div",_hoisted_15$5,[createBaseVNode("span",null,toDisplayString(unref($t2)("components.multiSelector.hints.format")),1),!__props.isGuest&&!hasPermanentOption.value?(openBlock(),createElementBlock("span",_hoisted_16$5,toDisplayString(unref($t2)("components.multiSelector.hints.permanent")),1)):createCommentVNode("",!0)])):createCommentVNode("",!0)]))}});const MultiSelector=_export_sfc(_sfc_main$x,[["__scopeId","data-v-7020459e"]]),DEFAULT_WATERMARK_CONFIG={enabled:!1,type:"text",text:"PixelPunk",fontSize:48,fontFamily:"Arial",fontColor:"#ffffff",fontWeight:"normal",fileBase64:"",position:"bottom-right",offsetX:20,offsetY:20,offsetUnit:"px",opacity:.7,scale:1,rotation:0,shadow:!0,shadowColor:"#000000",shadowBlur:4,shadowOffsetX:1,shadowOffsetY:1,relativeSize:.15},_hoisted_1$t={class:"section-group"},_hoisted_2$p={class:"section-header"},_hoisted_3$l={class:"section-title"},_hoisted_4$k={class:"section-content"},_hoisted_5$h={class:"config-item"},_hoisted_6$e={class:"type-selector"},_hoisted_7$b=["checked"],_hoisted_8$b={class:"type-card"},_hoisted_9$b={class:"type-label"},_hoisted_10$9=["checked"],_hoisted_11$9={class:"type-card"},_hoisted_12$7={class:"type-label"},_sfc_main$w=defineComponent({name:"WatermarkTypeSelector",__name:"WatermarkTypeSelector",props:{config:{}},emits:["update:config"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,updateType=type=>{emit("update:config",{...props.config,type})};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$t,[createBaseVNode("div",_hoisted_2$p,[createBaseVNode("h4",_hoisted_3$l,toDisplayString(_ctx.$t("components.watermark.type.label")),1)]),createBaseVNode("div",_hoisted_4$k,[createBaseVNode("div",_hoisted_5$h,[createBaseVNode("div",_hoisted_6$e,[createBaseVNode("label",{class:normalizeClass(["type-option",{active:__props.config.type==="text"}])},[createBaseVNode("input",{checked:__props.config.type==="text",type:"radio",value:"text",class:"type-radio",onChange:_cache[0]||(_cache[0]=$event=>updateType("text"))},null,40,_hoisted_7$b),createBaseVNode("div",_hoisted_8$b,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-font text-sm"},null,-1)),createBaseVNode("span",_hoisted_9$b,toDisplayString(_ctx.$t("components.watermark.type.text")),1)])],2),createBaseVNode("label",{class:normalizeClass(["type-option",{active:__props.config.type==="image"}])},[createBaseVNode("input",{checked:__props.config.type==="image",type:"radio",value:"image",class:"type-radio",onChange:_cache[1]||(_cache[1]=$event=>updateType("image"))},null,40,_hoisted_10$9),createBaseVNode("div",_hoisted_11$9,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-image text-sm"},null,-1)),createBaseVNode("span",_hoisted_12$7,toDisplayString(_ctx.$t("components.watermark.type.image")),1)])],2)])])])]))}});const WatermarkTypeSelector=_export_sfc(_sfc_main$w,[["__scopeId","data-v-4c21c42c"]]),_hoisted_1$s={class:"section-group"},_hoisted_2$o={class:"section-header"},_hoisted_3$k={class:"section-title"},_hoisted_4$j={class:"section-content"},_hoisted_5$g={class:"config-item"},_hoisted_6$d={class:"config-label"},_hoisted_7$a={class:"config-item"},_hoisted_8$a={class:"config-label"},_hoisted_9$a={class:"slider-control"},_hoisted_10$8={class:"slider-value"},_hoisted_11$8={class:"config-item"},_hoisted_12$6={class:"config-label"},_hoisted_13$6={class:"config-item"},_hoisted_14$5={class:"config-label"},_sfc_main$v=defineComponent({name:"WatermarkTextConfig",__name:"WatermarkTextConfig",props:{config:{}},emits:["update:config"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,updateConfig=(key,value)=>{emit("update:config",{...props.config,[key]:value})};return(_ctx,_cache)=>{const _component_cyberInput=resolveComponent("cyberInput"),_component_cyberSlider=resolveComponent("cyberSlider"),_component_cyberColorPicker=resolveComponent("cyberColorPicker"),_component_cyberRadioGroup=resolveComponent("cyberRadioGroup");return openBlock(),createElementBlock("div",_hoisted_1$s,[createBaseVNode("div",_hoisted_2$o,[createBaseVNode("h4",_hoisted_3$k,toDisplayString(_ctx.$t("components.watermark.textConfig.title")),1)]),createBaseVNode("div",_hoisted_4$j,[createBaseVNode("div",_hoisted_5$g,[createBaseVNode("label",_hoisted_6$d,toDisplayString(_ctx.$t("components.watermark.textConfig.text")),1),createVNode(_component_cyberInput,{"model-value":__props.config.text,placeholder:_ctx.$t("components.watermark.textConfig.textPlaceholder"),"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>updateConfig("text",$event))},null,8,["model-value","placeholder"])]),createBaseVNode("div",_hoisted_7$a,[createBaseVNode("label",_hoisted_8$a,toDisplayString(_ctx.$t("components.watermark.textConfig.fontSize")),1),createBaseVNode("div",_hoisted_9$a,[createVNode(_component_cyberSlider,{"model-value":__props.config.fontSize,min:12,max:200,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>updateConfig("fontSize",$event))},null,8,["model-value"]),createBaseVNode("span",_hoisted_10$8,toDisplayString(__props.config.fontSize)+"px",1)])]),createBaseVNode("div",_hoisted_11$8,[createBaseVNode("label",_hoisted_12$6,toDisplayString(_ctx.$t("components.watermark.textConfig.fontColor")),1),createVNode(_component_cyberColorPicker,{"model-value":__props.config.fontColor,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>updateConfig("fontColor",$event))},null,8,["model-value"])]),createBaseVNode("div",_hoisted_13$6,[createBaseVNode("label",_hoisted_14$5,toDisplayString(_ctx.$t("components.watermark.textConfig.fontWeight")),1),createVNode(_component_cyberRadioGroup,{"model-value":__props.config.fontWeight??"normal",options:[{label:_ctx.$t("components.watermark.textConfig.normal"),value:"normal"},{label:_ctx.$t("components.watermark.textConfig.bold"),value:"bold"}],"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>updateConfig("fontWeight",$event))},null,8,["model-value","options"])])])])}}});const WatermarkTextConfig=_export_sfc(_sfc_main$v,[["__scopeId","data-v-827acf3f"]]),_hoisted_1$r={class:"section-group"},_hoisted_2$n={class:"section-header"},_hoisted_3$j={class:"section-title"},_hoisted_4$i={class:"section-content"},_hoisted_5$f={class:"config-item"},_hoisted_6$c={class:"config-label"},_hoisted_7$9={class:"upload-area"},_hoisted_8$9={class:"upload-buttons"},_hoisted_9$9={key:0,class:"image-preview"},_hoisted_10$7={class:"preview-container"},_hoisted_11$7=["src","alt"],_sfc_main$u=defineComponent({name:"WatermarkFileConfig",__name:"WatermarkFileConfig",props:{config:{}},emits:["update:config"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,{$t:$t2}=useTexts(),toast=useToast(),imageInput=ref(),handleImageUpload=event=>{const file=event.target.files?.[0];if(file){if(!file.type.startsWith("image/")){toast.error($t2("components.watermark.messages.fileTypeError"));return}if(file.size>2*1024*1024){toast.error($t2("components.watermark.messages.fileSizeError"));return}const reader=new FileReader;reader.onload=e=>{const result=e.target?.result;if(result&&result.includes(",")){const base64Data=result.split(",")[1],newConfig={...props.config,fileBase64:base64Data,imageFile:file};emit("update:config",newConfig)}},reader.readAsDataURL(file)}},useDefaultImage=async()=>{try{const blob=await(await fetch("/pixelpunk.png")).blob(),reader=new FileReader;reader.onload=()=>{const base64=reader.result.split(",")[1]||"",newConfig={...props.config,fileBase64:base64,imageFile:void 0};emit("update:config",newConfig)},reader.readAsDataURL(blob)}catch{}},handleImageError=()=>{};return(_ctx,_cache)=>{const _component_cyberButton=resolveComponent("cyberButton");return openBlock(),createElementBlock("div",_hoisted_1$r,[createBaseVNode("div",_hoisted_2$n,[createBaseVNode("h4",_hoisted_3$j,toDisplayString(unref($t2)("components.watermark.imageConfig.title")),1)]),createBaseVNode("div",_hoisted_4$i,[createBaseVNode("div",_hoisted_5$f,[createBaseVNode("label",_hoisted_6$c,toDisplayString(unref($t2)("components.watermark.imageConfig.image")),1),createBaseVNode("div",_hoisted_7$9,[createBaseVNode("div",_hoisted_8$9,[createBaseVNode("input",{ref_key:"imageInput",ref:imageInput,type:"file",accept:"image/*",class:"hidden",onChange:handleImageUpload},null,544),createVNode(_component_cyberButton,{variant:"outline",size:"sm",class:"upload-btn",onClick:_cache[0]||(_cache[0]=$event=>imageInput.value?.click())},{default:withCtx(()=>[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-upload mr-2"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.imageConfig.upload")),1)]),_:1}),createVNode(_component_cyberButton,{variant:"outline",size:"sm",class:"upload-btn",onClick:useDefaultImage},{default:withCtx(()=>[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-image mr-2"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.imageConfig.useDefault")),1)]),_:1})]),__props.config.fileBase64?(openBlock(),createElementBlock("div",_hoisted_9$9,[createBaseVNode("div",_hoisted_10$7,[createBaseVNode("img",{src:"data:image/png;base64,"+__props.config.fileBase64,alt:unref($t2)("components.watermark.imageConfig.previewAlt"),class:"preview-image",onError:handleImageError},null,40,_hoisted_11$7)])])):createCommentVNode("",!0)])])])])}}});const WatermarkFileConfig=_export_sfc(_sfc_main$u,[["__scopeId","data-v-8e293332"]]),_hoisted_1$q={class:"section-group"},_hoisted_2$m={class:"section-header"},_hoisted_3$i={class:"section-title"},_hoisted_4$h={class:"section-content"},_hoisted_5$e={class:"config-item"},_hoisted_6$b={class:"config-label"},_hoisted_7$8={class:"position-grid"},_hoisted_8$8=["title","onClick"],_hoisted_9$8={class:"config-item"},_hoisted_10$6={class:"config-label"},_hoisted_11$6={class:"offset-controls"},_hoisted_12$5={class:"offset-input-group"},_hoisted_13$5={class:"input-label"},_hoisted_14$4={class:"offset-input-group"},_hoisted_15$4={class:"input-label"},_hoisted_16$4={class:"hint-text"},_hoisted_17$3={key:0,class:"warning-text"},_sfc_main$t=defineComponent({name:"WatermarkPositionConfig",__name:"WatermarkPositionConfig",props:{config:{}},emits:["update:config"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,positionOptions=[{value:"top-left",labelKey:"watermark.position.topLeft",icon:"fas fa-arrow-up text-xs"},{value:"top-center",labelKey:"watermark.position.topCenter",icon:"fas fa-arrow-up text-xs"},{value:"top-right",labelKey:"watermark.position.topRight",icon:"fas fa-arrow-up text-xs"},{value:"middle-left",labelKey:"watermark.position.middleLeft",icon:"fas fa-arrow-left text-xs"},{value:"middle-center",labelKey:"watermark.position.center",icon:"fas fa-circle text-xs"},{value:"middle-right",labelKey:"watermark.position.middleRight",icon:"fas fa-arrow-right text-xs"},{value:"bottom-left",labelKey:"watermark.position.bottomLeft",icon:"fas fa-arrow-down text-xs"},{value:"bottom-center",labelKey:"watermark.position.bottomCenter",icon:"fas fa-arrow-down text-xs"},{value:"bottom-right",labelKey:"watermark.position.bottomRight",icon:"fas fa-arrow-down text-xs"}],updatePosition=position=>{emit("update:config",{...props.config,position})},updateOffsetX=value=>{emit("update:config",{...props.config,offsetX:value,offsetUnit:"px"})},updateOffsetY=value=>{emit("update:config",{...props.config,offsetY:value,offsetUnit:"px"})},offsetX=computed({get:()=>props.config.offsetX??20,set:value=>updateOffsetX(value)}),offsetY=computed({get:()=>props.config.offsetY??20,set:value=>updateOffsetY(value)}),showOffsetWarning=computed(()=>{const x=offsetX.value,y=offsetY.value;return x>1e3||y>1e3||x<-200||y<-200});return(_ctx,_cache)=>{const _component_cyberInput=resolveComponent("cyberInput");return openBlock(),createElementBlock("div",_hoisted_1$q,[createBaseVNode("div",_hoisted_2$m,[createBaseVNode("h4",_hoisted_3$i,toDisplayString(_ctx.$t("components.watermark.position.title")),1)]),createBaseVNode("div",_hoisted_4$h,[createBaseVNode("div",_hoisted_5$e,[createBaseVNode("label",_hoisted_6$b,toDisplayString(_ctx.$t("components.watermark.position.label")),1),createBaseVNode("div",_hoisted_7$8,[(openBlock(),createElementBlock(Fragment,null,renderList(positionOptions,pos=>createBaseVNode("button",{key:pos.value,class:normalizeClass(["position-btn",[__props.config.position===pos.value?"active":""]]),title:_ctx.$t(pos.labelKey),onClick:$event=>updatePosition(pos.value)},[createBaseVNode("i",{class:normalizeClass(pos.icon)},null,2)],10,_hoisted_8$8)),64))])]),createBaseVNode("div",_hoisted_9$8,[createBaseVNode("label",_hoisted_10$6,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-ruler mr-1.5 text-xs"},null,-1)),createBaseVNode("span",null,toDisplayString(_ctx.$t("components.watermark.offset.title")),1)]),createBaseVNode("div",_hoisted_11$6,[createBaseVNode("div",_hoisted_12$5,[createBaseVNode("label",_hoisted_13$5,toDisplayString(_ctx.$t("components.watermark.offset.horizontal")),1),createVNode(_component_cyberInput,{modelValue:offsetX.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>offsetX.value=$event),modelModifiers:{number:!0},type:"number",min:-500,max:5e3,class:"offset-input"},null,8,["modelValue"]),_cache[3]||(_cache[3]=createBaseVNode("span",{class:"input-unit"},"px",-1))]),createBaseVNode("div",_hoisted_14$4,[createBaseVNode("label",_hoisted_15$4,toDisplayString(_ctx.$t("components.watermark.offset.vertical")),1),createVNode(_component_cyberInput,{modelValue:offsetY.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>offsetY.value=$event),modelModifiers:{number:!0},type:"number",min:-500,max:5e3,class:"offset-input"},null,8,["modelValue"]),_cache[4]||(_cache[4]=createBaseVNode("span",{class:"input-unit"},"px",-1))])]),createBaseVNode("p",_hoisted_16$4,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-info-circle mr-1 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(_ctx.$t("components.watermark.offset.hint")),1)]),showOffsetWarning.value?(openBlock(),createElementBlock("p",_hoisted_17$3,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-exclamation-triangle mr-1 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(_ctx.$t("components.watermark.offset.warning")),1)])):createCommentVNode("",!0)])])])}}});const WatermarkPositionConfig=_export_sfc(_sfc_main$t,[["__scopeId","data-v-96bb0802"]]),_hoisted_1$p={class:"section-group"},_hoisted_2$l={class:"section-header"},_hoisted_3$h={class:"section-title"},_hoisted_4$g={class:"section-content"},_hoisted_5$d={class:"config-item"},_hoisted_6$a={class:"config-label"},_hoisted_7$7={class:"slider-control"},_hoisted_8$7={class:"slider-value"},_hoisted_9$7={class:"config-item"},_hoisted_10$5={class:"config-label"},_hoisted_11$5={class:"slider-control"},_hoisted_12$4={class:"slider-value"},_hoisted_13$4={class:"hint-text"},_hoisted_14$3={class:"config-item"},_hoisted_15$3={class:"config-label"},_hoisted_16$3={class:"slider-control"},_hoisted_17$2={class:"slider-value"},_hoisted_18$2={class:"hint-text"},_hoisted_19$2={class:"config-item"},_hoisted_20$2={class:"config-label"},_hoisted_21$2={class:"slider-control"},_hoisted_22$2={class:"slider-value"},_sfc_main$s=defineComponent({name:"WatermarkStyleConfig",__name:"WatermarkStyleConfig",props:{config:{}},emits:["update:config"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,updateConfig=(key,value)=>{emit("update:config",{...props.config,[key]:value})};return(_ctx,_cache)=>{const _component_cyberSlider=resolveComponent("cyberSlider");return openBlock(),createElementBlock("div",_hoisted_1$p,[createBaseVNode("div",_hoisted_2$l,[createBaseVNode("h4",_hoisted_3$h,toDisplayString(_ctx.$t("components.watermark.style.title")),1)]),createBaseVNode("div",_hoisted_4$g,[createBaseVNode("div",_hoisted_5$d,[createBaseVNode("label",_hoisted_6$a,toDisplayString(_ctx.$t("components.watermark.style.opacity")),1),createBaseVNode("div",_hoisted_7$7,[createVNode(_component_cyberSlider,{"model-value":__props.config.opacity,min:.1,max:1,step:.1,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>updateConfig("opacity",$event))},null,8,["model-value"]),createBaseVNode("span",_hoisted_8$7,toDisplayString(Math.round(__props.config.opacity*100))+"%",1)])]),createBaseVNode("div",_hoisted_9$7,[createBaseVNode("label",_hoisted_10$5,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-expand-arrows-alt mr-1.5 text-xs"},null,-1)),createBaseVNode("span",null,toDisplayString(_ctx.$t("components.watermark.style.relativeSize")),1)]),createBaseVNode("div",_hoisted_11$5,[createVNode(_component_cyberSlider,{"model-value":__props.config.relativeSize||.15,min:.05,max:.5,step:.01,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>updateConfig("relativeSize",$event))},null,8,["model-value"]),createBaseVNode("span",_hoisted_12$4,toDisplayString(Math.round((__props.config.relativeSize||.15)*100))+"%",1)]),createBaseVNode("p",_hoisted_13$4,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-info-circle mr-1 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(_ctx.$t("components.watermark.style.relativeSizeHint")),1)])]),createBaseVNode("div",_hoisted_14$3,[createBaseVNode("label",_hoisted_15$3,toDisplayString(_ctx.$t("components.watermark.style.scale")),1),createBaseVNode("div",_hoisted_16$3,[createVNode(_component_cyberSlider,{"model-value":__props.config.scale??1,min:.01,max:2,step:.01,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>updateConfig("scale",$event))},null,8,["model-value"]),createBaseVNode("span",_hoisted_17$2,toDisplayString(Math.round((__props.config.scale??1)*100))+"%",1)]),createBaseVNode("p",_hoisted_18$2,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-info-circle mr-1 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(_ctx.$t("components.watermark.style.scaleHint")),1)])]),createBaseVNode("div",_hoisted_19$2,[createBaseVNode("label",_hoisted_20$2,toDisplayString(_ctx.$t("components.watermark.style.rotation")),1),createBaseVNode("div",_hoisted_21$2,[createVNode(_component_cyberSlider,{"model-value":__props.config.rotation??0,min:-180,max:180,step:5,"onUpdate:modelValue":_cache[3]||(_cache[3]=$event=>updateConfig("rotation",$event))},null,8,["model-value"]),createBaseVNode("span",_hoisted_22$2,toDisplayString(__props.config.rotation??0)+"¬∞",1)])])])])}}});const WatermarkStyleConfig=_export_sfc(_sfc_main$s,[["__scopeId","data-v-ed934085"]]),_hoisted_1$o={class:"section-group"},_hoisted_2$k={class:"section-header"},_hoisted_3$g={class:"section-title"},_hoisted_4$f={class:"section-content"},_hoisted_5$c={class:"config-item"},_hoisted_6$9={class:"config-item"},_hoisted_7$6={class:"config-label"},_hoisted_8$6={class:"config-item"},_hoisted_9$6={class:"config-label"},_hoisted_10$4={class:"slider-control"},_hoisted_11$4={class:"slider-value"},_sfc_main$r=defineComponent({name:"WatermarkEffectsConfig",__name:"WatermarkEffectsConfig",props:{config:{}},emits:["update:config"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,updateConfig=(key,value)=>{emit("update:config",{...props.config,[key]:value})};return(_ctx,_cache)=>{const _component_cyberCheckbox=resolveComponent("cyberCheckbox"),_component_cyberColorPicker=resolveComponent("cyberColorPicker"),_component_cyberSlider=resolveComponent("cyberSlider");return openBlock(),createElementBlock("div",_hoisted_1$o,[createBaseVNode("div",_hoisted_2$k,[createBaseVNode("h4",_hoisted_3$g,toDisplayString(_ctx.$t("components.watermark.effects.title")),1)]),createBaseVNode("div",_hoisted_4$f,[createBaseVNode("div",_hoisted_5$c,[createVNode(_component_cyberCheckbox,{"model-value":__props.config.shadow,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>updateConfig("shadow",$event))},{default:withCtx(()=>[createTextVNode(toDisplayString(_ctx.$t("components.watermark.effects.shadow")),1)]),_:1},8,["model-value"])]),__props.config.shadow?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",_hoisted_6$9,[createBaseVNode("label",_hoisted_7$6,toDisplayString(_ctx.$t("components.watermark.effects.shadowColor")),1),createVNode(_component_cyberColorPicker,{"model-value":__props.config.shadowColor,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>updateConfig("shadowColor",$event))},null,8,["model-value"])]),createBaseVNode("div",_hoisted_8$6,[createBaseVNode("label",_hoisted_9$6,toDisplayString(_ctx.$t("components.watermark.effects.shadowBlur")),1),createBaseVNode("div",_hoisted_10$4,[createVNode(_component_cyberSlider,{"model-value":__props.config.shadowBlur,min:0,max:10,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>updateConfig("shadowBlur",$event))},null,8,["model-value"]),createBaseVNode("span",_hoisted_11$4,toDisplayString(__props.config.shadowBlur),1)])])],64)):createCommentVNode("",!0)])])}}});const WatermarkEffectsConfig=_export_sfc(_sfc_main$r,[["__scopeId","data-v-6fc84bd2"]]),_hoisted_1$n={class:"watermark-panel"},_hoisted_2$j={class:"panel-sections"},_sfc_main$q=defineComponent({name:"WatermarkPanel",__name:"WatermarkPanel",props:{config:{},onConfigChange:{type:Function}},emits:["config-change"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,localConfig=ref({...props.config});watch(localConfig,newConfig=>{emit("config-change",{...newConfig})},{deep:!0}),watch(()=>props.config,newConfig=>{JSON.stringify(newConfig)!==JSON.stringify(localConfig.value)&&(localConfig.value={...newConfig})},{deep:!0});const handleConfigUpdate=newConfig=>{localConfig.value={...newConfig}};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$n,[createBaseVNode("div",_hoisted_2$j,[createVNode(WatermarkTypeSelector,{config:localConfig.value,"onUpdate:config":handleConfigUpdate},null,8,["config"]),localConfig.value.type==="text"?(openBlock(),createBlock(WatermarkTextConfig,{key:0,config:localConfig.value,"onUpdate:config":handleConfigUpdate},null,8,["config"])):createCommentVNode("",!0),localConfig.value.type==="image"?(openBlock(),createBlock(WatermarkFileConfig,{key:1,config:localConfig.value,"onUpdate:config":handleConfigUpdate},null,8,["config"])):createCommentVNode("",!0),createVNode(WatermarkPositionConfig,{config:localConfig.value,"onUpdate:config":handleConfigUpdate},null,8,["config"]),createVNode(WatermarkStyleConfig,{config:localConfig.value,"onUpdate:config":handleConfigUpdate},null,8,["config"]),createVNode(WatermarkEffectsConfig,{config:localConfig.value,"onUpdate:config":handleConfigUpdate},null,8,["config"])])]))}});const WatermarkPanel=_export_sfc(_sfc_main$q,[["__scopeId","data-v-6d9060ad"]]);const getImageRect=(img,canvasWidth,canvasHeight)=>{if(!img)return{x:0,y:0,width:canvasWidth,height:canvasHeight};const imgRatio=img.width/img.height,canvasRatio=canvasWidth/canvasHeight;let drawWidth,drawHeight,drawX,drawY;return imgRatio>canvasRatio?(drawWidth=canvasWidth,drawHeight=canvasWidth/imgRatio,drawX=0,drawY=(canvasHeight-drawHeight)/2):(drawHeight=canvasHeight,drawWidth=canvasHeight*imgRatio,drawX=(canvasWidth-drawWidth)/2,drawY=0),{x:drawX,y:drawY,width:drawWidth,height:drawHeight}},calculateWatermarkPosition=(config,watermarkImageData,width,height,previewImageData)=>{let watermarkWidth=0,watermarkHeight=0;if(config.type==="text"){const ctx=document.createElement("canvas").getContext("2d");ctx&&(ctx.font=`${config.fontWeight} ${config.fontSize}px ${config.fontFamily}`,watermarkWidth=ctx.measureText(config.text).width*config.scale,watermarkHeight=config.fontSize*config.scale)}else watermarkImageData&&(watermarkWidth=watermarkImageData.width*config.scale,watermarkHeight=watermarkImageData.height*config.scale);const minDragSize=40;if(watermarkWidth=Math.max(watermarkWidth,minDragSize),watermarkHeight=Math.max(watermarkHeight,minDragSize),config.rotation!==0){const rad=Math.abs(config.rotation)*Math.PI/180,cos=Math.abs(Math.cos(rad)),sin=Math.abs(Math.sin(rad)),rotatedWidth=watermarkWidth*cos+watermarkHeight*sin,rotatedHeight=watermarkWidth*sin+watermarkHeight*cos;watermarkWidth=rotatedWidth,watermarkHeight=rotatedHeight}const imgRect=getImageRect(previewImageData,width,height),offsetX=config.offsetX??20,offsetY=config.offsetY??20;let x=0,y=0;switch(config.position){case"top-left":x=imgRect.x+offsetX,y=imgRect.y+offsetY;break;case"top-center":x=imgRect.x+(imgRect.width-watermarkWidth)/2+offsetX,y=imgRect.y+offsetY;break;case"top-right":x=imgRect.x+imgRect.width-watermarkWidth-offsetX,y=imgRect.y+offsetY;break;case"middle-left":x=imgRect.x+offsetX,y=imgRect.y+(imgRect.height-watermarkHeight)/2+offsetY;break;case"middle-center":x=imgRect.x+(imgRect.width-watermarkWidth)/2+offsetX,y=imgRect.y+(imgRect.height-watermarkHeight)/2+offsetY;break;case"middle-right":x=imgRect.x+imgRect.width-watermarkWidth-offsetX,y=imgRect.y+(imgRect.height-watermarkHeight)/2+offsetY;break;case"bottom-left":x=imgRect.x+offsetX,y=imgRect.y+imgRect.height-watermarkHeight-offsetY;break;case"bottom-center":x=imgRect.x+(imgRect.width-watermarkWidth)/2+offsetX,y=imgRect.y+imgRect.height-watermarkHeight-offsetY;break;case"bottom-right":x=imgRect.x+imgRect.width-watermarkWidth-offsetX,y=imgRect.y+imgRect.height-watermarkHeight-offsetY;break;case"custom":x=imgRect.x+offsetX,y=imgRect.y+offsetY;break;default:x=imgRect.x+imgRect.width-watermarkWidth-offsetX,y=imgRect.y+imgRect.height-watermarkHeight-offsetY}return{x,y,width:watermarkWidth,height:watermarkHeight}},getAnchorPosition=(position,imgRect)=>{const{x,y,width,height}=imgRect;switch(position){case"top-left":return{x,y};case"top-center":return{x:x+width/2,y};case"top-right":return{x:x+width,y};case"middle-left":return{x,y:y+height/2};case"middle-center":return{x:x+width/2,y:y+height/2};case"middle-right":return{x:x+width,y:y+height/2};case"bottom-left":return{x,y:y+height};case"bottom-center":return{x:x+width/2,y:y+height};case"bottom-right":return{x:x+width,y:y+height};default:return{x:x+width,y:y+height}}},getHoveredResizeHandle=(mouseX,mouseY,previewX,previewY,previewWidth,previewHeight)=>{const handles=[{name:"top-left",x:previewX,y:previewY},{name:"top-right",x:previewX+previewWidth,y:previewY},{name:"bottom-left",x:previewX,y:previewY+previewHeight},{name:"bottom-right",x:previewX+previewWidth,y:previewY+previewHeight}];for(const handle of handles){const dx=mouseX-handle.x,dy=mouseY-handle.y;if(Math.sqrt(dx*dx+dy*dy)<=10)return handle.name}return null};function getBrandColor(alpha=1){const root=document.documentElement,values=(getComputedStyle(root).getPropertyValue("--color-brand-500-rgb").trim()||"139, 92, 246").split(",").map(v=>v.trim());return values.length===3?`rgba(${values[0]}, ${values[1]}, ${values[2]}, ${alpha})`:`rgba(139, 92, 246, ${alpha})`}function getSuccessColor(alpha=1){const root=document.documentElement,values=(getComputedStyle(root).getPropertyValue("--color-success-500-rgb").trim()||"34, 197, 94").split(",").map(v=>v.trim());return values.length===3?`rgba(${values[0]}, ${values[1]}, ${values[2]}, ${alpha})`:`rgba(34, 197, 94, ${alpha})`}function getDangerColor(alpha=1){const root=document.documentElement,values=(getComputedStyle(root).getPropertyValue("--color-danger-500-rgb").trim()||"239, 68, 68").split(",").map(v=>v.trim());return values.length===3?`rgba(${values[0]}, ${values[1]}, ${values[2]}, ${alpha})`:`rgba(239, 68, 68, ${alpha})`}function drawDistanceLabel(ctx,text,x,y){const textWidth=ctx.measureText(text).width,textHeight=11;ctx.fillStyle=getBrandColor(.9),ctx.fillRect(x-textWidth/2-4,y-textHeight/2-4,textWidth+4*2,textHeight+4*2),ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(text,x,y)}const drawGuideLines=(ctx,watermarkPos,imgRect,position,isDragging)=>{if(!isDragging)return;ctx.save(),ctx.setLineDash([4,4]),ctx.strokeStyle=getBrandColor(1),ctx.lineWidth=1,ctx.fillStyle=getBrandColor(1),ctx.font="bold 11px Arial";const wmX=watermarkPos.x,wmY=watermarkPos.y,wmW=watermarkPos.width,wmH=watermarkPos.height,showLeft=position.includes("left"),showRight=position.includes("right"),showTop=position.includes("top"),showBottom=position.includes("bottom");if(showLeft){const dist=Math.round(wmX-imgRect.x);ctx.beginPath(),ctx.moveTo(imgRect.x,wmY+wmH/2),ctx.lineTo(wmX,wmY+wmH/2),ctx.stroke();const labelX=imgRect.x+(wmX-imgRect.x)/2,labelY=wmY+wmH/2-5;drawDistanceLabel(ctx,`${dist}px`,labelX,labelY)}if(showRight){const dist=Math.round(imgRect.x+imgRect.width-(wmX+wmW));ctx.beginPath(),ctx.moveTo(wmX+wmW,wmY+wmH/2),ctx.lineTo(imgRect.x+imgRect.width,wmY+wmH/2),ctx.stroke();const labelX=wmX+wmW+dist/2,labelY=wmY+wmH/2-5;drawDistanceLabel(ctx,`${dist}px`,labelX,labelY)}if(showTop){const dist=Math.round(wmY-imgRect.y);ctx.beginPath(),ctx.moveTo(wmX+wmW/2,imgRect.y),ctx.lineTo(wmX+wmW/2,wmY),ctx.stroke();const labelX=wmX+wmW/2+5,labelY=imgRect.y+(wmY-imgRect.y)/2;drawDistanceLabel(ctx,`${dist}px`,labelX,labelY)}if(showBottom){const dist=Math.round(imgRect.y+imgRect.height-(wmY+wmH));ctx.beginPath(),ctx.moveTo(wmX+wmW/2,wmY+wmH),ctx.lineTo(wmX+wmW/2,imgRect.y+imgRect.height),ctx.stroke();const labelX=wmX+wmW/2+5,labelY=wmY+wmH+dist/2;drawDistanceLabel(ctx,`${dist}px`,labelX,labelY)}ctx.restore()},drawPreviewAreaBorder=(ctx,x,y,width,height,previewWidth,previewHeight,labelText)=>{ctx.save(),ctx.strokeStyle=getBrandColor(.8),ctx.lineWidth=3,ctx.setLineDash([10,5]),ctx.strokeRect(x,y,width,height),ctx.setLineDash([]);const cornerSize=8;ctx.fillStyle=getBrandColor(.9),ctx.fillRect(x-cornerSize/2,y-cornerSize/2,cornerSize,cornerSize),ctx.fillRect(x+width-cornerSize/2,y-cornerSize/2,cornerSize,cornerSize),ctx.fillRect(x-cornerSize/2,y+height-cornerSize/2,cornerSize,cornerSize),ctx.fillRect(x+width-cornerSize/2,y+height-cornerSize/2,cornerSize,cornerSize),ctx.fillStyle=getBrandColor(.95),ctx.font='bold 13px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',ctx.textAlign="left",ctx.textBaseline="top";const finalLabelText=labelText||`Preview Area: ${previewWidth} √ó ${previewHeight}px`,labelPadding=8,labelWidth=ctx.measureText(finalLabelText).width+labelPadding*2,labelHeight=24;ctx.fillStyle=getBrandColor(.95),ctx.fillRect(x+10,y+10,labelWidth,labelHeight),ctx.fillStyle="#ffffff",ctx.fillText(finalLabelText,x+10+labelPadding,y+10+6),ctx.restore()},drawAnchorPoint=(ctx,x,y)=>{ctx.save();const gradient=ctx.createRadialGradient(x,y,0,x,y,12);gradient.addColorStop(0,getDangerColor(.4)),gradient.addColorStop(1,getDangerColor(0)),ctx.fillStyle=gradient,ctx.beginPath(),ctx.arc(x,y,12,0,Math.PI*2),ctx.fill(),ctx.fillStyle=getDangerColor(1),ctx.beginPath(),ctx.arc(x,y,6,0,Math.PI*2),ctx.fill(),ctx.strokeStyle="#ffffff",ctx.lineWidth=2,ctx.stroke(),ctx.fillStyle="rgba(255, 255, 255, 0.5)",ctx.beginPath(),ctx.arc(x-1,y-1,2,0,Math.PI*2),ctx.fill(),ctx.restore()},drawAnchorLine=(ctx,anchorX,anchorY,watermarkCenterX,watermarkCenterY)=>{ctx.save(),ctx.strokeStyle=getDangerColor(.5),ctx.lineWidth=2,ctx.setLineDash([8,6]),ctx.beginPath(),ctx.moveTo(anchorX,anchorY),ctx.lineTo(watermarkCenterX,watermarkCenterY),ctx.stroke(),ctx.setLineDash([]),ctx.restore()},drawResizeHandles=(ctx,x,y,width,height,hoveredCorner=null)=>{const handles=[{name:"top-left",x,y},{name:"top-right",x:x+width,y},{name:"bottom-left",x,y:y+height},{name:"bottom-right",x:x+width,y:y+height}];ctx.save(),handles.forEach(handle=>{const isHovered=hoveredCorner===handle.name;if(isHovered){const gradient=ctx.createRadialGradient(handle.x,handle.y,0,handle.x,handle.y,18);gradient.addColorStop(0,getBrandColor(.4)),gradient.addColorStop(1,getBrandColor(0)),ctx.fillStyle=gradient,ctx.beginPath(),ctx.arc(handle.x,handle.y,12*1.5,0,Math.PI*2),ctx.fill()}ctx.fillStyle=getBrandColor(isHovered?.8:1),ctx.fillRect(handle.x-12/2,handle.y-12/2,12,12),ctx.strokeStyle="#ffffff",ctx.lineWidth=2,ctx.strokeRect(handle.x-12/2,handle.y-12/2,12,12),isHovered&&(ctx.fillStyle="rgba(255, 255, 255, 0.4)",ctx.fillRect(handle.x-12/2+2,handle.y-12/2+2,12-4,12-4))}),ctx.restore()},DEFAULT_PREVIEW_SIZE={width:2e3,height:1200},CANVAS_CONFIG={minPreviewSize:500,maxPreviewSize:1e4,minZoom:.1,maxZoom:5,zoomSpeed:.9,inverseZoomSpeed:1.1,fitMargin:80,baseGridSize:50,handleSize:12,handleHitThreshold:4},RULER_CONFIG={intervals:{zoom2x:50,zoom1x:100,zoom05x:200,default:500},zoomThresholds:{high:2,medium:1,low:.5}},PRESET_SIZES=[{name:"1080p",width:1920,height:1080},{name:"2K",width:2560,height:1440},{name:"4K",width:3840,height:2160},{name:"8K",width:7680,height:4320}];function useCanvasState(){const canvasSize=ref({width:580,height:326}),canvasZoom=ref(1),canvasPan=ref({x:0,y:0}),previewSize=ref({...DEFAULT_PREVIEW_SIZE});return{canvasSize,canvasZoom,canvasPan,previewSize,setPreviewSize:(width,height)=>{previewSize.value={width,height}},fitToView:()=>{const{width,height}=canvasSize.value,margin=CANVAS_CONFIG.fitMargin,fitZoomX=(width-margin)/previewSize.value.width,fitZoomY=(height-margin)/previewSize.value.height,fitZoom=Math.min(fitZoomX,fitZoomY,1),centerPanX=(width-previewSize.value.width*fitZoom)/2,centerPanY=(height-previewSize.value.height*fitZoom)/2;canvasZoom.value=fitZoom,canvasPan.value={x:centerPanX,y:centerPanY}},resetZoom:()=>{const{width,height}=canvasSize.value;canvasZoom.value=1;const centerPanX=(width-previewSize.value.width)/2,centerPanY=(height-previewSize.value.height)/2;canvasPan.value={x:centerPanX,y:centerPanY}}}}function useImageLoader(previewImageProp,config,onLoad){const previewImageData=ref(),watermarkImageData=ref(),droppedImageUrl=ref();return{previewImageData,watermarkImageData,droppedImageUrl,loadPreviewImage:()=>{const imageUrl=droppedImageUrl.value||previewImageProp;if(imageUrl){const img=new Image;img.crossOrigin="anonymous",img.onload=()=>{previewImageData.value=img,onLoad()},img.onerror=()=>{previewImageData.value=void 0,onLoad()},img.src=imageUrl}else previewImageData.value=void 0,onLoad()},loadWatermarkImage:()=>{if(config.value.type==="image"&&config.value.fileBase64){const img=new Image;img.crossOrigin="anonymous",img.onload=()=>{watermarkImageData.value=img,onLoad()},img.onerror=()=>{watermarkImageData.value=void 0,onLoad()},img.src=`data:image/png;base64,${config.value.fileBase64}`}else watermarkImageData.value=void 0}}}function useWatermarkDrag(watermarkRect,previewImageData,previewSize,canvasZoom,canvasPan,config,emit){const isDraggingWatermark=ref(!1),dragStartPos=ref({x:0,y:0}),dragStartWatermarkPos=ref({x:0,y:0}),isPointInWatermark=(x,y)=>{const rect=watermarkRect.value;return x>=rect.x&&x<=rect.x+rect.width&&y>=rect.y&&y<=rect.y+rect.height};return{isDraggingWatermark,isPointInWatermark,startDrag:(canvasX,canvasY)=>isPointInWatermark(canvasX,canvasY)?(isDraggingWatermark.value=!0,dragStartPos.value={x:canvasX,y:canvasY},dragStartWatermarkPos.value={x:watermarkRect.value.x,y:watermarkRect.value.y},!0):!1,updateDrag:(canvasX,canvasY)=>{if(!isDraggingWatermark.value)return;const deltaX=canvasX-dragStartPos.value.x,deltaY=canvasY-dragStartPos.value.y;let newWatermarkX=dragStartWatermarkPos.value.x+deltaX,newWatermarkY=dragStartWatermarkPos.value.y+deltaY;const wmWidth=watermarkRect.value.width,wmHeight=watermarkRect.value.height,previewW=previewSize.value.width,previewH=previewSize.value.height,imgRect=getImageRect(previewImageData.value,previewW,previewH);newWatermarkX=Math.max(imgRect.x,Math.min(newWatermarkX,imgRect.x+imgRect.width-wmWidth)),newWatermarkY=Math.max(imgRect.y,Math.min(newWatermarkY,imgRect.y+imgRect.height-wmHeight));const currentPosition=config.value.position;let offsetX=0,offsetY=0;currentPosition.includes("left")?offsetX=newWatermarkX-imgRect.x:currentPosition.includes("right")?offsetX=imgRect.x+imgRect.width-(newWatermarkX+wmWidth):offsetX=0,currentPosition.includes("top")?offsetY=newWatermarkY-imgRect.y:currentPosition.includes("bottom")?offsetY=imgRect.y+imgRect.height-(newWatermarkY+wmHeight):currentPosition.includes("middle")&&(offsetY=0),emit("config-change",{...config.value,offsetX:Math.round(offsetX),offsetY:Math.round(offsetY),offsetUnit:"px"})},endDrag:()=>{isDraggingWatermark.value=!1}}}function usePreviewResize(previewSize,canvasZoom,canvasPan){const isResizingPreview=ref(!1),resizeCorner=ref(null),resizeStartSize=ref({width:0,height:0}),dragStartPos=ref({x:0,y:0}),hoveredCorner=ref(null);return{isResizingPreview,hoveredCorner,checkHover:(screenX,screenY)=>{const zoom=canvasZoom.value,{x:panX,y:panY}=canvasPan.value,previewW=previewSize.value.width,previewH=previewSize.value.height,previewScreenX=0*zoom+panX,previewScreenY=0*zoom+panY,previewScreenW=previewW*zoom,previewScreenH=previewH*zoom,hovered=getHoveredResizeHandle(screenX,screenY,previewScreenX,previewScreenY,previewScreenW,previewScreenH);return hoveredCorner.value=hovered,hovered},startResize:(corner,screenX,screenY)=>{isResizingPreview.value=!0,resizeCorner.value=corner,resizeStartSize.value={width:previewSize.value.width,height:previewSize.value.height},dragStartPos.value={x:screenX,y:screenY}},updateResize:(screenX,screenY)=>{if(!isResizingPreview.value||!resizeCorner.value)return;const zoom=canvasZoom.value,deltaScreenX=screenX-dragStartPos.value.x,deltaScreenY=screenY-dragStartPos.value.y,deltaCanvasX=deltaScreenX/zoom,deltaCanvasY=deltaScreenY/zoom;let newWidth=resizeStartSize.value.width,newHeight=resizeStartSize.value.height;switch(resizeCorner.value){case"top-left":newWidth=resizeStartSize.value.width-deltaCanvasX,newHeight=resizeStartSize.value.height-deltaCanvasY;break;case"top-right":newWidth=resizeStartSize.value.width+deltaCanvasX,newHeight=resizeStartSize.value.height-deltaCanvasY;break;case"bottom-left":newWidth=resizeStartSize.value.width-deltaCanvasX,newHeight=resizeStartSize.value.height+deltaCanvasY;break;case"bottom-right":newWidth=resizeStartSize.value.width+deltaCanvasX,newHeight=resizeStartSize.value.height+deltaCanvasY;break}newWidth=Math.max(CANVAS_CONFIG.minPreviewSize,Math.min(CANVAS_CONFIG.maxPreviewSize,newWidth)),newHeight=Math.max(CANVAS_CONFIG.minPreviewSize,Math.min(CANVAS_CONFIG.maxPreviewSize,newHeight)),previewSize.value={width:Math.round(newWidth),height:Math.round(newHeight)}},endResize:()=>{isResizingPreview.value=!1,resizeCorner.value=null}}}function useCanvasZoomPan(canvasZoom,canvasPan){const isSpacePressed=ref(!1),isPanningCanvas=ref(!1),panStartPos=ref({x:0,y:0});return{isSpacePressed,isPanningCanvas,handleWheel:(e,mouseX,mouseY)=>{e.preventDefault();const canvasXBefore=(mouseX-canvasPan.value.x)/canvasZoom.value,canvasYBefore=(mouseY-canvasPan.value.y)/canvasZoom.value,zoomDelta=e.deltaY>0?CANVAS_CONFIG.zoomSpeed:CANVAS_CONFIG.inverseZoomSpeed,newZoom=Math.max(CANVAS_CONFIG.minZoom,Math.min(CANVAS_CONFIG.maxZoom,canvasZoom.value*zoomDelta)),canvasXAfter=(mouseX-canvasPan.value.x)/newZoom,canvasYAfter=(mouseY-canvasPan.value.y)/newZoom;canvasPan.value={x:canvasPan.value.x+(canvasXAfter-canvasXBefore)*newZoom,y:canvasPan.value.y+(canvasYAfter-canvasYBefore)*newZoom},canvasZoom.value=newZoom},startPan:(clientX,clientY)=>isSpacePressed.value?(isPanningCanvas.value=!0,panStartPos.value={x:clientX,y:clientY},!0):!1,updatePan:(clientX,clientY)=>{if(!isPanningCanvas.value)return;const deltaX=clientX-panStartPos.value.x,deltaY=clientY-panStartPos.value.y;canvasPan.value={x:canvasPan.value.x+deltaX,y:canvasPan.value.y+deltaY},panStartPos.value={x:clientX,y:clientY}},endPan:()=>{isPanningCanvas.value=!1},handleKeyDown:e=>{e.code==="Space"&&!isSpacePressed.value&&(isSpacePressed.value=!0,e.preventDefault())},handleKeyUp:e=>{e.code==="Space"&&(isSpacePressed.value=!1,isPanningCanvas.value=!1)}}}function useRulers(canvasZoom,canvasPan,canvasSize){const getInterval=zoom=>zoom>=RULER_CONFIG.zoomThresholds.high?RULER_CONFIG.intervals.zoom2x:zoom>=RULER_CONFIG.zoomThresholds.medium?RULER_CONFIG.intervals.zoom1x:zoom>=RULER_CONFIG.zoomThresholds.low?RULER_CONFIG.intervals.zoom05x:RULER_CONFIG.intervals.default,horizontalRulerMarks=computed(()=>{const marks=[],zoom=canvasZoom.value,panX=canvasPan.value.x,viewportWidth=canvasSize.value.width,interval=getInterval(zoom),canvasStart=-panX/zoom,canvasEnd=(viewportWidth-panX)/zoom,firstMark=Math.floor(canvasStart/interval)*interval;for(let i=firstMark;i<=canvasEnd;i+=interval){const screenPos=i*zoom+panX;screenPos>=0&&screenPos<=viewportWidth&&marks.push({value:i,position:screenPos+30})}return marks}),verticalRulerMarks=computed(()=>{const marks=[],zoom=canvasZoom.value,panY=canvasPan.value.y,viewportHeight=canvasSize.value.height,interval=getInterval(zoom),canvasStart=-panY/zoom,canvasEnd=(viewportHeight-panY)/zoom,firstMark=Math.floor(canvasStart/interval)*interval;for(let i=firstMark;i<=canvasEnd;i+=interval){const screenPos=i*zoom+panY;screenPos>=0&&screenPos<=viewportHeight&&marks.push({value:i,position:screenPos+40})}return marks});return{horizontalRulerMarks,verticalRulerMarks}}function useFileDrop(droppedImageUrl,onDrop){const isDragOver=ref(!1);return{isDragOver,handleDragOver:e=>{e.preventDefault(),isDragOver.value=!0},handleDragLeave:()=>{isDragOver.value=!1},handleDrop:e=>{e.preventDefault(),isDragOver.value=!1;const files=e.dataTransfer?.files;if(files&&files.length>0){const file=files[0];if(file.type.startsWith("image/")){const reader=new FileReader;reader.onload=event=>{const result=event.target?.result;result&&(droppedImageUrl.value=result,onDrop())},reader.readAsDataURL(file)}}}}}const _hoisted_1$m={class:"watermark-preview"},_hoisted_2$i={class:"preview-toolbar"},_hoisted_3$f={class:"toolbar-left"},_hoisted_4$e={class:"zoom-indicator"},_hoisted_5$b={class:"size-selector-group"},_hoisted_6$8=["value","checked","onChange"],_hoisted_7$5={class:"size-radio-text"},_hoisted_8$5={class:"current-size-display"},_hoisted_9$5={class:"size-text"},_hoisted_10$3={class:"toolbar-right"},_hoisted_11$3={key:0,class:"dragging-status"},_hoisted_12$3={class:"view-controls-group"},_hoisted_13$3=["title"],_hoisted_14$2={class:"btn-text"},_hoisted_15$2=["title"],_hoisted_16$2=["title"],_hoisted_17$1={class:"btn-text"},_hoisted_18$1={class:"ruler-vertical"},_hoisted_19$1={class:"ruler-label"},_hoisted_20$1={class:"canvas-wrapper"},_hoisted_21$1={key:0,class:"drag-overlay"},_hoisted_22$1={class:"drag-text"},_hoisted_23$1={key:1,class:"canvas-hints-panel"},_hoisted_24$1={class:"hint-item-row hint-info"},_hoisted_25$1={class:"hint-color-green"},_hoisted_26$1={class:"hint-color-purple"},_hoisted_27$1={key:2,class:"offset-info-panel"},_hoisted_28$1={class:"info-header"},_hoisted_29={class:"info-content"},_hoisted_30={class:"info-item"},_hoisted_31={class:"info-label"},_hoisted_32={class:"info-value"},_hoisted_33={class:"info-item"},_hoisted_34={class:"info-label"},_hoisted_35={class:"info-value"},_hoisted_36={class:"info-item"},_hoisted_37={class:"info-label"},_hoisted_38={class:"info-value"},_hoisted_39={class:"ruler-horizontal"},_hoisted_40={class:"ruler-label"},_sfc_main$p=defineComponent({name:"WatermarkPreview",__name:"WatermarkPreview",props:{config:{},previewImage:{},onConfigChange:{type:Function}},emits:["config-change"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,canvasRef=ref(),animationFrameId=ref(),watermarkRect=ref({x:0,y:0,width:0,height:0}),localConfig=ref({...props.config});watch(()=>props.config,newConfig=>{localConfig.value={...newConfig}},{deep:!0,immediate:!0});const{canvasSize,canvasZoom,canvasPan,previewSize,setPreviewSize,fitToView,resetZoom}=useCanvasState(),{previewImageData,watermarkImageData,droppedImageUrl,loadPreviewImage,loadWatermarkImage}=useImageLoader(props.previewImage,localConfig,drawCanvas),{isDraggingWatermark,isPointInWatermark,startDrag,updateDrag,endDrag}=useWatermarkDrag(watermarkRect,previewImageData,previewSize,canvasZoom,canvasPan,localConfig,emit),{isResizingPreview,hoveredCorner,checkHover,startResize,updateResize,endResize}=usePreviewResize(previewSize,canvasZoom,canvasPan),{isSpacePressed,isPanningCanvas,handleWheel,startPan,updatePan,endPan,handleKeyDown,handleKeyUp}=useCanvasZoomPan(canvasZoom,canvasPan),{horizontalRulerMarks,verticalRulerMarks}=useRulers(canvasZoom,canvasPan,canvasSize),{isDragOver,handleDragOver,handleDragLeave,handleDrop}=useFileDrop(droppedImageUrl,loadPreviewImage),initCanvas=()=>{if(!canvasRef.value)return;const canvas=canvasRef.value;if(!canvas.getContext("2d"))return;const container=canvas.parentElement;if(container){const width=container.clientWidth,height=container.clientHeight;canvas.width=width,canvas.height=height,canvas.style.width=`${width}px`,canvas.style.height=`${height}px`,canvasSize.value={width,height};const margin=CANVAS_CONFIG.fitMargin,fitZoomX=(width-margin)/previewSize.value.width,fitZoomY=(height-margin)/previewSize.value.height,fitZoom=Math.min(fitZoomX,fitZoomY,1),centerPanX=(width-previewSize.value.width*fitZoom)/2,centerPanY=(height-previewSize.value.height*fitZoom)/2;canvasZoom.value=fitZoom,canvasPan.value={x:centerPanX,y:centerPanY}}drawCanvas()},drawInfiniteGrid=(ctx,width,height)=>{const zoom=canvasZoom.value,{x:panX,y:panY}=canvasPan.value,gridSize=CANVAS_CONFIG.baseGridSize*zoom,startX=panX%gridSize-gridSize,startY=panY%gridSize-gridSize;ctx.strokeStyle=getBrandColor(.15),ctx.lineWidth=1;for(let x=startX;x<width+gridSize;x+=gridSize)ctx.beginPath(),ctx.moveTo(Math.round(x),0),ctx.lineTo(Math.round(x),height),ctx.stroke();for(let y=startY;y<height+gridSize;y+=gridSize)ctx.beginPath(),ctx.moveTo(0,Math.round(y)),ctx.lineTo(width,Math.round(y)),ctx.stroke();const originX=panX,originY=panY;originX>=0&&originX<=width&&(ctx.strokeStyle=getBrandColor(.4),ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(Math.round(originX),0),ctx.lineTo(Math.round(originX),height),ctx.stroke()),originY>=0&&originY<=height&&(ctx.strokeStyle=getBrandColor(.4),ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(0,Math.round(originY)),ctx.lineTo(width,Math.round(originY)),ctx.stroke())};function drawCanvas(){const canvas=canvasRef.value;if(!canvas)return;const ctx=canvas.getContext("2d");if(!ctx)return;const{width,height}=canvasSize.value;ctx.clearRect(0,0,width,height),drawInfiniteGrid(ctx,width,height);const zoom=canvasZoom.value,{x:panX,y:panY}=canvasPan.value,previewW=previewSize.value.width,previewH=previewSize.value.height,previewCanvasX=0,previewCanvasY=0,previewScreenX=previewCanvasX*zoom+panX,previewScreenY=previewCanvasY*zoom+panY,previewScreenW=previewW*zoom,previewScreenH=previewH*zoom;if(ctx.save(),previewImageData.value){const imgRect2=getImageRect(previewImageData.value,previewW,previewH),imgScreenX2=imgRect2.x*zoom+panX,imgScreenY2=imgRect2.y*zoom+panY,imgScreenW2=imgRect2.width*zoom,imgScreenH2=imgRect2.height*zoom;ctx.drawImage(previewImageData.value,imgScreenX2,imgScreenY2,imgScreenW2,imgScreenH2)}ctx.restore();let wmWidth=100,wmHeight=30;if(localConfig.value.type==="text"){const tempCtx=document.createElement("canvas").getContext("2d");tempCtx&&(tempCtx.font=`${localConfig.value.fontWeight} ${localConfig.value.fontSize}px ${localConfig.value.fontFamily}`,wmWidth=tempCtx.measureText(localConfig.value.text).width*localConfig.value.scale,wmHeight=localConfig.value.fontSize*localConfig.value.scale)}else watermarkImageData.value&&(wmWidth=watermarkImageData.value.width*localConfig.value.scale,wmHeight=watermarkImageData.value.height*localConfig.value.scale);if(localConfig.value.rotation!==0){const rad=Math.abs(localConfig.value.rotation)*Math.PI/180,cos=Math.abs(Math.cos(rad)),sin=Math.abs(Math.sin(rad)),rotatedW=wmWidth*cos+wmHeight*sin,rotatedH=wmWidth*sin+wmHeight*cos;wmWidth=rotatedW,wmHeight=rotatedH}const position=calculateWatermarkPosition(localConfig.value,watermarkImageData.value,previewW,previewH,previewImageData.value),watermarkScreenX=position.x*zoom+panX,watermarkScreenY=position.y*zoom+panY,watermarkScreenW=wmWidth*zoom,watermarkScreenH=wmHeight*zoom;ctx.save(),ctx.globalAlpha=localConfig.value.opacity,localConfig.value.shadow&&(ctx.shadowColor=localConfig.value.shadowColor,ctx.shadowBlur=localConfig.value.shadowBlur*zoom,ctx.shadowOffsetX=localConfig.value.shadowOffsetX*zoom,ctx.shadowOffsetY=localConfig.value.shadowOffsetY*zoom);const centerX=watermarkScreenX+watermarkScreenW/2,centerY=watermarkScreenY+watermarkScreenH/2;ctx.translate(centerX,centerY),localConfig.value.rotation!==0&&ctx.rotate(localConfig.value.rotation*Math.PI/180),localConfig.value.type==="text"?(ctx.font=`${localConfig.value.fontWeight} ${localConfig.value.fontSize*localConfig.value.scale*zoom}px ${localConfig.value.fontFamily}`,ctx.fillStyle=localConfig.value.fontColor,ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(localConfig.value.text,0,0)):localConfig.value.type==="image"&&watermarkImageData.value&&ctx.drawImage(watermarkImageData.value,-watermarkScreenW/2,-watermarkScreenH/2,watermarkScreenW,watermarkScreenH),ctx.restore();const imgRect=getImageRect(previewImageData.value,previewW,previewH),imgScreenX=imgRect.x*zoom+panX,imgScreenY=imgRect.y*zoom+panY,imgScreenW=imgRect.width*zoom,imgScreenH=imgRect.height*zoom;isDraggingWatermark.value&&drawGuideLines(ctx,{x:watermarkScreenX,y:watermarkScreenY,width:watermarkScreenW,height:watermarkScreenH},{x:imgScreenX,y:imgScreenY,width:imgScreenW,height:imgScreenH},localConfig.value.position,!0);const previewAreaLabel=$t2("components.watermark.preview.previewArea",{width:previewW,height:previewH});if(drawPreviewAreaBorder(ctx,previewScreenX,previewScreenY,previewScreenW,previewScreenH,previewW,previewH,previewAreaLabel),previewImageData.value){ctx.save(),ctx.strokeStyle=getSuccessColor(.6),ctx.lineWidth=2,ctx.setLineDash([6,4]),ctx.strokeRect(imgScreenX,imgScreenY,imgScreenW,imgScreenH),ctx.setLineDash([]),ctx.fillStyle=getSuccessColor(.9),ctx.font='bold 12px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',ctx.textAlign="left",ctx.textBaseline="top";const labelText=$t2("components.watermark.preview.imageArea",{width:Math.round(imgRect.width),height:Math.round(imgRect.height)}),labelPadding=6,labelWidth=ctx.measureText(labelText).width+labelPadding*2,labelHeight=20;ctx.fillStyle=getSuccessColor(.9),ctx.fillRect(imgScreenX+10,imgScreenY+10,labelWidth,labelHeight),ctx.fillStyle="#ffffff",ctx.fillText(labelText,imgScreenX+10+labelPadding,imgScreenY+10+4),ctx.restore()}const anchorPos=getAnchorPosition(localConfig.value.position,imgRect),anchorScreenX=anchorPos.x*zoom+panX,anchorScreenY=anchorPos.y*zoom+panY;drawAnchorPoint(ctx,anchorScreenX,anchorScreenY);const watermarkCenterScreenX=watermarkScreenX+watermarkScreenW/2,watermarkCenterScreenY=watermarkScreenY+watermarkScreenH/2;drawAnchorLine(ctx,anchorScreenX,anchorScreenY,watermarkCenterScreenX,watermarkCenterScreenY),drawResizeHandles(ctx,previewScreenX,previewScreenY,previewScreenW,previewScreenH,hoveredCorner.value),watermarkRect.value={x:position.x,y:position.y,width:wmWidth,height:wmHeight}}const handleCanvasMouseDown=e=>{const canvas=canvasRef.value;if(!canvas)return;const rect=canvas.getBoundingClientRect(),screenX=e.clientX-rect.left,screenY=e.clientY-rect.top;if(startPan(e.clientX,e.clientY)){canvas.style.cursor="grabbing",e.preventDefault();return}const zoom=canvasZoom.value,{x:panX,y:panY}=canvasPan.value,canvasX=(screenX-panX)/zoom,canvasY=(screenY-panY)/zoom,clickedHandle=checkHover(screenX,screenY);if(clickedHandle){startResize(clickedHandle,screenX,screenY),e.preventDefault();return}startDrag(canvasX,canvasY)&&(canvas.style.cursor="grabbing",e.preventDefault())},handleCanvasMouseMove=e=>{const canvas=canvasRef.value;if(!canvas)return;const rect=canvas.getBoundingClientRect(),screenX=e.clientX-rect.left,screenY=e.clientY-rect.top;animationFrameId.value!==void 0&&cancelAnimationFrame(animationFrameId.value),animationFrameId.value=requestAnimationFrame(()=>{if(isPanningCanvas.value){updatePan(e.clientX,e.clientY);return}const zoom=canvasZoom.value,{x:panX,y:panY}=canvasPan.value,canvasX=(screenX-panX)/zoom,canvasY=(screenY-panY)/zoom;if(isResizingPreview.value){updateResize(screenX,screenY);return}if(isDraggingWatermark.value)updateDrag(canvasX,canvasY);else{const hovered=checkHover(screenX,screenY);isSpacePressed.value?canvas.style.cursor="grab":hovered?hovered==="top-left"||hovered==="bottom-right"?canvas.style.cursor="nwse-resize":(hovered==="top-right"||hovered==="bottom-left")&&(canvas.style.cursor="nesw-resize"):canvas.style.cursor=isPointInWatermark(canvasX,canvasY)?"grab":"default"}})},handleCanvasMouseUp=()=>{if(isDraggingWatermark.value){endDrag();const canvas=canvasRef.value;canvas&&(canvas.style.cursor="default"),drawCanvas()}if(isResizingPreview.value){endResize();const canvas=canvasRef.value;canvas&&(canvas.style.cursor="default")}if(isPanningCanvas.value){endPan();const canvas=canvasRef.value;canvas&&(canvas.style.cursor=isSpacePressed.value?"grab":"default")}},handleCanvasMouseLeave=()=>{handleCanvasMouseUp()},positionMap=computed(()=>({"top-left":$t2("components.watermark.position.topLeft"),"top-center":$t2("components.watermark.position.topCenter"),"top-right":$t2("components.watermark.position.topRight"),"middle-left":$t2("components.watermark.position.middleLeft"),"middle-center":$t2("components.watermark.position.center"),"middle-right":$t2("components.watermark.position.middleRight"),"bottom-left":$t2("components.watermark.position.bottomLeft"),"bottom-center":$t2("components.watermark.position.bottomCenter"),"bottom-right":$t2("components.watermark.position.bottomRight")})),getPositionName=position=>positionMap.value[position]||position,handleCanvasWheel=e=>{const canvas=canvasRef.value;if(!canvas)return;const rect=canvas.getBoundingClientRect(),mouseX=e.clientX-rect.left,mouseY=e.clientY-rect.top;handleWheel(e,mouseX,mouseY)},handleResize=()=>{initCanvas()},handleSetPreviewSize=(width,height)=>{setPreviewSize(width,height),nextTick(()=>{fitToView()})},resetView=()=>{fitToView()};return onMounted(()=>{initCanvas(),loadPreviewImage(),document.addEventListener("mouseup",handleCanvasMouseUp),document.addEventListener("keydown",handleKeyDown),document.addEventListener("keyup",handleKeyUp),window.addEventListener("resize",handleResize)}),onUnmounted(()=>{document.removeEventListener("mouseup",handleCanvasMouseUp),document.removeEventListener("keydown",handleKeyDown),document.removeEventListener("keyup",handleKeyUp),window.removeEventListener("resize",handleResize),animationFrameId.value!==void 0&&cancelAnimationFrame(animationFrameId.value)}),watch(localConfig,()=>{nextTick(()=>{drawCanvas()})},{deep:!0}),watch(()=>props.previewImage,()=>{loadPreviewImage()}),watch(()=>[localConfig.value.type,localConfig.value.fileBase64],()=>{loadWatermarkImage()},{immediate:!0}),watch(()=>[canvasZoom.value,canvasPan.value.x,canvasPan.value.y],()=>{nextTick(()=>{drawCanvas()})}),watch(()=>[previewSize.value.width,previewSize.value.height],()=>{nextTick(()=>{drawCanvas()})}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$m,[createBaseVNode("div",_hoisted_2$i,[createBaseVNode("div",_hoisted_3$f,[createBaseVNode("div",_hoisted_4$e,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-search-plus mr-1.5 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(Math.round(unref(canvasZoom)*100))+"% ",1)]),createBaseVNode("div",_hoisted_5$b,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(PRESET_SIZES),preset=>(openBlock(),createElementBlock("label",{key:preset.name,class:normalizeClass(["size-radio-label",{active:unref(previewSize).width===preset.width&&unref(previewSize).height===preset.height}])},[createBaseVNode("input",{type:"radio",value:`${preset.width}x${preset.height}`,checked:unref(previewSize).width===preset.width&&unref(previewSize).height===preset.height,onChange:$event=>handleSetPreviewSize(preset.width,preset.height),class:"size-radio-input"},null,40,_hoisted_6$8),createBaseVNode("span",_hoisted_7$5,toDisplayString(preset.name),1)],2))),128))]),createBaseVNode("div",_hoisted_8$5,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-ruler-combined mr-1 text-xs"},null,-1)),createBaseVNode("span",_hoisted_9$5,toDisplayString(unref(previewSize).width)+" √ó "+toDisplayString(unref(previewSize).height),1)])]),createBaseVNode("div",_hoisted_10$3,[unref(isDraggingWatermark)?(openBlock(),createElementBlock("div",_hoisted_11$3,[_cache[7]||(_cache[7]=createBaseVNode("i",{class:"fas fa-hand-rock mr-1.5 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.preview.dragging")),1)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_12$3,[createBaseVNode("button",{class:"view-control-btn",title:unref($t2)("components.watermark.preview.fitWindow"),onClick:_cache[0]||(_cache[0]=(...args)=>unref(fitToView)&&unref(fitToView)(...args))},[_cache[8]||(_cache[8]=createBaseVNode("i",{class:"fas fa-expand mr-1 text-xs"},null,-1)),createBaseVNode("span",_hoisted_14$2,toDisplayString(unref($t2)("components.watermark.preview.fit")),1)],8,_hoisted_13$3),createBaseVNode("button",{class:"view-control-btn",title:unref($t2)("components.watermark.preview.actualSize"),onClick:_cache[1]||(_cache[1]=(...args)=>unref(resetZoom)&&unref(resetZoom)(...args))},[..._cache[9]||(_cache[9]=[createBaseVNode("i",{class:"fas fa-search mr-1 text-xs"},null,-1),createBaseVNode("span",{class:"btn-text"},"1:1",-1)])],8,_hoisted_15$2),createBaseVNode("button",{class:"view-control-btn",title:unref($t2)("components.watermark.preview.resetView"),onClick:resetView},[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-redo mr-1 text-xs"},null,-1)),createBaseVNode("span",_hoisted_17$1,toDisplayString(unref($t2)("components.watermark.preview.reset")),1)],8,_hoisted_16$2)])])]),createBaseVNode("div",{class:normalizeClass(["preview-main",{"drag-over":unref(isDragOver)}]),onDragover:_cache[2]||(_cache[2]=(...args)=>unref(handleDragOver)&&unref(handleDragOver)(...args)),onDragleave:_cache[3]||(_cache[3]=(...args)=>unref(handleDragLeave)&&unref(handleDragLeave)(...args)),onDrop:_cache[4]||(_cache[4]=(...args)=>unref(handleDrop)&&unref(handleDrop)(...args))},[createBaseVNode("div",_hoisted_18$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(verticalRulerMarks),mark=>(openBlock(),createElementBlock("div",{key:mark.value,class:"ruler-mark",style:normalizeStyle({top:`${mark.position}px`})},[createBaseVNode("span",_hoisted_19$1,toDisplayString(mark.value),1),createBaseVNode("div",{class:normalizeClass(["ruler-tick",{major:mark.value%100===0}])},null,2)],4))),128))]),createBaseVNode("div",_hoisted_20$1,[createBaseVNode("canvas",{ref_key:"canvasRef",ref:canvasRef,class:normalizeClass(["preview-canvas",{"drag-active":unref(isDragOver),panning:unref(isSpacePressed)}]),onMousedown:handleCanvasMouseDown,onMousemove:handleCanvasMouseMove,onMouseup:handleCanvasMouseUp,onMouseleave:handleCanvasMouseLeave,onWheel:handleCanvasWheel},null,34),unref(isDragOver)?(openBlock(),createElementBlock("div",_hoisted_21$1,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-image text-4xl"},null,-1)),createBaseVNode("p",_hoisted_22$1,toDisplayString(unref($t2)("components.watermark.preview.dropToPreview")),1)])):createCommentVNode("",!0),unref(previewImageData)&&!unref(isDraggingWatermark)&&!unref(isDragOver)?(openBlock(),createElementBlock("div",_hoisted_23$1,[createBaseVNode("div",_hoisted_24$1,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-info-circle text-xs"},null,-1)),createBaseVNode("span",null,[createBaseVNode("span",_hoisted_25$1,toDisplayString(unref($t2)("components.watermark.preview.greenFrame")),1),createTextVNode("="+toDisplayString(unref($t2)("components.watermark.preview.imageArea2"))+" ",1),createBaseVNode("span",_hoisted_26$1,toDisplayString(unref($t2)("components.watermark.preview.purpleFrame")),1),createTextVNode("="+toDisplayString(unref($t2)("components.watermark.preview.previewCanvas")),1)])])])):createCommentVNode("",!0),unref(isDraggingWatermark)?(openBlock(),createElementBlock("div",_hoisted_27$1,[createBaseVNode("div",_hoisted_28$1,[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-info-circle mr-1.5 text-xs"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.preview.positionInfo")),1)]),createBaseVNode("div",_hoisted_29,[createBaseVNode("div",_hoisted_30,[createBaseVNode("span",_hoisted_31,toDisplayString(unref($t2)("components.watermark.preview.anchor"))+":",1),createBaseVNode("span",_hoisted_32,toDisplayString(getPositionName(__props.config.position)),1)]),createBaseVNode("div",_hoisted_33,[createBaseVNode("span",_hoisted_34,toDisplayString(unref($t2)("components.watermark.preview.horizontal"))+":",1),createBaseVNode("span",_hoisted_35,toDisplayString(__props.config.offsetX??20)+"px",1)]),createBaseVNode("div",_hoisted_36,[createBaseVNode("span",_hoisted_37,toDisplayString(unref($t2)("components.watermark.preview.vertical"))+":",1),createBaseVNode("span",_hoisted_38,toDisplayString(__props.config.offsetY??20)+"px",1)])])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_39,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(horizontalRulerMarks),mark=>(openBlock(),createElementBlock("div",{key:mark.value,class:"ruler-mark",style:normalizeStyle({left:`${mark.position}px`})},[createBaseVNode("span",_hoisted_40,toDisplayString(mark.value),1),createBaseVNode("div",{class:normalizeClass(["ruler-tick",{major:mark.value%100===0}])},null,2)],4))),128))])],34)]))}}),_hoisted_1$l={class:"watermark-config-main"},_hoisted_2$h={class:"config-content"},_hoisted_3$e={class:"config-sidebar"},_hoisted_4$d={class:"sidebar-header"},_hoisted_5$a={class:"sidebar-title"},_hoisted_6$7={class:"sidebar-content"},_hoisted_7$4={class:"preview-main"},_hoisted_8$4={class:"preview-header"},_hoisted_9$4={class:"preview-title-row"},_hoisted_10$2={class:"preview-title"},_hoisted_11$2={class:"help-btn"},_hoisted_12$2={class:"help-text"},_hoisted_13$2={class:"help-tooltip-content"},_hoisted_14$1={class:"help-section"},_hoisted_15$1={class:"help-title"},_hoisted_16$1={class:"help-desc"},_hoisted_17={class:"help-highlight"},_hoisted_18={class:"help-section"},_hoisted_19={class:"help-title"},_hoisted_20={class:"help-desc"},_hoisted_21={class:"preview-actions"},_hoisted_22={class:"preview-content"},_hoisted_23={class:"config-footer"},_hoisted_24={class:"footer-hints"},_hoisted_25={class:"hint-item"},_hoisted_26={class:"hint-item"},_hoisted_27={class:"hint-item"},_hoisted_28={class:"footer-actions"},_sfc_main$o=defineComponent({name:"WatermarkConfig",__name:"index",props:{visible:{type:Boolean},config:{default:()=>({...DEFAULT_WATERMARK_CONFIG})},previewImage:{default:void 0}},emits:["update:visible","confirm","cancel"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),toast=useToast(),props=__props,emit=__emit,localVisible=ref(props.visible),localConfig=ref({...props.config,enabled:!0});watch(()=>props.visible,newValue=>{localVisible.value=newValue,newValue&&(localConfig.value={...props.config,enabled:!0})}),watch(localVisible,newValue=>{emit("update:visible",newValue)}),watch(()=>props.config,newConfig=>{localConfig.value={...newConfig}},{deep:!0});const handleConfigChange=newConfig=>{localConfig.value={...newConfig}},handleConfirm2=async()=>{const finalConfig={...localConfig.value};let pureBase64="";if(finalConfig.type==="text"&&finalConfig.text&&finalConfig.text.trim())try{const canvasConfig={...finalConfig,targetWidth:1e3,targetHeight:1e3},result=await generateWatermark(canvasConfig);if(result.success&&result.base64Data)pureBase64=result.base64Data.replace(/^data:image\/\w+;base64,/,""),finalConfig.fileBase64=pureBase64;else{const errorMsg=result.error||$t2("components.watermark.errors.generateFailed");toast.error(errorMsg);return}}catch(error2){const errorMsg=error2 instanceof Error?error2.message:$t2("components.watermark.errors.generateException");toast.error(errorMsg);return}else finalConfig.type==="image"&&finalConfig.fileBase64&&(pureBase64=finalConfig.fileBase64);emit("confirm",finalConfig),localVisible.value=!1},handleClose=()=>{emit("cancel"),localVisible.value=!1},clearPreviewImage=()=>{};return(_ctx,_cache)=>{const _component_cyberTooltip=resolveComponent("cyberTooltip"),_component_CyberButton=resolveComponent("CyberButton"),_component_cyberDialog=resolveComponent("cyberDialog");return openBlock(),createBlock(_component_cyberDialog,{modelValue:localVisible.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>localVisible.value=$event),title:unref($t2)("components.watermark.title"),width:"1400px",height:"800px","close-on-click-overlay":!1,onClose:handleClose},{footer:withCtx(()=>[createBaseVNode("div",_hoisted_23,[createBaseVNode("div",_hoisted_24,[createBaseVNode("div",_hoisted_25,[_cache[11]||(_cache[11]=createBaseVNode("i",{class:"fas fa-hand-pointer"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.watermark.footer.hints.dragWatermark")),1)]),createBaseVNode("div",_hoisted_26,[_cache[12]||(_cache[12]=createBaseVNode("i",{class:"fas fa-arrows-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.watermark.footer.hints.dragCorners")),1)]),createBaseVNode("div",_hoisted_27,[_cache[13]||(_cache[13]=createBaseVNode("i",{class:"fas fa-upload"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.watermark.footer.hints.dropImage")),1)])]),createBaseVNode("div",_hoisted_28,[createVNode(_component_CyberButton,{type:"secondary",onClick:handleClose},{default:withCtx(()=>[_cache[14]||(_cache[14]=createBaseVNode("i",{class:"fas fa-times mr-1.5"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("actions.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{type:"primary",onClick:handleConfirm2},{default:withCtx(()=>[_cache[15]||(_cache[15]=createBaseVNode("i",{class:"fas fa-check mr-1.5"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.footer.apply")),1)]),_:1})])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$l,[createBaseVNode("div",_hoisted_2$h,[createBaseVNode("div",_hoisted_3$e,[createBaseVNode("div",_hoisted_4$d,[createBaseVNode("h3",_hoisted_5$a,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-sliders-h mr-2"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.configOptions")),1)])]),createBaseVNode("div",_hoisted_6$7,[createVNode(WatermarkPanel,{config:localConfig.value,onConfigChange:handleConfigChange},null,8,["config"])])]),createBaseVNode("div",_hoisted_7$4,[createBaseVNode("div",_hoisted_8$4,[createBaseVNode("div",_hoisted_9$4,[createBaseVNode("h3",_hoisted_10$2,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-eye mr-2"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.livePreview")),1)]),createVNode(_component_cyberTooltip,{placement:"bottom","max-width":350},{content:withCtx(()=>[createBaseVNode("div",_hoisted_13$2,[createBaseVNode("div",_hoisted_14$1,[createBaseVNode("div",_hoisted_15$1,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-map-pin mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.help.positionTitle")),1)]),createBaseVNode("div",_hoisted_16$1,[createBaseVNode("span",_hoisted_17,toDisplayString(unref($t2)("components.watermark.help.positionFormula")),1),_cache[5]||(_cache[5]=createBaseVNode("br",null,null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.help.positionDesc")),1)])]),createBaseVNode("div",_hoisted_18,[createBaseVNode("div",_hoisted_19,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-keyboard mr-1"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.help.shortcutsTitle")),1)]),createBaseVNode("div",_hoisted_20,[createBaseVNode("kbd",null,toDisplayString(unref($t2)("components.watermark.help.spaceKey")),1),createTextVNode(" + "+toDisplayString(unref($t2)("components.watermark.help.dragCanvas")),1),_cache[7]||(_cache[7]=createBaseVNode("br",null,null,-1)),createBaseVNode("kbd",null,toDisplayString(unref($t2)("components.watermark.help.scrollWheel")),1),createTextVNode("Ôºö"+toDisplayString(unref($t2)("components.watermark.help.zoomCanvas")),1),_cache[8]||(_cache[8]=createBaseVNode("br",null,null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.help.dragWatermark")),1),_cache[9]||(_cache[9]=createBaseVNode("br",null,null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.help.dragCorners")),1)])])])]),default:withCtx(()=>[createBaseVNode("button",_hoisted_11$2,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-question-circle text-sm"},null,-1)),createBaseVNode("span",_hoisted_12$2,toDisplayString(unref($t2)("components.watermark.help.title")),1)])]),_:1})]),createBaseVNode("div",_hoisted_21,[createVNode(_component_CyberButton,{size:"sm",type:"secondary",onClick:clearPreviewImage},{default:withCtx(()=>[_cache[10]||(_cache[10]=createBaseVNode("i",{class:"fas fa-times mr-1.5"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("components.watermark.clearPreview")),1)]),_:1})])]),createBaseVNode("div",_hoisted_22,[createVNode(_sfc_main$p,{config:localConfig.value,"preview-image":__props.previewImage,onConfigChange:handleConfigChange},null,8,["config","preview-image"])])])])])]),_:1},8,["modelValue","title"])}}});const WatermarkConfig=_export_sfc(_sfc_main$o,[["__scopeId","data-v-d9f8c6cb"]]),_hoisted_1$k=["title"],_hoisted_2$g={class:"expiry-text"},_sfc_main$n=defineComponent({name:"ImageExpiryTag",__name:"index",props:{expiresAt:{default:null},storageDuration:{default:""},isTimeLimited:{type:Boolean,default:!1},position:{default:"top-left"},mode:{default:"both"},showIcon:{type:Boolean,default:!0},className:{default:""}},setup(__props){const props=__props,remainingTime=ref(0),timer=ref(null),{$t:$t2}=useTexts(),isVisible=computed(()=>props.isTimeLimited&&props.expiresAt),positionClass=computed(()=>{switch(props.position){case"top-left":return"pos-top-left";case"top-right":return"pos-top-right";case"bottom-left":return"pos-bottom-left";case"bottom-right":return"pos-bottom-right";default:return"pos-top-left"}}),expiryStatus=computed(()=>{if(!remainingTime.value)return"expired";const oneDay=24*60*60*1e3,oneHour=60*60*1e3;return remainingTime.value<=0?"expired":remainingTime.value<=oneHour||remainingTime.value<=oneDay?"expiring-soon":"active"}),statusConfig=computed(()=>({expired:{color:"var(--color-error-500)",bgColor:"rgba(var(--color-error-rgb), 0.15)",borderColor:"rgba(var(--color-error-rgb), 0.3)",icon:"fas fa-exclamation-triangle",text:$t2("components.fileExpiryTag.statuses.expired")},"expiring-soon":{color:"var(--color-warning-500)",bgColor:"rgba(var(--color-warning-rgb), 0.15)",borderColor:"rgba(var(--color-warning-rgb), 0.3)",icon:"fas fa-clock",text:$t2("components.fileExpiryTag.statuses.expiringSoon")},active:{color:"var(--color-brand-500)",bgColor:"rgba(var(--color-brand-500-rgb), 0.15)",borderColor:"rgba(var(--color-brand-500-rgb), 0.3)",icon:"fas fa-hourglass-half",text:$t2("components.fileExpiryTag.statuses.active")}})[expiryStatus.value]),statusClass=computed(()=>`status-${expiryStatus.value}`),remainingText=computed(()=>{if(!remainingTime.value||remainingTime.value<=0)return $t2("components.fileExpiryTag.statuses.expired");const dayUnit=$t2("components.fileExpiryTag.units.day"),hourUnit=$t2("components.fileExpiryTag.units.hour"),minuteUnit=$t2("components.fileExpiryTag.units.minute"),days=Math.floor(remainingTime.value/(24*60*60*1e3)),hours=Math.floor(remainingTime.value%(24*60*60*1e3)/(60*60*1e3)),minutes=Math.floor(remainingTime.value%(60*60*1e3)/(60*1e3));return days>0?`${days}${dayUnit}${hours}${hourUnit}`:hours>0?`${hours}${hourUnit}${minutes}${minuteUnit}`:`${minutes}${minuteUnit}`}),durationText=computed(()=>{if(!props.storageDuration)return"";const unitDay=$t2("components.fileExpiryTag.units.day"),unitHour=$t2("components.fileExpiryTag.units.hour"),unitMinute=$t2("components.fileExpiryTag.units.minute"),duration=props.storageDuration.toLowerCase();return duration.includes("d")?duration.replace("d",unitDay):duration.includes("h")?duration.replace("h",unitHour):duration.includes("m")?duration.replace("m",unitMinute):props.storageDuration}),displayText=computed(()=>props.mode==="countdown"?remainingText.value:props.mode==="duration"?durationText.value||remainingText.value||statusConfig.value.text:durationText.value&&expiryStatus.value!=="expired"?`${durationText.value} (${remainingText.value})`:remainingText.value),tooltipText=computed(()=>{if(!props.expiresAt)return"";const formattedDate=new Date(props.expiresAt).toLocaleString(getCurrentLocale()),expiredPrefix=$t2("components.fileExpiryTag.labels.expiredAtPrefix"),expiredSuffix=$t2("components.fileExpiryTag.labels.expiredAtSuffix"),storageDurationLabel=$t2("components.fileExpiryTag.labels.storageDuration"),expiresAtLabel=$t2("components.fileExpiryTag.labels.expiresAt");return expiryStatus.value==="expired"?`${expiredPrefix} ${formattedDate} ${expiredSuffix}`:durationText.value?`${storageDurationLabel}: ${durationText.value}
${expiresAtLabel}: ${formattedDate}`:`${expiresAtLabel}: ${formattedDate}`}),updateRemainingTime=()=>{if(!props.expiresAt){remainingTime.value=0;return}const expiryDate=new Date(props.expiresAt).getTime(),now=Date.now();remainingTime.value=expiryDate-now},startTimer=()=>{props.expiresAt&&(updateRemainingTime(),remainingTime.value>0&&(timer.value=window.setInterval(updateRemainingTime,60*1e3)))},clearTimer=()=>{timer.value&&(window.clearInterval(timer.value),timer.value=null)};return onMounted(()=>{startTimer()}),onUnmounted(()=>{clearTimer()}),watch([()=>props.expiresAt,()=>props.isTimeLimited],()=>{clearTimer(),isVisible.value&&startTimer()},{immediate:!0}),(_ctx,_cache)=>isVisible.value?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["cyber-file-expiry-tag",[positionClass.value,statusClass.value,props.className]]),title:tooltipText.value},[__props.showIcon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([statusConfig.value.icon,"expiry-icon"])},null,2)):createCommentVNode("",!0),createBaseVNode("span",_hoisted_2$g,toDisplayString(displayText.value),1)],10,_hoisted_1$k)):createCommentVNode("",!0)}});const ImageExpiryTag=_export_sfc(_sfc_main$n,[["__scopeId","data-v-5165033a"]]),_hoisted_1$j={class:"header-left"},_hoisted_2$f={class:"title-section"},_hoisted_3$d={class:"title-text"},_hoisted_4$c={key:0,class:"subtitle"},_sfc_main$m=defineComponent({__name:"AdminWrapperHeader",props:{title:{},subtitle:{},icon:{},compact:{type:Boolean},hasTopbar:{type:Boolean}},setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("header",{class:normalizeClass(["layout-header",{compact:__props.compact}])},[createBaseVNode("div",{class:normalizeClass(["header-main",{compact:__props.compact}])},[createBaseVNode("div",_hoisted_1$j,[createBaseVNode("div",_hoisted_2$f,[createBaseVNode("h1",{class:normalizeClass(["page-title",{compact:__props.compact}])},[renderSlot(_ctx.$slots,"icon",{},()=>[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([__props.icon,"title-icon",{compact:__props.compact}])},null,2)):createCommentVNode("",!0)],!0),createBaseVNode("span",_hoisted_3$d,[renderSlot(_ctx.$slots,"title",{},()=>[createTextVNode(toDisplayString(__props.title),1)],!0)])],2),_ctx.$slots.subtitle||__props.subtitle?(openBlock(),createElementBlock("div",_hoisted_4$c,[renderSlot(_ctx.$slots,"subtitle",{},()=>[createTextVNode(toDisplayString(__props.subtitle),1)],!0)])):createCommentVNode("",!0)])]),_ctx.$slots.actions?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["header-actions",{compact:__props.compact}])},[renderSlot(_ctx.$slots,"actions",{},void 0,!0)],2)):createCommentVNode("",!0)],2),__props.hasTopbar?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["header-topbar",{compact:__props.compact}])},[renderSlot(_ctx.$slots,"topbar",{},void 0,!0)],2)):createCommentVNode("",!0)],2))}});const AdminWrapperHeader=_export_sfc(_sfc_main$m,[["__scopeId","data-v-04b73f7b"]]),_hoisted_1$i={key:0,class:"admin-layout-sidebar"},_hoisted_2$e={class:"sidebar-content"},_hoisted_3$c={key:0,class:"content-toolbar"},_hoisted_4$b={key:0,class:"content-toolbar"},_sfc_main$l=defineComponent({__name:"AdminWrapperContent",props:{sidebarLayout:{type:Boolean,default:!1},contentPadding:{default:"1.5rem"},compact:{type:Boolean,default:!1}},setup(__props){return useCssVars(_ctx=>({v710a8fac:_ctx.contentPadding})),(_ctx,_cache)=>(openBlock(),createElementBlock("main",{class:normalizeClass(["admin-layout-content",{"sidebar-layout":__props.sidebarLayout}])},[__props.sidebarLayout?(openBlock(),createElementBlock(Fragment,{key:0},[_ctx.$slots.sidebar?(openBlock(),createElementBlock("aside",_hoisted_1$i,[renderSlot(_ctx.$slots,"sidebar",{},void 0,!0)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_2$e,[_ctx.$slots.toolbar?(openBlock(),createElementBlock("div",_hoisted_3$c,[renderSlot(_ctx.$slots,"toolbar",{},void 0,!0)])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["main-content",{compact:__props.compact}])},[renderSlot(_ctx.$slots,"default",{},()=>[renderSlot(_ctx.$slots,"content",{},void 0,!0)],!0)],2)])],64)):(openBlock(),createElementBlock(Fragment,{key:1},[_ctx.$slots.toolbar?(openBlock(),createElementBlock("div",_hoisted_4$b,[renderSlot(_ctx.$slots,"toolbar",{},void 0,!0)])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["main-content",{compact:__props.compact}])},[renderSlot(_ctx.$slots,"default",{},()=>[renderSlot(_ctx.$slots,"content",{},void 0,!0)],!0)],2)],64))],2))}});const AdminWrapperContent=_export_sfc(_sfc_main$l,[["__scopeId","data-v-1e782ea7"]]),_hoisted_1$h=["data-compact"],_sfc_main$k=defineComponent({name:"CyberAdminWrapper",__name:"index",props:{title:{},subtitle:{},icon:{},compact:{type:Boolean,default:!1},contentPadding:{default:"1.5rem"},sidebarLayout:{type:Boolean,default:!1},showTopbar:{type:Boolean,default:!1}},setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"cyber-admin-wrapper","data-compact":__props.compact},[createVNode(AdminWrapperHeader,{title:__props.title,subtitle:__props.subtitle,icon:__props.icon,compact:__props.compact,"has-topbar":__props.showTopbar},createSlots({icon:withCtx(()=>[renderSlot(_ctx.$slots,"icon",{},void 0,!0)]),title:withCtx(()=>[renderSlot(_ctx.$slots,"title",{},void 0,!0)]),subtitle:withCtx(()=>[renderSlot(_ctx.$slots,"subtitle",{},void 0,!0)]),stats:withCtx(()=>[renderSlot(_ctx.$slots,"stats",{},void 0,!0)]),actions:withCtx(()=>[renderSlot(_ctx.$slots,"actions",{},void 0,!0)]),_:2},[__props.showTopbar?{name:"topbar",fn:withCtx(()=>[renderSlot(_ctx.$slots,"topbar",{},void 0,!0)]),key:"0"}:void 0]),1032,["title","subtitle","icon","compact","has-topbar"]),createVNode(AdminWrapperContent,{"sidebar-layout":__props.sidebarLayout,"content-padding":__props.contentPadding,compact:__props.compact},{sidebar:withCtx(()=>[renderSlot(_ctx.$slots,"sidebar",{},void 0,!0)]),toolbar:withCtx(()=>[renderSlot(_ctx.$slots,"toolbar",{},void 0,!0)]),default:withCtx(()=>[renderSlot(_ctx.$slots,"default",{},void 0,!0)]),content:withCtx(()=>[renderSlot(_ctx.$slots,"content",{},void 0,!0)]),_:3},8,["sidebar-layout","content-padding","compact"])],8,_hoisted_1$h))}});const CyberAdminWrapper=_export_sfc(_sfc_main$k,[["__scopeId","data-v-a370262c"]]),_hoisted_1$g={class:"cyber-side-nav-layout"},_hoisted_2$d={class:"side-nav-header"},_hoisted_3$b={class:"header-content"},_hoisted_4$a={class:"header-left"},_hoisted_5$9={class:"title-section"},_hoisted_6$6={class:"page-title"},_hoisted_7$3={key:1,class:"page-subtitle"},_hoisted_8$3={key:0,class:"header-actions"},_hoisted_9$3={class:"side-nav-main-content"},_hoisted_10$1={class:"side-nav-sidebar"},_hoisted_11$1={class:"nav-menu"},_hoisted_12$1=["onClick"],_hoisted_13$1={class:"nav-label"},_hoisted_14={key:1,class:"nav-badge"},_hoisted_15={class:"side-nav-content-area"},_hoisted_16={class:"content-wrapper"},_sfc_main$j=defineComponent({name:"CyberSideNavTabs",__name:"index",props:{title:{},subtitle:{},icon:{},tabs:{},activeTab:{default:""},syncWithUrl:{type:Boolean,default:!1},urlParamName:{default:"tab"}},emits:["update:activeTab","tab-change","change"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,visibleTabs=computed(()=>props.tabs.filter(tab=>tab.visible!==!1)),handleTabClick=tab=>{if(tab.disabled)return;const tabKey=tab.key||tab.id||"";emit("update:activeTab",tabKey),emit("tab-change",tabKey,tab),emit("change",tabKey)};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$g,[createBaseVNode("div",_hoisted_2$d,[createBaseVNode("div",_hoisted_3$b,[createBaseVNode("div",_hoisted_4$a,[createBaseVNode("div",_hoisted_5$9,[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([__props.icon,"title-icon"])},null,2)):createCommentVNode("",!0),createBaseVNode("h1",_hoisted_6$6,toDisplayString(__props.title),1),__props.subtitle?(openBlock(),createElementBlock("div",_hoisted_7$3,toDisplayString(__props.subtitle),1)):createCommentVNode("",!0)])]),_ctx.$slots.actions?(openBlock(),createElementBlock("div",_hoisted_8$3,[renderSlot(_ctx.$slots,"actions",{},void 0,!0)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_9$3,[createBaseVNode("div",_hoisted_10$1,[createBaseVNode("nav",_hoisted_11$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(visibleTabs.value,tab=>(openBlock(),createElementBlock("div",{key:tab.key||tab.id,class:normalizeClass(["nav-item",{active:__props.activeTab===(tab.key||tab.id)}]),onClick:$event=>handleTabClick(tab)},[tab.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([tab.icon,"nav-icon"])},null,2)):createCommentVNode("",!0),createBaseVNode("span",_hoisted_13$1,toDisplayString(tab.name||tab.label),1),tab.badge?(openBlock(),createElementBlock("span",_hoisted_14,toDisplayString(tab.badge),1)):createCommentVNode("",!0),_cache[0]||(_cache[0]=createBaseVNode("div",{class:"nav-indicator"},null,-1))],10,_hoisted_12$1))),128))])]),createBaseVNode("div",_hoisted_15,[createBaseVNode("div",_hoisted_16,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])])])]))}});const CyberSideNavTabs=_export_sfc(_sfc_main$j,[["__scopeId","data-v-075171f4"]]),_hoisted_1$f={class:"nav-menu"},_hoisted_2$c=["onClick"],_hoisted_3$a={class:"nav-label"},_hoisted_4$9={key:1,class:"nav-badge"},_sfc_main$i=defineComponent({name:"CyberSidebarNav",__name:"index",props:{tabs:{},activeTab:{}},emits:["tab-change"],setup(__props,{emit:__emit}){const emit=__emit,handleTabClick=tab=>{emit("tab-change",tab.key)};return(_ctx,_cache)=>(openBlock(),createElementBlock("nav",_hoisted_1$f,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.tabs,tab=>(openBlock(),createElementBlock("div",{key:tab.key,class:normalizeClass(["nav-item",{active:__props.activeTab===tab.key}]),onClick:$event=>handleTabClick(tab)},[tab.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([tab.icon,"nav-icon"])},null,2)):createCommentVNode("",!0),createBaseVNode("span",_hoisted_3$a,toDisplayString(tab.name),1),tab.badge&&tab.badge!=="0"?(openBlock(),createElementBlock("span",_hoisted_4$9,toDisplayString(tab.badge),1)):createCommentVNode("",!0),_cache[0]||(_cache[0]=createBaseVNode("div",{class:"nav-indicator"},null,-1))],10,_hoisted_2$c))),128))]))}});const __unplugin_components_0$2=_export_sfc(_sfc_main$i,[["__scopeId","data-v-dc4b7612"]]),_hoisted_1$e=["disabled","onClick","onKeydown"],_hoisted_2$b={class:"header-content"},_hoisted_3$9={class:"header-icon-wrapper"},_hoisted_4$8={class:"header-text"},_hoisted_5$8={class:"header-title"},_hoisted_6$5={class:"toggle-area"},_hoisted_7$2={class:"content-wrapper"},_hoisted_8$2={class:"content-inner"},_hoisted_9$2=["innerHTML"],_sfc_main$h=defineComponent({name:"CyberAccordion",__name:"index",props:{items:{},modelValue:{default:null},multiple:{type:Boolean,default:!1},expandedItems:{default:()=>[]},bordered:{type:Boolean,default:!0},gap:{default:"8px"},animationDuration:{default:250},card:{type:Boolean,default:!0},size:{default:"medium"}},emits:["update:modelValue","update:expandedItems","item-click","item-expand","item-collapse"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,isItemActive=itemId=>props.multiple?props.expandedItems.includes(itemId):props.modelValue===itemId,handleToggle=item=>{if(item.disabled)return;const isExpanded=props.multiple?props.expandedItems.includes(item.id):props.modelValue===item.id;if(props.multiple){const newItems=[...props.expandedItems];if(isExpanded){const index2=newItems.indexOf(item.id);index2>-1&&newItems.splice(index2,1)}else newItems.push(item.id);emit("update:expandedItems",newItems)}else emit("update:modelValue",isExpanded?null:item.id);emit("item-click",item,!isExpanded),emit(isExpanded?"item-collapse":"item-expand",item)},getContentStyle=itemId=>isItemActive(itemId)?{"--expand-duration":`${props.animationDuration}ms`}:{"--expand-duration":"0ms"};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["cyber-accordion-v2",[`cyber-accordion-v2--${__props.size}`,{"cyber-accordion-v2--bordered":__props.bordered},__props.size==="small"?"text-sm":__props.size==="large"?"text-lg":"text-base"]]),style:normalizeStyle({gap:__props.gap})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.items,(item,index2)=>(openBlock(),createElementBlock("div",{key:item.id,class:normalizeClass(["accordion-item",{"accordion-item--active":isItemActive(item.id),"accordion-item--disabled":item.disabled}])},[createBaseVNode("button",{class:"accordion-header",disabled:item.disabled,onClick:$event=>handleToggle(item),onKeydown:[withKeys($event=>handleToggle(item),["enter"]),withKeys(withModifiers($event=>handleToggle(item),["prevent"]),["space"])]},[createBaseVNode("div",_hoisted_2$b,[createBaseVNode("div",_hoisted_3$9,[item.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([item.icon,"header-icon"])},null,2)):createCommentVNode("",!0),_cache[0]||(_cache[0]=createBaseVNode("div",{class:"icon-glow"},null,-1))]),createBaseVNode("div",_hoisted_4$8,[createBaseVNode("h3",_hoisted_5$8,toDisplayString(item.title),1),_cache[1]||(_cache[1]=createBaseVNode("div",{class:"header-line"},null,-1))])]),createBaseVNode("div",_hoisted_6$5,[createBaseVNode("div",{class:normalizeClass(["toggle-icon",{"toggle-icon--rotated":isItemActive(item.id)}])},[..._cache[2]||(_cache[2]=[createBaseVNode("div",{class:"chevron-line chevron-line--1"},null,-1),createBaseVNode("div",{class:"chevron-line chevron-line--2"},null,-1)])],2),_cache[3]||(_cache[3]=createBaseVNode("div",{class:"toggle-glow"},null,-1))])],40,_hoisted_1$e),createBaseVNode("div",{class:normalizeClass(["accordion-content",{"accordion-content--expanded":isItemActive(item.id)}]),style:normalizeStyle(getContentStyle(item.id))},[createBaseVNode("div",_hoisted_7$2,[createBaseVNode("div",_hoisted_8$2,[renderSlot(_ctx.$slots,"default",{item,index:index2,expanded:isItemActive(item.id)},()=>[item.content?(openBlock(),createElementBlock("div",{key:0,class:"default-content",innerHTML:item.content},null,8,_hoisted_9$2)):createCommentVNode("",!0)],!0)]),_cache[4]||(_cache[4]=createBaseVNode("div",{class:"content-glow"},null,-1))])],6)],2))),128))],6))}});const CyberAccordion=_export_sfc(_sfc_main$h,[["__scopeId","data-v-3fd56676"]]),_hoisted_1$d={class:"skeleton-info"},_hoisted_2$a={key:0,class:"skeleton skeleton-text subtitle"},_hoisted_3$8={key:1,class:"skeleton-tags"},_hoisted_4$7={key:2,class:"skeleton-actions"},_hoisted_5$7={key:1,class:"skeleton-table"},_sfc_main$g=defineComponent({name:"CyberSkeleton",__name:"index",props:{type:{},size:{default:"normal"},count:{},loading:{type:Boolean,default:!0},animation:{default:"wave"},simple:{type:Boolean,default:!1}},setup(__props){const props=__props,actualCount=computed(()=>{if(props.count)return props.count;switch(props.type){case"card":return 6;case"table":return 5;case"list":return 3;default:return 3}});return(_ctx,_cache)=>__props.loading?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["cyber-skeleton-container",[`type-${__props.type}`,`size-${__props.size}`,`animation-${__props.animation}`]])},[__props.type==="card"?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(actualCount.value,i=>(openBlock(),createElementBlock("div",{key:i,class:"skeleton-card"},[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"skeleton skeleton-image"},null,-1)),createBaseVNode("div",_hoisted_1$d,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"skeleton skeleton-text title"},null,-1)),__props.simple?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_2$a)),__props.simple?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_3$8,[..._cache[0]||(_cache[0]=[createBaseVNode("div",{class:"skeleton skeleton-tag"},null,-1),createBaseVNode("div",{class:"skeleton skeleton-tag"},null,-1),createBaseVNode("div",{class:"skeleton skeleton-tag small"},null,-1)])])),__props.simple?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_4$7,[..._cache[1]||(_cache[1]=[createStaticVNode('<div class="skeleton skeleton-text date" data-v-646d3511></div><div class="skeleton-buttons" data-v-646d3511><div class="skeleton skeleton-btn" data-v-646d3511></div><div class="skeleton skeleton-btn" data-v-646d3511></div><div class="skeleton skeleton-btn" data-v-646d3511></div></div>',2)])]))])]))),128)):createCommentVNode("",!0),__props.type==="table"?(openBlock(),createElementBlock("div",_hoisted_5$7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(actualCount.value,i=>(openBlock(),createElementBlock("div",{key:i,class:"skeleton-table-row"},[..._cache[4]||(_cache[4]=[createStaticVNode('<div class="skeleton skeleton-cell" data-v-646d3511></div><div class="skeleton skeleton-cell" data-v-646d3511></div><div class="skeleton skeleton-cell" data-v-646d3511></div><div class="skeleton skeleton-cell" data-v-646d3511></div><div class="skeleton skeleton-cell small" data-v-646d3511></div>',5)])]))),128))])):createCommentVNode("",!0),__props.type==="list"?(openBlock(!0),createElementBlock(Fragment,{key:2},renderList(actualCount.value,i=>(openBlock(),createElementBlock("div",{key:i,class:"skeleton-list-item"},[..._cache[5]||(_cache[5]=[createBaseVNode("div",{class:"skeleton skeleton-avatar"},null,-1),createBaseVNode("div",{class:"skeleton-content"},[createBaseVNode("div",{class:"skeleton skeleton-text title"}),createBaseVNode("div",{class:"skeleton skeleton-text subtitle"})],-1)])]))),128)):createCommentVNode("",!0)],2)):createCommentVNode("",!0)}});const __unplugin_components_0$1=_export_sfc(_sfc_main$g,[["__scopeId","data-v-646d3511"]]),_hoisted_1$c=["data-loading"],_hoisted_2$9={class:"stats-container"},_hoisted_3$7={class:"stats-icon"},_hoisted_4$6={class:"stats-content"},_hoisted_5$6={class:"stats-value"},_hoisted_6$4={class:"stats-label"},_sfc_main$f=defineComponent({name:"CyberStatsCard",__name:"index",props:{value:{},label:{},icon:{},loading:{type:Boolean,default:!1}},setup(__props){const props=__props,formattedValue=computed(()=>props.loading?"---":typeof props.value=="number"?props.value.toLocaleString():props.value);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"stats-card","data-loading":__props.loading},[createBaseVNode("div",_hoisted_2$9,[createBaseVNode("div",_hoisted_3$7,[createBaseVNode("i",{class:normalizeClass(__props.icon)},null,2)]),createBaseVNode("div",_hoisted_4$6,[createBaseVNode("div",_hoisted_5$6,toDisplayString(formattedValue.value),1),createBaseVNode("div",_hoisted_6$4,toDisplayString(__props.label),1)])])],8,_hoisted_1$c))}});const StatsCard=_export_sfc(_sfc_main$f,[["__scopeId","data-v-d20dccdc"]]);StatsCard.install=app=>{app.component("CyberStatsCard",StatsCard)};const _hoisted_1$b={class:"stats-section"},_hoisted_2$8={class:"stats-grid"},_sfc_main$e=defineComponent({name:"CyberStatsSection",__name:"index",setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$b,[createBaseVNode("div",_hoisted_2$8,[renderSlot(_ctx.$slots,"default",{},void 0,!0)])]))}});const StatsSection=_export_sfc(_sfc_main$e,[["__scopeId","data-v-8ca28adc"]]);StatsSection.install=app=>{app.component("CyberStatsSection",StatsSection)};function getAccessLevelTitle(type,level){const{$t:$t2}=useTexts();return`${$t2(`access.levels.${level}`)}${$t2(`access.types.${type}`)} - ${$t2("access.actions.toggle")}`}const ACCESS_LEVEL_ICONS={private:"fas fa-lock",protected:"fas fa-shield-alt",public:"fas fa-globe"},_hoisted_1$a=["title"],_sfc_main$d=defineComponent({name:"AccessLevelToggle",__name:"index",props:{accessLevel:{},type:{default:"image"},size:{default:"medium"},disabled:{type:Boolean,default:!1}},emits:["toggle"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,handleToggle=()=>{props.disabled||emit("toggle")},sizeBox={small:"w-5 h-5",medium:"w-6 h-6",large:"w-7 h-7"},sizeIcon={small:"text-[9px]",medium:"text-[10px]",large:"text-[11px]"},levelBase={private:"border border-[rgba(var(--color-error-rgb),0.4)] bg-[rgba(var(--color-error-rgb),0.2)]",public:"border border-[rgba(var(--color-success-rgb),0.4)] bg-[rgba(var(--color-success-rgb),0.2)]",protected:"border border-[rgba(var(--color-warning-rgb),0.4)] bg-[rgba(var(--color-warning-rgb),0.2)]"},levelHover={private:"hover:border-[rgba(var(--color-error-rgb),0.9)] hover:bg-[rgba(var(--color-error-rgb),0.25)] hover:shadow-[0_0_8px_rgba(var(--color-error-rgb),0.3)]",public:"hover:border-[rgba(var(--color-success-rgb),0.9)] hover:bg-[rgba(var(--color-success-rgb),0.25)] hover:shadow-[0_0_8px_rgba(var(--color-success-rgb),0.3)]",protected:"hover:border-[rgba(var(--color-warning-rgb),0.9)] hover:bg-[rgba(var(--color-warning-rgb),0.25)] hover:shadow-[0_0_8px_rgba(var(--color-warning-rgb),0.3)]"},iconColor={private:"text-[rgb(var(--color-error-rgb))]",public:"text-[rgb(var(--color-success-rgb))]",protected:"text-[rgb(var(--color-warning-rgb))]"},iconHover={private:"group-hover:[text-shadow:0_0_8px_rgba(var(--color-error-rgb),0.8)]",public:"group-hover:[text-shadow:0_0_8px_rgba(var(--color-success-rgb),0.8)]",protected:"group-hover:[text-shadow:0_0_8px_rgba(var(--color-warning-rgb),0.8)]"};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["group absolute right-2 top-2 z-[5] flex items-center justify-center rounded-full backdrop-blur-sm transition-all duration-200 ease-in-out",[sizeBox[__props.size],"bg-[rgba(var(--color-background-900-rgb),0.4)]",levelBase[__props.accessLevel],__props.disabled?"cursor-not-allowed opacity-50":"cursor-pointer hover:scale-105",!__props.disabled&&levelHover[__props.accessLevel]]]),title:unref(getAccessLevelTitle)(__props.type,__props.accessLevel),onClick:withModifiers(handleToggle,["stop"])},[createBaseVNode("i",{class:normalizeClass([unref(ACCESS_LEVEL_ICONS)[__props.accessLevel],sizeIcon[__props.size],iconColor[__props.accessLevel],"transition-all duration-200 [text-shadow:0_1px_2px_rgba(0,0,0,0.5)]",!__props.disabled&&iconHover[__props.accessLevel]])},null,2)],10,_hoisted_1$a))}}),_hoisted_1$9=["title"],_sfc_main$c=defineComponent({name:"CyberTag",__name:"index",props:{variant:{default:"primary"},size:{default:"small"},closable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},round:{type:Boolean,default:!1},truncate:{type:Boolean}},emits:["close","click"],setup(__props){const props=__props,getVariantClasses=()=>{switch(props.variant){case"success":return"tag-success";case"warning":return"tag-warning";case"error":return"tag-error";case"info":return"tag-info";case"secondary":return"tag-secondary";case"outline":return"bg-transparent text-brand-500 border-brand-500";case"primary":default:return"tag-primary"}},getSizeClasses=()=>{switch(props.size){case"large":return"px-3 py-1.5 text-sm";case"medium":return"px-2.5 py-1 text-sm";case"small":default:return"px-1.5 py-0.5"}};return(_ctx,_cache)=>(openBlock(),createElementBlock("span",{class:normalizeClass(["cyber-tag inline-flex items-center gap-1 border transition-all duration-200",[getVariantClasses(),getSizeClasses(),{"rounded-full":__props.round,rounded:!__props.round,"cursor-not-allowed opacity-50":__props.disabled,"cursor-pointer hover:opacity-80":!__props.disabled,"max-w-20 overflow-hidden text-ellipsis whitespace-nowrap":props.truncate}]]),title:__props.truncate?String(_ctx.$slots.default?.()[0]?.children||""):void 0,onClick:_cache[1]||(_cache[1]=$event=>!__props.disabled&&_ctx.$emit("click"))},[renderSlot(_ctx.$slots,"default",{},void 0,!0),__props.closable&&!__props.disabled?(openBlock(),createElementBlock("i",{key:0,class:"fas fa-times cursor-pointer text-xs hover:opacity-70",onClick:_cache[0]||(_cache[0]=withModifiers($event=>_ctx.$emit("close"),["stop"]))})):createCommentVNode("",!0)],10,_hoisted_1$9))}});const Tag=_export_sfc(_sfc_main$c,[["__scopeId","data-v-aedc9591"]]),_hoisted_1$8={class:"flex items-center gap-1 whitespace-nowrap"},_sfc_main$b=defineComponent({name:"SmartTagContainer",__name:"index",props:{tags:{},variant:{default:"primary"},size:{default:"small"},truncate:{type:Boolean,default:!0},minTags:{default:1},moreVariant:{default:"secondary"}},emits:["tag-click"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,containerRef=ref(),measureRef=ref(),visibleTagCount=ref(props.tags.length),calculateVisibleTags=async()=>{if(!containerRef.value||!measureRef.value||props.tags.length===0)return;await nextTick();const containerWidth=containerRef.value.offsetWidth,gap=4;if(props.tags.length===0){visibleTagCount.value=0;return}const measureTags=measureRef.value.querySelectorAll(".cyber-tag");if(measureTags.length===0){visibleTagCount.value=props.tags.length;return}let allTagsWidth=0;for(let i=0;i<measureTags.length;i++){const tagElement=measureTags[i];tagElement&&(allTagsWidth+=tagElement.offsetWidth,i>0&&(allTagsWidth+=gap))}if(allTagsWidth<=containerWidth){visibleTagCount.value=props.tags.length;return}const estimatedMoreTagWidth=50;let totalTagsWidth=0,visibleCount=0;for(let i=0;i<measureTags.length;i++){const tagElement=measureTags[i];if(!tagElement)continue;const tagWidth=tagElement.offsetWidth,gapWidth=visibleCount>0?gap:0,newTotalWidth=totalTagsWidth+gapWidth+tagWidth;if(newTotalWidth+gap+estimatedMoreTagWidth<=containerWidth)totalTagsWidth=newTotalWidth,visibleCount++;else{totalTagsWidth+gapWidth+30+gap+estimatedMoreTagWidth<=containerWidth&&props.truncate&&visibleCount++;break}}const finalVisibleCount=Math.max(visibleCount,props.minTags);visibleTagCount.value=finalVisibleCount},visibleTags=computed(()=>props.tags.slice(0,visibleTagCount.value)),remainingCount=computed(()=>Math.max(0,props.tags.length-visibleTagCount.value)),showMoreButton=computed(()=>remainingCount.value>0),handleTagClick=(tag,index2)=>{emit("tag-click",tag,index2)};watch(()=>props.tags,()=>{visibleTagCount.value=props.tags.length,nextTick(()=>{calculateVisibleTags()})},{immediate:!0});let resizeObserver=null;return onMounted(()=>{setTimeout(()=>{calculateVisibleTags()},100),containerRef.value&&ResizeObserver&&(resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{calculateVisibleTags()},10)}),resizeObserver.observe(containerRef.value))}),onUnmounted(()=>{resizeObserver&&containerRef.value&&(resizeObserver.unobserve(containerRef.value),resizeObserver=null)}),(_ctx,_cache)=>{const _component_CyberTag=resolveComponent("CyberTag");return openBlock(),createElementBlock("div",{ref_key:"containerRef",ref:containerRef,class:"smart-tag-container flex w-full items-center gap-1 overflow-hidden"},[(openBlock(!0),createElementBlock(Fragment,null,renderList(visibleTags.value,(tag,index2)=>(openBlock(),createBlock(_component_CyberTag,{key:`visible-${index2}`,variant:__props.variant,size:__props.size,truncate:__props.truncate&&index2===visibleTagCount.value-1&&showMoreButton.value,class:normalizeClass(["flex-shrink-0",{"truncated-tag":__props.truncate&&index2===visibleTagCount.value-1&&showMoreButton.value}]),onClick:$event=>handleTagClick(tag,index2)},{default:withCtx(()=>[createTextVNode(toDisplayString(tag),1)]),_:2},1032,["variant","size","truncate","class","onClick"]))),128)),showMoreButton.value?(openBlock(),createBlock(_component_CyberTag,{key:0,variant:__props.moreVariant,size:__props.size,class:"flex-shrink-0"},{default:withCtx(()=>[createTextVNode(" +"+toDisplayString(remainingCount.value),1)]),_:1},8,["variant","size"])):createCommentVNode("",!0),createBaseVNode("div",{ref_key:"measureRef",ref:measureRef,class:"pointer-events-none invisible absolute left-0 top-0"},[createBaseVNode("div",_hoisted_1$8,[(openBlock(!0),createElementBlock(Fragment,null,renderList(props.tags,(tag,index2)=>(openBlock(),createBlock(_component_CyberTag,{key:`measure-${index2}`,variant:__props.variant,size:__props.size,truncate:!1},{default:withCtx(()=>[createTextVNode(toDisplayString(tag),1)]),_:2},1032,["variant","size"]))),128))])],512)],512)}}});const SmartTagContainer=_export_sfc(_sfc_main$b,[["__scopeId","data-v-ee0d1647"]]),_hoisted_1$7={key:0,class:"nav-section-header"},_hoisted_2$7={class:"nav-section-title"},_hoisted_3$6={class:"section-text"},_hoisted_4$5=["onClick"],_hoisted_5$5={class:"nav-item-icon"},_sfc_main$a=defineComponent({name:"SidebarNav",__name:"SidebarNav",props:{collapsed:{type:Boolean,default:!1}},setup(__props){const{$t:$t2}=useTexts(),route=useRoute(),router2=useRouter(),authStore=useAuthStore(),navSections=computed(()=>[{title:null,items:[{name:$t2("components.sidebar.nav.dashboard"),path:"/dashboard",icon:"fas fa-tachometer-alt"},{name:$t2("components.sidebar.nav.folders"),path:"/folders",icon:"fas fa-folder"},{name:$t2("components.sidebar.nav.resource"),path:"/resource",icon:"fas fa-images"},{name:$t2("components.sidebar.nav.explore"),path:"/explore",icon:"fas fa-compass"},{name:$t2("components.sidebar.nav.upload"),path:"/upload",icon:"fas fa-cloud-upload-alt"},{name:$t2("components.sidebar.nav.messages"),path:"/messages",icon:"fas fa-envelope"},{name:$t2("components.sidebar.nav.shares"),path:"/shares",icon:"fas fa-share-alt"}]},{title:$t2("components.sidebar.nav.management"),icon:"fas fa-cogs",items:[{name:$t2("components.sidebar.nav.tagManage"),path:"/tag-manage",icon:"fas fa-tags"},{name:$t2("components.sidebar.nav.categoryManage"),path:"/category-manage",icon:"fas fa-sitemap"},{name:$t2("components.sidebar.nav.automation"),path:"/automation",icon:"fas fa-robot"},{name:$t2("components.sidebar.nav.openApi"),path:"/open-api",icon:"fas fa-random"}]},{title:$t2("components.sidebar.nav.system"),icon:"fas fa-cog",items:[{name:$t2("components.sidebar.nav.settings"),path:"/settings",icon:"fas fa-user-cog"}]}]),filteredNavSections=computed(()=>navSections.value.map(section=>{if(section.requiresAdmin&&!authStore.isAdmin)return null;const filteredItems=section.items.filter(item=>!item.requiresAdmin||authStore.isAdmin);return{...section,items:filteredItems}}).filter(section=>section!==null&&section.items.length>0)),isActive=path=>path==="/dashboard"?route.path==="/dashboard"||route.path==="/":route.path.startsWith(path),navigateTo=path=>{router2.push(path)};return(_ctx,_cache)=>{const _component_CyberTooltip=resolveComponent("CyberTooltip");return openBlock(),createElementBlock("div",{class:normalizeClass(["sidebar-nav-container",{"no-padding":__props.collapsed}])},[(openBlock(!0),createElementBlock(Fragment,null,renderList(filteredNavSections.value,(section,index2)=>(openBlock(),createElementBlock("div",{key:section.title||`section-${index2}`,class:normalizeClass(["nav-section",{"nav-section-collapsed":__props.collapsed}])},[!__props.collapsed&&section.title?(openBlock(),createElementBlock("div",_hoisted_1$7,[createBaseVNode("div",_hoisted_2$7,[createBaseVNode("i",{class:normalizeClass([section.icon,"section-icon"])},null,2),createBaseVNode("span",_hoisted_3$6,toDisplayString(section.title),1)])])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["nav-items",{"nav-items-collapsed":__props.collapsed}])},[(openBlock(!0),createElementBlock(Fragment,null,renderList(section.items,item=>(openBlock(),createBlock(_component_CyberTooltip,{key:item.path,content:item.name,placement:"right",disabled:!__props.collapsed},{default:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["nav-item",[{"nav-item-active":isActive(item.path)},{"nav-item-collapsed":__props.collapsed}]]),onClick:$event=>navigateTo(item.path)},[createBaseVNode("div",_hoisted_5$5,[createBaseVNode("i",{class:normalizeClass(item.icon)},null,2)]),createBaseVNode("span",{class:normalizeClass(["nav-item-text",{"nav-text-collapsed":__props.collapsed}])},toDisplayString(item.name),3)],10,_hoisted_4$5)]),_:2},1032,["content","disabled"]))),128))],2)],2))),128))],2)}}});const SidebarNav=_export_sfc(_sfc_main$a,[["__scopeId","data-v-080aadfb"]]),_hoisted_1$6={class:"sidebar-content"},_hoisted_2$6={class:"sidebar-header"},_hoisted_3$5={class:"sidebar-nav"},_hoisted_4$4={class:"sidebar-footer"},_hoisted_5$4={key:0,class:"layout-toggle-wrapper"},_sfc_main$9=defineComponent({name:"CyberSidebar",__name:"index",setup(__props){const{$t:$t2}=useTexts(),layoutStore=useLayoutStore(),{socialLinks,layoutSettings,loadSettings}=useAppearanceSettings(),communityDialogRef=ref(),qqGroupDialogRef=ref(),sidebarStyle=computed(()=>({width:`${layoutStore.currentSidebarWidth}px`,transform:layoutStore.isLeftLayout?"translateX(0)":"translateX(-100%)"})),isCollapsed=computed(()=>layoutStore.sidebarCollapsed),buttonLayout=computed(()=>{let count=1;if(layoutSettings.value.multiLayoutEnabled&&count++,socialLinks.value.official.show&&count++,socialLinks.value.github.show&&count++,socialLinks.value.wechat.show&&socialLinks.value.wechat.hasConfig&&count++,socialLinks.value.qq.show&&socialLinks.value.qq.hasConfig&&count++,count<=5)return{totalCount:count,rows:1,firstRowCount:count,secondRowCount:0,gridColumns:count};{const firstRowCount=Math.ceil(count/2),secondRowCount=count-firstRowCount;return{totalCount:count,rows:2,firstRowCount,secondRowCount,gridColumns:Math.max(firstRowCount,secondRowCount)}}}),openGitHub=()=>{window.open(socialLinks.value.github.url,"_blank")},openOfficialSite=()=>{window.open(socialLinks.value.official.url,"_blank")},showCommunityDialog=()=>{communityDialogRef.value?.show()},showQQGroupDialog=()=>{qqGroupDialogRef.value?.show()};return onMounted(async()=>{await loadSettings()}),(_ctx,_cache)=>{const _component_CyberLayoutToggleButton=resolveComponent("CyberLayoutToggleButton"),_component_CyberIconButton=resolveComponent("CyberIconButton"),_component_CyberCommunityDialog=resolveComponent("CyberCommunityDialog");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["cyber-sidebar",{"sidebar-collapsed":isCollapsed.value,"sidebar-expanded":!isCollapsed.value}]),style:normalizeStyle(sidebarStyle.value)},[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"sidebar-background"},[createBaseVNode("div",{class:"sidebar-glow"}),createBaseVNode("div",{class:"sidebar-grid"})],-1)),createBaseVNode("div",_hoisted_1$6,[createBaseVNode("div",_hoisted_2$6,[createVNode(BrandLogo,{"show-version":!isCollapsed.value,collapsed:isCollapsed.value},null,8,["show-version","collapsed"])]),createBaseVNode("div",_hoisted_3$5,[createVNode(SidebarNav,{collapsed:isCollapsed.value},null,8,["collapsed"])]),createBaseVNode("div",_hoisted_4$4,[createBaseVNode("div",{class:"sidebar-tools",style:normalizeStyle({gridTemplateColumns:isCollapsed.value?"1fr":`repeat(${buttonLayout.value.gridColumns}, 1fr)`})},[unref(layoutSettings).multiLayoutEnabled?(openBlock(),createElementBlock("div",_hoisted_5$4,[createVNode(_component_CyberLayoutToggleButton,{size:"sm",variant:"icon",tooltip:!0,"tooltip-placement":isCollapsed.value?"right":"top"},null,8,["tooltip-placement"])])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["social-links",{"social-collapsed":isCollapsed.value}])},[unref(socialLinks).official.show?(openBlock(),createBlock(_component_CyberIconButton,{key:0,type:"cyber",size:"small",tooltip:unref($t2)("components.sidebar.social.visitWebsite"),"tooltip-placement":isCollapsed.value?"right":"top",onClick:openOfficialSite},{default:withCtx(()=>[..._cache[0]||(_cache[0]=[createBaseVNode("i",{class:"fas fa-globe"},null,-1)])]),_:1},8,["tooltip","tooltip-placement"])):createCommentVNode("",!0),unref(socialLinks).github.show?(openBlock(),createBlock(_component_CyberIconButton,{key:1,type:"cyber",size:"small",tooltip:unref($t2)("components.sidebar.social.visitGitHub"),"tooltip-placement":isCollapsed.value?"right":"top",onClick:openGitHub},{default:withCtx(()=>[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fab fa-github"},null,-1)])]),_:1},8,["tooltip","tooltip-placement"])):createCommentVNode("",!0),unref(socialLinks).wechat.show&&unref(socialLinks).wechat.hasConfig?(openBlock(),createBlock(_component_CyberIconButton,{key:2,type:"cyber",size:"small",tooltip:unref($t2)("components.sidebar.social.joinWechat"),"tooltip-placement":isCollapsed.value?"right":"top",onClick:showCommunityDialog},{default:withCtx(()=>[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fab fa-weixin"},null,-1)])]),_:1},8,["tooltip","tooltip-placement"])):createCommentVNode("",!0),unref(socialLinks).qq.show&&unref(socialLinks).qq.hasConfig?(openBlock(),createBlock(_component_CyberIconButton,{key:3,type:"cyber",size:"small",tooltip:unref($t2)("components.sidebar.social.joinQQ"),"tooltip-placement":isCollapsed.value?"right":"top",onClick:showQQGroupDialog},{default:withCtx(()=>[..._cache[3]||(_cache[3]=[createBaseVNode("i",{class:"fab fa-qq"},null,-1)])]),_:1},8,["tooltip","tooltip-placement"])):createCommentVNode("",!0)],2),createVNode(_component_CyberIconButton,{type:"cyber",size:"small",tooltip:isCollapsed.value?unref($t2)("components.sidebar.toggle.expand"):unref($t2)("components.sidebar.toggle.collapse"),"tooltip-placement":isCollapsed.value?"right":"top",onClick:unref(layoutStore).toggleSidebar},{default:withCtx(()=>[createBaseVNode("i",{class:normalizeClass(isCollapsed.value?"fas fa-angle-right":"fas fa-angle-left")},null,2)]),_:1},8,["tooltip","tooltip-placement","onClick"])],4)])])],6),unref(socialLinks).wechat.show&&unref(socialLinks).wechat.hasConfig?(openBlock(),createBlock(_component_CyberCommunityDialog,{key:0,type:"wechat","qr-image":unref(socialLinks).wechat.qrImage,"contact-info":unref(socialLinks).wechat.account,ref_key:"communityDialogRef",ref:communityDialogRef},null,8,["qr-image","contact-info"])):createCommentVNode("",!0),unref(socialLinks).qq.show&&unref(socialLinks).qq.hasConfig?(openBlock(),createBlock(_component_CyberCommunityDialog,{key:1,type:"qq","qr-image":unref(socialLinks).qq.qrImage,"contact-info":unref(socialLinks).qq.groupNumber,ref_key:"qqGroupDialogRef",ref:qqGroupDialogRef},null,8,["qr-image","contact-info"])):createCommentVNode("",!0)],64)}}});const CyberSidebar=_export_sfc(_sfc_main$9,[["__scopeId","data-v-2f3af3c3"]]),_hoisted_1$5={class:"layout-switcher"},_hoisted_2$5={class:"switcher-title"},_hoisted_3$4={class:"switcher-buttons"},_sfc_main$8=defineComponent({name:"LayoutSwitcher",__name:"index",setup(__props){const{$t:$t2}=useTexts(),layoutStore=useLayoutStore(),isTopLayout=computed(()=>layoutStore.isTopLayout),isLeftLayout=computed(()=>layoutStore.isLeftLayout),switchToTop=()=>{layoutStore.setLayoutMode("top")},switchToLeft=()=>{layoutStore.setLayoutMode("left")};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$5,toDisplayString(unref($t2)("components.layoutSwitcher.title")),1),createBaseVNode("div",_hoisted_3$4,[createBaseVNode("button",{class:normalizeClass(["layout-button",{active:isTopLayout.value}]),onClick:switchToTop},[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-align-justify"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.layoutSwitcher.topNav")),1)],2),createBaseVNode("button",{class:normalizeClass(["layout-button",{active:isLeftLayout.value}]),onClick:switchToLeft},[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-grip-vertical"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t2)("components.layoutSwitcher.sidebar")),1)],2)])]))}});const LayoutSwitcher=_export_sfc(_sfc_main$8,[["__scopeId","data-v-d9649d26"]]);function useLayoutNavigation(){const router2=useRouter(),route=useRoute(),layoutStore=useLayoutStore(),toggleLayoutWithNavigation=async()=>{if(!layoutStore.canToggleLayout)return{newMode:layoutStore.mode,targetPath:route.path,switched:!1,reason:"Multi-layout mode is disabled"};const newMode=layoutStore.mode==="left"?"top":"left";layoutStore.setLayoutMode(newMode);const targetPath=newMode==="left"?"/dashboard":"/";try{await router2.push(targetPath)}catch(error2){console.warn("Failed to navigate:",error2)}return{newMode,targetPath,switched:!0}};return{currentLayout:layoutStore.mode,canToggleLayout:layoutStore.canToggleLayout,toggleLayoutWithNavigation}}const _hoisted_1$4=["title"],_hoisted_2$4={key:0,class:"button-text"},_sfc_main$7=defineComponent({name:"LayoutToggleButton",__name:"index",props:{size:{default:"md"},variant:{default:"icon"},tooltip:{type:Boolean,default:!0},tooltipPlacement:{default:"bottom"}},setup(__props){const{$t:$t2}=useTexts(),props=__props,layoutStore=useLayoutStore(),{toggleLayoutWithNavigation}=useLayoutNavigation(),buttonClasses=computed(()=>["layout-toggle-btn",`size-${props.size}`,`variant-${props.variant}`]),iconClass=computed(()=>layoutStore.isTopLayout?"fas fa-grip-vertical":"fas fa-grip-horizontal"),tooltipText=computed(()=>layoutStore.isLeftLayout?$t2("components.layoutToggleButton.switchToTop"):$t2("components.layoutToggleButton.switchToLeft")),buttonText=computed(()=>layoutStore.isTopLayout?$t2("components.layoutToggleButton.sidebarLayout"):$t2("components.layoutToggleButton.topLayout")),handleToggle=async()=>{await toggleLayoutWithNavigation()};return(_ctx,_cache)=>{const _component_CyberIconButton=resolveComponent("CyberIconButton");return __props.variant==="icon"?(openBlock(),createBlock(_component_CyberIconButton,{key:0,type:"cyber",size:props.size==="sm"?"small":"medium",tooltip:__props.tooltip?tooltipText.value:void 0,"tooltip-placement":__props.tooltipPlacement,onClick:handleToggle},{default:withCtx(()=>[createBaseVNode("i",{class:normalizeClass(iconClass.value)},null,2)]),_:1},8,["size","tooltip","tooltip-placement"])):(openBlock(),createBlock(resolveDynamicComponent(__props.tooltip?"CyberTooltip":"div"),normalizeProps(mergeProps({key:1},__props.tooltip?{content:tooltipText.value,placement:__props.tooltipPlacement}:{})),{default:withCtx(()=>[createBaseVNode("button",{class:normalizeClass(buttonClasses.value),onClick:handleToggle,title:__props.tooltip?void 0:tooltipText.value},[createBaseVNode("i",{class:normalizeClass(iconClass.value)},null,2),__props.variant==="text"||__props.variant==="both"?(openBlock(),createElementBlock("span",_hoisted_2$4,toDisplayString(buttonText.value),1)):createCommentVNode("",!0)],10,_hoisted_1$4)]),_:1},16))}}});const LayoutToggleButton=_export_sfc(_sfc_main$7,[["__scopeId","data-v-87879d66"]]);function useLayoutStyles(){const layoutStore=useLayoutStore(),route=useRoute(),isTopLayout=computed(()=>layoutStore.isTopLayout),isLeftLayout=computed(()=>layoutStore.isLeftLayout),pageType=computed(()=>{const path=route.path;return path==="/"?"home":path.startsWith("/admin")?"admin":path.startsWith("/docs")?"docs":path.includes("gallery")||path.includes("explore")?"gallery":path.includes("share")?"share":"default"}),containerClasses=computed(()=>({"layout-container":!0,"layout-top":isTopLayout.value,"layout-left":isLeftLayout.value,[`page-${pageType.value}`]:!0})),pageContainerStyle=computed(()=>({width:"var(--layout-container-width)",maxWidth:"var(--layout-content-max-width)",padding:"var(--layout-content-padding)",margin:"0 auto"})),gridContainerStyle=computed(()=>({display:"grid",gridTemplateColumns:"var(--layout-grid-cols)",gap:"var(--layout-grid-gap)"})),cardStyle=computed(()=>({padding:"var(--layout-card-padding)",borderRadius:"var(--layout-card-radius)",transition:"all var(--layout-animation-duration) ease"})),titleStyle=computed(()=>({fontSize:"var(--layout-title-size)",lineHeight:1.2}));return{isTopLayout,isLeftLayout,pageType,containerClasses,pageContainerStyle,gridContainerStyle,cardStyle,titleStyle,getGridCols:(minWidth=300)=>isLeftLayout.value?`repeat(auto-fill, minmax(${Math.max(minWidth-50,200)}px, 1fr))`:`repeat(auto-fill, minmax(${minWidth}px, 1fr))`,getSpacing:(type="element")=>`var(--layout-${type}-gap)`,getPageSpecificStyles:()=>{switch(pageType.value){case"admin":return{"--layout-card-gap":isLeftLayout.value?"0.75rem":"1.5rem","--layout-table-density":isLeftLayout.value?"compact":"comfortable"};case"gallery":return{"--layout-grid-gap":isLeftLayout.value?"0.5rem":"1rem","--layout-image-size":isLeftLayout.value?"150px":"200px"};case"home":return isTopLayout.value?{"--layout-hero-height":"100vh","--layout-section-gap":"5rem"}:{};default:return{}}}}}const _sfc_main$6=defineComponent({name:"LayoutAdaptivePageContainer",__name:"PageContainer",props:{fullWidth:{type:Boolean,default:!1},maxWidth:{default:""},padding:{default:""},pageType:{default:"default"}},setup(__props){const props=__props,{containerClasses,pageContainerStyle,getPageSpecificStyles}=useLayoutStyles(),containerStyle=computed(()=>{const baseStyle={...pageContainerStyle.value},pageStyles=getPageSpecificStyles();return props.fullWidth&&(baseStyle.maxWidth="none"),props.maxWidth&&(baseStyle.maxWidth=props.maxWidth),props.padding&&(baseStyle.padding=props.padding),{...baseStyle,...pageStyles}}),containerClassList=computed(()=>({...containerClasses.value,"full-width":props.fullWidth,[`page-${props.pageType}`]:!0}));return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(containerClassList.value),style:normalizeStyle(containerStyle.value)},[renderSlot(_ctx.$slots,"default",{},void 0,!0)],6))}});const PageContainer=_export_sfc(_sfc_main$6,[["__scopeId","data-v-6acf559a"]]),_sfc_main$5=defineComponent({name:"LayoutAdaptiveGridContainer",__name:"GridContainer",props:{minColumnWidth:{default:300},columns:{default:""},gap:{default:""},autoColumns:{type:Boolean,default:!0}},setup(__props){const props=__props,{gridContainerStyle,getGridCols,getSpacing}=useLayoutStyles(),gridStyle=computed(()=>{const baseStyle={...gridContainerStyle.value};return props.columns?baseStyle.gridTemplateColumns=props.columns:props.autoColumns&&(baseStyle.gridTemplateColumns=getGridCols(props.minColumnWidth)),props.gap?baseStyle.gap=props.gap:baseStyle.gap=getSpacing("card"),baseStyle});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:"adaptive-grid",style:normalizeStyle(gridStyle.value)},[renderSlot(_ctx.$slots,"default",{},void 0,!0)],4))}});const GridContainer=_export_sfc(_sfc_main$5,[["__scopeId","data-v-4d8aeb6c"]]),_sfc_main$4=defineComponent({name:"LayoutAdaptiveCardContainer",__name:"CardContainer",props:{tag:{default:"div"},hoverable:{type:Boolean,default:!1},padding:{default:""},borderRadius:{default:""},variant:{default:"default"}},setup(__props){const props=__props,{cardStyle,isLeftLayout}=useLayoutStyles(),computedCardStyle=computed(()=>{const baseStyle={...cardStyle.value};switch(props.padding&&(baseStyle.padding=props.padding),props.borderRadius&&(baseStyle.borderRadius=props.borderRadius),props.variant){case"admin":baseStyle.padding=isLeftLayout.value?"1rem":"1.5rem",baseStyle.borderRadius=isLeftLayout.value?"0.5rem":"0.75rem";break;case"gallery":baseStyle.padding=isLeftLayout.value?"0.5rem":"1rem",baseStyle.borderRadius="var(--layout-card-radius)";break;case"stats":baseStyle.padding=isLeftLayout.value?"1.25rem":"1.75rem";break}return baseStyle}),cardClasses=computed(()=>({"adaptive-card":!0,hoverable:props.hoverable,[`variant-${props.variant}`]:!0}));return(_ctx,_cache)=>(openBlock(),createBlock(resolveDynamicComponent(__props.tag),{class:normalizeClass(cardClasses.value),style:normalizeStyle(computedCardStyle.value)},{default:withCtx(()=>[renderSlot(_ctx.$slots,"default",{},void 0,!0)]),_:3},8,["class","style"]))}});const CardContainer=_export_sfc(_sfc_main$4,[["__scopeId","data-v-8fc5577a"]]);__unplugin_components_1$1.install=app=>{app.component("CyberContextMenu",__unplugin_components_1$1)};const _hoisted_1$3={class:"cyber-background"},_hoisted_2$3={key:0,class:"aurora-bands"},_hoisted_3$3={key:1,class:"enhanced-effects"},_hoisted_4$3={class:"ambient-glow"},_hoisted_5$3={key:0,class:"glow glow-3"},_hoisted_6$3={key:0,class:"digital-rain"},_sfc_main$3=defineComponent({name:"CyberHomeBackground",__name:"index",props:{showEnhancedEffects:{type:Boolean,default:!1},showDigitalRain:{type:Boolean,default:!1},showRedOrb:{type:Boolean,default:!1},showAurora:{type:Boolean,default:!1}},setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"grid-overlay"},null,-1)),__props.showAurora?(openBlock(),createElementBlock("div",_hoisted_2$3,[..._cache[0]||(_cache[0]=[createBaseVNode("div",{class:"band band-1"},null,-1),createBaseVNode("div",{class:"band band-2"},null,-1),createBaseVNode("div",{class:"band band-3"},null,-1)])])):createCommentVNode("",!0),__props.showEnhancedEffects?(openBlock(),createElementBlock("div",_hoisted_3$3,[createBaseVNode("div",_hoisted_4$3,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"glow glow-1"},null,-1)),_cache[2]||(_cache[2]=createBaseVNode("div",{class:"glow glow-2"},null,-1)),__props.showRedOrb?(openBlock(),createElementBlock("div",_hoisted_5$3)):createCommentVNode("",!0)]),_cache[4]||(_cache[4]=createBaseVNode("div",{class:"elegant-beams"},[createBaseVNode("div",{class:"beam-line"})],-1)),__props.showDigitalRain?(openBlock(),createElementBlock("div",_hoisted_6$3,[..._cache[3]||(_cache[3]=[createBaseVNode("div",{class:"rain-column rain-1"},"01",-1),createBaseVNode("div",{class:"rain-column rain-2"},"10",-1)])])):createCommentVNode("",!0)])):createCommentVNode("",!0)]))}});const __unplugin_components_0=_export_sfc(_sfc_main$3,[["__scopeId","data-v-f8a6f44d"]]),_hoisted_1$2={class:"theme-toggle"},_hoisted_2$2={key:0,class:"theme-text"},_hoisted_3$2={class:"dropdown-header"},_hoisted_4$2={class:"header-title"},_hoisted_5$2={class:"theme-options"},_hoisted_6$2=["onClick"],_hoisted_7$1={class:"option-icon"},_hoisted_8$1={class:"option-content"},_hoisted_9$1={class:"option-label"},_hoisted_10={class:"option-description"},_hoisted_11={key:0,class:"option-check"},_hoisted_12={key:0,class:"system-hint"},_hoisted_13={class:"hint-text"},_sfc_main$2=defineComponent({name:"CyberThemeToggle",__name:"index",props:{size:{default:"small"},showDropdown:{type:Boolean,default:!0},showText:{type:Boolean,default:!1},placement:{default:"bottom"},align:{default:"right"}},setup(__props){const{$t:$t2}=useTexts(),props=__props,{selectedTheme,appliedTheme,setTheme,themeOptions,currentThemeInfo}=useTheme(),dropdownOpen=ref(!1),dropdownRef=ref(),buttonRef=ref(),dropdownStyle=ref({}),updateDropdownPosition=()=>{if(!buttonRef.value)return;const rect=buttonRef.value.getBoundingClientRect(),style={};props.placement==="top"?style.bottom=`${window.innerHeight-rect.top+8}px`:style.top=`${rect.bottom+8}px`,props.align==="left"?style.left=`${rect.left}px`:style.right=`${window.innerWidth-rect.right}px`,dropdownStyle.value=style},toggleDropdown=()=>{props.showDropdown&&(dropdownOpen.value=!dropdownOpen.value,dropdownOpen.value&&updateDropdownPosition())},selectTheme=theme=>{setTheme(theme),dropdownOpen.value=!1};return onClickOutside(dropdownRef,event=>{buttonRef.value?.contains(event.target)||(dropdownOpen.value=!1)},{ignore:[buttonRef]}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("button",{ref_key:"buttonRef",ref:buttonRef,class:normalizeClass(["theme-toggle-btn",[`theme-toggle-btn--${__props.size}`,{"theme-toggle-btn--active":dropdownOpen.value}]]),onClick:toggleDropdown},[createBaseVNode("i",{class:normalizeClass(["fas",`fa-${unref(currentThemeInfo).icon}`,"theme-icon"])},null,2),__props.showText?(openBlock(),createElementBlock("span",_hoisted_2$2,toDisplayString(unref(currentThemeInfo).label),1)):createCommentVNode("",!0)],2),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"theme-dropdown"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"dropdownRef",ref:dropdownRef,class:"theme-dropdown",style:normalizeStyle(dropdownStyle.value)},[createBaseVNode("div",_hoisted_3$2,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-palette header-icon"},null,-1)),createBaseVNode("span",_hoisted_4$2,toDisplayString(unref($t2)("theme.selectTheme")),1)]),createBaseVNode("div",_hoisted_5$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(themeOptions),option=>(openBlock(),createElementBlock("button",{key:option.value,class:normalizeClass(["theme-option",{active:unref(selectedTheme)===option.value}]),onClick:$event=>selectTheme(option.value)},[createBaseVNode("div",_hoisted_7$1,[createBaseVNode("i",{class:normalizeClass(["fas",`fa-${option.icon}`])},null,2)]),createBaseVNode("div",_hoisted_8$1,[createBaseVNode("div",_hoisted_9$1,toDisplayString(option.label),1),createBaseVNode("div",_hoisted_10,toDisplayString(option.description),1)]),unref(selectedTheme)===option.value?(openBlock(),createElementBlock("div",_hoisted_11,[..._cache[1]||(_cache[1]=[createBaseVNode("i",{class:"fas fa-check-circle"},null,-1)])])):createCommentVNode("",!0)],10,_hoisted_6$2))),128))]),unref(selectedTheme)==="system"?(openBlock(),createElementBlock("div",_hoisted_12,[_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-info-circle hint-icon"},null,-1)),createBaseVNode("span",_hoisted_13,toDisplayString(unref($t2)("theme.currentSystem",{theme:unref(appliedTheme)==="light"?unref($t2)("theme.light"):unref($t2)("theme.dark")})),1)])):createCommentVNode("",!0)],4),[[vShow,dropdownOpen.value&&__props.showDropdown]])]),_:1})]))]))}});const ThemeToggle=_export_sfc(_sfc_main$2,[["__scopeId","data-v-168f8da7"]]),_hoisted_1$1={key:0,class:"card-header"},_hoisted_2$1={class:"flex items-center gap-3"},_hoisted_3$1={class:"flex-1"},_hoisted_4$1={class:"card-title"},_hoisted_5$1={key:0,class:"card-subtitle"},_hoisted_6$1={key:1,class:"card-footer"},_sfc_main$1=defineComponent({__name:"index",props:{title:{},subtitle:{},icon:{},hoverable:{type:Boolean,default:!0},padding:{default:"medium"}},setup(__props){const props=__props,paddingClass=computed(()=>({none:"p-0",small:"p-3",medium:"p-4",large:"p-6"})[props.padding]);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["card",{"card-hoverable":__props.hoverable}])},[__props.title||_ctx.$slots.header?(openBlock(),createElementBlock("div",_hoisted_1$1,[renderSlot(_ctx.$slots,"header",{},()=>[createBaseVNode("div",_hoisted_2$1,[__props.icon?(openBlock(),createElementBlock("i",{key:0,class:normalizeClass([__props.icon,"card-icon"])},null,2)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_3$1,[createBaseVNode("h3",_hoisted_4$1,toDisplayString(__props.title),1),__props.subtitle?(openBlock(),createElementBlock("p",_hoisted_5$1,toDisplayString(__props.subtitle),1)):createCommentVNode("",!0)])])],!0)])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["card-content",unref(paddingClass)])},[renderSlot(_ctx.$slots,"default",{},void 0,!0)],2),_ctx.$slots.footer?(openBlock(),createElementBlock("div",_hoisted_6$1,[renderSlot(_ctx.$slots,"footer",{},void 0,!0)])):createCommentVNode("",!0)],2))}});const Card=_export_sfc(_sfc_main$1,[["__scopeId","data-v-57d3212b"]]),_hoisted_1={class:"cyber-color-picker"},_hoisted_2=["value","placeholder"],_hoisted_3={class:"picker-body-compact"},_hoisted_4={class:"color-canvas-wrapper"},_hoisted_5={class:"hue-slider-wrapper"},_hoisted_6={class:"preset-colors-compact"},_hoisted_7=["onClick"],_hoisted_8={class:"color-input-row-compact"},_hoisted_9={class:"picker-footer-compact"},_sfc_main=defineComponent({__name:"index",props:{modelValue:{},placeholder:{default:"#000000"}},emits:["update:modelValue"],setup(__props,{emit:__emit}){const{$t:$t2}=useTexts(),props=__props,emit=__emit,showPicker=ref(!1),canvasRef=ref(null),panelRef=ref(null),currentColor=ref(props.modelValue),hexInput=ref(props.modelValue),isDraggingCanvas=ref(!1),isDraggingHue=ref(!1),panelStyle=ref({}),hue=ref(0),saturation=ref(100),value=ref(100),cursorPosition=ref({x:280,y:0}),huePosition=ref(0),presetColors=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2"];onMounted(()=>{initializeFromHex(props.modelValue),drawColorCanvas()}),watch(()=>props.modelValue,newVal=>{currentColor.value=newVal,hexInput.value=newVal,initializeFromHex(newVal)}),watch(hue,()=>{drawColorCanvas()});function togglePicker(event){showPicker.value=!showPicker.value,showPicker.value&&nextTick(()=>{calculatePanelPosition(event),drawColorCanvas()})}function calculatePanelPosition(event){const rect=event.currentTarget.getBoundingClientRect(),panelWidth=260,panelHeight=380,padding=8;let left=rect.left,top=rect.bottom+padding;left+panelWidth>window.innerWidth&&(left=window.innerWidth-panelWidth-padding),left<padding&&(left=padding),top+panelHeight>window.innerHeight&&(top=rect.top-panelHeight-padding),top<padding&&(top=padding),panelStyle.value={left:`${left}px`,top:`${top}px`}}function closePicker(){showPicker.value=!1}function confirmColor(){emit("update:modelValue",currentColor.value),closePicker()}function selectPresetColor(color){currentColor.value=color,hexInput.value=color,initializeFromHex(color)}function drawColorCanvas(){if(!canvasRef.value)return;const canvas=canvasRef.value,ctx=canvas.getContext("2d");if(!ctx)return;const width=canvas.width,height=canvas.height;ctx.fillStyle=`hsl(${hue.value}, 100%, 50%)`,ctx.fillRect(0,0,width,height);const whiteGradient=ctx.createLinearGradient(0,0,width,0);whiteGradient.addColorStop(0,"rgba(255, 255, 255, 1)"),whiteGradient.addColorStop(1,"rgba(255, 255, 255, 0)"),ctx.fillStyle=whiteGradient,ctx.fillRect(0,0,width,height);const blackGradient=ctx.createLinearGradient(0,0,0,height);blackGradient.addColorStop(0,"rgba(0, 0, 0, 0)"),blackGradient.addColorStop(1,"rgba(0, 0, 0, 1)"),ctx.fillStyle=blackGradient,ctx.fillRect(0,0,width,height)}function handleCanvasMouseDown(e){isDraggingCanvas.value=!0,updateColorFromCanvas(e)}function handleCanvasMouseMove(e){isDraggingCanvas.value&&updateColorFromCanvas(e)}function handleCanvasMouseUp(){isDraggingCanvas.value=!1}function updateColorFromCanvas(e){if(!canvasRef.value)return;const rect=canvasRef.value.getBoundingClientRect(),x=Math.max(0,Math.min(e.clientX-rect.left,rect.width)),y=Math.max(0,Math.min(e.clientY-rect.top,rect.height));cursorPosition.value={x,y},saturation.value=x/rect.width*100,value.value=100-y/rect.height*100,updateColorFromHSV()}function handleHueMouseDown(e){isDraggingHue.value=!0,updateHueFromSlider(e);const handleMouseMove=e2=>{isDraggingHue.value&&updateHueFromSlider(e2)},handleMouseUp=()=>{isDraggingHue.value=!1,document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)};document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp)}function updateHueFromSlider(e){const rect=e.currentTarget.getBoundingClientRect(),percentage=Math.max(0,Math.min(e.clientX-rect.left,rect.width))/rect.width*100;huePosition.value=percentage,hue.value=percentage/100*360,updateColorFromHSV()}function hsvToHex(h2,s,v){const rgb=hsvToRgb(h2,s,v);return rgbToHex(rgb.r,rgb.g,rgb.b)}function hsvToRgb(h2,s,v){s=s/100,v=v/100;const c=v*s,x=c*(1-Math.abs(h2/60%2-1)),m=v-c;let r=0,g=0,b=0;return h2>=0&&h2<60?(r=c,g=x,b=0):h2>=60&&h2<120?(r=x,g=c,b=0):h2>=120&&h2<180?(r=0,g=c,b=x):h2>=180&&h2<240?(r=0,g=x,b=c):h2>=240&&h2<300?(r=x,g=0,b=c):h2>=300&&h2<360&&(r=c,g=0,b=x),{r:Math.round((r+m)*255),g:Math.round((g+m)*255),b:Math.round((b+m)*255)}}function rgbToHex(r,g,b){return`#${[r,g,b].map(x=>x.toString(16).padStart(2,"0")).join("")}`}function hexToHsv(hex){const rgb=hexToRgb(hex);if(!rgb)return{h:0,s:0,v:0};const r=rgb.r/255,g=rgb.g/255,b=rgb.b/255,max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min;let h2=0;const s=max===0?0:delta/max,v=max;return delta!==0&&(max===r?h2=((g-b)/delta+(g<b?6:0))/6:max===g?h2=((b-r)/delta+2)/6:h2=((r-g)/delta+4)/6),{h:h2*360,s:s*100,v:v*100}}function hexToRgb(hex){const result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null}function initializeFromHex(hex){const hsv=hexToHsv(hex);hue.value=hsv.h,saturation.value=hsv.s,value.value=hsv.v,huePosition.value=hue.value/360*100,canvasRef.value&&(cursorPosition.value={x:saturation.value/100*canvasRef.value.width,y:(100-value.value)/100*canvasRef.value.height})}function updateColorFromHSV(){currentColor.value=hsvToHex(hue.value,saturation.value,value.value),hexInput.value=currentColor.value}function handleHexInput(e){const input=e.target.value;/^#[0-9A-Fa-f]{6}$/.test(input)&&(currentColor.value=input,initializeFromHex(input))}function validateHexInput(){/^#[0-9A-Fa-f]{6}$/.test(hexInput.value)||(hexInput.value=currentColor.value)}return(_ctx,_cache)=>{const _component_CyberButton=resolveComponent("CyberButton");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",{class:"color-input-wrapper",onClick:togglePicker},[createBaseVNode("div",{class:"color-preview",style:normalizeStyle({backgroundColor:__props.modelValue})},null,4),createBaseVNode("input",{value:__props.modelValue,type:"text",class:"color-text",readonly:"",placeholder:__props.placeholder},null,8,_hoisted_2),_cache[2]||(_cache[2]=createBaseVNode("i",{class:"fas fa-palette color-icon"},null,-1))]),(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(Transition,{name:"color-picker-fade"},{default:withCtx(()=>[showPicker.value?(openBlock(),createElementBlock("div",{key:0,class:"color-picker-overlay",onClick:closePicker},[createBaseVNode("div",{ref_key:"panelRef",ref:panelRef,class:"color-picker-panel",style:normalizeStyle(panelStyle.value),onClick:_cache[1]||(_cache[1]=withModifiers(()=>{},["stop"]))},[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("canvas",{ref_key:"canvasRef",ref:canvasRef,class:"color-canvas",width:"220",height:"140",onMousedown:handleCanvasMouseDown,onMousemove:handleCanvasMouseMove,onMouseup:handleCanvasMouseUp,onMouseleave:handleCanvasMouseUp},null,544),createBaseVNode("div",{class:"color-cursor",style:normalizeStyle({left:`${cursorPosition.value.x}px`,top:`${cursorPosition.value.y}px`})},null,4)]),createBaseVNode("div",_hoisted_5,[createBaseVNode("div",{class:"hue-slider",onMousedown:handleHueMouseDown},[createBaseVNode("div",{class:"hue-cursor",style:normalizeStyle({left:`${huePosition.value}%`})},null,4)],32)]),createBaseVNode("div",_hoisted_6,[(openBlock(),createElementBlock(Fragment,null,renderList(presetColors,color=>createBaseVNode("div",{key:color,class:normalizeClass(["preset-color-compact",{active:__props.modelValue.toLowerCase()===color.toLowerCase()}]),style:normalizeStyle({backgroundColor:color}),onClick:$event=>selectPresetColor(color)},null,14,_hoisted_7)),64))]),createBaseVNode("div",_hoisted_8,[createBaseVNode("div",{class:"current-color-preview-compact",style:normalizeStyle({backgroundColor:currentColor.value})},null,4),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>hexInput.value=$event),type:"text",class:"hex-input-compact",placeholder:"#000000",onInput:handleHexInput,onBlur:validateHexInput},null,544),[[vModelText,hexInput.value]])]),createBaseVNode("div",_hoisted_9,[createVNode(_component_CyberButton,{size:"sm",type:"secondary",onClick:closePicker},{default:withCtx(()=>[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-times mr-1.5"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("actions.cancel")),1)]),_:1}),createVNode(_component_CyberButton,{size:"sm",type:"primary",onClick:confirmColor},{default:withCtx(()=>[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-check mr-1.5"},null,-1)),createTextVNode(" "+toDisplayString(unref($t2)("actions.confirm")),1)]),_:1})])])],4)])):createCommentVNode("",!0)]),_:1})]))])}}});const ColorPicker=_export_sfc(_sfc_main,[["__scopeId","data-v-f7517443"]]),componentMap={CyberCard:Card,CyberSwitch:Switch,CyberDropdown:Dropdown,CyberNavbar:Navbar,CyberToast:Toast,CyberButton:__unplugin_components_0$4,CyberDialog:__unplugin_components_3,CyberInput:__unplugin_components_2,CyberPopconfirm:Popconfirm,CyberBreadcrumb:Breadcrumb,CyberLoading:Loading,CyberFolderTree:FolderTree,CyberFileViewer:FileViewer,CyberPagination:Pagination,CyberUserAvatar:UserAvatar,CyberRadio:Radio,CyberRadioGroup:RadioGroup,CyberLogo:Logo,CyberSlider:Slider,CyberFile:File,CyberFileDetailModal:FileDetailModal,CyberTooltip,CyberDatePicker:DatePicker,CyberCheckbox:Checkbox,CyberMobileNavigation:MobileNavigation,CyberShareFolder:ShareFolder,CyberShareFile:ShareFile,CyberWaterfallLayout:WaterfallLayout,CyberFileLoading,CyberParticleBackground:ParticleBackground,CyberBackground,CyberDrawer:Drawer,CyberDataTable:CyberTable,CyberTable,CyberResumableUploads,CyberBadge:Badge,CyberConfirmDialog,CyberIconButton,CyberIconPicker:IconPicker,CyberCopyright:Copyright,CyberCommunityDialog:CommunityDialog,CyberNotificationDialog:NotificationDialog,CyberDuplicateBadge:__unplugin_components_0$3,CyberGlobalUploadFloat:GlobalUploadFloat,CyberGlobalUploadDrawer:GlobalUploadDrawer,CyberMultiSelector:MultiSelector,CyberWatermarkConfig:WatermarkConfig,CyberFileExpiryTag:ImageExpiryTag,CyberAdminWrapper,CyberSideNavTabs,CyberSidebarNav:__unplugin_components_0$2,CyberAccordion,CyberSkeleton:__unplugin_components_0$1,CyberStatsCard:StatsCard,CyberStatsSection:StatsSection,CyberAccessLevelToggle:_sfc_main$d,CyberTag:Tag,CyberSmartTagContainer:SmartTagContainer,CyberSidebar,CyberLayoutSwitcher:LayoutSwitcher,CyberLayoutToggleButton:LayoutToggleButton,CyberPageContainer:PageContainer,CyberGridContainer:GridContainer,CyberCardContainer:CardContainer,CyberContextMenu:__unplugin_components_1$1,CyberHomeBackground:__unplugin_components_0,CyberThemeToggle:ThemeToggle,CyberColorPicker:ColorPicker,CyberAnnouncementButton:AnnouncementButton,CyborgCharacter:__unplugin_components_1,CyberCyborgCharacter:__unplugin_components_1},createCyberUI=(options={})=>({install(app){const{components:components2=[]}=options;components2.length>0?components2.forEach(name=>{componentMap[name]&&app.component(name,componentMap[name])}):Object.entries(componentMap).forEach(([name,component])=>{app.component(name,component)})}}),CyberComponentsPlugin=createCyberUI(),CyberComponentsPlugin$1=CyberComponentsPlugin;var __defProp$2=Object.defineProperty,__defNormalProp$2=(obj,key,value)=>key in obj?__defProp$2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$2=(obj,key,value)=>(__defNormalProp$2(obj,typeof key!="symbol"?key+"":key,value),value);class Validator{static getMessages($t2){return{required:$t2("utils.errors.required"),type:$t2("utils.errors.type"),min:$t2("utils.errors.min",{min:"{min}"}),max:$t2("utils.errors.max",{max:"{max}"}),length:$t2("utils.errors.length"),pattern:$t2("utils.errors.pattern"),email:$t2("utils.errors.email"),phone:$t2("utils.errors.phone"),url:$t2("utils.errors.url"),username:$t2("utils.errors.username"),password:$t2("utils.errors.password"),custom:$t2("utils.errors.custom")}}static validate(value,rules,$t2){for(const rule of rules){const result=this.validateSingle(value,rule,$t2);if(!result.valid)return result}return{valid:!0,value}}static validateSingle(value,rule,$t2){const msgs=$t2?this.getMessages($t2):this.MESSAGES;if(rule.required&&this.isEmpty(value))return{valid:!1,message:rule.message||msgs.required};if(!rule.required&&this.isEmpty(value))return{valid:!0,value};if(rule.type){const typeResult=this.validateType(value,rule.type,$t2);if(!typeResult.valid)return{valid:!1,message:rule.message||typeResult.message||msgs.type}}if(rule.min!==void 0||rule.max!==void 0){const rangeResult=this.validateRange(value,rule.min,rule.max,$t2);if(!rangeResult.valid)return{valid:!1,message:rule.message||rangeResult.message}}if(rule.pattern&&typeof value=="string"&&!rule.pattern.test(value))return{valid:!1,message:rule.message||msgs.pattern};if(rule.custom){const customResult=rule.custom(value);if(!customResult.valid)return{valid:!1,message:rule.message||customResult.message||msgs.custom}}return{valid:!0,value}}static isEmpty(value){return value==null?!0:typeof value=="string"?value.trim()==="":Array.isArray(value)?value.length===0:typeof value=="object"?Object.keys(value).length===0:!1}static validateType(value,type,$t2){const msgs=$t2?this.getMessages($t2):this.MESSAGES;switch(type){case"string":if(typeof value!="string")return{valid:!1,message:$t2?$t2("utils.errors.mustBeString"):"Must be a string"};break;case"number":if(typeof value!="number"||isNaN(value))return{valid:!1,message:$t2?$t2("utils.errors.mustBeNumber"):"Must be a number"};break;case"email":if(!this.PATTERNS.email.test(String(value)))return{valid:!1,message:msgs.email};break;case"phone":if(!this.PATTERNS.phone.test(String(value)))return{valid:!1,message:msgs.phone};break;case"url":if(!this.PATTERNS.url.test(String(value)))return{valid:!1,message:msgs.url};break;case"password":if(!this.PATTERNS.password.test(String(value)))return{valid:!1,message:msgs.password};break}return{valid:!0}}static validateRange(value,min,max,$t2){const length=typeof value=="string"?value.length:typeof value=="number"?value:Array.isArray(value)?value.length:0;return min!==void 0&&length<min?{valid:!1,message:$t2?$t2("utils.errors.min",{min:String(min)}):this.MESSAGES.min.replace("{min}",String(min))}:max!==void 0&&length>max?{valid:!1,message:$t2?$t2("utils.errors.max",{max:String(max)}):this.MESSAGES.max.replace("{max}",String(max))}:{valid:!0}}static batchValidate(data,rules,$t2){const result={valid:!0,errors:{},values:{}};for(const[field,fieldRules]of Object.entries(rules)){const value=data[field],validation=this.validate(value,fieldRules,$t2);if(validation.valid)result.values[field]=validation.value;else{result.valid=!1;const defaultMsg=$t2?$t2("utils.errors.custom"):"Validation failed";result.errors[field]=[validation.message||defaultMsg]}}return result}static isEmail(email){return this.PATTERNS.email.test(email)}static isPhone(phone){return this.PATTERNS.phone.test(phone)}static isUrl(url){return this.PATTERNS.url.test(url)}static isUsername(username){return this.PATTERNS.username.test(username)}static isPassword(password){return this.PATTERNS.password.test(password)}static isIPv4(ip){return this.PATTERNS.ipv4.test(ip)}static isMacAddress(mac){return this.PATTERNS.mac.test(mac)}static isUUID(uuid){return this.PATTERNS.uuid.test(uuid)}static isHexColor(color){return this.PATTERNS.hex.test(color)}static isBase64(str){return this.PATTERNS.base64.test(str)}static checkPasswordStrength(password,$t2){let score=0;const feedback=[];password.length>=8?score+=1:feedback.push($t2?$t2("utils.password.feedback.minLength"):"Password must be at least 8 characters"),password.length>=12&&(score+=1),/[a-z]/.test(password)?score+=1:feedback.push($t2?$t2("utils.password.feedback.requireLowercase"):"Include at least one lowercase letter"),/[A-Z]/.test(password)?score+=1:feedback.push($t2?$t2("utils.password.feedback.requireUppercase"):"Include at least one uppercase letter"),/[0-9]/.test(password)?score+=1:feedback.push($t2?$t2("utils.password.feedback.requireNumber"):"Include at least one number"),/[^a-zA-Z0-9]/.test(password)?score+=1:feedback.push($t2?$t2("utils.password.feedback.suggestSpecial"):"Consider adding special characters"),/(.)\1{2,}/.test(password)?feedback.push($t2?$t2("utils.password.feedback.avoidRepeat"):"Avoid repeating characters"):score+=1;const levels=["weak","weak","medium","medium","strong","strong","very-strong","very-strong"];return{score,level:levels[Math.min(score,levels.length-1)],feedback}}}__publicField$2(Validator,"PATTERNS",{email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^1[3-9]\d{9}$/,url:/^https?:\/\/([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,username:/^[a-zA-Z0-9_-]{3,20}$/,password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{8,}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,mac:/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/,uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,hex:/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,base64:/^[A-Za-z0-9+/]+=*$/});__publicField$2(Validator,"MESSAGES",{required:"This field is required",type:"Invalid field type",min:"Value is too small, min is {min}",max:"Value is too large, max is {max}",length:"Invalid length",pattern:"Invalid format",email:"Please enter a valid email address",phone:"Please enter a valid phone number",url:"Please enter a valid URL",username:"Username must be 3-20 chars: letters, numbers, _ or -",password:"Password must contain upper/lowercase letters and numbers, min 8 chars",custom:"Validation failed"});__publicField$2(Validator,"sanitize",{html(str){return str.replace(/<[^>]*>/g,"")},sql(str){return str.replace(/['"\\;]/g,"")},xss(str){return str.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},whitespace(str){return str.trim().replace(/\s+/g," ")},special(str){return str.replace(/[^\w\s-]/gi,"")},number(str){return str.replace(/[^\d.-]/g,"")},email(str){return str.toLowerCase().trim()},phone(str){return str.replace(/[^\d]/g,"")},url(str){try{return new URL(str).toString()}catch{return str}}});__publicField$2(Validator,"format",{fileSize(bytes,decimals=2){if(bytes===0)return"0 Bytes";const k=1024,dm=decimals<0?0:decimals,sizes=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(bytes)/Math.log(k));return`${parseFloat((bytes/Math.pow(k,i)).toFixed(dm))} ${sizes[i]}`},number(num,locale="zh-CN"){return new Intl.NumberFormat(locale).format(num)},currency(amount,currency="CNY",locale="zh-CN"){return new Intl.NumberFormat(locale,{style:"currency",currency}).format(amount)},percentage(value,decimals=2){return`${(value*100).toFixed(decimals)}%`},duration(milliseconds,$t2){const seconds=Math.floor(milliseconds/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24);return $t2?days>0?$t2("utils.time.daysHours",{d:days,h:hours%24}):hours>0?$t2("utils.time.hoursMinutes",{h:hours,m:minutes%60}):minutes>0?$t2("utils.time.minutesSeconds",{m:minutes,s:seconds%60}):$t2("utils.time.seconds",{n:seconds}):days>0?`${days}d ${hours%24}h`:hours>0?`${hours}h ${minutes%60}m`:minutes>0?`${minutes}m ${seconds%60}s`:`${seconds}s`},relative(date,locale="zh-CN"){const rtf=new Intl.RelativeTimeFormat(locale,{numeric:"auto"}),now=new Date,diff=date.getTime()-now.getTime(),seconds=Math.floor(diff/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24);return Math.abs(days)>0?rtf.format(days,"day"):Math.abs(hours)>0?rtf.format(hours,"hour"):Math.abs(minutes)>0?rtf.format(minutes,"minute"):rtf.format(seconds,"second")}});Validator.PATTERNS.username;function getValidationRules($t2){return{required:{required:!0,message:$t2("utils.errors.required")},email:{type:"email",required:!0,message:$t2("utils.errors.email")},phone:{type:"phone",required:!0,message:$t2("utils.errors.phone")},url:{type:"url",message:$t2("utils.errors.url")},password:{type:"password",required:!0,message:$t2("utils.errors.password")},username:{required:!0,pattern:Validator.PATTERNS.username,message:$t2("utils.errors.username")},minLength:length=>({min:length,message:$t2("utils.errors.minLength",{n:String(length)})}),maxLength:length=>({max:length,message:$t2("utils.errors.maxLength",{n:String(length)})}),range:(min,max)=>({min,max}),numeric:{type:"number",message:$t2("utils.errors.mustBeNumber")},positive:{type:"number",custom:value=>value>0?{valid:!0}:{valid:!1,message:$t2("utils.errors.mustBePositive")}}}}var __defProp$1=Object.defineProperty,__defNormalProp$1=(obj,key,value)=>key in obj?__defProp$1(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField$1=(obj,key,value)=>(__defNormalProp$1(obj,typeof key!="symbol"?key+"":key,value),value);class MessageEventManager{constructor(){__publicField$1(this,"listeners",new Map)}on(type,callback){this.listeners.has(type)||this.listeners.set(type,new Set),this.listeners.get(type)?.add(callback)}off(type,callback){const callbacks=this.listeners.get(type);callbacks&&(callbacks.delete(callback),callbacks.size===0&&this.listeners.delete(type))}emit(type,data){const callbacks=this.listeners.get(type);callbacks&&callbacks.forEach(callback=>{try{callback(data)}catch{}})}clear(){this.listeners.clear()}}const messageEvents=new MessageEventManager;function useMessageEvents(){return{on:messageEvents.on.bind(messageEvents),off:messageEvents.off.bind(messageEvents),emit:messageEvents.emit.bind(messageEvents),clear:messageEvents.clear.bind(messageEvents)}}var __defProp=Object.defineProperty,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__publicField=(obj,key,value)=>(__defNormalProp(obj,typeof key!="symbol"?key+"":key,value),value);class MessageSystemManager{constructor(){__publicField(this,"toast",useMessageToast()),__publicField(this,"modal",useMessageModal()),__publicField(this,"events",useMessageEvents()),__publicField(this,"isInitialized",!1)}init(){this.isInitialized||(this.events.on("new-message",message=>{this.handleNewMessage(message)}),this.events.on("message-read",messageId=>{this.handleMessageRead(messageId)}),this.events.on("message-deleted",messageId=>{this.handleMessageDeleted(messageId)}),this.isInitialized=!0)}handleNewMessage(message){this.shouldShowToastForMessage(message)&&this.toast.showMessage({title:message.title,content:message.content,type:message.type,action_url:message.action_url,action_text:message.action_text,action_style:message.action_style}),this.shouldPlaySound(message)&&this.playNotificationSound()}handleMessageRead(_messageId){}handleMessageDeleted(_messageId){}shouldShowToastForMessage(message){return message.priority===1?!0:["system.maintenance","system.announcement","content.review_approved","content.review_rejected","storage.quota_warning","security.login_alert","account.storage_granted","account.bandwidth_granted"].includes(message.type)}shouldPlaySound(message){return message.priority===1||message.type==="security.login_alert"}playNotificationSound(){try{const audioContext=new(window.AudioContext||window.webkitAudioContext),oscillator=audioContext.createOscillator(),gainNode=audioContext.createGain();oscillator.connect(gainNode),gainNode.connect(audioContext.destination),oscillator.frequency.setValueAtTime(800,audioContext.currentTime),oscillator.frequency.setValueAtTime(600,audioContext.currentTime+.1),gainNode.gain.setValueAtTime(.1,audioContext.currentTime),gainNode.gain.exponentialRampToValueAtTime(.01,audioContext.currentTime+.3),oscillator.start(audioContext.currentTime),oscillator.stop(audioContext.currentTime+.3)}catch{}}showMessageToast(message){this.toast.showMessage({title:message.title,content:message.content,type:message.type,action_url:message.action_url,action_text:message.action_text,action_style:message.action_style})}showMessageDetail(_message){}simulateNewMessage(message){this.events.emit("new-message",message)}markMessageAsRead(messageId){this.events.emit("message-read",messageId)}deleteMessage(messageId){this.events.emit("message-deleted",messageId)}destroy(){this.events.clear(),this.toast.clear(),this.isInitialized=!1}}const messageSystem=new MessageSystemManager;function installTextTheme(app){const textCache=new Map;app.config.globalProperties.$t=key=>{const store=useTextThemeStore(),currentInstance=getCurrentInstance();return currentInstance&&currentInstance.isUnmounted===!1?(textCache.has(key)||textCache.set(key,computed(()=>store.getText(key))),textCache.get(key).value):computed(()=>store.getText(key))},app.config.globalProperties.$toggleTheme=()=>{useTextThemeStore().toggleTheme()},app.config.globalProperties.$setTheme=theme=>{useTextThemeStore().setTheme(theme)}}async function initializeApp(){FaviconManager.setImmediate();const app=createApp(_sfc_main$1G),pinia=createPinia();app.use(pinia);const settingsStore=useSettingsStore(),layoutStore=useLayoutStore();try{await settingsStore.loadGlobalSettings(),await layoutStore.initializeLayout()}catch(error2){console.error("Settings initialization failed:",error2)}app.use(router),app.use(CyberComponentsPlugin$1),app.use(directivesPlugin),app.use(installTextTheme);const theme=useTheme(),systemDefaultTheme=settingsStore.defaultTheme;return await theme.initialize(systemDefaultTheme),messageSystem.init(),app.mount("#app"),app}initializeApp().catch(error2=>{console.error("App initialization failed:",error2)});nextTick(()=>{const initializeAuth=()=>{useAuthStore().initAuth()},stopCleanup=UploadStorageManager.startPeriodicCleanup();window.addEventListener("beforeunload",stopCleanup),document.readyState==="complete"||document.readyState==="interactive"?setTimeout(initializeAuth,0):document.addEventListener("DOMContentLoaded",initializeAuth),window.addEventListener("load",()=>{document.dispatchEvent(new Event("render-event"))})});export{__unplugin_components_0$3 as $,useMessageToast as A,Breadcrumb as B,CyberTooltip as C,DEFAULT_WATERMARK_CONFIG as D,useMessageModal as E,FileViewer as F,getUserMessages as G,getUnreadCount as H,formatMessage as I,formatRelativeTime$1 as J,markMessageRead as K,LAYOUT as L,getCurrentLocale as M,getFileList as N,useTheme as O,getUserFolders as P,getMessageTypeConfig as Q,getPriorityConfig as R,SIZE_LIMITS as S,TIMING as T,UserTerminal as U,MessageStatus as V,MessagePriority as W,markAllMessagesRead as X,deleteMessage as Y,__unplugin_components_0$1 as Z,_export_sfc as _,getSetting as a,StorageUtil as a0,TOKEN_KEY as a1,userVectorSearch as a2,deleteFile as a3,toggleAccessLevel as a4,getValidationRules as a5,updateFolder as a6,createFolder as a7,Validator as a8,__unplugin_components_1$1 as a9,formatDate as aA,getRandomRecommendedFile as aB,API_BASE_URL as aC,formatRelativeTime as aD,Loading as aE,_sfc_main$1A as aF,moveFiles as aG,Z_INDEX$1 as aH,debounce as aI,sendRegistrationCode as aJ,_imports_0 as aK,__unplugin_components_1 as aL,setupApi as aM,BrandLogo as aN,ThemeToggle as aO,__unplugin_components_3 as aP,checkBaiduAnalytics as aQ,checkGoogleAnalytics as aR,__unplugin_components_0$2 as aS,showConfirmDialog as aT,useTextThemeStore as aU,__unplugin_components_0$4 as aV,__unplugin_components_2 as aW,AccessRestrictionCodes as aX,AccessRestrictionKeys as aY,router as aZ,logger$1 as a_,getFolderList as aa,moveFolder as ab,getFolderDetail as ac,reorderFolders as ad,reorderFiles as ae,getFolderListWithImages as af,deleteFolder as ag,visibilityFolder as ah,batchDeleteFiles as ai,post as aj,put as ak,del as al,userApi as am,fileApi as an,folderApi as ao,getUserProfile as ap,uploadAvatar as aq,updateUserProfile as ar,updatePassword as as,sendChangeEmailCode as at,changeEmail as au,getAccessControlConfig as av,createOrUpdateAccessControl as aw,resetAccessControlConfig as ax,useAppearanceSettings as ay,useConfirmDialog as az,batchUpsertSettings as b,createSetting as c,deleteSetting as d,getGlobalSettings as e,getGlobalSettingsByGroup as f,getSettings as g,getLegalDocuments as h,useLayoutStore as i,useTexts as j,useBreadcrumbStore as k,__unplugin_components_0 as l,useSettingsStore as m,useAuthStore as n,galleryVectorSearch as o,processParams as p,useToast as q,downloadFileQuick as r,createFileDataURL as s,useUploadStore as t,updateSetting as u,useUploadConfig as v,logger as w,useFolderPath as x,get as y,formatFileSize as z};
