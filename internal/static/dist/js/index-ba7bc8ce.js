import{x as get,j as useTexts,_ as _export_sfc,M as useTheme,X as __unplugin_components_0}from"./index-4d0dab4c.js";import{d as defineComponent,c as computed,z as openBlock,I as createElementBlock,a0 as createBaseVNode,Q as normalizeStyle,J as renderSlot,a1 as toDisplayString,R as normalizeClass,K as createCommentVNode,u as unref,r as ref,b as onMounted,A as createBlock,L as withCtx,ab as createTextVNode,w as watch,o as onUnmounted,E as resolveComponent,f as createVNode,n as nextTick,G as resolveDirective,F as Fragment,M as renderList,H as withDirectives}from"./vue-vendor-31320f47.js";import{g as getTaggingStats}from"./index-a7f74a87.js";import{g as getVectorStats}from"./index-fbd281f9.js";import{i as init}from"./echarts-79943a2a.js";import{u as useResponsivePageSize}from"./useResponsivePageSize-3b6a8f45.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";const baseUrl="/admin/stats";function getDashboardUserStats(){return get(`${baseUrl}/users`)}function getDashboardImageStats(){return get(`${baseUrl}/files`)}function getDashboardStorageStats(){return get(`${baseUrl}/storage`)}function getDashboardUploadTrends(days=7){return get(`${baseUrl}/upload-trends`,{days})}function getDashboardShareStats(){return get(`${baseUrl}/shares`)}function getDashboardTagStats(){return get(`${baseUrl}/tags`)}function getDashboardRecentUploads(limit=10){return get(`${baseUrl}/latest-files`,{limit})}const _hoisted_1$a={class:"card-header"},_hoisted_2$a={class:"header-info"},_hoisted_3$9={class:"card-title"},_hoisted_4$9={key:0,class:"header-extra"},_hoisted_5$9={class:"card-content"},_hoisted_6$9={key:0,class:"card-footer"},_hoisted_7$9={key:0,class:"update-time"},_hoisted_8$9=["disabled","aria-busy"],_sfc_main$a=defineComponent({__name:"DashboardCard",props:{title:{},badge:{},badgeType:{default:"normal"},iconGradient:{default:()=>["rgba(var(--color-brand-500-rgb), 0.15)","rgba(var(--color-brand-500-rgb), 0.25)"]},refreshable:{type:Boolean,default:!0},isRefreshing:{type:Boolean},lastUpdated:{},showUpdateTime:{type:Boolean,default:!0},size:{default:"medium"}},emits:["refresh"],setup(__props){const{$t}=useTexts(),props=__props,cardClass=computed(()=>({[`card-${props.size}`]:!0})),badgeClass=computed(()=>({[`badge-${props.badgeType}`]:!0})),iconStyle=computed(()=>{const[from,to]=props.iconGradient;return{background:`linear-gradient(135deg, ${from} 0%, ${to} 100%)`}});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["dashboard-card",cardClass.value])},[createBaseVNode("div",_hoisted_1$a,[createBaseVNode("div",{class:"header-icon",style:normalizeStyle(iconStyle.value)},[renderSlot(_ctx.$slots,"icon",{},()=>[_cache[1]||(_cache[1]=createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1))],!0)],4),createBaseVNode("div",_hoisted_2$a,[createBaseVNode("h3",_hoisted_3$9,toDisplayString(__props.title),1),__props.badge?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["header-badge",badgeClass.value])},toDisplayString(__props.badge),3)):createCommentVNode("",!0)]),_ctx.$slots.extra?(openBlock(),createElementBlock("div",_hoisted_4$9,[renderSlot(_ctx.$slots,"extra",{},void 0,!0)])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_5$9,[renderSlot(_ctx.$slots,"default",{},void 0,!0)]),_ctx.$slots.footer||__props.showUpdateTime?(openBlock(),createElementBlock("div",_hoisted_6$9,[renderSlot(_ctx.$slots,"footer",{},()=>[__props.lastUpdated?(openBlock(),createElementBlock("span",_hoisted_7$9,toDisplayString(unref($t)("admin.dashboard.common.updatedAt"))+" "+toDisplayString(__props.lastUpdated),1)):createCommentVNode("",!0),__props.refreshable?(openBlock(),createElementBlock("button",{key:1,class:"refresh-btn",disabled:__props.isRefreshing,"aria-busy":__props.isRefreshing?"true":"false",onClick:_cache[0]||(_cache[0]=$event=>_ctx.$emit("refresh"))},[(openBlock(),createElementBlock("svg",{class:normalizeClass(["h-4 w-4",{"animate-spin":__props.isRefreshing}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[..._cache[2]||(_cache[2]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,_hoisted_8$9)):createCommentVNode("",!0)],!0)])):createCommentVNode("",!0)],2))}});const DashboardCard=_export_sfc(_sfc_main$a,[["__scopeId","data-v-221d2833"]]),_hoisted_1$9={class:"user-content"},_hoisted_2$9={class:"metric-main"},_hoisted_3$8={class:"metric-left"},_hoisted_4$8={class:"metric-value"},_hoisted_5$8={class:"metric-label"},_hoisted_6$8={class:"metric-right"},_hoisted_7$8={class:"today-upload"},_hoisted_8$8={class:"upload-count"},_hoisted_9$8={class:"upload-label"},_hoisted_10$8={class:"metrics-grid"},_hoisted_11$7={class:"metric-item"},_hoisted_12$7={class:"metric-label"},_hoisted_13$7={class:"metric-value-row"},_hoisted_14$7={class:"metric-number"},_hoisted_15$6={class:"metric-item"},_hoisted_16$6={class:"metric-label"},_hoisted_17$6={class:"metric-value-row"},_hoisted_18$6={class:"metric-number"},_hoisted_19$6={class:"metric-item"},_hoisted_20$6={class:"metric-label"},_hoisted_21$5={class:"metric-value-row"},_hoisted_22$4={class:"metric-number"},_sfc_main$9=defineComponent({name:"UserStatsCard",__name:"UserStatsCard",setup(__props){const{$t}=useTexts(),totalUsers=ref(0),activeUsersToday=ref(0),newUsersToday=ref(0),growthRate=ref(0),bannedUsers=ref(0),lastUpdated=ref(""),isRefreshing=ref(!1);computed(()=>growthRate.value>0?"trend-positive":growthRate.value<0?"trend-negative":"trend-neutral"),computed(()=>growthRate.value>0?"M7 14l3-3 3 3m-3-3v12":growthRate.value<0?"M17 10l-3 3-3-3m3 3V2":"M5 12h14");const safeGrowthRate=computed(()=>{const rate=growthRate.value;return rate==null||isNaN(rate)||!isFinite(rate)?0:Math.round(rate)}),formatNumber=num=>num==null||isNaN(num)||!isFinite(num)?"0":num>=1e6?`${(num/1e6).toFixed(1)}M`:num>=1e3?`${(num/1e3).toFixed(1)}K`:Math.round(num).toString(),fetchData=async()=>{const startTime=Date.now();isRefreshing.value=!0;try{const result=await getDashboardUserStats();if(result.success&&result.data){totalUsers.value=result.data.total_users||0,activeUsersToday.value=result.data.active_users_today||0,newUsersToday.value=result.data.new_users_today||0,growthRate.value=result.data.growth_rate||0,bannedUsers.value=result.data.banned_users||0;const now=new Date;lastUpdated.value=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`}}catch{}finally{const elapsed=Date.now()-startTime,delay=Math.max(0,1e3-elapsed),now=new Date,updated=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`;setTimeout(()=>{isRefreshing.value=!1,lastUpdated.value=updated},delay)}},refresh=()=>{isRefreshing.value||fetchData()};return onMounted(()=>{fetchData()}),(_ctx,_cache)=>(openBlock(),createBlock(DashboardCard,{title:unref($t)("admin.dashboard.userStats.title"),badge:`${safeGrowthRate.value>0?"+":""}${safeGrowthRate.value}%`,"badge-type":safeGrowthRate.value>0?"success":safeGrowthRate.value<0?"danger":"normal",refreshable:!0,"is-refreshing":isRefreshing.value,"last-updated":lastUpdated.value,onRefresh:refresh},{icon:withCtx(()=>[..._cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$9,[createBaseVNode("div",_hoisted_2$9,[createBaseVNode("div",_hoisted_3$8,[createBaseVNode("div",_hoisted_4$8,toDisplayString(formatNumber(totalUsers.value)),1),createBaseVNode("div",_hoisted_5$8,toDisplayString(unref($t)("admin.dashboard.userStats.totalUsers")),1)]),createBaseVNode("div",_hoisted_6$8,[createBaseVNode("div",_hoisted_7$8,[createBaseVNode("span",_hoisted_8$8,"+"+toDisplayString(formatNumber(newUsersToday.value)),1),createBaseVNode("span",_hoisted_9$8,toDisplayString(unref($t)("admin.dashboard.userStats.newToday")),1)])])]),createBaseVNode("div",_hoisted_10$8,[createBaseVNode("div",_hoisted_11$7,[createBaseVNode("span",_hoisted_12$7,toDisplayString(unref($t)("admin.dashboard.userStats.activeToday")),1),createBaseVNode("div",_hoisted_13$7,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"metric-icon active"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),createBaseVNode("span",_hoisted_14$7,toDisplayString(formatNumber(activeUsersToday.value)),1)])]),createBaseVNode("div",_hoisted_15$6,[createBaseVNode("span",_hoisted_16$6,toDisplayString(unref($t)("admin.dashboard.userStats.newToday")),1),createBaseVNode("div",_hoisted_17$6,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"metric-icon new"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 0 1 6 6H2a6 6 0 0 1 6-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})])],-1)),createBaseVNode("span",_hoisted_18$6,toDisplayString(formatNumber(newUsersToday.value)),1)])]),createBaseVNode("div",_hoisted_19$6,[createBaseVNode("span",_hoisted_20$6,toDisplayString(unref($t)("admin.dashboard.userStats.banned")),1),createBaseVNode("div",_hoisted_21$5,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"metric-icon danger"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_22$4,toDisplayString(formatNumber(bannedUsers.value)),1)])])])])]),_:1},8,["title","badge","badge-type","is-refreshing","last-updated"]))}});const UserStatsCard=_export_sfc(_sfc_main$9,[["__scopeId","data-v-178b5034"]]),_hoisted_1$8={class:"image-content"},_hoisted_2$8={class:"metric-main"},_hoisted_3$7={class:"metric-value"},_hoisted_4$7={class:"value-number"},_hoisted_5$7={class:"value-label"},_hoisted_6$7={class:"today-upload"},_hoisted_7$7={class:"upload-count"},_hoisted_8$7={class:"upload-label"},_hoisted_9$7={class:"metrics-grid"},_hoisted_10$7={class:"metric-item"},_hoisted_11$6={class:"metric-label"},_hoisted_12$6={class:"metric-value-row"},_hoisted_13$6={class:"metric-number"},_hoisted_14$6={class:"metric-item"},_hoisted_15$5={class:"metric-label"},_hoisted_16$5={class:"metric-value-row"},_hoisted_17$5={class:"metric-number"},_hoisted_18$5={class:"metric-item"},_hoisted_19$5={class:"metric-value-row"},_hoisted_20$5={class:"metric-number"},_sfc_main$8=defineComponent({name:"ImageStatsCard",__name:"FileStatsCard",setup(__props){const{$t}=useTexts(),totalImages=ref(0),uploadedToday=ref(0),aiTaggedPercentage=ref(0),pendingReview=ref(0),nsfwDetected=ref(0),untaggedCount=ref(0),lastUpdated=ref(""),isRefreshing=ref(!1),safeAiTaggedPercentage=computed(()=>{const percentage=aiTaggedPercentage.value;return percentage==null||isNaN(percentage)||!isFinite(percentage)?0:Math.round(percentage)}),formatNumber=num=>num==null||isNaN(num)||!isFinite(num)?"0":num>=1e6?`${(num/1e6).toFixed(1)}M`:num>=1e3?`${(num/1e3).toFixed(1)}K`:Math.round(num).toString(),fetchData=async()=>{const startTime=Date.now();isRefreshing.value=!0;try{const result=await getDashboardImageStats();if(result.success&&result.data){totalImages.value=result.data.total_files||0,uploadedToday.value=result.data.uploaded_today||0,aiTaggedPercentage.value=Math.round(result.data.ai_tagged_percentage||0),pendingReview.value=result.data.pending_review||0,nsfwDetected.value=result.data.nsfw_detected||0,untaggedCount.value=result.data.untagged_count||0;const now=new Date;lastUpdated.value=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`}}catch{}finally{const elapsed=Date.now()-startTime,delay=Math.max(0,1e3-elapsed),now=new Date,updated=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`;setTimeout(()=>{isRefreshing.value=!1,lastUpdated.value,lastUpdated.value=updated},delay)}},refresh=()=>{isRefreshing.value||fetchData()};return onMounted(()=>{fetchData()}),(_ctx,_cache)=>(openBlock(),createBlock(DashboardCard,{title:unref($t)("admin.dashboard.fileStats.title"),badge:`AI ${safeAiTaggedPercentage.value}%`,"badge-type":safeAiTaggedPercentage.value>=80?"success":safeAiTaggedPercentage.value>=60?"warning":"danger",refreshable:!0,"is-refreshing":isRefreshing.value,"last-updated":lastUpdated.value,onRefresh:refresh},{icon:withCtx(()=>[..._cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$8,[createBaseVNode("div",_hoisted_2$8,[createBaseVNode("div",_hoisted_3$7,[createBaseVNode("span",_hoisted_4$7,toDisplayString(formatNumber(totalImages.value)),1),createBaseVNode("span",_hoisted_5$7,toDisplayString(unref($t)("admin.dashboard.fileStats.totalFiles")),1)]),createBaseVNode("div",_hoisted_6$7,[createBaseVNode("span",_hoisted_7$7,"+"+toDisplayString(uploadedToday.value),1),createBaseVNode("span",_hoisted_8$7,toDisplayString(unref($t)("admin.dashboard.fileStats.uploadedToday")),1)])]),createBaseVNode("div",_hoisted_9$7,[createBaseVNode("div",_hoisted_10$7,[createBaseVNode("span",_hoisted_11$6,toDisplayString(unref($t)("admin.dashboard.fileStats.pendingReview")),1),createBaseVNode("div",_hoisted_12$6,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"metric-icon pending"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_13$6,toDisplayString(formatNumber(pendingReview.value)),1)])]),createBaseVNode("div",_hoisted_14$6,[createBaseVNode("span",_hoisted_15$5,toDisplayString(unref($t)("admin.dashboard.fileStats.untagged")),1),createBaseVNode("div",_hoisted_16$5,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"metric-icon untagged"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_17$5,toDisplayString(formatNumber(untaggedCount.value)),1)])]),createBaseVNode("div",_hoisted_18$5,[_cache[4]||(_cache[4]=createBaseVNode("span",{class:"metric-label"},"NSFW",-1)),createBaseVNode("div",_hoisted_19$5,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"metric-icon danger"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_20$5,toDisplayString(formatNumber(nsfwDetected.value)),1)])])])])]),_:1},8,["title","badge","badge-type","is-refreshing","last-updated"]))}});const FileStatsCard=_export_sfc(_sfc_main$8,[["__scopeId","data-v-b18096e6"]]),_hoisted_1$7={class:"storage-content"},_hoisted_2$7={class:"main-metric"},_hoisted_3$6={class:"metric-value"},_hoisted_4$6={class:"value-number"},_hoisted_5$6={class:"value-label"},_hoisted_6$6={class:"today-upload"},_hoisted_7$6={class:"upload-count"},_hoisted_8$6={class:"upload-label"},_hoisted_9$6={class:"sub-metrics"},_hoisted_10$6={class:"metric-item"},_hoisted_11$5={class:"metric-label"},_hoisted_12$5={class:"metric-value-row"},_hoisted_13$5={class:"metric-number"},_hoisted_14$5={class:"metric-item"},_hoisted_15$4={class:"metric-label"},_hoisted_16$4={class:"metric-value-row"},_hoisted_17$4={key:0,class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_18$4={key:1,class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_19$4={class:"metric-number"},_hoisted_20$4={class:"metric-item"},_hoisted_21$4={class:"metric-label"},_hoisted_22$3={class:"metric-value-row"},_hoisted_23$3={class:"metric-number"},_sfc_main$7=defineComponent({name:"StorageStatsCard",__name:"StorageStatsCard",setup(__props){const{$t}=useTexts(),totalStorage=ref(0),formattedStorage=ref("0 B"),averageFileSize=ref(0),usagePercentage=ref(0),growthRate=ref(0),totalBandwidth=ref(0),formattedBandwidth=ref("0 B"),newStorageToday=ref(0),formattedNewStorage=ref("0 B"),lastUpdated=ref(""),isRefreshing=ref(!1),dailyChangeRate=computed(()=>{const yesterday=totalStorage.value-newStorageToday.value;if(yesterday<=0||newStorageToday.value===0)return 0;const rate=newStorageToday.value/yesterday*100;return isNaN(rate)||!isFinite(rate)?0:rate}),formatBytes=bytes=>bytes==null||isNaN(bytes)||!isFinite(bytes)||bytes<=0?"0 B":bytes>=1024*1024*1024?`${(bytes/(1024*1024*1024)).toFixed(1)} GB`:bytes>=1024*1024?`${(bytes/(1024*1024)).toFixed(1)} MB`:bytes>=1024?`${(bytes/1024).toFixed(1)} KB`:`${bytes.toFixed(0)} B`,fetchData=async()=>{const startTime=Date.now();isRefreshing.value=!0;try{const result=await getDashboardStorageStats();if(result.success&&result.data){totalStorage.value=result.data.total_storage||0,formattedStorage.value=result.data.formatted_storage||"0 B",averageFileSize.value=result.data.average_file_size||0,usagePercentage.value=Math.round(result.data.usage_percentage||0),growthRate.value=result.data.growth_rate||0,totalBandwidth.value=result.data.total_bandwidth||0,formattedBandwidth.value=result.data.formatted_bandwidth||"0 B",newStorageToday.value=result.data.new_storage_today||0,formattedNewStorage.value=result.data.formatted_new_storage||"0 B";const now=new Date;lastUpdated.value=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`}}catch{}finally{const elapsed=Date.now()-startTime,delay=Math.max(0,1e3-elapsed),now=new Date,updated=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`;setTimeout(()=>{isRefreshing.value=!1,lastUpdated.value,lastUpdated.value=updated},delay)}},refresh=()=>{isRefreshing.value||fetchData()};return onMounted(()=>{fetchData()}),(_ctx,_cache)=>(openBlock(),createBlock(DashboardCard,{title:unref($t)("admin.dashboard.storageStats.title"),badge:`${dailyChangeRate.value>0?"+":""}${dailyChangeRate.value.toFixed(1)}%`,"badge-type":dailyChangeRate.value>0?"success":dailyChangeRate.value<0?"danger":"normal",refreshable:!0,"is-refreshing":isRefreshing.value,"last-updated":lastUpdated.value,onRefresh:refresh},{icon:withCtx(()=>[..._cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})],-1)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$7,[createBaseVNode("div",_hoisted_2$7,[createBaseVNode("div",_hoisted_3$6,[createBaseVNode("span",_hoisted_4$6,toDisplayString(formattedStorage.value),1),createBaseVNode("span",_hoisted_5$6,toDisplayString(unref($t)("admin.dashboard.storageStats.totalStorage")),1)]),createBaseVNode("div",_hoisted_6$6,[createBaseVNode("span",_hoisted_7$6,toDisplayString(formattedNewStorage.value),1),createBaseVNode("span",_hoisted_8$6,toDisplayString(unref($t)("admin.dashboard.storageStats.newToday")),1)])]),createBaseVNode("div",_hoisted_9$6,[createBaseVNode("div",_hoisted_10$6,[createBaseVNode("span",_hoisted_11$5,toDisplayString(unref($t)("admin.dashboard.storageStats.averageSize")),1),createBaseVNode("div",_hoisted_12$5,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"metric-icon size"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_13$5,toDisplayString(formatBytes(averageFileSize.value)),1)])]),createBaseVNode("div",_hoisted_14$5,[createBaseVNode("span",_hoisted_15$4,toDisplayString(unref($t)("admin.dashboard.storageStats.growthRate")),1),createBaseVNode("div",_hoisted_16$4,[createBaseVNode("div",{class:normalizeClass(["metric-icon growth",{negative:growthRate.value<0}])},[growthRate.value>=0?(openBlock(),createElementBlock("svg",_hoisted_17$4,[..._cache[2]||(_cache[2]=[createBaseVNode("path",{"fill-rule":"evenodd",d:"M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"},null,-1)])])):(openBlock(),createElementBlock("svg",_hoisted_18$4,[..._cache[3]||(_cache[3]=[createBaseVNode("path",{"fill-rule":"evenodd",d:"M16.707 10.293a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 111.414-1.414L9 14.586V3a1 1 0 012 0v11.586l4.293-4.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])]))],2),createBaseVNode("span",_hoisted_19$4,toDisplayString(Math.abs(growthRate.value).toFixed(1))+"%",1)])]),createBaseVNode("div",_hoisted_20$4,[createBaseVNode("span",_hoisted_21$4,toDisplayString(unref($t)("admin.dashboard.storageStats.totalBandwidth")),1),createBaseVNode("div",_hoisted_22$3,[_cache[4]||(_cache[4]=createBaseVNode("div",{class:"metric-icon size"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M4 3h12a1 1 0 011 1v12a1 1 0 01-1 1H4a1 1 0 01-1-1V4a1 1 0 011-1zm3 4a1 1 0 000 2h6a1 1 0 100-2H7zm0 4a1 1 0 000 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_23$3,toDisplayString(formattedBandwidth.value),1)])])])])]),_:1},8,["title","badge","badge-type","is-refreshing","last-updated"]))}});const StorageStatsCard=_export_sfc(_sfc_main$7,[["__scopeId","data-v-59484e33"]]),_hoisted_1$6={class:"share-content"},_hoisted_2$6={class:"main-metric"},_hoisted_3$5={class:"metric-value"},_hoisted_4$5={class:"value-number"},_hoisted_5$5={class:"value-label"},_hoisted_6$5={class:"today-upload"},_hoisted_7$5={class:"upload-count"},_hoisted_8$5={class:"upload-label"},_hoisted_9$5={class:"sub-metrics"},_hoisted_10$5={class:"metric-item"},_hoisted_11$4={class:"metric-label"},_hoisted_12$4={class:"metric-value-row"},_hoisted_13$4={class:"metric-number"},_hoisted_14$4={class:"metric-item"},_hoisted_15$3={class:"metric-label"},_hoisted_16$3={class:"metric-value-row"},_hoisted_17$3={class:"metric-number"},_hoisted_18$3={class:"metric-item"},_hoisted_19$3={class:"metric-label"},_hoisted_20$3={class:"metric-value-row"},_hoisted_21$3={class:"metric-number"},_sfc_main$6=defineComponent({name:"ShareStatsCard",__name:"ShareStatsCard",setup(__props){const{$t}=useTexts(),totalShares=ref(0),publicShares=ref(0),privateShares=ref(0),totalVisits=ref(0),totalDownloads=ref(0),growthRate=ref(0),newSharesToday=ref(0),lastUpdated=ref(""),isRefreshing=ref(!1);computed(()=>totalShares.value>0?Math.round(publicShares.value/totalShares.value*100):0),computed(()=>totalShares.value>0?Math.round(privateShares.value/totalShares.value*100):0);const safeGrowthRate=computed(()=>{const rate=growthRate.value;return rate==null||isNaN(rate)||!isFinite(rate)?0:Math.round(rate)}),formatNumber=num=>num==null||isNaN(num)||!isFinite(num)?"0":num>=1e6?`${(num/1e6).toFixed(1)}M`:num>=1e3?`${(num/1e3).toFixed(1)}K`:Math.round(num).toString(),fetchData=async()=>{const startTime=Date.now();isRefreshing.value=!0;try{const result=await getDashboardShareStats();if(result.success&&result.data){totalShares.value=result.data.total_shares||0,publicShares.value=result.data.public_shares||0,privateShares.value=result.data.private_shares||0,totalVisits.value=result.data.total_visits||0,totalDownloads.value=result.data.total_downloads||0,growthRate.value=result.data.growth_rate||0,newSharesToday.value=result.data.new_shares_today||0;const now=new Date;lastUpdated.value=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`}}catch{}finally{const elapsed=Date.now()-startTime,delay=Math.max(0,1e3-elapsed),now=new Date,updated=`${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`;setTimeout(()=>{isRefreshing.value=!1,lastUpdated.value,lastUpdated.value=updated},delay)}},refresh=()=>{isRefreshing.value||fetchData()};return onMounted(()=>{fetchData()}),(_ctx,_cache)=>(openBlock(),createBlock(DashboardCard,{title:unref($t)("admin.dashboard.shareStats.title"),badge:`${safeGrowthRate.value>0?"+":""}${safeGrowthRate.value}%`,"badge-type":safeGrowthRate.value>0?"success":"normal",refreshable:!0,"is-refreshing":isRefreshing.value,"last-updated":lastUpdated.value,onRefresh:refresh},{icon:withCtx(()=>[..._cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})],-1)])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$6,[createBaseVNode("div",_hoisted_2$6,[createBaseVNode("div",_hoisted_3$5,[createBaseVNode("span",_hoisted_4$5,toDisplayString(formatNumber(totalShares.value)),1),createBaseVNode("span",_hoisted_5$5,toDisplayString(unref($t)("admin.dashboard.shareStats.totalShares")),1)]),createBaseVNode("div",_hoisted_6$5,[createBaseVNode("span",_hoisted_7$5,toDisplayString(formatNumber(newSharesToday.value)),1),createBaseVNode("span",_hoisted_8$5,toDisplayString(unref($t)("admin.dashboard.shareStats.newToday")),1)])]),createBaseVNode("div",_hoisted_9$5,[createBaseVNode("div",_hoisted_10$5,[createBaseVNode("span",_hoisted_11$4,toDisplayString(unref($t)("admin.dashboard.shareStats.publicShares")),1),createBaseVNode("div",_hoisted_12$4,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"metric-icon public"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),createBaseVNode("path",{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_13$4,toDisplayString(formatNumber(publicShares.value)),1)])]),createBaseVNode("div",_hoisted_14$4,[createBaseVNode("span",_hoisted_15$3,toDisplayString(unref($t)("admin.dashboard.shareStats.privateShares")),1),createBaseVNode("div",_hoisted_16$3,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"metric-icon private"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_17$3,toDisplayString(formatNumber(privateShares.value)),1)])]),createBaseVNode("div",_hoisted_18$3,[createBaseVNode("span",_hoisted_19$3,toDisplayString(unref($t)("admin.dashboard.shareStats.totalDownloads")),1),createBaseVNode("div",_hoisted_20$3,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"metric-icon downloads"},[createBaseVNode("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1)),createBaseVNode("span",_hoisted_21$3,toDisplayString(formatNumber(totalDownloads.value)),1)])])])])]),_:1},8,["title","badge","badge-type","is-refreshing","last-updated"]))}});const ShareStatsCard=_export_sfc(_sfc_main$6,[["__scopeId","data-v-29c0e5a6"]]),_hoisted_1$5={class:"metrics-overview"},_hoisted_2$5={class:"metrics-row"},_sfc_main$5=defineComponent({name:"DashboardMetricsRow",__name:"DashboardMetricsRow",props:{refreshKey:{}},setup(__props){return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$5,[(openBlock(),createBlock(UserStatsCard,{key:__props.refreshKey})),(openBlock(),createBlock(FileStatsCard,{key:__props.refreshKey})),(openBlock(),createBlock(StorageStatsCard,{key:__props.refreshKey})),(openBlock(),createBlock(ShareStatsCard,{key:__props.refreshKey}))])]))}});const DashboardMetricsRow=_export_sfc(_sfc_main$5,[["__scopeId","data-v-aafb5a8c"]]),_hoisted_1$4={class:"ai-services-card"},_hoisted_2$4={class:"card-header"},_hoisted_3$4={class:"header-title"},_hoisted_4$4={class:"card-content"},_hoisted_5$4={key:0,class:"services-columns"},_hoisted_6$4={class:"service-column"},_hoisted_7$4={class:"service-header"},_hoisted_8$4={class:"service-info"},_hoisted_9$4={class:"service-title"},_hoisted_10$4={class:"service-name"},_hoisted_11$3={class:"completion-rate"},_hoisted_12$3={class:"service-stats"},_hoisted_13$3={class:"stat-item primary"},_hoisted_14$3={class:"stat-info"},_hoisted_15$2={class:"stat-value"},_hoisted_16$2={class:"stat-label"},_hoisted_17$2={class:"stat-item success"},_hoisted_18$2={class:"stat-info"},_hoisted_19$2={class:"stat-value"},_hoisted_20$2={class:"stat-label"},_hoisted_21$2={class:"stat-item warning"},_hoisted_22$2={class:"stat-info"},_hoisted_23$2={class:"stat-value"},_hoisted_24$2={class:"stat-label"},_hoisted_25$2={class:"stat-item processing"},_hoisted_26$1={class:"stat-info"},_hoisted_27$1={class:"stat-value"},_hoisted_28={class:"stat-label"},_hoisted_29={class:"stat-item danger"},_hoisted_30={class:"stat-info"},_hoisted_31={class:"stat-value"},_hoisted_32={class:"stat-label"},_hoisted_33={class:"stat-item muted"},_hoisted_34={class:"stat-info"},_hoisted_35={class:"stat-value"},_hoisted_36={class:"stat-label"},_hoisted_37={class:"service-column"},_hoisted_38={class:"service-header"},_hoisted_39={class:"service-info"},_hoisted_40={class:"service-title"},_hoisted_41={class:"service-name"},_hoisted_42={class:"completion-rate"},_hoisted_43={class:"service-stats"},_hoisted_44={class:"stat-item primary"},_hoisted_45={class:"stat-info"},_hoisted_46={class:"stat-value"},_hoisted_47={class:"stat-label"},_hoisted_48={class:"stat-item success"},_hoisted_49={class:"stat-info"},_hoisted_50={class:"stat-value"},_hoisted_51={class:"stat-label"},_hoisted_52={class:"stat-item warning"},_hoisted_53={class:"stat-info"},_hoisted_54={class:"stat-value"},_hoisted_55={class:"stat-label"},_hoisted_56={class:"stat-item processing"},_hoisted_57={class:"stat-info"},_hoisted_58={class:"stat-value"},_hoisted_59={class:"stat-label"},_hoisted_60={class:"stat-item danger"},_hoisted_61={class:"stat-info"},_hoisted_62={class:"stat-value"},_hoisted_63={class:"stat-label"},_hoisted_64={class:"stat-item muted"},_hoisted_65={class:"stat-info"},_hoisted_66={class:"stat-value"},_hoisted_67={class:"stat-label"},_hoisted_68={key:1,class:"empty-state"},_hoisted_69={class:"empty-title"},_hoisted_70={class:"empty-subtitle"},_sfc_main$4=defineComponent({name:"AIServicesCard",__name:"AIServicesCard",setup(__props){const{$t}=useTexts(),loading=ref(!1),taggingData=ref(null),vectorData=ref(null),data=computed(()=>{const tagging={total_count:0,none_count:0,pending_count:0,done_count:0,failed_count:0,skipped_count:0,ignored_count:0};taggingData.value?.status_stats&&taggingData.value.status_stats.forEach(item=>{switch(tagging.total_count+=item.count,item.status){case"none":tagging.none_count=item.count;break;case"pending":tagging.pending_count=item.count;break;case"done":tagging.done_count=item.count;break;case"failed":tagging.failed_count=item.count;break;case"ignored":tagging.ignored_count=item.count;break}});const vectors={total_count:vectorData.value?.total_count||0,pending_count:vectorData.value?.pending_count||0,processing_count:vectorData.value?.running_count||0,completed_count:vectorData.value?.completed_count||0,failed_count:vectorData.value?.failed_count||0,reset_count:vectorData.value?.reset_count||0,active_workers:vectorData.value?.active_workers||0,max_workers:vectorData.value?.max_workers||0};return{tagging,vectors,health_status:{tagging_service:taggingData.value?"healthy":"down",vector_service:vectorData.value?"healthy":"down"}}}),hasData=computed(()=>data.value.tagging.total_count>0||data.value.vectors.total_count>0||data.value.tagging.pending_count>0||data.value.vectors.processing_count>0),formatNumber=num=>num>=1e6?`${(num/1e6).toFixed(1)}M`:num>=1e3?`${(num/1e3).toFixed(1)}K`:num.toString(),getCompletionRate=(completed,total)=>total===0?"0%":`${Math.round(completed/total*100)}%`;function getStatusClass(status){switch(status){case"healthy":return"status-healthy";case"degraded":return"status-warning";case"down":return"status-danger";default:return"status-unknown"}}function getStatusText(status){switch(status){case"healthy":return $t("admin.dashboard.aiServices.statusNormal");case"degraded":return $t("admin.dashboard.aiServices.statusDegraded");case"down":return $t("admin.dashboard.aiServices.statusDown");default:return $t("admin.dashboard.aiServices.statusUnknown")}}async function fetchData(){try{loading.value=!0;const[taggingResult,vectorResult]=await Promise.all([getTaggingStats().catch(()=>({success:!1,data:null})),getVectorStats().catch(()=>({success:!1,data:null}))]);taggingResult?.success&&taggingResult.data&&(taggingData.value=taggingResult.data),vectorResult?.success&&vectorResult.data&&(vectorData.value=vectorResult.data)}catch{}finally{loading.value=!1}}function refresh(){fetchData()}return onMounted(()=>{fetchData()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$4,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"header-icon"},[createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),createBaseVNode("div",_hoisted_3$4,[createBaseVNode("h3",null,toDisplayString(unref($t)("admin.dashboard.aiServices.title")),1)]),createBaseVNode("div",{class:"refresh-btn",onClick:refresh},[(openBlock(),createElementBlock("svg",{class:normalizeClass(["h-4 w-4",{"animate-spin":loading.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[..._cache[0]||(_cache[0]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))])]),createBaseVNode("div",_hoisted_4$4,[hasData.value?(openBlock(),createElementBlock("div",_hoisted_5$4,[createBaseVNode("div",_hoisted_6$4,[createBaseVNode("div",_hoisted_7$4,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"service-icon tagging"},[createBaseVNode("svg",{class:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"})])],-1)),createBaseVNode("div",_hoisted_8$4,[createBaseVNode("div",_hoisted_9$4,[createBaseVNode("span",_hoisted_10$4,toDisplayString(unref($t)("admin.dashboard.aiServices.taggingService")),1),createBaseVNode("span",_hoisted_11$3,toDisplayString(getCompletionRate(data.value.tagging.done_count,data.value.tagging.total_count)),1)]),createBaseVNode("div",{class:normalizeClass(["service-status",getStatusClass(data.value.health_status.tagging_service)])},[_cache[2]||(_cache[2]=createBaseVNode("span",{class:"status-dot"},null,-1)),createTextVNode(" "+toDisplayString(getStatusText(data.value.health_status.tagging_service)),1)],2)])]),createBaseVNode("div",_hoisted_12$3,[createBaseVNode("div",_hoisted_13$3,[createBaseVNode("div",_hoisted_14$3,[createBaseVNode("div",_hoisted_15$2,toDisplayString(formatNumber(data.value.tagging.total_count)),1),createBaseVNode("div",_hoisted_16$2,toDisplayString(unref($t)("admin.dashboard.aiServices.totalCount")),1)]),_cache[4]||(_cache[4]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-database"})],-1))]),createBaseVNode("div",_hoisted_17$2,[createBaseVNode("div",_hoisted_18$2,[createBaseVNode("div",_hoisted_19$2,toDisplayString(formatNumber(data.value.tagging.done_count)),1),createBaseVNode("div",_hoisted_20$2,toDisplayString(unref($t)("admin.dashboard.aiServices.completed")),1)]),_cache[5]||(_cache[5]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-check"})],-1))]),createBaseVNode("div",_hoisted_21$2,[createBaseVNode("div",_hoisted_22$2,[createBaseVNode("div",_hoisted_23$2,toDisplayString(formatNumber(data.value.tagging.none_count)),1),createBaseVNode("div",_hoisted_24$2,toDisplayString(unref($t)("admin.dashboard.aiServices.unprocessed")),1)]),_cache[6]||(_cache[6]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-clock"})],-1))]),createBaseVNode("div",_hoisted_25$2,[createBaseVNode("div",_hoisted_26$1,[createBaseVNode("div",_hoisted_27$1,toDisplayString(formatNumber(data.value.tagging.pending_count)),1),createBaseVNode("div",_hoisted_28,toDisplayString(unref($t)("admin.dashboard.aiServices.processing")),1)]),_cache[7]||(_cache[7]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-spinner fa-spin"})],-1))]),createBaseVNode("div",_hoisted_29,[createBaseVNode("div",_hoisted_30,[createBaseVNode("div",_hoisted_31,toDisplayString(formatNumber(data.value.tagging.failed_count)),1),createBaseVNode("div",_hoisted_32,toDisplayString(unref($t)("admin.dashboard.aiServices.failed")),1)]),_cache[8]||(_cache[8]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-times"})],-1))]),createBaseVNode("div",_hoisted_33,[createBaseVNode("div",_hoisted_34,[createBaseVNode("div",_hoisted_35,toDisplayString(formatNumber(data.value.tagging.skipped_count)),1),createBaseVNode("div",_hoisted_36,toDisplayString(unref($t)("admin.dashboard.aiServices.skipped")),1)]),_cache[9]||(_cache[9]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-forward"})],-1))])])]),createBaseVNode("div",_hoisted_37,[createBaseVNode("div",_hoisted_38,[_cache[11]||(_cache[11]=createBaseVNode("div",{class:"service-icon vector"},[createBaseVNode("svg",{class:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})])],-1)),createBaseVNode("div",_hoisted_39,[createBaseVNode("div",_hoisted_40,[createBaseVNode("span",_hoisted_41,toDisplayString(unref($t)("admin.dashboard.aiServices.vectorService")),1),createBaseVNode("span",_hoisted_42,toDisplayString(getCompletionRate(data.value.vectors.completed_count,data.value.vectors.total_count)),1)]),createBaseVNode("div",{class:normalizeClass(["service-status",getStatusClass(data.value.health_status.vector_service)])},[_cache[10]||(_cache[10]=createBaseVNode("span",{class:"status-dot"},null,-1)),createTextVNode(" "+toDisplayString(getStatusText(data.value.health_status.vector_service)),1)],2)])]),createBaseVNode("div",_hoisted_43,[createBaseVNode("div",_hoisted_44,[createBaseVNode("div",_hoisted_45,[createBaseVNode("div",_hoisted_46,toDisplayString(formatNumber(data.value.vectors.total_count)),1),createBaseVNode("div",_hoisted_47,toDisplayString(unref($t)("admin.dashboard.aiServices.totalCount")),1)]),_cache[12]||(_cache[12]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-database"})],-1))]),createBaseVNode("div",_hoisted_48,[createBaseVNode("div",_hoisted_49,[createBaseVNode("div",_hoisted_50,toDisplayString(formatNumber(data.value.vectors.completed_count)),1),createBaseVNode("div",_hoisted_51,toDisplayString(unref($t)("admin.dashboard.aiServices.completed")),1)]),_cache[13]||(_cache[13]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-check"})],-1))]),createBaseVNode("div",_hoisted_52,[createBaseVNode("div",_hoisted_53,[createBaseVNode("div",_hoisted_54,toDisplayString(formatNumber(data.value.vectors.pending_count)),1),createBaseVNode("div",_hoisted_55,toDisplayString(unref($t)("admin.dashboard.aiServices.pending")),1)]),_cache[14]||(_cache[14]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-clock"})],-1))]),createBaseVNode("div",_hoisted_56,[createBaseVNode("div",_hoisted_57,[createBaseVNode("div",_hoisted_58,toDisplayString(formatNumber(data.value.vectors.processing_count)),1),createBaseVNode("div",_hoisted_59,toDisplayString(unref($t)("admin.dashboard.aiServices.processing")),1)]),_cache[15]||(_cache[15]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-cog fa-spin"})],-1))]),createBaseVNode("div",_hoisted_60,[createBaseVNode("div",_hoisted_61,[createBaseVNode("div",_hoisted_62,toDisplayString(formatNumber(data.value.vectors.failed_count)),1),createBaseVNode("div",_hoisted_63,toDisplayString(unref($t)("admin.dashboard.aiServices.failed")),1)]),_cache[16]||(_cache[16]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-times"})],-1))]),createBaseVNode("div",_hoisted_64,[createBaseVNode("div",_hoisted_65,[createBaseVNode("div",_hoisted_66,toDisplayString(data.value.vectors.active_workers)+"/"+toDisplayString(data.value.vectors.max_workers),1),createBaseVNode("div",_hoisted_67,toDisplayString(unref($t)("admin.dashboard.aiServices.workers")),1)]),_cache[17]||(_cache[17]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-server"})],-1))])])])])):(openBlock(),createElementBlock("div",_hoisted_68,[_cache[18]||(_cache[18]=createBaseVNode("div",{class:"empty-icon"},"ðŸ¤–",-1)),createBaseVNode("div",_hoisted_69,toDisplayString(unref($t)("admin.dashboard.aiServices.emptyTitle")),1),createBaseVNode("div",_hoisted_70,toDisplayString(unref($t)("admin.dashboard.aiServices.emptySubtitle")),1)]))])]))}});const AIServicesCard=_export_sfc(_sfc_main$4,[["__scopeId","data-v-1c12c4f7"]]),_hoisted_1$3={class:"chart-card upload-trends"},_hoisted_2$3={class:"card-header"},_hoisted_3$3={class:"header-info"},_hoisted_4$3={class:"time-selector"},_hoisted_5$3={class:"chart-content"},_hoisted_6$3={key:0,class:"chart-loading"},_hoisted_7$3={key:1,class:"chart-wrapper"},_hoisted_8$3={key:2,class:"empty-state"},_hoisted_9$3={class:"empty-title"},_hoisted_10$3={class:"empty-subtitle"},_hoisted_11$2={key:3,class:"chart-summary"},_hoisted_12$2={class:"summary-item"},_hoisted_13$2={class:"summary-value"},_hoisted_14$2={class:"summary-label"},_hoisted_15$1={class:"summary-item"},_hoisted_16$1={class:"summary-value"},_hoisted_17$1={class:"summary-label"},_hoisted_18$1={class:"summary-item storage"},_hoisted_19$1={class:"summary-value"},_hoisted_20$1={class:"summary-label"},_hoisted_21$1={class:"summary-item storage"},_hoisted_22$1={class:"summary-value"},_hoisted_23$1={class:"summary-label"},_hoisted_24$1={class:"summary-item"},_hoisted_25$1={class:"summary-label"},_sfc_main$3=defineComponent({name:"UploadTrendsChart",__name:"UploadTrendsChart",setup(__props){const{$t}=useTexts(),{appliedTheme}=useTheme(),selectedDays=ref("15"),isLoading=ref(!1),chartContainer=ref(),chartData=ref({timeline:[],uploadCounts:[],storageGrowth:[]});let chartInstance=null;const timeOptions=computed(()=>[{value:"7",label:$t("admin.dashboard.uploadTrends.last7Days")},{value:"15",label:$t("admin.dashboard.uploadTrends.last15Days")},{value:"30",label:$t("admin.dashboard.uploadTrends.last30Days")}]),hasData=computed(()=>chartData.value.timeline.length>0&&chartData.value.uploadCounts.length>0),totalUploads=computed(()=>chartData.value.uploadCounts.reduce((sum,count)=>sum+count,0)),avgDaily=computed(()=>{const counts=chartData.value.uploadCounts;return counts.length>0?Math.round(totalUploads.value/counts.length):0}),trendPercentage=computed(()=>{const counts=chartData.value.uploadCounts;if(counts.length<2)return 0;const recent=counts.slice(-3).reduce((sum,count)=>sum+count,0)/3,earlier=counts.slice(0,3).reduce((sum,count)=>sum+count,0)/3;return earlier===0?0:Math.round((recent-earlier)/earlier*100)}),totalStorageGrowth=computed(()=>chartData.value.storageGrowth.reduce((sum,size)=>sum+size,0)),formattedStorageGrowth=computed(()=>{const bytes=totalStorageGrowth.value;if(bytes===0||isNaN(bytes)||!isFinite(bytes))return"0 B";const k=1024,sizes=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(bytes)/Math.log(k));if(isNaN(i)||!isFinite(i)||i<0)return"0 B";const sizeIndex=Math.min(i,sizes.length-1);return`${(bytes/Math.pow(k,sizeIndex)).toFixed(2)} ${sizes[sizeIndex]}`}),avgDailyStorage=computed(()=>{const growth=chartData.value.storageGrowth;if(growth.length===0)return"0 B";const avgBytes=totalStorageGrowth.value/growth.length;if(avgBytes===0||isNaN(avgBytes)||!isFinite(avgBytes))return"0 B";const k=1024,sizes=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(avgBytes)/Math.log(k));return isNaN(i)||!isFinite(i)||i<0?"0 B":`${(avgBytes/Math.pow(k,i)).toFixed(2)} ${sizes[i]}`}),fetchData=async()=>{isLoading.value=!0;try{const days=parseInt(selectedDays.value),result=await getDashboardUploadTrends(days);result?.success&&result.data?(chartData.value={timeline:result.data.timeline||[],uploadCounts:result.data.upload_counts||[],storageGrowth:result.data.storage_growth||[]},await nextTick(),setTimeout(()=>{renderChart()},100)):chartData.value={timeline:[],uploadCounts:[],storageGrowth:[]}}catch{chartData.value={timeline:[],uploadCounts:[],storageGrowth:[]}}finally{isLoading.value=!1}},renderChart=()=>{if(!chartContainer.value||!hasData.value)return;chartInstance&&(chartInstance.dispose(),chartInstance=null),chartInstance=init(chartContainer.value);const rootStyles=getComputedStyle(document.documentElement),contentHeading=rootStyles.getPropertyValue("--color-content-heading").trim(),contentDefault=rootStyles.getPropertyValue("--color-content-default").trim(),contentMuted=rootStyles.getPropertyValue("--color-content-muted").trim(),bg700=rootStyles.getPropertyValue("--color-background-700").trim(),bg700Rgb=rootStyles.getPropertyValue("--color-background-700-rgb").trim(),brand500=rootStyles.getPropertyValue("--color-brand-500").trim(),brand500Rgb=rootStyles.getPropertyValue("--color-brand-500-rgb").trim(),success500=brand500,successRgb=brand500Rgb,formatBytes=bytes=>{if(bytes===0||isNaN(bytes)||!isFinite(bytes)||bytes==null)return"0 B";const k=1024,sizes=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(bytes)/Math.log(k));if(isNaN(i)||!isFinite(i)||i<0)return"0 B";const sizeIndex=Math.min(i,sizes.length-1);return`${(bytes/Math.pow(k,sizeIndex)).toFixed(2)} ${sizes[sizeIndex]}`};let effectiveLength=chartData.value.uploadCounts.length,hasNonZeroData=!1;for(let i=chartData.value.uploadCounts.length-1;i>=0;i--)if(chartData.value.uploadCounts[i]>0){effectiveLength=i+1,hasNonZeroData=!0;break}hasNonZeroData||(effectiveLength=chartData.value.uploadCounts.length);const effectiveTimeline=chartData.value.timeline.slice(0,effectiveLength),effectiveCounts=chartData.value.uploadCounts.slice(0,effectiveLength),effectiveStorage=chartData.value.storageGrowth.slice(0,effectiveLength),xAxisData=effectiveTimeline.map(dateStr=>{const date=new Date(dateStr);return`${date.getMonth()+1}/${date.getDate()}`}),option={backgroundColor:"transparent",grid:{left:"1%",right:"1%",bottom:"3%",top:"10%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:`rgba(${bg700Rgb}, 0.95)`,borderColor:brand500,borderWidth:1,borderRadius:8,textStyle:{color:contentHeading,fontSize:12},extraCssText:`backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(${brand500Rgb}, 0.3), 0 0 16px rgba(${brand500Rgb}, 0.1);`,formatter(params){if(!params||params.length===0)return"";const uploadParam=params[0],storageParam=params[1],{name}=uploadParam;return`
          <div class="radius-sm" style="padding: 12px;">
            <div style="color: ${brand500}; font-weight: 600; margin-bottom: 10px; font-size: 14px; text-shadow: 0 0 8px rgba(${brand500Rgb}, 0.5);">
              ðŸ“… ${name}
            </div>
            <div style="display: flex; flex-direction: column; gap: 6px;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="color: ${contentDefault}; font-size: 12px;">${$t("admin.dashboard.uploadTrends.tooltip.uploadCountLabel")}</span>
                <span style="color: ${brand500}; font-weight: 700; font-size: 15px; text-shadow: 0 0 8px rgba(${brand500Rgb}, 0.5);">${uploadParam.value}</span>
                <span style="color: ${contentMuted}; font-size: 11px; font-weight: 500;">${$t("admin.dashboard.uploadTrends.filesUnit")}</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="color: ${contentDefault}; font-size: 12px;">${$t("admin.dashboard.uploadTrends.tooltip.storageGrowthLabel")}</span>
                <span style="color: ${success500}; font-weight: 700; font-size: 15px; text-shadow: 0 0 8px rgba(${successRgb}, 0.5);">${formatBytes(storageParam.value)}</span>
              </div>
            </div>
          </div>
        `}},xAxis:{type:"category",data:xAxisData,boundaryGap:!1,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:contentMuted,fontSize:11,margin:10},splitLine:{show:!0,lineStyle:{color:`rgba(${brand500Rgb}, 0.15)`,type:"dashed"}}},yAxis:[{type:"value",name:$t("admin.dashboard.uploadTrends.uploadCount"),nameTextStyle:{color:brand500,fontSize:11,padding:[0,0,0,10]},position:"left",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:contentMuted,fontSize:11,formatter:"{value}"},splitLine:{show:!0,lineStyle:{color:`rgba(${brand500Rgb}, 0.15)`,type:"dashed"}}},{type:"value",name:$t("admin.dashboard.uploadTrends.storageGrowth"),nameTextStyle:{color:brand500,fontSize:11,padding:[0,10,0,0]},position:"right",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:contentMuted,fontSize:11,formatter:value=>formatBytes(value)},splitLine:{show:!1}}],series:[{name:$t("admin.dashboard.uploadTrends.uploadCount"),type:"line",yAxisIndex:0,data:effectiveCounts,smooth:!0,symbol:"circle",symbolSize:8,showSymbol:!0,lineStyle:{color:brand500,width:3,shadowColor:`rgba(${brand500Rgb}, 0.5)`,shadowBlur:10},itemStyle:{color:brand500,borderColor:bg700,borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:`rgba(${brand500Rgb}, 0.3)`},{offset:1,color:`rgba(${brand500Rgb}, 0.05)`}]}},emphasis:{scale:!0,focus:"series"}},{name:$t("admin.dashboard.uploadTrends.storageGrowth"),type:"line",yAxisIndex:1,data:effectiveStorage,smooth:!0,symbol:"circle",symbolSize:8,showSymbol:!0,lineStyle:{color:success500,width:3,shadowColor:`rgba(${successRgb}, 0.5)`,shadowBlur:10},itemStyle:{color:success500,borderColor:bg700,borderWidth:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:`rgba(${successRgb}, 0.25)`},{offset:1,color:`rgba(${successRgb}, 0.03)`}]}},emphasis:{scale:!0,focus:"series"}}]};chartInstance.setOption(option)},handleResize=()=>{chartInstance&&chartInstance.resize()};return watch(appliedTheme,_newTheme=>{hasData.value&&chartContainer.value&&setTimeout(()=>{renderChart()},50)}),onMounted(()=>{fetchData(),window.addEventListener("resize",handleResize)}),onUnmounted(()=>{window.removeEventListener("resize",handleResize),chartInstance&&(chartInstance.dispose(),chartInstance=null)}),(_ctx,_cache)=>{const _component_CyberDropdown=resolveComponent("CyberDropdown");return openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("div",_hoisted_2$3,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"header-icon"},[createBaseVNode("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1)),createBaseVNode("div",_hoisted_3$3,[createBaseVNode("h3",null,toDisplayString(unref($t)("admin.dashboard.uploadTrends.title")),1),createBaseVNode("div",_hoisted_4$3,[createVNode(_component_CyberDropdown,{modelValue:selectedDays.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>selectedDays.value=$event),options:timeOptions.value,clearable:!1,searchable:!1,placeholder:unref($t)("admin.dashboard.uploadTrends.selectTimeRange"),onChange:fetchData},null,8,["modelValue","options","placeholder"])])])]),createBaseVNode("div",_hoisted_5$3,[isLoading.value?(openBlock(),createElementBlock("div",_hoisted_6$3,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"loading-spinner"},null,-1)),createBaseVNode("span",null,toDisplayString(unref($t)("admin.dashboard.uploadTrends.loading")),1)])):hasData.value?(openBlock(),createElementBlock("div",_hoisted_7$3,[createBaseVNode("div",{ref_key:"chartContainer",ref:chartContainer,class:"chart-canvas"},null,512)])):!isLoading.value&&!hasData.value?(openBlock(),createElementBlock("div",_hoisted_8$3,[_cache[3]||(_cache[3]=createBaseVNode("div",{class:"empty-icon"},"ðŸ“ˆ",-1)),createBaseVNode("div",_hoisted_9$3,toDisplayString(unref($t)("admin.dashboard.uploadTrends.noData")),1),createBaseVNode("div",_hoisted_10$3,toDisplayString(unref($t)("admin.dashboard.uploadTrends.tryOtherRange")),1)])):createCommentVNode("",!0),hasData.value&&!isLoading.value?(openBlock(),createElementBlock("div",_hoisted_11$2,[createBaseVNode("div",_hoisted_12$2,[createBaseVNode("div",_hoisted_13$2,toDisplayString(totalUploads.value),1),createBaseVNode("div",_hoisted_14$2,toDisplayString(unref($t)("admin.dashboard.uploadTrends.totalUploads")),1)]),createBaseVNode("div",_hoisted_15$1,[createBaseVNode("div",_hoisted_16$1,toDisplayString(avgDaily.value),1),createBaseVNode("div",_hoisted_17$1,toDisplayString(unref($t)("admin.dashboard.uploadTrends.avgDaily")),1)]),createBaseVNode("div",_hoisted_18$1,[createBaseVNode("div",_hoisted_19$1,toDisplayString(formattedStorageGrowth.value),1),createBaseVNode("div",_hoisted_20$1,toDisplayString(unref($t)("admin.dashboard.uploadTrends.totalStorageGrowth")),1)]),createBaseVNode("div",_hoisted_21$1,[createBaseVNode("div",_hoisted_22$1,toDisplayString(avgDailyStorage.value),1),createBaseVNode("div",_hoisted_23$1,toDisplayString(unref($t)("admin.dashboard.uploadTrends.avgDailyStorage")),1)]),createBaseVNode("div",_hoisted_24$1,[createBaseVNode("div",{class:normalizeClass(["summary-value",{positive:trendPercentage.value>0,negative:trendPercentage.value<0}])},toDisplayString(trendPercentage.value>0?"+":"")+toDisplayString(trendPercentage.value)+"% ",3),createBaseVNode("div",_hoisted_25$1,toDisplayString(unref($t)("admin.dashboard.uploadTrends.trend")),1)])])):createCommentVNode("",!0)])])}}});const UploadTrendsChart=_export_sfc(_sfc_main$3,[["__scopeId","data-v-c6a0012b"]]),_hoisted_1$2={class:"recent-uploads-card"},_hoisted_2$2={class:"card-header"},_hoisted_3$2={class:"card-content"},_hoisted_4$2={class:"images-grid"},_hoisted_5$2={key:0,class:"empty-container"},_hoisted_6$2={key:1,class:"images-grid"},_hoisted_7$2=["onClick"],_hoisted_8$2={class:"image-preview"},_hoisted_9$2={class:"image-badges"},_hoisted_10$2={class:"image-badge"},_hoisted_11$1={key:0,class:"image-badge"},_hoisted_12$1={class:"image-info"},_hoisted_13$1=["title"],_hoisted_14$1={class:"user-info"},_sfc_main$2=defineComponent({__name:"RecentUploadsCard",setup(__props){const{$t}=useTexts(),loading=ref(!1),showSkeleton=ref(!1),data=ref({recent_uploads:[]}),imageLoadingStates=ref({}),showFilePreview=ref(!1),selectedFile=ref(null),{pageSize:autoPageSize,recalc}=useResponsivePageSize({containerSelector:".recent-uploads-card .card-content",gridSelector:".recent-uploads-card .images-grid",childSelector:".image-item",itemMinWidth:200,columnGap:16,rowMultiple:2,defaultSize:6,debug:!1,preferCssColumns:!0,mode:"once"}),currentPreviewIndex=computed(()=>!selectedFile.value||!data.value.recent_uploads?0:data.value.recent_uploads.findIndex(img=>img.id===selectedFile.value?.id)||0),handlePrevImage=()=>{if(!data.value.recent_uploads)return;const currentIndex=currentPreviewIndex.value;currentIndex>0&&(selectedFile.value=data.value.recent_uploads[currentIndex-1])},handleNextImage=()=>{if(!data.value.recent_uploads)return;const currentIndex=currentPreviewIndex.value;currentIndex<data.value.recent_uploads.length-1&&(selectedFile.value=data.value.recent_uploads[currentIndex+1])};function viewImage(image){selectedFile.value=image,showFilePreview.value=!0}async function fetchData(){try{loading.value=!0,showSkeleton.value=!0;const limit=autoPageSize.value||8,result=await getDashboardRecentUploads(limit);if(result.success&&result.data&&Array.isArray(result.data)){const validUploads=result.data.filter(item=>!!item.id).map((item,index2)=>({...item,id:item.id||`temp-${Date.now()}-${index2}`}));data.value={recent_uploads:validUploads}}else data.value={recent_uploads:[]}}catch{data.value={recent_uploads:[]}}finally{loading.value=!1,showSkeleton.value=!1}}function refresh(){recalc(!0),fetchData()}return onMounted(async()=>{loading.value=!0,showSkeleton.value=!0,await nextTick(),setTimeout(()=>{recalc(!0),fetchData()},200)}),(_ctx,_cache)=>{const _component_CyberSkeleton=__unplugin_components_0,_component_CyberFile=resolveComponent("CyberFile"),_component_cyber_file_expiry_tag=resolveComponent("cyber-file-expiry-tag"),_component_cyberFileViewer=resolveComponent("cyberFileViewer"),_directive_loading=resolveDirective("loading");return openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[_cache[2]||(_cache[2]=createBaseVNode("div",{class:"header-icon"},[createBaseVNode("i",{class:"fas fa-clock"})],-1)),createBaseVNode("h3",null,toDisplayString(unref($t)("admin.dashboard.recentUploads.title")),1),createBaseVNode("div",{class:"refresh-btn",onClick:refresh},[createBaseVNode("i",{class:normalizeClass(["fas fa-refresh",{"animate-spin":loading.value}])},null,2)])]),createBaseVNode("div",_hoisted_3$2,[createBaseVNode("div",_hoisted_4$2,[createVNode(_component_CyberSkeleton,{type:"card",count:unref(autoPageSize)||6,loading:showSkeleton.value,simple:""},null,8,["count","loading"])]),!loading.value&&!showSkeleton.value&&(!data.value.recent_uploads||data.value.recent_uploads.length===0)?(openBlock(),createElementBlock("div",_hoisted_5$2,[_cache[3]||(_cache[3]=createBaseVNode("i",{class:"fas fa-image"},null,-1)),createBaseVNode("p",null,toDisplayString(unref($t)("admin.dashboard.recentUploads.noRecentUploads")),1)])):createCommentVNode("",!0),!showSkeleton.value&&data.value.recent_uploads&&data.value.recent_uploads.length>0?(openBlock(),createElementBlock("div",_hoisted_6$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(data.value.recent_uploads,(image,index2)=>(openBlock(),createElementBlock("div",{key:`image-${image.id||index2}`,class:"image-item",onClick:$event=>viewImage(image)},[withDirectives((openBlock(),createElementBlock("div",_hoisted_8$2,[createVNode(_component_CyberFile,{src:image.full_thumb_url,alt:image.display_name||image.file_name,"is-nsfw":image?.ai_info?.is_nsfw,width:"100%",height:"100%","fit-mode":"cover",onLoading:$event=>imageLoadingStates.value[image.id]=$event,"show-loading-text":!1},null,8,["src","alt","is-nsfw","onLoading"]),image.is_time_limited?(openBlock(),createBlock(_component_cyber_file_expiry_tag,{key:0,"expires-at":image.expires_at,"storage-duration":image.storage_duration,"is-time-limited":image.is_time_limited,position:"top-left",mode:"both","show-icon":!0},null,8,["expires-at","storage-duration","is-time-limited"])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_9$2,[createBaseVNode("div",_hoisted_10$2,toDisplayString(image.size_formatted),1),image.format?(openBlock(),createElementBlock("div",_hoisted_11$1,toDisplayString(image.format.toUpperCase()),1)):createCommentVNode("",!0)])])),[[_directive_loading,imageLoadingStates.value[image.id]]]),createBaseVNode("div",_hoisted_12$1,[createBaseVNode("div",{class:"image-name",title:image.display_name||image.file_name},toDisplayString(image.display_name||image.file_name),9,_hoisted_13$1),createBaseVNode("div",_hoisted_14$1,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-user"},null,-1)),createBaseVNode("span",null,toDisplayString(image.user?.username||unref($t)("admin.dashboard.recentUploads.unknownUser")),1)])])],8,_hoisted_7$2))),128))])):createCommentVNode("",!0)]),createVNode(_component_cyberFileViewer,{modelValue:showFilePreview.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>showFilePreview.value=$event),file:selectedFile.value,files:data.value.recent_uploads,"initial-index":currentPreviewIndex.value,"show-side-nav":!0,"show-keyboard-tips":!0,onClose:_cache[1]||(_cache[1]=$event=>showFilePreview.value=!1),onPrev:handlePrevImage,onNext:handleNextImage},null,8,["modelValue","file","files","initial-index"])])}}});const RecentUploadsCard=_export_sfc(_sfc_main$2,[["__scopeId","data-v-940c8ef6"]]),_hoisted_1$1={class:"tag-stats-card"},_hoisted_2$1={class:"card-header"},_hoisted_3$1={class:"card-content"},_hoisted_4$1={key:0,class:"stats-wrapper"},_hoisted_5$1={class:"overview-stats"},_hoisted_6$1={class:"stat-item primary"},_hoisted_7$1={class:"stat-info"},_hoisted_8$1={class:"stat-value"},_hoisted_9$1={class:"stat-label"},_hoisted_10$1={class:"stat-item success"},_hoisted_11={class:"stat-info"},_hoisted_12={class:"stat-value"},_hoisted_13={class:"stat-label"},_hoisted_14={class:"stat-item warning"},_hoisted_15={class:"stat-info"},_hoisted_16={class:"stat-value"},_hoisted_17={class:"stat-label"},_hoisted_18={class:"tags-grid"},_hoisted_19={class:"stat-info"},_hoisted_20={class:"stat-value"},_hoisted_21={class:"stat-label"},_hoisted_22={class:"tag-rank-badge"},_hoisted_23={class:"stat-info"},_hoisted_24={class:"stat-label"},_hoisted_25={key:1,class:"empty-state"},_hoisted_26={class:"empty-title"},_hoisted_27={class:"empty-subtitle"},_sfc_main$1=defineComponent({__name:"TagStatsCard",setup(__props){const{$t}=useTexts(),loading=ref(!1),data=ref({ai_tags_count:0,tagged_images:0,untagged_images:0,popular_tags:[],manual_tags_count:0});function formatNumber(num){return num==null||Number.isNaN(num)?"0":num>=1e6?`${(num/1e6).toFixed(1)}M`:num>=1e3?`${(num/1e3).toFixed(1)}K`:num.toString()}function getTagGridClass(index2){return index2===0?"tag-gold":index2===1?"tag-silver":index2===2?"tag-bronze":"tag-normal"}async function fetchData(){try{loading.value=!0;const result=await getDashboardTagStats();result.success&&result.data&&(data.value=result.data)}catch{}finally{loading.value=!1}}const hasData=computed(()=>data.value.ai_tags_count>0||data.value.tagged_images>0||data.value.untagged_images>0||data.value.popular_tags&&data.value.popular_tags.length>0);function refresh(){fetchData()}return onMounted(()=>{fetchData()}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"header-icon"},[createBaseVNode("svg",{class:"h-6 w-6",fill:"currentColor",viewBox:"0 0 20 20"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"})])],-1)),createBaseVNode("h3",null,toDisplayString(unref($t)("admin.dashboard.tagStats.title")),1),createBaseVNode("div",{class:"refresh-btn",onClick:refresh},[(openBlock(),createElementBlock("svg",{class:normalizeClass(["h-4 w-4",{"animate-spin":loading.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[..._cache[0]||(_cache[0]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))])]),createBaseVNode("div",_hoisted_3$1,[hasData.value?(openBlock(),createElementBlock("div",_hoisted_4$1,[createBaseVNode("div",_hoisted_5$1,[createBaseVNode("div",_hoisted_6$1,[createBaseVNode("div",_hoisted_7$1,[createBaseVNode("div",_hoisted_8$1,toDisplayString(formatNumber(data.value.ai_tags_count)),1),createBaseVNode("div",_hoisted_9$1,toDisplayString(unref($t)("admin.dashboard.tagStats.aiTags")),1)]),_cache[2]||(_cache[2]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-robot"})],-1))]),createBaseVNode("div",_hoisted_10$1,[createBaseVNode("div",_hoisted_11,[createBaseVNode("div",_hoisted_12,toDisplayString(formatNumber(data.value.tagged_images)),1),createBaseVNode("div",_hoisted_13,toDisplayString(unref($t)("admin.dashboard.tagStats.taggedFiles")),1)]),_cache[3]||(_cache[3]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-check-circle"})],-1))]),createBaseVNode("div",_hoisted_14,[createBaseVNode("div",_hoisted_15,[createBaseVNode("div",_hoisted_16,toDisplayString(formatNumber(data.value.untagged_images)),1),createBaseVNode("div",_hoisted_17,toDisplayString(unref($t)("admin.dashboard.tagStats.untaggedFiles")),1)]),_cache[4]||(_cache[4]=createBaseVNode("div",{class:"stat-icon"},[createBaseVNode("i",{class:"fas fa-exclamation-triangle"})],-1))])]),createBaseVNode("div",_hoisted_18,[(openBlock(!0),createElementBlock(Fragment,null,renderList(data.value.popular_tags.slice(0,12),(tag,index2)=>(openBlock(),createElementBlock("div",{key:tag.name,class:normalizeClass(["stat-item tag-item",getTagGridClass(index2)])},[createBaseVNode("div",_hoisted_19,[createBaseVNode("div",_hoisted_20,toDisplayString(formatNumber(tag.count)),1),createBaseVNode("div",_hoisted_21,toDisplayString(tag.name),1)]),createBaseVNode("div",_hoisted_22,toDisplayString(index2+1),1)],2))),128)),(openBlock(!0),createElementBlock(Fragment,null,renderList(Math.max(0,12-data.value.popular_tags.length),i=>(openBlock(),createElementBlock("div",{key:`empty-tag-${i}`,class:"stat-item empty-item"},[createBaseVNode("div",_hoisted_23,[_cache[5]||(_cache[5]=createBaseVNode("div",{class:"stat-value"},"-",-1)),createBaseVNode("div",_hoisted_24,toDisplayString(unref($t)("admin.dashboard.tagStats.none")),1)])]))),128))])])):(openBlock(),createElementBlock("div",_hoisted_25,[_cache[6]||(_cache[6]=createBaseVNode("div",{class:"empty-icon"},"ðŸ·ï¸",-1)),createBaseVNode("div",_hoisted_26,toDisplayString(unref($t)("admin.dashboard.tagStats.noData")),1),createBaseVNode("div",_hoisted_27,toDisplayString(unref($t)("admin.dashboard.tagStats.waitingForData")),1)]))])]))}});const TagStatsCard=_export_sfc(_sfc_main$1,[["__scopeId","data-v-fc0b595b"]]),_hoisted_1={class:"admin-dashboard-page"},_hoisted_2={class:"dashboard-content"},_hoisted_3={class:"charts-analytics"},_hoisted_4={class:"main-chart-section"},_hoisted_5={class:"monitoring-panels"},_hoisted_6={class:"panel-row"},_hoisted_7={class:"panel-item"},_hoisted_8={class:"panel-item"},_hoisted_9={class:"recent-uploads-section"},_hoisted_10={class:"recent-uploads-full"},_sfc_main=defineComponent({name:"AdminDashboard",__name:"index",setup(__props){const{$t}=useTexts(),refreshKey=ref(0);return(_ctx,_cache)=>{const _component_CyberAdminWrapper=resolveComponent("CyberAdminWrapper");return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(_component_CyberAdminWrapper,{title:unref($t)("admin.dashboard.title"),subtitle:unref($t)("admin.dashboard.subtitle"),icon:"fas fa-tachometer-alt"},{content:withCtx(()=>[createBaseVNode("div",_hoisted_2,[createVNode(DashboardMetricsRow,{"refresh-key":refreshKey.value},null,8,["refresh-key"]),createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[(openBlock(),createBlock(UploadTrendsChart,{key:refreshKey.value}))]),createBaseVNode("div",_hoisted_5,[createBaseVNode("div",_hoisted_6,[createBaseVNode("div",_hoisted_7,[(openBlock(),createBlock(AIServicesCard,{key:refreshKey.value}))]),createBaseVNode("div",_hoisted_8,[(openBlock(),createBlock(TagStatsCard,{key:refreshKey.value}))])])])]),createBaseVNode("div",_hoisted_9,[createBaseVNode("div",_hoisted_10,[(openBlock(),createBlock(RecentUploadsCard,{key:refreshKey.value}))])])])]),_:1},8,["title","subtitle"])])}}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-0d1ee453"]]);export{index as default};
