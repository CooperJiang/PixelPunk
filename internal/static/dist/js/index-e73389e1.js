import{d as defineComponent,I as createElementBlock,a0 as createBaseVNode,f as createVNode,a1 as toDisplayString,K as createCommentVNode,ab as createTextVNode,E as resolveComponent,z as openBlock,c as computed,A as createBlock,F as Fragment,M as renderList,R as normalizeClass,r as ref,Q as normalizeStyle,b as onMounted,o as onUnmounted,w as watch,u as unref,a4 as useRoute}from"./vue-vendor-31320f47.js";import{g as getAuthorHomepage,b as getAuthorFolder}from"./index-224e43f9.js";import{_ as _export_sfc,aC as formatRelativeTime,K as getCurrentLocale,j as useTexts,aD as Loading,r as downloadFileQuick,q as useToast,aE as _sfc_main$5}from"./index-ac67a30c.js";import{F as FolderBreadcrumb}from"./FolderBreadcrumb-3e408967.js";import{F as FilesGridView}from"./FilesGridView-cb63b8e3.js";import"./editor-markdown-0b2e1ce5.js";import"./axios-c2a59b9f.js";import"./spark-md5-d0a97131.js";import"./highlight-common-d6c232ae.js";import"./comlink-c7be92b7.js";/* empty css                 */import"./vueuse-2480d07f.js";import"./marked-e9418aa8.js";import"./dompurify-76a35038.js";import"./vue-table-79795ca5.js";import"./draggable-5c726607.js";import"./dialog-12b1cf68.js";const _hoisted_1$4={key:0,class:"author-header"},_hoisted_2$4={class:"author-profile"},_hoisted_3$4={class:"profile-main"},_hoisted_4$4={class:"avatar-section"},_hoisted_5$4={class:"info-section"},_hoisted_6$3={class:"author-name"},_hoisted_7$3={key:0,class:"author-bio"},_hoisted_8$3={class:"author-meta"},_hoisted_9$3={class:"meta-item"},_hoisted_10$3=["href"],_hoisted_11$3={class:"stats-section"},_hoisted_12$2={class:"stat-item"},_hoisted_13$2={class:"stat-value"},_hoisted_14$2={class:"stat-label"},_hoisted_15$2={class:"stat-item"},_hoisted_16$2={class:"stat-value"},_hoisted_17$2={class:"stat-label"},_hoisted_18$1={class:"stat-item"},_hoisted_19$1={class:"stat-value"},_hoisted_20$1={class:"stat-label"},_sfc_main$4=defineComponent({name:"AuthorHeader",__name:"index",props:{authorInfo:{},stats:{},texts:{}},setup(__props){const props=__props,formatJoinedDays=days=>props.texts.joinedLabel.replace("{days}",String(days)),formatNumber=num=>num<1e3?num.toString():num<1e4?`${(num/1e3).toFixed(1)}K`:num<1e6?`${Math.floor(num/1e3)}K`:num<1e7?`${(num/1e6).toFixed(1)}M`:`${Math.floor(num/1e6)}M`;return(_ctx,_cache)=>{const _component_CyberUserAvatar=resolveComponent("CyberUserAvatar");return __props.authorInfo?(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$4,[createBaseVNode("div",_hoisted_3$4,[createBaseVNode("div",_hoisted_4$4,[createVNode(_component_CyberUserAvatar,{"avatar-url":__props.authorInfo.avatarFullPath,username:__props.authorInfo.username,size:"md","show-border":!0},null,8,["avatar-url","username"])]),createBaseVNode("div",_hoisted_5$4,[createBaseVNode("h1",_hoisted_6$3,toDisplayString(__props.authorInfo.username),1),__props.authorInfo.bio?(openBlock(),createElementBlock("p",_hoisted_7$3,toDisplayString(__props.authorInfo.bio),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_8$3,[createBaseVNode("span",_hoisted_9$3,[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)),createTextVNode(" "+toDisplayString(formatJoinedDays(__props.authorInfo.daysJoined)),1)]),__props.authorInfo.website?(openBlock(),createElementBlock("a",{key:0,href:__props.authorInfo.website,target:"_blank",rel:"noopener noreferrer",class:"meta-link"},[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-external-link-alt"},null,-1)),createTextVNode(" "+toDisplayString(props.texts.websiteLabel),1)],8,_hoisted_10$3)):createCommentVNode("",!0)])])]),createBaseVNode("div",_hoisted_11$3,[createBaseVNode("div",_hoisted_12$2,[createBaseVNode("div",_hoisted_13$2,toDisplayString(formatNumber(__props.stats.totalViews)),1),createBaseVNode("div",_hoisted_14$2,toDisplayString(props.texts.stats.views),1)]),createBaseVNode("div",_hoisted_15$2,[createBaseVNode("div",_hoisted_16$2,toDisplayString(__props.stats.totalShares),1),createBaseVNode("div",_hoisted_17$2,toDisplayString(props.texts.stats.shares),1)]),createBaseVNode("div",_hoisted_18$1,[createBaseVNode("div",_hoisted_19$1,toDisplayString(__props.stats.totalFiles||0),1),createBaseVNode("div",_hoisted_20$1,toDisplayString(props.texts.stats.images),1)])])])])):createCommentVNode("",!0)}}});const AuthorHeader=_export_sfc(_sfc_main$4,[["__scopeId","data-v-b73a24e4"]]),_hoisted_1$3={class:"section-container"},_hoisted_2$3={class:"section-header"},_hoisted_3$3={class:"header-left"},_hoisted_4$3={class:"section-title"},_hoisted_5$3={class:"title-content"},_hoisted_6$2={class:"title-text"},_hoisted_7$2={class:"title-subtitle"},_hoisted_8$2={key:1,class:"folder-cards"},_hoisted_9$2=["onClick"],_hoisted_10$2={class:"folder-card-content"},_hoisted_11$2={class:"folder-icon-wrapper"},_hoisted_12$1={key:0,class:"fas fa-folder"},_hoisted_13$1={key:1,class:"fas fa-spinner fa-spin"},_hoisted_14$1={class:"folder-details"},_hoisted_15$1=["title"],_hoisted_16$1={class:"folder-meta"},_hoisted_17$1={class:"folder-meta-item"},_sfc_main$3=defineComponent({name:"AuthorFolderList",__name:"index",props:{folders:{},currentFolderId:{},folderLoading:{type:Boolean},breadcrumbLoading:{type:Boolean},loading:{type:Boolean},texts:{},breadcrumbTrail:{},authorName:{}},emits:["folder-click","breadcrumb-click"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,handleFolderClick=folder=>{emit("folder-click",folder)},getFormattedDate=dateString=>{if(!dateString)return console.warn("Date is empty"),props.texts.unknownTime||props.texts.unknownTime;try{return formatRelativeTime(new Date(dateString).toISOString())}catch(e){return console.error("Date formatting error:",e,dateString),String(dateString)}},handleBreadcrumbClick=item=>{emit("breadcrumb-click",item)},breadcrumbItems=computed(()=>{const rootItem={id:null,name:props.authorName||props.texts.rootFolder||props.texts.rootFolder};if(!props.currentFolderId)return[rootItem];const trail=props.breadcrumbTrail||[];return[rootItem,...trail]});return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("div",_hoisted_2$3,[createBaseVNode("div",_hoisted_3$3,[createBaseVNode("h2",_hoisted_4$3,[_cache[0]||(_cache[0]=createBaseVNode("div",{class:"title-icon"},[createBaseVNode("i",{class:"fas fa-folder-open"}),createBaseVNode("div",{class:"icon-glow"})],-1)),createBaseVNode("div",_hoisted_5$3,[createBaseVNode("span",_hoisted_6$2,toDisplayString(__props.currentFolderId?props.texts.childTitle:props.texts.rootTitle),1),createBaseVNode("span",_hoisted_7$2,toDisplayString(__props.currentFolderId?props.texts.childSubtitle:props.texts.rootSubtitle),1)])])])]),breadcrumbItems.value.length>0?(openBlock(),createBlock(FolderBreadcrumb,{key:0,class:"folder-breadcrumb-nav",items:breadcrumbItems.value,"show-icon":!0,"auto-add-root":!1,onClick:handleBreadcrumbClick},null,8,["items"])):createCommentVNode("",!0),__props.folders.length>0?(openBlock(),createElementBlock("div",_hoisted_8$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.folders,folder=>(openBlock(),createElementBlock("div",{key:folder.id,class:normalizeClass(["folder-card",{loading:__props.folderLoading&&__props.currentFolderId===folder.id,disabled:__props.folderLoading||__props.breadcrumbLoading||__props.loading,current:__props.currentFolderId===folder.id}]),onClick:$event=>handleFolderClick(folder)},[createBaseVNode("div",_hoisted_10$2,[createBaseVNode("div",_hoisted_11$2,[!__props.folderLoading||__props.currentFolderId!==folder.id?(openBlock(),createElementBlock("i",_hoisted_12$1)):(openBlock(),createElementBlock("i",_hoisted_13$1))]),createBaseVNode("div",_hoisted_14$1,[createBaseVNode("div",{class:"folder-name",title:folder.name},toDisplayString(folder.name),9,_hoisted_15$1),createBaseVNode("div",_hoisted_16$1,[createBaseVNode("div",_hoisted_17$1,[_cache[1]||(_cache[1]=createBaseVNode("i",{class:"fas fa-clock"},null,-1)),createBaseVNode("span",null,toDisplayString(props.texts.createdLabel.replace("{time}",getFormattedDate(folder.createdAt))),1)])])])]),_cache[2]||(_cache[2]=createBaseVNode("div",{class:"folder-highlight"},null,-1))],10,_hoisted_9$2))),128))])):createCommentVNode("",!0)]))}});const AuthorFolderList=_export_sfc(_sfc_main$3,[["__scopeId","data-v-0ece2e72"]]),_hoisted_1$2={class:"section-container"},_hoisted_2$2={class:"section-header"},_hoisted_3$2={class:"section-title"},_hoisted_4$2={class:"title-content"},_hoisted_5$2={class:"title-text"},_hoisted_6$1={class:"title-subtitle"},_hoisted_7$1={class:"item-count"},_hoisted_8$1={class:"count-number"},_hoisted_9$1={class:"count-label"},_hoisted_10$1={key:0,class:"shares-list"},_hoisted_11$1=["onClick"],_hoisted_12={class:"share-cover"},_hoisted_13={class:"cover-wrapper"},_hoisted_14=["src","alt","onError"],_hoisted_15={key:1,class:"empty-cover"},_hoisted_16={class:"share-content"},_hoisted_17={class:"share-name"},_hoisted_18={key:0,class:"share-description"},_hoisted_19={class:"share-meta"},_hoisted_20={class:"meta-item"},_hoisted_21={class:"meta-item"},_hoisted_22={class:"meta-item"},_hoisted_23={class:"share-key"},_hoisted_24={class:"share-actions"},_hoisted_25={class:"status-badge"},_hoisted_26={key:1,class:"empty-state"},_sfc_main$2=defineComponent({name:"AuthorShareList",__name:"index",props:{shares:{},texts:{}},emits:["share-click"],setup(__props,{emit:__emit}){const props=__props,failedCoverIds=ref(new Set),emit=__emit,handleShareClick=share=>{emit("share-click",share)},shouldShowCover=share=>!!(share.coverImageFullThumbURL||share.coverImageFullPath)&&!failedCoverIds.value.has(share.id),handleCoverError=(share,event)=>{const next=new Set(failedCoverIds.value);next.add(share.id),failedCoverIds.value=next;const target=event.target;target&&target.remove()},formatViews=views=>views<1e3?views.toString():views<1e4?`${(views/1e3).toFixed(1)}K`:views<1e6?`${Math.floor(views/1e3)}K`:`${(views/1e6).toFixed(1)}M`,getCreatedLabel=date=>{if(!date)return"";const formatted=formatRelativeTime(new Date(date).toISOString());return props.texts.meta.createdLabel.replace("{time}",formatted)};return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("h2",_hoisted_3$2,[_cache[0]||(_cache[0]=createBaseVNode("div",{class:"title-icon"},[createBaseVNode("i",{class:"fas fa-share-alt"}),createBaseVNode("div",{class:"icon-glow"})],-1)),createBaseVNode("div",_hoisted_4$2,[createBaseVNode("span",_hoisted_5$2,toDisplayString(props.texts.sectionTitle),1),createBaseVNode("span",_hoisted_6$1,toDisplayString(props.texts.sectionSubtitle),1)]),createBaseVNode("div",_hoisted_7$1,[createBaseVNode("span",_hoisted_8$1,toDisplayString(__props.shares.length),1),createBaseVNode("span",_hoisted_9$1,toDisplayString(props.texts.statusBadge),1)])]),_cache[1]||(_cache[1]=createBaseVNode("div",{class:"header-decoration"},[createBaseVNode("div",{class:"decoration-line"}),createBaseVNode("div",{class:"decoration-dots"})],-1))]),__props.shares.length>0?(openBlock(),createElementBlock("div",_hoisted_10$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.shares,(share,index2)=>(openBlock(),createElementBlock("div",{key:share.id,class:"share-item animate-in",style:normalizeStyle({"--delay":`${index2*.08}s`}),onClick:$event=>handleShareClick(share)},[createBaseVNode("div",_hoisted_12,[createBaseVNode("div",_hoisted_13,[shouldShowCover(share)?(openBlock(),createElementBlock("img",{key:0,src:share.coverImageFullThumbURL||share.coverImageFullPath,alt:share.name,class:"cover-img",onError:$event=>handleCoverError(share,$event)},null,40,_hoisted_14)):(openBlock(),createElementBlock("div",_hoisted_15,[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-images"},null,-1)])])),_cache[3]||(_cache[3]=createBaseVNode("div",{class:"cover-overlay"},[createBaseVNode("i",{class:"fas fa-external-link-alt"})],-1))])]),createBaseVNode("div",_hoisted_16,[createBaseVNode("h3",_hoisted_17,toDisplayString(share.name),1),share.description?(openBlock(),createElementBlock("p",_hoisted_18,toDisplayString(share.description),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_19,[createBaseVNode("div",_hoisted_20,[_cache[4]||(_cache[4]=createBaseVNode("i",{class:"fas fa-eye"},null,-1)),createBaseVNode("span",null,toDisplayString(props.texts.meta.viewsLabel.replace("{count}",formatViews(share.views||0))),1)]),createBaseVNode("div",_hoisted_21,[_cache[5]||(_cache[5]=createBaseVNode("i",{class:"fas fa-calendar-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(getCreatedLabel(share.createdAt)),1)]),createBaseVNode("div",_hoisted_22,[_cache[6]||(_cache[6]=createBaseVNode("i",{class:"fas fa-key"},null,-1)),createBaseVNode("span",_hoisted_23,toDisplayString(props.texts.meta.keyLabel.replace("{key}",share.shareKey)),1)])])]),createBaseVNode("div",_hoisted_24,[createBaseVNode("div",_hoisted_25,toDisplayString(props.texts.statusBadge),1)]),_cache[7]||(_cache[7]=createBaseVNode("div",{class:"hover-glow"},null,-1))],12,_hoisted_11$1))),128))])):(openBlock(),createElementBlock("div",_hoisted_26,[_cache[8]||(_cache[8]=createBaseVNode("div",{class:"empty-icon"},[createBaseVNode("i",{class:"fas fa-share-alt"})],-1)),createBaseVNode("h3",null,toDisplayString(props.texts.empty.title),1),createBaseVNode("p",null,toDisplayString(props.texts.empty.description),1),_cache[9]||(_cache[9]=createBaseVNode("div",{class:"empty-decoration"},[createBaseVNode("div",{class:"decoration-line"}),createBaseVNode("div",{class:"decoration-dot"}),createBaseVNode("div",{class:"decoration-line"})],-1))]))]))}});const AuthorShareList=_export_sfc(_sfc_main$2,[["__scopeId","data-v-be1314ae"]]),_hoisted_1$1={class:"author-empty-state"},_hoisted_2$1={class:"empty-icon-wrapper"},_hoisted_3$1={class:"empty-title"},_hoisted_4$1={class:"empty-description"},_hoisted_5$1={key:0,class:"empty-suggestion"},_sfc_main$1=defineComponent({name:"AuthorEmptyState",__name:"index",props:{iconClass:{default:"fas fa-folder-open"},title:{},description:{},showRetryButton:{type:Boolean,default:!1},retryText:{default:"Retry"},statusCode:{default:"INFO_100"},suggestion:{default:""}},emits:["retry"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,currentTime=ref("");let timeInterval=null;const renderedSuggestion=computed(()=>props.suggestion??""),updateTime=()=>{const now=new Date;currentTime.value=now.toLocaleTimeString(getCurrentLocale(),{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})},handleRetry=()=>{emit("retry")};return onMounted(()=>{updateTime(),timeInterval=setInterval(updateTime,1e3)}),onUnmounted(()=>{timeInterval&&(clearInterval(timeInterval),timeInterval=null)}),(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("i",{class:normalizeClass(__props.iconClass)},null,2)]),createBaseVNode("h3",_hoisted_3$1,toDisplayString(__props.title),1),createBaseVNode("p",_hoisted_4$1,toDisplayString(__props.description),1),renderedSuggestion.value?(openBlock(),createElementBlock("p",_hoisted_5$1,toDisplayString(renderedSuggestion.value),1)):createCommentVNode("",!0),__props.showRetryButton?(openBlock(),createElementBlock("button",{key:1,class:"retry-button",onClick:handleRetry},[_cache[0]||(_cache[0]=createBaseVNode("i",{class:"fas fa-sync-alt"},null,-1)),createBaseVNode("span",null,toDisplayString(__props.retryText),1)])):createCommentVNode("",!0)]))}});const AuthorEmptyState=_export_sfc(_sfc_main$1,[["__scopeId","data-v-495251cb"]]),_hoisted_1={class:"author-page"},_hoisted_2={class:"author-page__nav"},_hoisted_3={class:"author-page__nav-brand"},_hoisted_4={class:"author-page__nav-actions"},_hoisted_5=["title","disabled"],_hoisted_6=["title"],_hoisted_7={class:"author-page__main"},_hoisted_8={key:0,class:"author-page__section"},_hoisted_9={class:"author-page__toolbar"},_hoisted_10={class:"author-page__content"},_hoisted_11={key:0,class:"files-section"},_sfc_main=defineComponent({name:"AuthorPage",__name:"index",setup(__props){const route=useRoute(),toast=useToast(),{$t}=useTexts(),loading=ref(!0),imageLoading=ref(!1),folderLoading=ref(!1),breadcrumbLoading=ref(!1),isFullscreen=ref(!1),error=ref(""),authorInfo=ref(null),stats=ref({totalFiles:0,totalFolders:0,totalShares:0,totalViews:0}),folders=ref([]),images=ref([]),shares=ref([]),pagination=ref(null),currentFolderId=ref(),breadcrumbTrail=ref([]),searchQuery=ref(""),previewDialogVisible=ref(!1),previewImage=ref(null),previewImages=ref([]),previewIndex=ref(0),authorId=computed(()=>route.params.id),headerTexts=computed(()=>({joinedLabel:$t("author.header.joinedLabel"),websiteLabel:$t("author.header.websiteLabel"),stats:{views:$t("author.header.stats.views"),shares:$t("author.header.stats.shares"),images:$t("author.header.stats.images")}})),folderTexts=computed(()=>({rootTitle:$t("author.folders.rootTitle"),rootSubtitle:$t("author.folders.rootSubtitle"),childTitle:$t("author.folders.childTitle"),childSubtitle:$t("author.folders.childSubtitle"),countLabel:$t("author.folders.countLabel"),createdLabel:$t("author.folders.createdLabel"),unknownTime:$t("author.folders.unknownTime"),rootFolder:$t("author.folders.rootFolder")})),shareTexts=computed(()=>({sectionTitle:$t("author.shares.sectionTitle"),sectionSubtitle:$t("author.shares.sectionSubtitle"),statusBadge:$t("author.shares.statusBadge"),meta:{viewsLabel:$t("author.shares.meta.viewsLabel"),createdLabel:$t("author.shares.meta.createdLabel"),keyLabel:$t("author.shares.meta.keyLabel")},empty:{title:$t("author.shares.empty.title"),description:$t("author.shares.empty.description")}})),emptyTexts=computed(()=>({title:$t("author.empty.title"),description:$t("author.empty.description"),suggestion:$t("author.empty.suggestion"),statusCode:"INFO_204",retryText:$t("author.empty.retry")})),errorTexts=computed(()=>({title:$t("author.error.title"),retry:$t("author.error.retry")})),toolbarTexts=computed(()=>({searchPlaceholder:$t("author.toolbar.searchPlaceholder"),refresh:$t("author.toolbar.refresh"),fullscreenEnter:$t("author.toolbar.fullscreenEnter"),fullscreenExit:$t("author.toolbar.fullscreenExit")})),filteredFolders=computed(()=>{if(!searchQuery.value)return folders.value;const keyword=searchQuery.value.toLowerCase();return folders.value.filter(folder=>folder.name?.toLowerCase().includes(keyword))}),filteredImages=computed(()=>{if(!searchQuery.value)return images.value;const keyword=searchQuery.value.toLowerCase();return images.value.filter(image=>image.originalName?.toLowerCase().includes(keyword))}),filteredShares=computed(()=>{if(!searchQuery.value)return shares.value;const keyword=searchQuery.value.toLowerCase();return shares.value.filter(share=>share.name?.toLowerCase().includes(keyword))}),isAllEmpty=computed(()=>filteredFolders.value.length===0&&filteredImages.value.length===0&&filteredShares.value.length===0),isFolderContentEmpty=computed(()=>filteredFolders.value.length===0&&filteredImages.value.length===0),loadAuthorHomepage=async()=>{if(!authorId.value){error.value=$t("author.error.invalidAuthor"),loading.value=!1;return}loading.value=!0,imageLoading.value=!1,error.value="";try{const data=(await getAuthorHomepage(authorId.value)).data;authorInfo.value=data.author?normalizeAuthorInfo(data.author):null,stats.value=data.stats?normalizeStats(data.stats):{totalFiles:0,totalFolders:0,totalShares:0,totalViews:0},folders.value=(data.folders||[]).map(normalizeFolder),shares.value=(data.shares||[]).map(normalizeShare),images.value=(data.files||data.images||[]).map(normalizeImage),pagination.value=data.pagination?normalizePagination(data.pagination):null,breadcrumbTrail.value=[],currentFolderId.value=void 0}catch(err){error.value=extractErrorMessage(err,$t("author.error.loadFailed"))}finally{loading.value=!1,folderLoading.value=!1,breadcrumbLoading.value=!1}},loadFolderContent=async(folderId,page)=>{if(authorId.value){imageLoading.value=!0,error.value="";try{const data=(await getAuthorFolder(authorId.value,folderId,{page:page??pagination.value?.currentPage??1,size:pagination.value?.perPage??50})).data;folders.value=(data.subFolders||[]).map(normalizeFolder),images.value=(data.files||data.images||[]).map(normalizeImage),pagination.value=data.pagination?normalizePagination(data.pagination):null}catch(err){error.value=extractErrorMessage(err,$t("author.error.loadFolderFailed"))}finally{imageLoading.value=!1,folderLoading.value=!1,breadcrumbLoading.value=!1,loading.value=!1}}},handleFolderClick=async folder=>{if(loading.value||folderLoading.value||breadcrumbLoading.value||!folder.id||currentFolderId.value===folder.id)return;folderLoading.value=!0,currentFolderId.value=folder.id;const existingIndex=breadcrumbTrail.value.findIndex(item=>item.id===folder.id);existingIndex===-1?breadcrumbTrail.value=[...breadcrumbTrail.value,folder]:breadcrumbTrail.value=breadcrumbTrail.value.slice(0,existingIndex+1),await loadFolderContent(folder.id)},handleBreadcrumbClick=async item=>{if(loading.value||folderLoading.value||breadcrumbLoading.value)return;if(!item||item.id===null){if(!currentFolderId.value)return;breadcrumbLoading.value=!0,await loadAuthorHomepage();return}breadcrumbLoading.value=!0,currentFolderId.value=item.id;const index2=breadcrumbTrail.value.findIndex(breadcrumb=>breadcrumb.id===item.id);breadcrumbTrail.value=breadcrumbTrail.value.slice(0,index2+1),await loadFolderContent(item.id)},handleRefresh=()=>{currentFolderId.value?loadFolderContent(currentFolderId.value):loadAuthorHomepage()},handleRetry=()=>{handleRefresh()},toggleFullscreen=async()=>{try{document.fullscreenElement?(await document.exitFullscreen(),isFullscreen.value=!1):(await document.documentElement.requestFullscreen(),isFullscreen.value=!0)}catch(err){console.error(err)}},handleImageClick=image=>{if(!image){console.warn("Image data is empty");return}previewImages.value=filteredImages.value;const index2=filteredImages.value.findIndex(item=>item.id===image.id);previewIndex.value=index2>=0?index2:0,previewImage.value=image,previewDialogVisible.value=!0},handleImageDownload=image=>{downloadFileQuick(image.id,image.original_name||image.display_name)},handleCopyLink=async image=>{const url=image.full_url||image.url;if(!url){toast.error($t("author.toast.copyFailed"));return}try{await navigator.clipboard.writeText(url),toast.success($t("author.toast.copySuccess"))}catch(err){console.error(err),toast.error($t("author.toast.copyFailed"))}},handleShareClick=share=>{if(!share?.shareKey)return;const shareUrl=`/share/${share.shareKey}`;window.open(shareUrl,"_blank")},handlePreviewClose=()=>{previewDialogVisible.value=!1,previewImage.value=null},normalizeAuthorInfo=payload=>({id:Number(payload.id),username:payload.username??"",avatar:payload.avatar??payload.avatar_url??"",avatarFullPath:payload.avatarFullPath??payload.avatar_full_path??payload.avatar??"",bio:payload.bio??"",website:payload.website??"",createdAt:payload.createdAt??payload.created_at??"",daysJoined:payload.daysJoined??payload.days_joined??0}),normalizeStats=payload=>({totalFiles:payload.totalFiles??payload.total_files??0,totalFolders:payload.totalFolders??payload.total_folders??0,totalShares:payload.totalShares??payload.total_shares??0,totalViews:payload.totalViews??payload.total_views??0}),normalizeFolder=payload=>({id:String(payload.id),name:payload.name??payload.folderName??payload.folder_name??"",imageCount:payload.fileCount??payload.file_count??payload.imageCount??payload.image_count??0,coverImage:payload.coverFile??payload.cover_file??payload.coverImage??payload.cover_image??"",coverImageFullPath:payload.coverFileFullPath??payload.cover_file_full_path??payload.coverImageFullPath??payload.cover_image_full_path??"",coverImageThumbURL:payload.coverFileThumbURL??payload.cover_file_thumb_url??payload.coverImageThumbURL??payload.cover_image_thumb_url??"",coverImageFullThumbURL:payload.coverFileFullThumbURL??payload.cover_file_full_thumb_url??payload.coverImageFullThumbURL??payload.cover_image_full_thumb_url??"",createdAt:payload.createdAt??payload.created_at??"",totalSize:payload.totalSize??payload.total_size??0,totalSizeFormatted:payload.totalSizeFormatted??payload.total_size_formatted??""}),normalizeImage=payload=>({id:String(payload.id),url:payload.url??"",thumb_url:payload.thumb_url??"",full_url:payload.full_url??"",full_thumb_url:payload.full_thumb_url??"",original_name:payload.original_name??payload.originalName??payload.file_name??payload.fileName??"",display_name:payload.display_name??payload.displayName??payload.original_name??payload.originalName??"",size:payload.size??0,width:payload.width??0,height:payload.height??0,format:payload.format??"",access_level:payload.access_level??payload.accessLevel??"public",views:payload.views??0,description:payload.description??payload.ai_info?.description??void 0,ai_info:payload.ai_info??void 0,created_at:payload.created_at??payload.createdAt??"",updated_at:payload.updated_at??payload.updatedAt??""}),normalizeShare=payload=>({id:String(payload.id),name:payload.name??"",description:payload.description??"",shareKey:payload.shareKey??payload.share_key??"",views:payload.views??0,createdAt:payload.createdAt??payload.created_at??"",coverImage:payload.coverFile??payload.cover_file??payload.coverImage??payload.cover_image??"",coverImageFullPath:payload.coverFileFullPath??payload.cover_file_full_path??payload.coverImageFullPath??payload.cover_image_full_path??"",coverImageThumbURL:payload.coverFileThumbURL??payload.cover_file_thumb_url??payload.coverImageThumbURL??payload.cover_image_thumb_url??"",coverImageFullThumbURL:payload.coverFileFullThumbURL??payload.cover_file_full_thumb_url??payload.coverImageFullThumbURL??payload.cover_image_full_thumb_url??""}),normalizePagination=payload=>({currentPage:payload.currentPage??payload.current_page??1,perPage:payload.perPage??payload.per_page??payload.size??20,total:payload.total??0,lastPage:payload.lastPage??payload.last_page??1}),extractErrorMessage=(err,fallback)=>{if(typeof err=="string")return err;if(err instanceof Error){const axiosError=err;return axiosError.response?.data?.message||axiosError.message||fallback}return err&&typeof err=="object"&&"message"in err&&err.message||fallback};return watch(()=>authorId.value,async nextId=>{if(!nextId){error.value=$t("author.error.invalidAuthor"),loading.value=!1;return}await loadAuthorHomepage()},{immediate:!0}),onMounted(()=>{authorId.value||(loading.value=!1,error.value=$t("author.error.invalidAuthor"))}),(_ctx,_cache)=>{const _component_cyberFileViewer=resolveComponent("cyberFileViewer"),_component_CyberInput=resolveComponent("CyberInput");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("nav",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createVNode(_sfc_main$5)]),createBaseVNode("div",_hoisted_4,[createBaseVNode("button",{class:"nav-action",title:toolbarTexts.value.refresh,disabled:loading.value||folderLoading.value||imageLoading.value,onClick:handleRefresh},[..._cache[2]||(_cache[2]=[createBaseVNode("i",{class:"fas fa-sync-alt"},null,-1)])],8,_hoisted_5),createBaseVNode("button",{class:"nav-action",title:isFullscreen.value?toolbarTexts.value.fullscreenExit:toolbarTexts.value.fullscreenEnter,onClick:toggleFullscreen},[createBaseVNode("i",{class:normalizeClass(isFullscreen.value?"fas fa-compress-arrows-alt":"fas fa-expand-arrows-alt")},null,2)],8,_hoisted_6)]),createBaseVNode("div",{class:normalizeClass(["author-page__nav-progress",{"is-active":loading.value||imageLoading.value}])},[..._cache[3]||(_cache[3]=[createBaseVNode("div",{class:"author-page__nav-progress-bar"},null,-1)])],2)]),createBaseVNode("main",_hoisted_7,[createVNode(Loading,{visible:loading.value&&!authorInfo.value,"full-screen":"",text:unref($t)("author.loading")},null,8,["visible","text"]),createVNode(_component_cyberFileViewer,{modelValue:previewDialogVisible.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>previewDialogVisible.value=$event),file:previewImage.value,files:previewImages.value,"initial-index":previewIndex.value,"show-side-nav":!0,onClose:handlePreviewClose},null,8,["modelValue","file","files","initial-index"]),authorInfo.value?(openBlock(),createElementBlock("section",_hoisted_8,[createVNode(AuthorHeader,{"author-info":authorInfo.value,stats:stats.value,texts:headerTexts.value},null,8,["author-info","stats","texts"])])):createCommentVNode("",!0),createBaseVNode("section",_hoisted_9,[createVNode(_component_CyberInput,{modelValue:searchQuery.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>searchQuery.value=$event),type:"text",placeholder:toolbarTexts.value.searchPlaceholder,"prefix-icon":"search",clearable:!0,width:"350px",class:"author-page__search"},null,8,["modelValue","placeholder"])]),createBaseVNode("section",_hoisted_10,[createVNode(AuthorFolderList,{folders:filteredFolders.value,"current-folder-id":currentFolderId.value,"folder-loading":folderLoading.value,"breadcrumb-loading":breadcrumbLoading.value,loading:loading.value,texts:folderTexts.value,"breadcrumb-trail":breadcrumbTrail.value,"author-name":authorInfo.value?.username,onFolderClick:handleFolderClick,onBreadcrumbClick:handleBreadcrumbClick},null,8,["folders","current-folder-id","folder-loading","breadcrumb-loading","loading","texts","breadcrumb-trail","author-name"]),filteredImages.value.length>0?(openBlock(),createElementBlock("div",_hoisted_11,[createVNode(FilesGridView,{images:filteredImages.value,"select-mode":!1,"batch-mode":!1,preview:!0,onPreviewImage:handleImageClick,onCopyLink:handleCopyLink,onDownloadImage:handleImageDownload},null,8,["images"])])):createCommentVNode("",!0),!loading.value&&!imageLoading.value&&!error.value&&currentFolderId.value&&isFolderContentEmpty.value?(openBlock(),createBlock(AuthorEmptyState,{key:1,title:unref($t)("author.empty.folderEmpty.title"),description:unref($t)("author.empty.folderEmpty.description"),suggestion:unref($t)("author.empty.folderEmpty.suggestion"),"status-code":"","retry-text":emptyTexts.value.retryText,"show-retry-button":!1,onRetry:handleRetry},null,8,["title","description","suggestion","retry-text"])):createCommentVNode("",!0),createVNode(AuthorShareList,{shares:filteredShares.value,texts:shareTexts.value,onShareClick:handleShareClick},null,8,["shares","texts"]),!loading.value&&!imageLoading.value&&!error.value&&!currentFolderId.value&&isAllEmpty.value?(openBlock(),createBlock(AuthorEmptyState,{key:2,title:emptyTexts.value.title,description:emptyTexts.value.description,suggestion:emptyTexts.value.suggestion,"status-code":emptyTexts.value.statusCode,"retry-text":emptyTexts.value.retryText,"show-retry-button":!1,onRetry:handleRetry},null,8,["title","description","suggestion","status-code","retry-text"])):createCommentVNode("",!0),error.value?(openBlock(),createBlock(AuthorEmptyState,{key:3,title:errorTexts.value.title,description:error.value,"status-code":"ERROR_500","retry-text":errorTexts.value.retry,"show-retry-button":!0,onRetry:handleRetry},null,8,["title","description","retry-text"])):createCommentVNode("",!0)])])])}}});const index=_export_sfc(_sfc_main,[["__scopeId","data-v-773ddbae"]]);export{index as default};
