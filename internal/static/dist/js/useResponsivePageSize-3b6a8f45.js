import{r as ref,b as onMounted,j as onBeforeUnmount}from"./vue-vendor-31320f47.js";function useResponsivePageSize(options={}){const{containerSelector=".images-grid",gridSelector=containerSelector,childSelector=void 0,itemMinWidth=230,columnGap=15,rowMultiple=3,debounceMs=120,defaultSize=24,debug:_debug=!1,preferCssColumns=!0,minDeltaPx=8,mode="observe"}=options,pageSize=ref(defaultSize),columns=ref(1),containerWidth=ref(0);let resizeObserver=null,debounceTimer=null,lastWidth=0,stopped=!1;const log=(..._args)=>{},parsePx=val=>{if(!val)return 0;const n=parseFloat(val.toString());return isNaN(n)?0:n},cleanup=()=>{resizeObserver&&resizeObserver.disconnect(),window.removeEventListener("resize",handleResize),stopped=!0},calc=(force=!1)=>{if(stopped)return;const container=document.querySelector(containerSelector),grid=document.querySelector(gridSelector);if(!container)return;const width=container.clientWidth;if(!force&&Math.abs(width-lastWidth)<minDeltaPx)return;lastWidth=width,containerWidth.value=width;let colsFromCss=null,gapFromCss=columnGap,colsFromChild=null;if(grid){const style=window.getComputedStyle(grid),gridTemplateColumns=style.getPropertyValue("grid-template-columns")||"",colDefs=gridTemplateColumns.trim().split(/\s+/).filter(Boolean);colDefs.length>0&&gridTemplateColumns!=="none"&&(colsFromCss=colDefs.length);const cssGap=parsePx(style.getPropertyValue("column-gap"));if(gapFromCss=cssGap>0?cssGap:columnGap,!preferCssColumns){let childEl=null;childSelector?childEl=grid.querySelector(childSelector):childEl=grid.firstElementChild;const childWidth=childEl?.getBoundingClientRect().width||0;childWidth>0&&(colsFromChild=Math.max(1,Math.round((width+gapFromCss)/(childWidth+gapFromCss))))}}const effectiveItem=itemMinWidth+gapFromCss,colsFromMin=Math.max(1,Math.floor((width+gapFromCss)/effectiveItem)),finalCols=colsFromCss||colsFromChild||colsFromMin;columns.value=finalCols,pageSize.value=finalCols*rowMultiple,log("ðŸ“¦ Final pageSize:",pageSize.value,"=",finalCols,"Ã—",rowMultiple,"rows"),mode==="once"&&colsFromCss!==null&&cleanup()},handleResize=()=>{debounceTimer&&window.clearTimeout(debounceTimer),debounceTimer=window.setTimeout(calc,debounceMs)};return onMounted(()=>{if(mode==="observe"){const container=document.querySelector(containerSelector);container&&"ResizeObserver"in window&&(resizeObserver=new ResizeObserver(()=>{handleResize()}),resizeObserver.observe(container)),window.addEventListener("resize",handleResize,{passive:!0})}}),onBeforeUnmount(()=>cleanup()),{pageSize,columns,containerWidth,recalc:calc,stop:cleanup}}export{useResponsivePageSize as u};
